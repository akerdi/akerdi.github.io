<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2023落户</title>
      <link href="/2023/04/15/20230412luohu/"/>
      <url>/2023/04/15/20230412luohu/</url>
      
        <content type="html"><![CDATA[<h1 id="落户成功"><a href="#落户成功" class="headerlink" title="落户成功"></a>落户成功</h1><p>20230412户口本拿到，这里记录过程及中间的曲折。</p><ul><li>23.02.22开始提交申请</li><li>23.02.28预受理通过</li><li>23.03.14档案核实/教育背景核实已完成</li><li>23.02.15线下递交材料</li><li>23.03.17初审通过，等待审核</li><li>23.03.24审核通过</li><li>23.03.30公式中</li><li>23.04.05公示通过，流程结束。</li><li>23.04.08xxx, 已查询到您的准迁信息，请携带相关材料至派出所户籍窗口办理!</li><li>23.04.12窗口办理户口，拿到户口簿</li><li>23.04.15到手新身份证+办理劳动手册</li></ul><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>本来22年就尝试落户，由于带有随调老婆，她属于专科肄业，没有相关证件: <code>随调者要求学历/学位证书同主调人，否则主调人需要很高标准才可通过</code>. 我在去年不知情(新人事经验不足，工作即可随调)申请了三次之多(最后一次似乎是人事又主动帮我点了下)。所以一直等两倍基数的社保满6个月，也就是23年开年。</p><p>23年开年被告知工作调动，选择赔偿方案。我选择再次尝试落户，不落下来，之前那么努力不全成泡影了。钱可以赚的嘛，户口不是哪里都能落的。</p><p>22年能落的话，23年就能要辞退赔偿了，年终奖也没了，股份也被收回去了，现金亏死。唉，得一失一。</p><p>这次落户一次过哈，如果中间失误了，前公司就不理睬了，没有退路了。</p><h2 id="提交申请"><a href="#提交申请" class="headerlink" title="提交申请"></a>提交申请</h2><p>之前有提到，我已经是迫在眉睫要离开公司。具体事项谈好后，于23.02.22开始提交申请。</p><h3 id="申请人信息页"><a href="#申请人信息页" class="headerlink" title="申请人信息页"></a>申请人信息页</h3><p>这里申请需要填写本人教育信息/工作信息等，如图，其中【主要科研成功(工作业绩)及专业特长】栏目需要针对性的写全，花时间，找之前成功之人的借鉴格式。主要要表述内容1本人谁，什么公司什么职位负责什么。2个人发展历程，为公司贡献内容，带来什么结果。就这么多。</p><p><a href>申请人信息页</a></p><p>附加说明，职位或岗位可以写研发经理/研发管理/部门负责人等，在接下来的资料中尽量保持一致(没有影响，但是人事推荐)。</p><p>填写本公司任职的相关信息，户口迁出地要写对，户口迁入地信息填写房产信息(集体户不知道怎么填，问人事)。其中<code>户口迁入地派出所</code>我填写错误了居然也成功了，感觉这个不是很重要(应该是虹桥镇派出所，写错为了虹桥派出所)。</p><p><code>教育经历</code>正常填写，写最高学历信息。</p><p><code>工作经历</code>填写毕业开始的工作经历。本人毕业前实习就交了社保，那段时间不要写在上面。如我就写着: <code>2015-07 至 xxx</code>。然后再最后补充说明中手写一份材料说明该事件，如实陈述就好了，然后公司盖章，传到补充资料中，该文件在之后上交材料是要交上去的。</p><p>工作有空缺时间，就写待业: 主要工作内容:待业；部门岗位或职务:待业；工作单位:无；国家省市:中华人民共和国上海市；起止时间:xxx; 国家地区:中华人民共和国上海市；起止时间:xxx 等。</p><p>户口属地派出所可以在 微信公众号 - 上海公安人口管理 - 便民服务 - 属地派出所查询。我写错，却通过了是庆幸，但是后人不应该写错哈。</p><p>工作空缺我这里是有过两段，毕业后的最初两家公司，分别是空缺3月/2月。建议不要太多空缺，乖乖的好。</p><p><code>主要工作内容</code>我填写: IT软件开发。</p><p>正常工作的<code>部门岗位或职务</code>内容，老公司可以填写研发主管/研发等，如实填写，或者装一点点逼都OK，本公司如实填写，该title也不是很重要，但是本公司的<code>部门岗位或职务</code>需要和<code>申请人基本信息</code>中填写的一致。</p><h3 id="配偶基本信息"><a href="#配偶基本信息" class="headerlink" title="配偶基本信息"></a>配偶基本信息</h3><p>本人配偶不随调，所以填写内容简单: 随迁类型 勾选<code>暂不随调</code>。</p><p>如果有工作，如实写；如果最高学历肄业，那就是下一级的内容；</p><p>如果暂不随调，那么<code>配偶主要科研成果(工作业绩)及专业特长</code>就不用写了。</p><h3 id="子女信息"><a href="#子女信息" class="headerlink" title="子女信息"></a>子女信息</h3><p>正常填写，这里的户口迁出地址要和身份证一致，户口迁出地派出所在户口本首页，户口迁入地地址要填写正确。</p><p>户口迁入地派出所也尽可能填写正确，我这里还是和上边一样填写错误了，但是是通过的。</p><h3 id="附件信息"><a href="#附件信息" class="headerlink" title="附件信息"></a>附件信息</h3><p>按照正常上传。基本材料:主申请人身份证|基本材料:主申请人户口簿或户籍证明|基本材料:主申请人最高学历/学位证书|基本材料:承诺与授权|基本材料:结婚证|基本材料:配偶身份证件|子女材料:子女出生医学证明|子女材料:子女户口簿或户籍证明|教育背景材料|落户材料。等等</p><h3 id="上报"><a href="#上报" class="headerlink" title="上报"></a>上报</h3><p>人事点击上报后，过一两天即可在APP《上海人社》 - 我的应用 - 落户状态查询(经常用，下称<code>人社状态查询</code>)</p><p><img src alt="已上报，等待预受理"></p><h2 id="预受理通过"><a href="#预受理通过" class="headerlink" title="预受理通过"></a>预受理通过</h2><p>预受理属于线上审核材料基本资格，信息是否填写对应。于23.02.28人事通知通过，隔天<code>人社状态查</code>才更新看到。</p><p><img src alt="预受理通过，等待档案/教育背景核实"></p><p>这一步通过之后，就是把人才档案调入到区人才中心。人事会将获取到的调档函PDF发来，我属于外地，走的线下，打电话给老家的人才中心相关条件。</p><p>由于这块不是那么严，我打电话过去后，老家人才中心同意亲属带着相关材料即可办理。</p><p>办理完毕后也没有回执，可以在微信公众号《上海人才》 - 办理大厅 - 业务查询 - 人事档案所在地中查看。状态会从<code>核实中</code>，变为<code>已倒挡，核实完成</code>。</p><p>接着<code>人社状态查</code>状态变更为<code>档案核实/教育背景核实已完成</code>状态。时间来到23.03.14.</p><h2 id="线下递交材料"><a href="#线下递交材料" class="headerlink" title="线下递交材料"></a>线下递交材料</h2><p>于23.02.15线下递交材料，前天人事已经网上提交预约，到了可以直接办理，人才中心慢慢的人啊。</p><p>这里将手上所有资料递交给办事人员，她给个单子说明总共需要的文件，一个个递给她。中间可能有补新材料，人事还贴心的把印章带来，不然来回时间就没了。</p><p>这一步很简单，递交后，就完事了。</p><h2 id="初审"><a href="#初审" class="headerlink" title="初审"></a>初审</h2><p>预受理是检查填写和所给的材料是否相符，以及拒绝最基础满足门槛。</p><p>初审是区人才审核，这一步一般都能通过。</p><p>网上都是初审7天，之后的审核2填足以，我是反着来的: 于23.03.17显示<code>初审通过，等待审核</code>。仅两天。</p><p><img src alt="初审通过，等待审核"></p><h2 id="审核"><a href="#审核" class="headerlink" title="审核"></a>审核</h2><p>审核是市人才审核。于23.03.26查到<code>审核通过</code>(实际人事23.03.24告知已通过)。仅两天。</p><p><img src alt="审核通过"></p><h2 id="公示"><a href="#公示" class="headerlink" title="公示"></a>公示</h2><p>审核完成后，没有提示下一步操作，但是时间来的及则在本月公式，人事登录的网站可以最先看到状态，于23.03.30显示<code>公式中</code>，<code>人社状态查</code>之后才查到该状态。</p><p><img src alt="公示中"></p><h2 id="公示后"><a href="#公示后" class="headerlink" title="公示后"></a>公示后</h2><p>公示之后于23.04.05显示<code>公示通过，流程结束。</code></p><p><img src alt="公示通过，流程结束。"></p><p>公示通过后，人事会给你一份文件: <code>落户批复</code>。有什么作用？没作用，就是告诉你人才审核通过了，这时你等待户口转移就好了，没有人能阻止你户口搬来上海了。</p><p><code>同意人才引进人员xxx(身份证号: xxx)办理上海常住户口。</code></p><h2 id="办理准迁证"><a href="#办理准迁证" class="headerlink" title="办理准迁证"></a>办理准迁证</h2><p>使用微信公众号《上海人口平台》 - 落户审批查询，可以查到你的信息是否通知到派出所进行办理。于23.04.08显示<code>xxx, 已查询到您的准迁信息，请携带相关材料至派出所户籍窗口办理!</code></p><p><img src alt="xxx, 已查询到您的准迁信息，请携带相关材料至派出所户籍窗口办理!"></p><p>带着相关证件，夫妻双方(孩子不用去)前往派出所办理，填写相关材料，然后你会得到一张<code>准迁证</code>的一张纸。</p><h2 id="老家办理迁出"><a href="#老家办理迁出" class="headerlink" title="老家办理迁出"></a>老家办理迁出</h2><p>现在可以线上办理，但是不懂，于是还是走的线下。打电话给老家派出所详询。将迁出户籍所需材料寄回老家，家里亲人办理完毕后，再寄回来。</p><p>于23.04.11收到寄回来的除了相关材料，还包括两张纸，其中包括准迁证的右半边。</p><h2 id="办理落户"><a href="#办理落户" class="headerlink" title="办理落户"></a>办理落户</h2><p>于23.04.12办理户口。先去拍照，然后前往综合窗口办理，填写相关材料后，获得新的户口本。</p><p>完毕。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 落户 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20230308cpp_knowledge</title>
      <link href="/2023/03/08/20230308cpp-knowledge/"/>
      <url>/2023/03/08/20230308cpp-knowledge/</url>
      
        <content type="html"><![CDATA[<h1 id="CPP-Knowledge"><a href="#CPP-Knowledge" class="headerlink" title="CPP Knowledge"></a>CPP Knowledge</h1><h2 id="1-const-int-a-10-修改值"><a href="#1-const-int-a-10-修改值" class="headerlink" title="1. const int a = 10; 修改值"></a>1. <code>const int a = 10;</code> 修改值</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> b = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span>* c = (<span class="keyword">int</span>*)&amp;b;</span><br><span class="line">    *c = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"b ptr: "</span> &lt;&lt; &amp;b &lt;&lt; <span class="string">" b value: "</span> &lt;&lt; b &lt;&lt; <span class="string">" c ptr: "</span> &lt;&lt; c &lt;&lt; <span class="string">" c value: "</span>&lt;&lt; *c;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">30</span>;</span><br><span class="line">    n = *c;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">" n value: "</span> &lt;&lt; n &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>答案是: <code>b ptr: 0x7ffeefbff704 b value: 10 c ptr: 0x7ffeefbff704 c value: 20 n value: 20</code></p><ol><li>b确实没被修改</li><li>b、c地址相同，但是打印出来尽然不同</li><li>被修改过的值有效，可被赋值</li></ol><h2 id="2-类函数属性调用"><a href="#2-类函数属性调用" class="headerlink" title="2. 类函数属性调用"></a>2. 类函数属性调用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> Lval&amp;(Lval::*Lval_Func)(Lenv&amp;, Lval&amp;);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lval</span> &#123;</span></span><br><span class="line">    Lval_Func func;</span><br><span class="line">    <span class="function">Lval&amp; <span class="title">buildin_op</span><span class="params">(Lenv&amp;, Lval&amp;)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">Lval aval;</span><br></pre></td></tr></table></figure><p>aval如何调用func? 正常来说只需要复制后，调用方法:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aval.func = &amp;Lval::buildin_op;</span><br><span class="line">Lval_Func funcptr = aval.func;</span><br><span class="line">aval.*funcptr(env, otherval);</span><br></pre></td></tr></table></figure><h2 id="3-operator-正确使用"><a href="#3-operator-正确使用" class="headerlink" title="3. operator= 正确使用"></a>3. operator= 正确使用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lval</span> &#123;</span></span><br><span class="line">    Lval&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Lval&amp;);</span><br><span class="line">&#125;;</span><br><span class="line">Lval&amp; Lval::<span class="keyword">operator</span>=(<span class="keyword">const</span> Lval&amp; a) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>operator= 无法直接赋值，如: <code>Lval a; Lval&amp; b = a;</code> 正确做法是:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Lval a;</span><br><span class="line">Lval b;</span><br><span class="line">a = b;</span><br></pre></td></tr></table></figure><h2 id="4-operator-正确使用"><a href="#4-operator-正确使用" class="headerlink" title="4. operator== 正确使用"></a>4. operator== 正确使用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lval</span> &#123;</span></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Lval&amp;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> Lval::<span class="keyword">operator</span>==(<span class="keyword">const</span> Lval&amp; a) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>左右都为引用，正确使用如:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Lval* a = <span class="keyword">new</span> Lval;</span><br><span class="line">Lval* b = <span class="keyword">new</span> Lval;</span><br><span class="line"><span class="keyword">bool</span> isEq = *a == *b;</span><br></pre></td></tr></table></figure><h2 id="5-std-vector-v-v-push-back-3"><a href="#5-std-vector-v-v-push-back-3" class="headerlink" title="5. std::vector v; v.push_back(3);"></a>5. std::vector<int> v; v.push_back(3);</int></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;struct pollfd&gt; poll_args;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Conn* conn : fd2conn) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!conn) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pfd</span> = &#123;</span>&#125;;</span><br><span class="line">            pfd.fd = conn-&gt;fd;</span><br><span class="line">            pfd.events = (conn-&gt;state == STATE_REQ) ? POLLIN : POLLOUT;</span><br><span class="line">            pfd.events = pfd.events | POLLERR;</span><br><span class="line">            poll_args.push_back(pfd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>std::vector<t>::push_back() creates a copy of the argument and stores it in the vector. If you want to store pointers to objects in your vector, create a std::vector&lt;whatever*&gt; instead of std::vector<whatever>.</whatever></t></p>]]></content>
      
      
      
        <tags>
            
            <tag> cpp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20230307findjob</title>
      <link href="/2023/03/07/20230307findjob/"/>
      <url>/2023/03/07/20230307findjob/</url>
      
        <content type="html"><![CDATA[<h1 id="找工作"><a href="#找工作" class="headerlink" title="找工作"></a>找工作</h1><h2 id="本公司最后结束"><a href="#本公司最后结束" class="headerlink" title="本公司最后结束"></a>本公司最后结束</h2><p>那肯定要找工作的啦。</p><p>在公司最后一周，我还是继续拼命学习C++。因为C我基本掌握了相关用到的知识了，C++还有好多要学，所以这周基本在学习C++。公司环境人多眼杂，没有写简历，在家里也是忙着写完C++版本的数据库，同时阿黄的作业我也帮着辅导，罢了，等这周结束的时候来了。</p><p>周二的时候终于把人才引入审核信息单填写上去，并且手写签名，所填写内容是最后确定版本。个人简介部分也是参照海飞老铁，并询问过他是否OK，再三修改、确认信息后确认了。<br>能成便成，不成没有退路。这是用赔偿金换的机会啊。</p><p>公司2月24/25号办年会，我还想着去和过去合作的同学交流下道个别，我看名单没有我名字，我便跑去问人事。伟哥和我说，怕尴尬，好吧，便不去罢，没事。<br>23号时，还在学习C++，下午的时候感觉是时候了，就把电脑所有数据一盘清空，估计还有残留吧，黑苹果又没有一键清理所有数据。<br>当到晚上时，我想着把所有东西也一并带走了，但是另一个部门尽然加班到了9点半多了还不走。明天都要年会了啊喂，最后实在等不及了，一波一波把资料先拿到车上，上来再拿一波。终于拿完，包括我睡觉的垫子，回家回家。</p><h2 id="写简历、投简历"><a href="#写简历、投简历" class="headerlink" title="写简历、投简历"></a>写简历、投简历</h2><p>第二天在家里赶紧写第一版本简历: 使用以前用的iOS模板修改，把基本经历、项目描述清楚，先发送一版。目前想做的是C++，但是所做的公司项目基本都是Nodejs和iOS，第一版只是表达了我做了什么，然后我申请职位是C++。工资方面也不能要太低，要生活、要还贷、要养娃，先定个目标，C++接近目前工资，如果找Nodejs简历，就找目前要高很多的工资来。</p><p>简历发出去，全是华为OD外包的人事来找，感觉IT猎头都快被华为外包给淹没了 - 已经找过，继续发给我，真是多啊。其他公司的人事回复甚少，首先获得一个C++外包的面试机会，肯定先得到面试机会再说。面试中感觉都OK，问的继承相关问题，如虚函数概念；还有仿函数作用等等；再做了个Leetcode题，挺简单的。大晚上9点面试到10点多，后来也了无音讯，好吧，外包都不要我，哈哈。</p><p>第二天面试Nodejs，网达，这个名字我喜欢，我对旺达也很喜欢。工资是比较低的，理解，去就是写代码而不是做其他相关事务。不过从话语中听出，工作任务还是蛮多的，网上查了内容评价啥的，围绕工资发的及时，其他就那样。先拿offer吧。面试Nodejs，不是面对面，居然还是会有些紧张。户口没下来、简历还没拿到一个的原因？房贷无着落的原因？反正交流中一开始介绍时正常，然后不断回忆，控制精神力降低情况下，居然发生一点点紧张发抖情况。后来人事通知给offer，聊工资时，他们给了该岗位(17~19)最高工资，我觉得太少了，问工资还能谈么？她说回去问下。时间来到了下周一了。</p><p>第一周目标是拿到2个offer，姑且算1个offer吧。</p><p>周末又修改了简历，和老婆一起改，把iOS全都罗列一起，Nodejs工作业绩突出，C++项目多写几个。并且目标职位、擅长能力等突出下。C++岗位期望薪资也更加贴近真实实力: 想要拿17k的C++菜鸡。</p><p>第二周，周一，上午去外企ceren*面试，早早过去，然后赶紧拿出手机在楼下加油背更多知识，别等会考到。差不多时间上去，等9点20左右，在小房间先做C++面试题。题目都是英文，我做下来感觉都是C语言基础，cover(有个疑惑的问题回家后也查证，是以前学了但忘了的)。最后两题没做完，面试过来交流了。</p><p>先自我介绍，交流交流我的工作，iOS部分我就一笔带过，说以前承担的项目是如何的，有没有什么丰功伟绩，有那么几样。再说到目前公司工作，包括所做的内容，按照时间顺序交流了下所做的项目内容及遇到难题等。然后他交流了下他们公司目前做的 - 车载方面，但是底层核心是德国团队写，我们这里有限的几人能看不能改；上海团队做的是使用Typescript做中间层，但是遇到问题也是需要看C++相关逻辑部分，也要注重算法效率部分。所以招聘的也都是要比较强的团队。说到Typescript我就不困了，我强啊，哦不对，这个简单啊。但是我个人觉得，比较像目前公司的技术，写写中间胶水代码，然后和上下游沟通，重要的是要有找问题能力、解决问题能力。那我写代码就少了，我得考虑下。</p><p>快到中午时，和面试人借个电脑考继续教育的试，考完12点多了，好饿了，不过他说还有4题笔试题要做下(这在之前和我说过了)，我做完基本1点多了，我说做完OK了。我和对方一起出门，半路他把我拉到小屋子，问了说我的目前薪资是22*14+其他等等，期望会比较高。然后我们稍微再交流交流相关的，比如我的个人作风，工作态度等等。最后我下楼了。</p><p>半路拉我进屋子交流，基本确定这个offer是有的，不过工资多少不清楚，回到家继续发发简历把。那天中午赶紧乘地铁到嘉善路，然后开着小电驴回家，2点多才到家吃午饭。当天下午人事就打来电话问。大致了解，涨幅觉得还是能接受，做Typescript，基本这个是入门价把。老婆说这么低，她前端同事啥都不会，去深圳都也20多k；她现在前端同事啥都不会，工资都13k多。我在觉得价格尚可的同时，也同意试试其他公司，看价格有没有更高并且能待久点的。在我看来，至少现在获取了第一个offer，心里宽慰很多。</p><p>当天下午，先拒绝了网达的offer，工作对应的工资他们也给到位，只是我想拿到更高，或者我做C++也工资低一些也是可以的。晚上7点是杭州金融公司面试，问了好多好多C++金融工作中的问题，比如”如何判断float值是否等于0”这类问题。如果说float值有效数值我答得上来，这么问我就没经验了，嘿嘿；然后又问，那你知道float值的存储规则么？我特意记住正负号的，float值比较多内容就没花时间记，只记住一点点。然后也多问到多线程等问题。最后我知道应该没啥机会，就拜别了，反正我努力回答了嘛，小部分还是OK的。</p><p>这天是真累，晚上心情低落，打了会游戏，头更晕。习惯之后，发现脑子能量一直都比较低，容易很快就没有能量。第二天头晕晕的，不想搞东西，做了会游戏，又把”斯巴达克斯”的解说视频看完(刺激)，就到了晚上了。赶紧睡赶紧睡，睡前整了下博客，时间就又来到了23:20了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> hire,job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/03/07/Overview/"/>
      <url>/2023/03/07/Overview/</url>
      
        <content type="html"><![CDATA[<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>uuid: 2dcbb366-774e-09f8-a9ae-ce2e4861a9ee<br>uuid: 9cdf3758-8d1a-47e1-7cbd-8489a20273b5<br>uuid: b4f188e1-ffc6-d405-3317-c64775bab6ee<br>uuid: e6b29139-d39e-d257-6196-d8cad9db5289<br>uuid: 9fc0bfb8-1da9-6a07-53be-801eedfb5d4c<br>uuid: 80c17cc0-3f96-5393-0c56-bf1e95a93607<br>uuid: 6fa401b4-a17b-13f8-3d7c-49e9d932e812<br>uuid: 92bb7d37-50f0-e2f7-1aed-2995b7c8fe3b<br>uuid: c69f7c63-572d-9d95-5790-2d538504bce4<br>uuid: b3fdd412-46d8-02c2-7425-d0b0bbc3172b<br>uuid: 8b91dbc4-e6ce-3bf6-f920-4a165f7153e0<br>uuid: ad9fc685-9d4b-872f-2247-fa07b09b90a8<br>uuid: a8dec307-a708-e842-a5b6-935713af84c5<br>uuid: ee029fe6-8e1b-4fbe-a07d-0acc61faa9f8<br>uuid: 4cf81f76-821d-9477-08fe-543d24378d9f<br>uuid: 5cff601e-342a-ecba-f0ab-d78753eb8258<br>uuid: cc2b69fc-54b5-365a-71e0-1b6431a2ebdb<br>uuid: 744c7f95-65e5-75d2-6d84-e1e30b58d595<br>uuid: 79ebf8ad-6ec0-bdf6-bd42-59455fbaa531<br>uuid: 15a7e62b-3f3f-3706-4c51-1aafb1ae13e7<br>uuid: 509073d6-fb25-31b5-6e41-1e8b092ff088<br>uuid: d136527a-4f3b-efa5-5972-c17c38efdd7c<br>uuid: bc750b28-e8b3-781a-15cf-8a3d481dc9bb<br>uuid: 1882c980-120f-790f-1865-48f8811c88c4<br>uuid: 7059fc8c-88f2-04f9-e317-e2e3981080ed<br>uuid: 561e7af0-8643-8e78-5bea-49b0df09b70b<br>uuid: d0e09282-c8b3-1e1b-a886-919e0540fc12<br>uuid: 10070995-0274-f91d-6ea1-b2e18101c4e1<br>uuid: 79894b1c-4d10-d9c2-f62c-3ca5c3f33035<br>uuid: 4752c03d-dbf5-67b7-710d-e8a70568752b<br>uuid: 5a7e6553-7c4c-2a34-0cee-319db0742f5a<br>uuid: 2bab7bfd-80e8-ef29-d785-27f1afe36a92<br>uuid: 098a1403-7a38-b6da-eae6-354461f9b3ac<br>uuid: 16b614c1-3f8a-9511-17f2-5b44315f2937<br>uuid: a1390ac0-654d-9474-c9f0-7baddcbda350<br>uuid: 47e22bfc-e9d6-36ce-8eaf-edd2c878bcff<br>uuid: 657ecc44-e34d-cd17-fb00-e94864a4981d<br>uuid: 0dc41abf-98f6-356a-4048-380286485c45<br>uuid: b7bc3dea-f10c-4504-59fb-09ca8904a090<br>uuid: e5ca8899-097d-0da0-0bb9-314d6d194014<br>uuid: 1672b545-ff98-bd0a-106f-9c20ce255f12<br>uuid: 11769a95-c291-604b-b7e1-48963cdf26dc<br>uuid: 40e90660-327a-08a4-cc3e-b6fc1ccf7d55<br>uuid: f9fdf565-8679-633f-a1e2-29e87300ba58<br>uuid: 4f15bd6a-baf7-578a-0222-acd7780c5301<br>uuid: 0b8aef43-4f8d-3bed-0723-148846f4bae5<br>uuid: 0e0dc495-dceb-7f3d-bfdf-d850103a814c<br>uuid: 0f683e8a-6a1d-c0c9-bf52-b0e5c43d3d6f<br>uuid: 7b03bfd4-6d14-09ed-20b5-323ba5c7a9f1<br>uuid: 59e70a63-69dc-7bf1-fd8e-3cef2f4f853a<br>uuid: ca623f60-b5fd-0e02-f749-f7f62d43a7c2<br>uuid: 0e7a5948-21dc-2560-dc7e-605e95af9e95<br>uuid: 8e1f9a28-fc4e-1128-4a7a-fe34df1d5d19<br>uuid: 69c0b141-6efa-0f85-17be-30212f462195<br>uuid: 011449a6-f9ad-0f13-12fc-deafa00e517f<br>uuid: 08d515dc-1be3-4c92-dbcf-70c2fd3558b9<br>uuid: ab0c6473-d39f-a9d2-c7e6-a1bfd74cb645<br>uuid: dbfe68cd-29a8-3bb4-8770-7e9bb4ada4ce<br>uuid: 7da001d1-4096-b14a-1d3a-8360623eb0f9<br>uuid: e2253c7c-6623-3e4f-8858-2eeba539ac0c<br>uuid: b4256055-a1eb-8010-59f3-0242cdc06c96<br>uuid: cb1989f8-9e9b-b4e4-a552-06dd99ca658c<br>uuid: 8b5afa3b-6182-73e4-e675-c0fe65022cf2<br>uuid: a053cf2e-8f19-0ced-9350-047d0629095c<br>uuid: e4c147cd-7fba-10bc-8286-2a419b7540ce<br>uuid: fd0668b5-c7cd-6b9f-1c98-64df78979dd5<br>uuid: 505446cb-8b92-c9be-5258-05ed57126796<br>uuid: 163cd623-f809-8a43-97aa-d36ce4e30a21<br>uuid: d2a607b4-3933-8fad-dd07-87d73047942e<br>uuid: 4e755322-1a2f-3169-148c-87a5c3a85d83<br>uuid: f2255bed-d5d7-a2ab-f972-35e985c38fc4<br>uuid: 84e83907-b6ee-f6cd-2b51-87f87c002429<br>uuid: 07bac8f0-8e67-75fd-bf6c-fa1dd79c9651<br>uuid: e7e54a6e-ae90-b508-bd48-c00d6e98c7f1<br>uuid: 38237a41-d2d0-926b-5847-b2c6eaa3d8d6<br>uuid: da4c01c4-a367-3201-089f-8abec6eb7969<br>uuid: 6dd210f2-0a41-7bc7-9ffd-06add8682cd0<br>uuid: 512cee3c-270a-9b9a-f297-ead6bd5baa1e<br>uuid: 9487bd03-dfad-ca57-b574-7179002f3877<br>uuid: fe6205e4-2201-8a32-6a3f-0bb0ce613879<br>uuid: a71e9850-a09b-e978-fa03-635f4435e1e1<br>uuid: 7f8212b3-1587-f8c7-574d-1c7c88111b7a<br>uuid: 0181aeca-e7eb-6e31-902b-d657083ec4dd<br>uuid: a2b80176-bcbd-9605-bb4b-671e24ec5258<br>uuid: 45a366bd-00f0-cecc-df19-d9366cff33b1<br>uuid: 8eb0a99a-2026-fccc-d721-06d9c246781f<br>uuid: a97625c3-7296-366b-30aa-0b3010da3e3f<br>uuid: 164aaa1e-260b-44da-64fa-69968c959c45<br>uuid: fb14e3d3-682e-8e55-7936-a09e307a58f2<br>uuid: a9561920-4220-d134-b58a-d589880fba89<br>uuid: f528260c-b447-88cb-2718-3f5358e57089<br>uuid: 512aef2b-d96c-587d-7515-c642d7d5a933<br>uuid: abaec8c2-b1e8-ef67-e1e1-5f00c86ef1d3<br>uuid: c3fb587a-c161-8cce-9f81-e685596e9369<br>uuid: b610bfa9-026d-542e-e70f-8d861617995a<br>uuid: ac65cabe-9fcc-8ab7-b841-b63bb0ec1fab<br>uuid: 9c13747f-fcc1-d878-3da2-563f3a23dcf6<br>uuid: 0dcea89f-ba52-b22f-a353-42816934376d<br>uuid: 73a3d9c2-7f46-8c3a-94fd-5accb2fce0a9<br>uuid: 507b5851-3707-f1c9-e163-69b492d8bb2f<br>uuid: 39d0acdb-af45-7a5a-ab2d-fbbc15d9ae32<br>uuid: 8ac547fc-5f1d-99ec-5ff1-b246c02d2e0e<br>uuid: 09adcd87-0b52-ac3a-b5c8-fb007abb7d33<br>uuid: 53a846c1-d257-2567-a4d1-47a62b07dcbf<br>uuid: fa8e19f9-36f3-e999-57d3-e84b0c8aa68c<br>uuid: 0d17a556-4d9d-a03c-b82f-74a0499fabae<br>uuid: 705e735b-7dc3-81f4-363a-51866c22d572<br>uuid: 1f230ca6-afd4-5efc-40b4-03e3342021e4<br>uuid: 23da0964-5522-b31b-0a6c-7ee8ef73b46c<br>uuid: 46053ba6-69ba-972f-bcea-e21d5f7afce0<br>uuid: 9366d46c-84c7-674f-b232-8c6f103b2f54<br>uuid: 65b78a7c-5c44-8257-1b6f-2b56d3af897b<br>uuid: f7cd7d4d-d7ab-1a45-14eb-bf2e430fa379<br>uuid: bc00d833-5737-1677-434c-e72c0deed62c<br>uuid: 4e12184e-c908-173c-9972-ffd62b31b9a6<br>uuid: d22e8ed9-a58a-38ef-ba0b-0e9cd0b65467<br>uuid: f94863a0-8092-f3cd-cb74-969e602a4a13<br>uuid: a5a15509-5f00-90a7-1e61-c31aa360ffdb<br>uuid: 951a454e-a3f0-c09c-c0c2-891188142c96<br>uuid: 04aadb11-e432-a8c3-d7f5-6a7f3fea684d<br>uuid: a92eaa54-954c-2f26-6c33-2f16f82e14c8<br>uuid: 919fc586-eed7-e987-64da-7c61cd77696d<br>uuid: fa6083eb-45ce-870f-f74c-aaacbb897c5a<br>uuid: 30c8c3e9-d715-8b0d-5552-9a9d1b6c25a3<br>uuid: f7cec269-847b-3858-beeb-da36ea95d002<br>uuid: cb6ec074-0d6e-cd84-9e24-359f3349291c<br>uuid: c60c1f90-d01a-5966-635b-078c2e741880<br>uuid: b7d806b9-3b2d-a526-2093-fd8aa5fbbb46<br>uuid: a18717d5-875e-e4c2-67d4-a263c6ad8091<br>uuid: fcdc76f1-927f-edb3-bca9-3895cf650b43<br>uuid: ac037306-6957-de9f-935c-ae5daa3d2c35<br>uuid: 6ea2f9b8-ded6-9481-21bf-68a7b7a6a26c<br>uuid: 8d15d4fa-97b5-7081-5bd6-484830d5a699<br>uuid: 0222b7f8-0974-e144-d966-b9df8865eca3<br>uuid: 5f703f16-99bd-42d4-2260-c43bdacecc5b<br>uuid: 1678e672-ffb8-191b-374f-057a23f6f13c<br>uuid: e931d3c2-2b27-d02e-76be-9676e8bd06d6<br>uuid: 6c8cbc26-6f58-7bcf-abb1-e0a4a91462fe<br>uuid: d796643f-2381-66d5-c9f0-0dc70f4f57d2<br>uuid: a5d91bba-265f-8370-eed6-cff78a65efee<br>uuid: 87aff8b6-771f-ad68-3aeb-7eac4b6f7fbb<br>uuid: bde5b4c2-915b-0e6d-5f83-3d613d01eadb<br>uuid: f6d98c13-b837-6821-6a91-ef39bb5c8791<br>uuid: a4aa332e-e481-8494-986f-689ffdb7ba40<br>uuid: 61f3d929-b4c4-f1c5-31e3-90579e2ee727<br>uuid: 47c72115-ec7d-a553-086d-f1be11d13933<br>uuid: 0bc0a47e-1dfc-a019-edce-73873eb9fe01<br>uuid: aa59ad36-35ae-1b3a-37fd-c0039bc8b158<br>uuid: f7bb1dc6-b64c-e11f-8379-0f4af8fc536a<br>uuid: cdc8ccfd-276d-a911-8315-f31c090763b6<br>uuid: 5c0b1cda-7c63-e83d-b8d3-73e1b8ffa9b5<br>uuid: 2f49f7f3-48da-d764-e3ad-2294895754f1<br>uuid: 6cad6ed9-833b-97b0-f2a3-a38d1711da61<br>uuid: eea45e72-5200-9009-5ad1-5ac773812032<br>uuid: 0419551c-2552-62e3-e93a-9f92995c504b<br>uuid: daf36583-e798-34a7-59e4-54cdfb146aa2<br>uuid: 9e2d015a-7190-a15d-7a79-c4a212537c8f<br>uuid: 975d80b2-7325-c516-f44f-8429d9008ffa<br>uuid: f456de73-c4f9-72a0-a63d-a592f32dd201<br>uuid: e4304b69-a11f-e937-c69b-66f144b4da29<br>uuid: 23a0ec91-faed-f744-6569-a3663fb9f687<br>uuid: 1045ddec-891d-cc0e-75b6-2b7897572a71<br>uuid: f56ba400-c891-9686-636e-f38c03bcd888<br>uuid: e852e7c4-5a75-dcc8-576c-2e8dc3a5a126<br>uuid: e0832c1d-0aa4-7ade-e39f-7a60ca14b66e<br>uuid: 088e4b65-5128-ae73-b11f-2271c28ca555<br>uuid: 0ecbee70-f258-1ed2-6008-97fae1cfd1c6<br>uuid: d53ae0b1-b7f4-eb9d-d639-c44017a4fe56<br>uuid: 7c620a6e-b749-ca11-f159-5a4eb2779c30<br>uuid: a7330cf8-44bb-5c16-6387-82ff0161d360<br>uuid: a68c0542-891b-4b9e-f86c-5b2e4e84e598<br>uuid: 385f3838-258e-4696-9c3b-4e1c216640ba<br>uuid: 211c24e2-9722-99da-1ad0-52802415c900<br>uuid: 45fd7711-5a6b-c2ef-40f1-5d289a1cd2b5<br>uuid: 467c5e1f-f278-f481-b867-e447594f87e7<br>uuid: 0716f183-c239-5ef8-9457-9376dd2c4547<br>uuid: fc0bfbc9-6ff8-d002-f878-6cbcfea583fe<br>uuid: 1534435e-c702-c6fe-0f82-049a66dd23d4<br>uuid: 6a7ecb0e-b71f-d574-b22d-e2b47d7f7476<br>uuid: 986704df-912f-261d-96da-745d3d7e65f5<br>uuid: 39c6bc92-baa6-c89b-cbc5-4d21148ce5d2<br>uuid: 5524016f-cce6-f64c-1beb-1d8a517506ac<br>uuid: 912273a4-115d-0918-ee48-6db237d2967d<br>uuid: 9651bfaf-bc18-a5b4-be8b-baca70660f9f<br>uuid: 22d55b48-d51e-83d7-57a1-2157616c4968<br>uuid: d6bd08e1-f1aa-4cd8-0d10-3568807f41d6<br>uuid: 43fa85cb-547c-360c-ed27-276a45158eb9<br>uuid: 0ad17c61-1df1-05fd-2951-8ee1d956a32a<br>uuid: eec469a9-2d1f-ee58-be7a-91f3a626dbe3<br>uuid: 681a4713-937f-aa7e-b235-a810d79794aa<br>uuid: 89cc51fe-cb08-3fe0-d54a-8ba9c3c3ea68<br>uuid: f6b4db0a-d7f7-5c76-978f-905817ceb5a9<br>uuid: efcf3b9b-4ff1-6c90-42a9-aa4ff9a270d1<br>uuid: a533b8ab-def5-0a35-4ddd-757717650c81<br>uuid: 653c366c-c303-8167-0e2c-31219d23349e<br>uuid: 8a6442f5-0904-ce65-0b95-90f5fc618666<br>uuid: 712a9161-d202-71ee-b0e5-57b8b2292392<br>uuid: 2313f3b7-b489-d117-8697-4f1c1333c48c<br>uuid: 3b1fcdd2-baa9-87c4-a449-d5e43417a72e<br>uuid: 91547ee6-310e-dd5e-40eb-a47ebce43779<br>uuid: e50963ad-03b4-8898-4d15-cc533bf33478<br>uuid: 617910e9-3ec7-088f-f938-833d06dba946<br>uuid: b0b9c3a6-9467-af81-21a1-9a0ccc937e20<br>uuid: 3e5c8080-39bf-948a-6669-2af35aa66bff<br>uuid: ab07aa7e-3c55-44bf-dfe1-54e5f4cd4080<br>uuid: a59c510b-b251-f374-8d08-c77893748284<br>uuid: 6852cd10-353e-f70e-7230-271bd70f8083<br>uuid: 960cd295-0dc0-163c-dc8a-4487fc628261<br>uuid: 8d3fb060-cdae-227b-09c5-c3cb3f031309<br>uuid: 6f834b4d-7fd2-c000-2240-02f2f43e96d9<br>uuid: c46728f1-52a2-45cc-b7d7-2151cc602124<br>uuid: ec23a6a1-c03c-7403-7f9a-1eca77b10537<br>uuid: 510840db-6af4-474d-f38f-e461cf56b587<br>uuid: 967c9af3-bfc7-bc40-b7da-12785116042e<br>uuid: a89048c0-0d53-15c2-fcea-e5af345951f0<br>uuid: 8570705c-7bb5-6359-5bde-33d106ef7366<br>uuid: bc7dd61d-1de2-4ed1-906e-506c9bfc0094<br>uuid: 5602297a-166d-8f8b-66c8-51394975badf<br>uuid: 32636232-168f-9579-256d-d1ff063b88d8<br>uuid: 43b01d15-3cd8-e15e-8754-f7d5895c4bde<br>uuid: 4ebee87f-f624-2219-22c4-451dfa88fad6<br>uuid: 96e400bd-d8c8-3881-2832-581e9cd5fa71<br>uuid: 70c4e6f7-5f50-0215-9564-c09ec7eb7daa<br>uuid: cc91c74d-51ec-665d-619a-a880ef83a9e4<br>uuid: d0faec1f-b568-b918-694a-c2f0aa661b31<br>uuid: 5b8b2f2c-b67c-2461-cf88-000a32fbc09f<br>uuid: 0f236009-421b-dbf3-db0e-bcc39f8a6e9d<br>uuid: 0d4beb23-d43e-f723-35a5-d888413db962<br>uuid: 2c13d0dd-738a-b9e8-8f1f-cfbd4a38a083<br>uuid: 5d408475-764a-5b58-1fb5-69122f2a68db<br>uuid: 069ef650-3afa-09bf-e7ce-fb2a79397cb7<br>uuid: 35cd3ee0-8d7c-f905-3b68-362262e6856c<br>uuid: cb9ece29-fe72-9cf6-21ec-ccd9f13583cc<br>uuid: 3bbbef30-c1b9-92b9-bb30-8ca7b307629d<br>uuid: b70403f3-0857-1ec8-aec6-3a7aaf861b82<br>uuid: d5dc7473-e3a7-f428-d14a-d519b8e63f97<br>uuid: f2f5940d-974d-bfbd-7cdc-a920f88f4b95<br>uuid: 2caff677-9cda-3bb2-c4c3-3a3a875371b8<br>uuid: 6311bfaa-6ef8-02b9-86d7-75a0293e263e<br>uuid: 39c5e91b-2601-7d11-57cc-f137a6e76a62<br>uuid: be1739d6-d2bc-0f4c-4b28-901c7ec61024<br>uuid: aef0a69c-a53a-a6bb-cee3-892a1fd8e9e4<br>uuid: c821a27b-1788-3760-616c-dc239c7334a6<br>uuid: e3111abc-013b-bcff-7a62-4c95df32a390<br>uuid: b51af123-8f5c-a08f-631b-0985de8e8b2b<br>uuid: 2e562220-0afd-42a2-f75c-0c17a68e6dfe<br>uuid: c1b0f939-1edc-e580-b041-2d36386b3b46<br>uuid: 3007bfc9-d3ea-5b51-4cbe-2ae1b0f5c772<br>uuid: 8daf6463-cbf0-fd6f-63a8-080d8e06961b<br>uuid: 1996ded1-3d85-81c9-10cd-c57c7e15b8d0<br>uuid: 055f40de-82c6-5b90-b30a-4852ba83e484<br>uuid: fb85306d-3221-1fb6-5517-3d8725af5e70<br>uuid: 40d35acc-9cbe-29f6-5c6a-92bb6b057a69<br>uuid: cd373646-7c2b-7e31-7bf0-136f444b99cf<br>uuid: c56a7a41-db77-ef5e-690d-1b264d800817<br>uuid: 35321e4d-74cd-33c8-6bca-ba11397c0c1d<br>uuid: 6c996b2e-dde2-1758-0def-153320a9571f<br>uuid: 2bf8b76e-f91c-871d-f46e-d138c723c950<br>uuid: a8a7a95f-243a-f1ea-c5e9-62485838cec6<br>uuid: 5e001b97-d937-dc06-ba48-479f5cd7e3e2<br>uuid: 855068aa-7ca0-6b6e-4268-f0f2f6fa5e3f<br>uuid: 1f20f6aa-97db-ebdd-ef9f-a7e2daaa60ae<br>uuid: 6571d474-f3c5-7775-f6f2-349c21e55082<br>uuid: 8b4aff73-e3c6-2208-bbf3-f2d2d3acf8a7<br>uuid: 8b8019f5-94f9-fed1-7e45-6bfedd84cf62<br>uuid: 2610ea59-93f9-8805-5c06-237e47bf7312<br>uuid: 2fcccfdc-f0a9-66d0-a056-d9534892e29b<br>uuid: bf1d6b4e-9c44-3e5b-1c6b-a836d6205673<br>uuid: 75b3bb67-8097-bfdf-5d1e-d52afd25e1b4<br>uuid: 29406901-e672-9c9f-de81-bd07e1a2d91b<br>uuid: 68c0d9f5-a1d2-0368-ca15-a4096bb2c0ce<br>uuid: a93779ff-0ca3-aa22-b756-db6f56696cfe<br>uuid: 895fc295-d58d-51b4-d9cb-4844058f4a10<br>uuid: 41331eaf-4426-642a-7aee-ba3a44ed25c8<br>uuid: c1510d9d-3361-2518-9795-d43eae8c1744<br>uuid: 11411469-3170-0e9f-ec75-e751148b1134<br>uuid: 3e971e18-5891-241b-6662-33fe9e6348a1<br>uuid: 99e93a5d-f8eb-0e3c-6368-197ad1b2ad13<br>uuid: e2b39f4a-506c-1908-b88b-0abe9476a699<br>uuid: dc93af47-1d53-daa4-2ed7-26445a8cbf7c<br>uuid: bf81558b-ff7d-c7bd-32f0-5ab19a24abbb<br>uuid: 5e3a7e09-64b5-80e5-5275-453b1438f279<br>uuid: 88a2a888-4cbc-6884-c976-4ca1df70181b<br>uuid: 506db0f7-b62d-e966-6ffc-0ec93765d52c<br>uuid: a36488c0-6b36-e633-eed6-6e66e18968e8<br>uuid: bc5f9e6c-8018-6ca9-139f-e16de74c63f3<br>uuid: 4697d1f6-45a7-584d-f266-9d2819c096b0<br>uuid: 7c19d530-d44e-0fee-3b62-23f62746751c<br>uuid: 6bc0990d-7233-5f34-d8ec-274083101429<br>uuid: 4dca93c5-1290-4ff0-5726-e9bc6a804365<br>uuid: ee5b304b-1c96-f94a-19b9-cb1c2ff6985d<br>uuid: a83fb90c-8605-8994-17f1-0b2d9929371e<br>uuid: eb4b8d7f-be30-db91-ed98-cf5014de8c14<br>uuid: 9b22c975-5ce0-ae30-c542-ed57379a40b8<br>uuid: 9c091f5e-b950-9e9f-be5e-7bbdc843be94<br>uuid: 9c89e676-96f0-d6f8-3e35-e052f20c671b<br>uuid: 36af6114-e915-28c1-96be-aa914e7b5219<br>uuid: 05ab9163-4f6e-3051-62f8-bbac99b6a430<br>uuid: ce1e0c09-8c68-11d6-d053-6ce04204f747<br>uuid: 52188d2d-6471-3878-c931-bf1e1bb4ae3b<br>uuid: d3d66a1e-599e-350a-c500-0730c18dda9f<br>uuid: c4b7e1e6-b923-63c6-0104-4c9a36143d58<br>uuid: ca5dc6d8-085b-c962-de3a-73f8b880f826<br>uuid: 1eb50551-d23e-f66e-6625-4d5b86857498<br>uuid: 74d1aff5-18cb-1fed-bb0e-e3b90add4df0<br>uuid: 8608e09e-c345-623c-df13-85a706d3c42b<br>uuid: 86080503-0dca-0dfb-19e8-7a5c9a22e3ba<br>uuid: cfcbb85f-bf6a-e49c-0fe1-6efaea6b7e62<br>uuid: c46fabef-878c-6922-22e8-b07e6df5d323<br>uuid: cbcff5d5-30fe-e446-9639-8d386eea90a4<br>uuid: 06edc511-106c-17e2-8be4-8d1d8af7cd7d<br>uuid: c5f5e5d3-9b0f-5cc9-4675-0834d470f33c<br>uuid: 3f654188-934e-82c1-c7b0-2060483c7f86<br>uuid: 2859489f-a5a4-8264-a363-2dfdc1eb7829<br>uuid: c1cb5b2a-b96b-b700-4ac3-7fc59d51614b<br>uuid: 195ebbac-c0ba-cf40-69b5-3ad32a20daf0<br>uuid: f67cc8b8-f389-57a1-9cf4-74ede55e0459<br>uuid: b4149df9-51a1-ff5b-4886-e57231ecc72a<br>uuid: 5b393cd7-4c55-36f7-61c7-9a424eb69fed<br>uuid: 878c0902-97e2-d81b-a9a3-9a7383761170<br>uuid: ccd384c4-dd87-e5e2-4981-572f0831686a<br>uuid: 85ce62a4-777e-5dae-ee39-0b6d498afaaa<br>uuid: 776b0f3f-c7b6-cfea-d5bb-8096c6cc3d71<br>uuid: b1481ca0-0c74-1896-3c21-a83b4745a34c<br>uuid: 882bd406-ef04-4e54-8398-290fe52db448<br>uuid: 3f73c569-a48a-0d37-416b-96856f7a79b2<br>uuid: 3dfc1e3f-9812-022e-6a46-f18833360c8c<br>uuid: c75c4f00-034c-5479-17c1-d8648a92da21<br>uuid: 06fe0005-c44e-4b3c-760d-74420305fc4e<br>uuid: b6555b5b-4792-cb0d-d991-cd74a7875fd6<br>uuid: 5a34e1a8-d2c6-7f67-aaa4-664935efe4cc<br>uuid: 2839fc31-f637-4f1f-a3c5-221be60f509e<br>uuid: b896ead3-c48a-79a9-e844-d96247b37926<br>uuid: 77258c26-f271-fe4a-4b4c-a03bf3715f22<br>uuid: 427c6790-a908-d960-d081-853d41e8d6e4<br>uuid: 51ae7582-545d-9a07-386b-068f5fa07eb9<br>uuid: 8502e80d-a3f0-9f1d-a30b-8daa58f7fb60<br>uuid: 9912f770-6478-7b41-ae11-ffeea910fee2<br>uuid: 219d3692-580d-46b7-9889-a466680da541<br>uuid: 83d9bf94-d121-94dc-3bc6-2e3ee1f4d997<br>uuid: 2b2e7b56-b534-fcd9-8051-adf75b79c50e<br>uuid: 0473681f-9db3-bf7c-18f3-7145a5471600<br>uuid: 0763522a-231d-6523-5f08-25e5fe2476f3<br>uuid: b7021774-e182-3a45-ed95-ec0eed628c47<br>uuid: 93ffe89b-2b5c-4e12-6a97-5dacc89dbfc5<br>uuid: 46f643a5-eff1-d697-94ed-62d3971583f5<br>uuid: 4f0c6234-fec9-78ed-3bfd-6c64ac061ddf<br>uuid: 3f31060a-3adb-56b8-f7df-224032ae695f<br>uuid: b76632ad-fa23-21cc-e74b-569e70ad3e6f<br>uuid: 8052fafa-d008-bb1f-108c-ee55fd05f04c<br>uuid: b12e66af-931a-b092-a3b6-ab537a514e95<br>uuid: 042ab334-062f-f347-57c2-88c7652a1989<br>uuid: f289151e-31cc-f183-d5eb-b1af6af56e12<br>uuid: 01c7078a-c98a-9107-d52f-98a1f412917b<br>uuid: a66d1c01-69f3-2b3d-e7a2-274f5efbdf44<br>uuid: ea27e3df-766b-b513-8e2e-eda8e15e1e3a<br>uuid: 4703e145-83e9-b7da-79cf-6bbd001b9199<br>uuid: e95a2854-2f6b-cb40-83ec-dba73d83bdc8<br>uuid: 6e24e135-001a-5a1f-9d47-55cada7e6d5e<br>uuid: ff387c64-4b0f-f447-2f5a-5e94ed678057<br>uuid: ebecb7c3-a33f-d386-8850-4d86ce6ea576<br>uuid: 3c6144d8-ca2a-ca80-e34f-d6a2fd479de0<br>uuid: fd47f2fe-d587-2df2-3a8e-d0e0a14fb2a4<br>uuid: b98808db-5d82-0fa2-a86c-ebdc71eae6f1<br>uuid: c0a19ca4-1d42-899d-62c0-a88d0bf553b9<br>uuid: 0ff54a58-1d68-2c7e-3fe3-150da38f1042<br>uuid: c1bd661d-8518-d490-e76a-197d7df8c08b<br>uuid: 7af2ed1b-e52d-fa62-c391-d877117952ba<br>uuid: 3fa8bac8-8594-7f77-1a3c-f3bc21c4bfa5<br>uuid: 32496042-5f5f-0d1c-d8ab-209046554edf<br>uuid: 0747f2e0-747b-445d-b9b3-ed9bb3bfd1c0<br>uuid: 4f8002de-b12b-dce7-3855-0c6db4ea9a97<br>uuid: 729cd3d0-103f-ea40-f4cc-273901c60954<br>uuid: 444ecaeb-c223-43d9-3e3d-5035b89ba3ab<br>uuid: 68628d71-0592-f250-f86b-3a8050ca5b4d<br>uuid: 748fc95f-1f73-f959-64c5-d97051c5a19f<br>uuid: 467bc99d-cdec-eb0e-44fc-82cd5b102346<br>uuid: 8aac6df3-4fa9-4ba7-4258-484af8c976ea<br>uuid: 89c4105c-eb42-2732-d064-2cc52955ed0d<br>uuid: 714447d5-9ef6-99a3-6c3a-2f3b67480843<br>uuid: b4933192-e69b-1a63-1e56-a851051a2a4f<br>uuid: 91df2a4a-00b5-0fec-9b79-c2c27e03b63c<br>uuid: b5907a8d-c120-c014-95ee-258d79d1d3bc<br>uuid: 267b7d0b-9b1e-585c-9f20-79416dd91020<br>uuid: 0d425c2e-e866-fcfd-4c7e-f08c8adf2805<br>uuid: ef04d731-32ad-f028-3c5b-1edb4cd6ea85<br>uuid: 3cfa122d-0093-73b3-6211-4247d3a6fb76<br>uuid: c4f4df7d-51c5-5b68-6071-c66a5686a944<br>uuid: 2b4a0a0b-8564-9edc-8b46-09f8326a66cc<br>uuid: 17bf1910-b521-6ba6-36c3-2ece8a4ae681<br>uuid: 4c3347cb-0871-14eb-9898-99d0bd8ea910<br>uuid: 90d1eabf-4f3c-cfe0-49b9-b754c3c1970c<br>uuid: e9ca117e-235a-fd9c-6b2d-a5262363777a<br>uuid: 99ced8f5-90a5-5ed6-9373-a0c3ce083d39<br>uuid: 39f18e0d-e0d3-361e-e66d-38ef20f55aca<br>uuid: 9136b977-1208-755f-1f56-dad1ce939795<br>uuid: 75a2f596-8a13-2873-88b1-85450e738662<br>uuid: 05c2dc69-e3b0-522d-e819-593220f7e3ee<br>uuid: 352b3b26-55e8-61ca-dfb1-63da9e603bde<br>uuid: 4446f856-4769-cbbb-5d28-be167d08101c<br>uuid: 9c091e6e-12d6-a8c3-d371-feff0a0c59b4<br>uuid: 827137c4-f002-bda7-e2aa-994db739b9de<br>uuid: 29768711-34d9-d6b3-fe12-fefaf230ff41<br>uuid: e70f8791-6186-8cc3-4f5b-932814ae9aef<br>uuid: 5e4eb299-454a-b3f4-4004-962b4b5f92ea<br>uuid: 7c459d5f-dfb4-d14c-3dc5-61210821cadd<br>uuid: 54867872-556e-aa8a-4369-8641c914026f<br>uuid: 86392b33-e78a-9689-33eb-e8bdb57ceec1<br>uuid: f7c8125c-1f4f-57d5-404d-1270864d0318<br>uuid: 2030afee-fd11-65b0-2ce6-d762d8a21341<br>uuid: d24a7bd9-1d6f-3deb-a327-848bd9f5c5bd<br>uuid: 2c94b36c-1c3c-8366-b1b6-a91acda033d5<br>uuid: 4dcbdd26-b108-22f1-d763-c99588e06cb0<br>uuid: ef69a34e-fb73-1dae-271f-591f8c38018f<br>uuid: a0346700-cb26-7f3e-1550-5f2ea57588af<br>uuid: e2f826a5-696b-6177-24f3-828e4c809c31<br>uuid: 88086b9d-e87b-0905-5d6a-9efd36386a80<br>uuid: c4bec16d-1ac4-a481-cecf-10352958a213<br>uuid: afb3d504-c93b-9be7-f6d1-755612fef6b5<br>uuid: 5c7adfd3-7ddb-49db-f5e6-c8d79b65b795<br>uuid: c5ff44d8-7b6d-dca7-4469-d3cec78b191d<br>uuid: 5db8fb82-5273-8a19-5e57-1dceeb88dc61<br>uuid: 372a5f8e-f571-080f-279e-dc6cbf347ba0<br>uuid: 58c66f3d-3cfb-cdad-ce8b-e08de0976893<br>uuid: 12107404-6594-a807-4a24-5fa93ce073d3<br>uuid: 052cdd40-4ce7-25c1-b293-998a7dbd7880<br>uuid: 0b2a23fb-f1e8-3125-9658-7f53d7316216<br>uuid: 823e85c6-4eb2-bd50-6802-3c3f5028b823<br>uuid: 326b4dfe-1ded-cf4e-1b53-9bee9daadbec<br>uuid: a1dfb330-631a-8fe1-ae85-7774fa8fc7d4<br>uuid: d0bbe11f-da83-e552-10de-cf8fbf074b16<br>uuid: cf497bd3-d4f7-c887-e185-849e60f77717<br>uuid: 09093218-a318-9c7b-1b5c-c87005b45709<br>uuid: a761e4db-4a80-617c-f3e3-765a6a67c3c3<br>uuid: 14f1bd64-e1dd-4bd3-2cf0-a024259ef1b7<br>uuid: f46e01ed-cb18-d333-11aa-e85f0d0d695c<br>uuid: a05e4ec1-1943-de91-7595-25ea8e12b49b<br>uuid: 52fafcbd-050c-6a0b-aaf4-bfb759d4b788<br>uuid: 53a1c1ec-5696-5e1d-563d-e4747a5b7716<br>uuid: 9e841563-5145-037e-47e9-19e9c2762964<br>uuid: 83dd356c-eb6e-ee22-c34c-1685da5597d9<br>uuid: 5b88c698-6aff-bff9-fa62-52af4724d2a9<br>uuid: 426e9431-a972-6894-d361-929b39168f4c<br>uuid: e87b9611-8419-a968-8511-3e8330878ec1<br>uuid: c605b914-c705-9581-493b-71164808ba44<br>uuid: 47e90af8-d848-ecb6-419b-bbec41c6d5ef<br>uuid: 3dd44813-cfa2-6da0-d1b2-621bc9e51caa<br>uuid: 04fc5c5f-f302-e845-3f1b-786f6953d5d5<br>uuid: 885aee58-c2b7-e38b-9a50-45ee388324b3<br>uuid: 27343023-5f1b-27d9-3d40-ba0cc7e11705<br>uuid: 1c0d51f5-6b79-68be-18b3-8997606a3da5<br>uuid: cd43302f-7923-bcf3-262e-67a3f7deba6f<br>uuid: f6d98edd-0cfd-7ae8-f100-4ecc3599da4a<br>uuid: d98c5499-19f2-267f-131a-df5f41841fdf<br>uuid: 3f4721e8-f537-7e42-3011-72c7fa7fecea<br>uuid: 92e57f1d-0bee-c645-c10a-64cb8d68d791<br>uuid: c10f4028-ddbf-1a50-fd32-82d6dfb1d943<br>uuid: ad4ec29f-dc7e-4b06-8621-1c33cd916435<br>uuid: a2149e01-15bc-22bc-ef0b-4e8475975d7c<br>uuid: be4d2641-f30d-96be-0916-a168c934abed<br>uuid: e9fcb33c-b7b5-4392-f906-1d2c8a24b060<br>uuid: bcf2a2e3-00e0-ca88-9a35-965502bdc063<br>uuid: 4a4492be-527a-0e9a-e3b9-3025d5e38a25<br>uuid: bc34bc49-c0a8-f557-9ca2-ec5e488ded86<br>uuid: 8a03863c-ba11-64aa-3bb3-edcc0f7970d1<br>uuid: 71d2e720-81fe-65ee-b596-c5b2f486c4e8<br>uuid: 4005fb35-7ec0-aa12-482d-d48facbae711<br>uuid: 0195dd7a-9c00-e8a5-413a-6cd27c169613<br>uuid: 5cdea146-723f-8a3b-fdc6-3a73608e3548<br>uuid: 3e991504-5d7d-48a5-5a6b-683cf75f11d7<br>uuid: 5db78e5e-faf8-0a61-9493-a801f83109fe<br>uuid: 381b15fd-81b9-ab45-64a0-1799cfb9a65e<br>uuid: 81b0e9a8-312c-3c88-c595-3f30c4be2018<br>uuid: 78372752-433f-085f-b5fb-44ff77246d3d<br>uuid: 99dd4b17-d485-c092-377b-fa2440cf879a<br>uuid: 5187b38c-71bb-7012-6fc5-5ee916b90b91<br>uuid: 32decf35-e089-ea2f-9eb6-ae35187a4e2e<br>uuid: dfbe20a5-b19d-08b7-3682-4e5fd959f33c<br>uuid: 27603fa3-36b4-294a-0a92-f740e3787b4a<br>uuid: ac335b46-d548-49c3-6363-b52ecadc8b1b<br>uuid: b702b310-e3f9-67df-9644-d307d4dad226<br>uuid: 76d373c7-d1f4-13f0-ad86-0d5c72f1fe2d<br>uuid: 1785eee3-26ef-9b4e-3132-a35b5a2e8612<br>uuid: d2b75711-ec09-2b4f-6345-7424a6fb276a<br>uuid: edd587bd-6bb1-71f0-0a36-2dc4b933cd1d<br>uuid: fb08e28a-2bd8-044f-9d7b-cc6bf8accd34<br>uuid: b3ac203e-861c-8dde-ac92-ba3b43938f31<br>uuid: bea1d4fb-da09-136b-8a67-1270114a302e<br>uuid: 86057c0e-6366-6f8c-32f1-62692bbf5f1b<br>uuid: db06ea84-8c35-30c6-4448-221bb62e73e6<br>uuid: e7588472-a082-78f9-6557-fe6549f6523f<br>uuid: 592ca210-9e42-5148-d257-1a70a6d42f8c<br>uuid: ae6dd02b-6203-4c0b-696a-3590992849f5<br>uuid: 8e31d170-5805-d368-d2d1-fd89d493a4c8<br>uuid: b7b695d0-3af0-ad78-08cf-f3765c0b84eb<br>uuid: cc3c7e2c-a139-9c04-9a8e-3be98f78f00f<br>uuid: bacedaee-35f1-0d48-39c1-0eb26ac60f74<br>uuid: bdbeadf2-d618-44eb-3c1c-738c5734d3dd<br>uuid: d7521884-992f-12b3-897a-5289226109dc<br>uuid: c472346e-186c-c9f6-8823-a67fe590549f<br>uuid: 95399fd0-7cd1-a626-2ce6-ba14d6aaea37<br>uuid: bdc391cb-a0d7-0720-3f95-2d043f3c998e<br>uuid: a97bdf5c-039e-ba63-382c-3f1f80ae14c1<br>uuid: 71a3286a-0c16-2669-4728-ca8dff6f59f1<br>uuid: 27bdeb9d-983e-f18f-3a31-0bec88e26f64<br>uuid: 93ecf289-586f-d74f-c8bb-21964c4d6dba<br>uuid: 9c175f05-8bdd-5d07-fb17-fd9587d97c87<br>uuid: 6f40b0f2-a717-3691-768d-403eb381704a<br>uuid: 4a95ecbb-27c5-172d-407e-4d62efa26598<br>uuid: 9bb12f4d-0e24-a48e-5d4a-ba3be1e8f290<br>uuid: 5be0e2fb-ba4a-7fbb-140e-cdf6f655e6b1<br>uuid: 644238a7-7225-79ac-ea94-16825b0d159f<br>uuid: 1428f0e2-0f73-e602-0f6b-0c18119a2133<br>uuid: 5b590062-ae61-63f7-215f-3c8e62925ee1<br>uuid: eac24007-738d-57d9-57c9-9d51f1e1ab9f<br>uuid: 6449475f-70f4-babf-9704-c33d63112576<br>uuid: 5f943e9a-a263-babf-f1ba-b023f7d9a2a0<br>uuid: a6c79d40-0cef-40ac-d8bc-8830337c1d97<br>uuid: 265cd71d-c9a8-181e-142d-5dbec69fd93c<br>uuid: 1f5a3359-034d-9b3f-9d27-93ea7be0340b<br>uuid: 7a8600ef-83b6-8401-16bb-94f9a566eac3<br>uuid: 12c9f743-3ca6-ff71-781e-f244728b3697<br>uuid: 6a6f7879-cd4e-c73c-0089-535e4b35989f<br>uuid: e9ab1b94-3d46-22ba-cb1b-fa42493318ac<br>uuid: b6a2a51c-2c1f-46cd-8ba6-d0b3bee01b0e<br>uuid: 45ae9072-3938-59e6-5968-3bfa687175ae<br>uuid: ef35336d-d5a9-6d87-eb0b-7c68b72f3b20<br>uuid: d5a574ad-72fd-ec08-b84f-c3f4b7db0800<br>uuid: 57993e45-2e0b-37c0-fa3e-47a952717815<br>uuid: 3b67bfb5-ccb5-7aad-eb8a-fc26ce786e3d<br>uuid: d9de80f8-f08a-0fbf-1016-6506361f5509<br>uuid: 054d7d5b-09fb-9a09-f22f-7dbbb5552fd8<br>uuid: 33d5b70a-a1dd-45c7-3f97-25657d984eac<br>uuid: b8b9c4f1-b915-2f2c-87f4-73148f599c0e<br>uuid: 665a3a99-23a9-a665-9c7f-076a87e14d94<br>uuid: 1027ab07-8fdf-5fdc-2a93-93dd051d599c<br>uuid: 5b931b74-97fb-b621-71ef-04d4a5cbec20<br>uuid: fe86d4fd-588a-aff9-2453-b380ad366f0f<br>uuid: b2716486-65d2-d489-b656-54f9c2efb6c8<br>uuid: 20006b76-7b82-346b-b0fa-be54033f9a91<br>uuid: d341ef7c-da51-24c1-3752-9524c6eaf30e<br>uuid: 7cca89db-067f-349b-6351-e8d3cd704d38<br>uuid: 1db6cf74-f4f4-e444-0fad-5675013ea1bd<br>uuid: b70e489f-a490-ae38-06a3-58f3a111713c<br>uuid: 0e3102de-4587-7661-9de3-5ff185d64bfc<br>uuid: ac5148e7-a82a-540c-4aca-ce36248194f7<br>uuid: 27245988-cfb6-e138-4ddc-7109efb6ef57<br>uuid: 9b5d505c-dfaa-9021-557b-ad93874b196b<br>uuid: a1074813-149d-5bb0-b272-284ce129b05b<br>uuid: d2c92c01-173e-b0af-c1de-c25a308bbf76<br>uuid: 6516609a-0398-8d1d-d238-2b6f6d71513c<br>uuid: 249627a2-0b1b-4d47-42a3-fb1b865bae87<br>uuid: 8449f8a1-cb69-44cb-31f3-76808e071a30<br>uuid: 95e27335-74f5-aa32-9ef5-41e75e8c5956<br>uuid: 3fcc0607-0b9b-8e6e-8a57-fbe953923133<br>uuid: f198eddc-76ff-cf6d-e008-ce9cac9e241d<br>uuid: ed11572e-5185-4c98-bafc-c351732a9382<br>uuid: 294f4063-7b29-63d9-e770-01f2c4e23117<br>uuid: 8174ef39-c1d5-a99a-5608-96c7fbf63af6<br>uuid: 65797489-2be7-0a62-9e2b-f098d60d83eb<br>uuid: 948e27c6-f792-8305-54b9-a89af43124cb<br>uuid: ffd38592-2500-6917-3ebe-d90c8bd7e093<br>uuid: fcde190e-2c73-3bcd-784f-a9eb8d9d50ce<br>uuid: 76e53440-69d9-f210-713c-698c9d409c8d<br>uuid: 3072a1b4-1572-1caf-2bd5-c44c06c8a500<br>uuid: 6b743d1c-f81f-5313-d912-170077d9b634<br>uuid: 1daade07-3a7b-ae9a-bd34-619ccf874e20<br>uuid: 35333d51-cf8c-c10f-5ee3-64439a09fba2<br>uuid: 913237d3-cbfb-02ba-8b21-89a6b768611d<br>uuid: 7ac59933-4b8e-9df9-b672-b50b670e9d3d<br>uuid: e0f20ce1-dbf0-1c02-83b0-76e4dfa3a7d1<br>uuid: 3a45df7e-2a88-5637-9f04-1e7618a84476<br>uuid: 70a80832-59f6-c08a-b2f8-93a97e0da854<br>uuid: 733afc06-576d-3a89-0fcf-1a4e932d6df5<br>uuid: ff519ac5-1b27-b07e-a079-8ff9f9442f50<br>uuid: 5608d351-112d-b5cf-21d8-c4c6db90ece9<br>uuid: c0130682-4b49-28a8-6b03-251ed12d914f<br>uuid: 70c51b15-cd4b-1fc0-78b2-c47f7f7608e0<br>uuid: cc59d971-ba28-2172-1041-02acd094566c<br>uuid: fd9902e9-69e3-7543-cce1-ad3fe1ca4b0a<br>uuid: 10513c01-6e18-7438-c20e-38addee3bb77<br>uuid: 3bb1284e-edd5-f184-c9f9-2622ba51bd55<br>uuid: f6f62b58-94ba-d6b5-28bc-c0e85b062c75<br>uuid: cbf2ec76-1f08-a3a7-b040-f2f924bb018e<br>uuid: 9ef50c2e-8227-b1c9-faf3-8d15680169aa<br>uuid: 1e6415f9-f6b6-9196-bdd8-9123fcf05da4<br>uuid: b391f0c8-a4a5-f60e-1af7-4415857af3e8<br>uuid: 3934c70a-76c2-7e60-ebff-69098dc798ca<br>uuid: 4ef611a5-3e6b-1732-31e1-d7b411613d08<br>uuid: 57903363-4e65-d1d9-37e9-27c67c7a1f1a<br>uuid: 7d5cf1a8-672a-a772-8923-abc09e9928ff<br>uuid: 8394ebd3-3a96-bc93-de96-a2e2bb9c3b83<br>uuid: 58f5cec1-ac58-bca6-2c24-f639daba879d<br>uuid: fb411f6a-f110-464c-8e78-ae539717632f<br>uuid: 61499268-5126-f566-23aa-cbc268299641<br>uuid: 155b6d21-09c9-e690-0c7a-8bd31020cac6<br>uuid: 2e212024-afb8-87d5-b38b-441983ddfe17<br>uuid: 52ab7a09-c0b5-030a-86df-b6bd4391c5d8<br>uuid: 6bc40fe5-597b-3d42-145c-1377349894cd<br>uuid: 8ebc76f8-c096-8e7e-7325-30fb8b279088<br>uuid: 585e9c64-401c-dfa6-5051-dc1d80f85ac7<br>uuid: 3561e655-2a25-2f78-6f4c-d1303746e865<br>uuid: 71bc4867-b7a2-1fe3-78d5-bdab3c97eba1<br>uuid: f44580f8-e1d8-c700-93b7-553b8232e28d<br>uuid: bf8b39b1-77e8-720a-9be0-44a943795af7<br>uuid: 66a9d1a1-78f0-3dfd-c704-a8dd862a5641<br>uuid: 70916f9b-27a4-61b7-89a6-1979549d4a93<br>uuid: 91d8aaba-7f18-a30d-5d41-b19a8b2e53d8<br>uuid: 02e4143a-b60b-8e2e-d949-e6cf89426789<br>uuid: e9cffc43-1575-bead-a21b-fffda0a9f598<br>uuid: 48b136d9-7eb2-7436-fc18-3f9432c75b11<br>uuid: a3b20c4f-5474-569e-17ab-e5973326a935<br>uuid: f36f54a5-312f-6d6b-e149-d7275e19351e<br>uuid: 49161021-76c2-3670-6b85-7a90a7afc6ae<br>uuid: 03a54396-1f6e-9655-0932-55b6f673db94<br>uuid: 2988b0ba-8f9c-5db8-1796-c5df3cbe7951<br>uuid: 28606ee5-e2e0-96a8-d98c-c6f139f404c1<br>uuid: 35fe4b88-bbd1-a80f-30db-cd7ab1c8a19f<br>uuid: 44b94e9c-c6be-1a3b-0454-e17b8fa157fc<br>uuid: ef0774fb-f8a0-7562-a8ae-6ed9f772614f<br>uuid: a089e1be-6bb7-cbfb-4377-c1db7d712f25<br>uuid: 56b27c1a-2b6c-213d-eb1c-2b1a686b6fcc<br>uuid: bb2d8b8c-355a-580e-3d34-d472e54edfa0<br>uuid: 64fd2230-52ba-f5b3-41b1-ab590ab4052d<br>uuid: 6cfe63f9-a87f-4de9-fe8a-9c97ddc7d683<br>uuid: 4ed25721-c4d6-63c7-8321-29756cde8dec<br>uuid: df4b6583-d595-1679-563e-55dc9148de3e<br>uuid: a1e0ae17-caf8-3052-5049-a673db49660f<br>uuid: 0f173f1d-d720-bd72-a656-b37eaae3de59<br>uuid: 9ca7ad8d-fbb3-d91c-5f8f-ade2fcab9fb9<br>uuid: bb017330-8aaf-8077-5de3-cb284a447d5b<br>uuid: 4130f8ca-de43-2d0b-9159-9b214e1dbeee<br>uuid: f0cf2db2-842d-fd98-ebf1-a346517165c0<br>uuid: e5c2aca7-d4ee-4b48-1e4e-d6e103548676<br>uuid: 6aa5d026-d6ca-6d43-f231-31212be9d9f9<br>uuid: f14029cc-6997-2623-68d2-529f7ce3fe9c<br>uuid: a502f00d-8926-ca4e-16fa-80d27da9ce7f<br>uuid: b986a52c-c2ed-9b04-966d-380a9fbad54b<br>uuid: 10069a18-c439-e97b-cd65-233c9d2cf659<br>uuid: b64e39cf-3ec4-f048-44cb-62e6951fe045<br>uuid: 4f752b11-c5c8-0532-2599-e2f8d9042534<br>uuid: dd3f7c0a-ad5d-66a2-c659-61f9dca06181<br>uuid: b409fd89-5bad-e516-4dc2-509d575ec2ab<br>uuid: 282171e7-5fbf-e8d9-6cfc-346e474102ab<br>uuid: f27b591f-9921-e55f-6f35-50ce620765cf<br>uuid: 7f433b3d-2e53-3dca-e0ea-941fbfbea8df<br>uuid: 1854bc90-0ce8-9b5b-bd06-f2b9c23941c2<br>uuid: f3e627dd-4850-014a-bf86-7a060cd36943<br>uuid: e4bc3808-f785-4314-7c15-ee810bfc46af<br>uuid: a14e1c21-1832-86ba-4904-6308bd4ec9d2<br>uuid: 390b344f-4982-2630-3e85-d65c274c8a44<br>uuid: b4394d32-52b5-4cfb-dfb7-f483185a127e<br>uuid: 2705d109-6b10-e443-7eee-d2163925f910<br>uuid: be182829-fccb-9e14-7f63-77a320603f04<br>uuid: 5ea41486-ea18-0cf6-ef64-a7fb3999282d<br>uuid: 9bd56f5b-907d-3f90-973e-c16b5efb9ae1<br>uuid: 370eb01c-fa2b-638b-02a1-7bbb107c276a<br>uuid: 20f55c3d-d74b-23ab-496b-5dc443008a4d<br>uuid: 5f957168-8696-0261-2862-9935b9ad2be5<br>uuid: 1b9fe3cf-c772-6fb6-e239-479cfea9673d<br>uuid: 7fc7dcce-e677-f620-13f5-53f0f7a9739f<br>uuid: 676cafd7-8c93-75aa-8246-333173222fb4<br>uuid: f8fb0f6d-db27-5bab-b2de-47edf55d2878<br>uuid: 5dda7e91-e164-8109-8e53-31ce85076c4a<br>uuid: 775cecd3-df7b-030a-4f63-32821af3056a<br>uuid: dca04725-f65c-497b-8562-1083b3d5e929<br>uuid: afa89dc0-fa56-a030-a4b8-5e16ddf6a860<br>uuid: cc1b0bc6-e89e-7f6d-995c-f5539256f478<br>uuid: 7809b1bd-3231-8526-65f3-99280f035d78<br>uuid: b70f6f34-49b2-4e44-164b-a2fd66ba572c<br>uuid: d486586e-3eab-cbc9-9d96-00e6f67363ae<br>uuid: fab52b47-1796-6ab3-f7d7-685595465874<br>uuid: 0e2cfccb-31c1-11b1-8061-824b6076e136<br>uuid: dd78459c-f44e-6d6d-2b7f-ca7b4a78db53<br>uuid: 6bd40b4f-d911-bef5-3017-ddc19b2987d7<br>uuid: 606b12c2-ff21-c269-2cb3-b53c19bb22bc<br>uuid: b241c929-a95e-af6c-8316-dea76e0afe6f<br>uuid: 20b07273-0aa2-ff16-e56d-fb3c38f61abb<br>uuid: 6179b7c3-836b-1de9-e103-9f0eae5b5345<br>uuid: 8ae3ff7a-c310-2df0-2449-9ac3bf80d8fc<br>uuid: 7fd3d793-405d-44f4-e032-1505820a3e55<br>uuid: 2015c123-d30c-2738-fe9c-86c2a7121fe0<br>uuid: 435ca767-2e0f-b4e0-3fbc-42ece1920b33<br>uuid: 42bf6126-0fd3-5fd8-1451-15db50f0366b<br>uuid: 72d1a242-6858-f4da-7c74-34ac2bd98ada<br>uuid: 7bf1c8a7-12b9-532e-4fe6-d2bb70aadb87<br>uuid: 3c3be545-793b-126c-74ba-b6189389298b<br>uuid: 125677c3-c884-f0a5-9351-5337eb5878a9<br>uuid: 64fd74df-6e3c-1be7-5163-b899571f6f27<br>uuid: 05e33e30-450d-893e-0c61-c5fd521286cb<br>uuid: d82cdaaf-9e65-1fc6-518f-0b53eaf93fd2<br>uuid: fb196bb0-1f75-9e30-05bd-476a2e815a90<br>uuid: 9840a464-e3bd-3a8d-f74f-3167f6dd805f<br>uuid: 86cd8a20-f07d-4191-683c-2ae04bc91a15<br>uuid: 32433e85-2bde-7af7-24fc-1e1bf0f394d4<br>uuid: 49f5bbb0-fd6b-0609-6120-dea25348a719<br>uuid: b8e7b503-0c34-61a6-be4a-34ad418ca571<br>uuid: b1628696-e392-f037-c553-f6cf2c40e17c<br>uuid: d1a94d2e-28f1-8c9f-e7cc-5c40a3030cf0<br>uuid: 9dab05e4-6b9e-67aa-1d42-fca16a526f18<br>uuid: cfdd2d61-3cb1-d1d5-bd4a-284686221f1d<br>uuid: e5b0c0a2-d810-c458-6b18-0f3fb48172f4<br>uuid: 8e720772-f1f9-67bf-3695-dd45cf32a05b<br>uuid: 69a510e2-89ba-da7b-150e-c8aceacbd30c<br>uuid: 43b1486e-b239-cadd-ae35-d276bf71e5fb<br>uuid: c5211546-0ed3-3eaa-c917-e9d3af3f0f0c<br>uuid: 039dbc7f-cf0d-7e1a-3419-e47efecd29fc<br>uuid: 819c01ed-df4c-9123-bddb-19d4630a0b8b<br>uuid: d2c09a0f-c9e3-3c79-1103-bdf6ba591483<br>uuid: c373c4c7-aefd-dea7-140d-1e9dcaa7a322<br>uuid: 7fe6a00a-f0e8-cb09-da76-4c9fb674665d<br>uuid: bb03e620-4896-43e8-e0bc-ef689319e43d<br>uuid: f05a6bd6-f774-4a37-c2bf-ae14aad6a59c<br>uuid: 756e9c80-6cf5-8219-b069-0f6ea68bf9c3<br>uuid: 4deffad1-6bbd-8d5a-f3d5-56febb58cbb6<br>uuid: cce73952-5bf6-efac-8d3b-381e35561869<br>uuid: ee4e0b8a-b3f6-9f51-b693-dda08d5f4fb6<br>uuid: 6de26f9b-a919-7064-cd13-3e677e604fb7<br>uuid: 6d99c413-304d-4dc9-ce51-65446c94ecc6<br>uuid: a646d4de-a704-af97-f3d6-fb3f495560da<br>uuid: 6716c642-3cd9-93f8-56b9-e7ccab64bc0f<br>uuid: 0b7daeaf-fddd-da0a-657e-040c750315bb<br>uuid: 753157e9-47bf-96e1-2bea-b4f1eb480af3<br>uuid: 69020327-6bb9-abb1-2f66-37a5af257ef9<br>uuid: 68fcbc98-54f3-437a-3a91-c8d66af42f9d<br>uuid: a607dd79-5cc8-6044-7d2c-6afce7e66d00<br>uuid: e73cecea-f038-8d3d-b9b3-83d233c8e8c5<br>uuid: 0dde33c0-d492-da02-1987-2f3dcba6e86f<br>uuid: 7d1ea177-3592-404e-b63a-ef1712e75912<br>uuid: 34512739-14a1-5d58-02da-f6a6f66538bf<br>uuid: 2f711f99-559b-74d9-5be0-e47659ccdd75<br>uuid: f31791db-9ad0-9351-1894-f8418ad2cd2f<br>uuid: b4777a8b-7403-d575-9d3c-fd500f493356<br>uuid: fe69e41f-aacc-b053-04f1-c82fdbe75602<br>uuid: 44eef177-56b0-97a9-a182-668f99e173ee<br>uuid: c88a52dd-902a-7121-7dee-8e5d3348f755<br>uuid: 35735336-9d9a-6793-b795-541278bac7ba<br>uuid: 954b431c-776d-de3d-543a-1ff900979dec<br>uuid: b65744c8-6757-c3c4-07b0-1ad88bc3a855<br>uuid: 3a9213af-f754-8bae-03dc-b3251590e62c<br>uuid: f265d2ab-98d3-016d-e78a-04d15677b757<br>uuid: 5bae6579-2857-0b32-2831-9f53bb28f45d<br>uuid: 6d26dea1-1465-c720-ecbc-f4f323b7375b<br>uuid: 174c39cb-de53-163b-3b68-2fd05b39494d<br>uuid: e1dada6e-debb-9299-e66f-0fb473e41b88<br>uuid: f24cf272-96bb-0f1c-af16-01d924ff1fd9<br>uuid: 5fea8704-1324-938c-6702-32eb99cc31d1<br>uuid: 43a09ed4-1dcc-031e-07a6-46752d500d4c<br>uuid: b3f87167-8725-4ad8-2df7-b299a042a65c<br>uuid: fd8b2e10-651a-5171-acc8-8aa950ab0fb0<br>uuid: 0597362a-063d-1f6d-6151-f67e02c228e2<br>uuid: 175f020b-d73a-141d-606c-2d7bd0d3006b<br>uuid: f0e39b94-58b9-ad77-29c5-f5bac2cfa762<br>uuid: 0b486d7c-7654-bec9-4ff2-6d49bdf087d8<br>uuid: 00a9c63d-c99e-651e-61b3-f39918f8d100<br>uuid: 376af45a-7ba8-53f0-a3bb-78b92ccabea8<br>uuid: e5f70629-0ca1-98b7-c66f-9c0ef1ed9bf1<br>uuid: be6692b1-37d8-d871-ffce-7526abb6d172<br>uuid: c1e20f0c-9446-2f2b-2940-0a7e7d289b78<br>uuid: d7138ae5-a939-f413-c99b-ee4a57c8cea9<br>uuid: 4ff6801a-ed0d-a109-233f-a3e9d87b6583<br>uuid: f27555a1-c055-daa3-7c66-5f2ff0210004<br>uuid: 82fcaf54-731a-901a-fa7f-2dd8c76bd8ab<br>uuid: 66a61ddc-f2ec-858b-211c-ac81f5a2c435<br>uuid: e671050c-782b-34ff-9caf-8ae088a6474d<br>uuid: d4847e9b-100f-9695-6a16-892cbdc3ae0d<br>uuid: e1f46a40-ba09-dea2-1250-08ef22fbdbe6<br>uuid: 41d17378-290d-88e6-7a42-9a2641bf1918<br>uuid: 0106b5a5-5b23-9492-3dc5-11030d93aafa<br>uuid: 0a239776-d394-e169-38f1-f13708648725<br>uuid: 81c23f05-d1a3-9786-666b-58cc7f38c658<br>uuid: 48bb48b2-e272-8f7a-4c01-ecfb193912f8<br>uuid: 1ad84bc1-1d5d-6caa-01ba-111b4626bde4<br>uuid: ed11806c-0d95-3024-e4a9-ad0b36ffcf93<br>uuid: 5a203538-c73b-8ce0-5036-7baf0f47e2b7<br>uuid: b9aa5ae3-ebc2-a630-e5fc-4f8ed3afd146<br>uuid: abbeeb44-1428-7c6c-a917-978130696036<br>uuid: da9f86da-f786-a539-227c-c4189c0110f8<br>uuid: 4979c173-d1f2-d0c9-40ac-2cf7e5ab01b1<br>uuid: 62b7d814-d1f9-c7aa-8785-bd078e17cc0c<br>uuid: e14558b4-f177-66ae-88c3-7fcb76ffdb3b<br>uuid: a26e87dd-c861-11ce-ab73-b96896a08dd7<br>uuid: f11889d9-10f3-a707-c8ac-80b66a72b86b<br>uuid: a83978c0-aab7-4117-15bb-7f5e8d56f4ea<br>uuid: ffb836f5-d6c0-24e1-b6dc-af4b90d372d2<br>uuid: fc208c78-6c6e-4ae0-1bb8-886bb28e20e8<br>uuid: af7c6cdc-9283-fb6e-e81a-63c5da2c0ad2<br>uuid: aca8c7be-6a77-21e8-00d5-7ab42403c76d<br>uuid: 1daab8b0-eee5-6cf7-a416-90f3ece71a56<br>uuid: 63d12c50-157d-6ac5-a56e-1007be314698<br>uuid: 7daa3b19-4e52-823f-03f0-9afef9e3f420<br>uuid: 0de9d86c-8089-0c46-bb02-b46bf6db6105<br>uuid: 798e34e6-2791-e712-62a2-2a5d832cef30<br>uuid: 4580a90c-54b3-8b4b-2845-600d769c1a0e<br>uuid: bace9326-c9d3-e1d9-ceef-7c018dfcd392<br>uuid: ae455576-a5f6-5d98-858f-b2532379d1dd<br>uuid: f640d432-0c0b-f650-6f1f-0016077f434d<br>uuid: e1f71993-2f1f-88dc-e3d5-0c2dbfbe06ba<br>uuid: d9fb5ad4-4f11-8ebf-721e-28f381c04634<br>uuid: f5baf438-2d4f-f132-2132-2e558f38c276<br>uuid: 0fcee878-0893-ee26-a5cd-87482b1c220e<br>uuid: 8f4e68e0-8fc2-358b-6ebb-61b22ee7c5ae<br>uuid: 3af4296b-25e4-c807-2912-2521f7a42a52<br>uuid: a8baf66f-317f-a4db-24e7-f0c5d3233591<br>uuid: eb2165da-912d-0a62-4ab2-b83124f77b93<br>uuid: c9f17643-3541-b552-a63f-c150346354e1<br>uuid: 7d3db719-6244-4db0-a5d6-d783ae780c99<br>uuid: d6742d41-a323-c052-f1d9-af9ef8742a59<br>uuid: c1c0bfad-01fc-0273-8d91-f94753aa238b<br>uuid: b5ee0111-6c8f-351c-a2cb-07e1c949945f<br>uuid: 7a53b6dd-3caf-8f0f-706f-6a163778e186<br>uuid: 4813b258-8ef8-35b4-d54c-ea3bddd5da64<br>uuid: 19aecf54-04fe-444a-3312-69b1e4ef875b<br>uuid: dead2c62-ad8f-44b8-cf8b-a485e45983d7<br>uuid: 98f31c81-7460-f0ff-fb4f-438de74b2027<br>uuid: 19eb22f0-3c7b-70f3-56a9-3f815e97dd26<br>uuid: 94ad34e5-4757-d7fb-bc15-2f93f69db3b0<br>uuid: 6d1999e4-0254-484f-4f94-b45d69e7d1f3<br>uuid: f86bb2bf-8fe4-7bdc-77e1-09d0b5bbd9e0<br>uuid: 0644d2be-e910-7c72-11db-240d5e67cac2<br>uuid: 6b930e95-d6ff-4cf5-d124-04796d0d0194<br>uuid: 76368dbf-5d74-c037-d934-aed3bdcbd4f9<br>uuid: 8ee351a1-49d6-aef7-5034-ee3a781f2aa6<br>uuid: b3e4647d-0093-044c-4e06-ef01e3822a51<br>uuid: cea80feb-81c3-5b7a-b416-168136669799<br>uuid: 844da92b-9c37-c966-9482-0acdc2c8fab3<br>uuid: 47348b01-b19c-4164-ec3e-5193d52d221f<br>uuid: 9f607e24-8782-a434-2119-502146ee9a4d<br>uuid: f9e4ce94-1f5a-ce4f-cb5b-34e9511be429<br>uuid: 554e985c-e65f-1911-e31d-301482221ae8<br>uuid: 890bf177-56da-0313-bd0a-df16d0474d85<br>uuid: 4bfa775c-ae92-5879-1210-c0e5a83bb784<br>uuid: 8638f08a-7592-6bb7-c545-757895a5e353<br>uuid: 4cdd863d-6eaa-e715-933e-b17f5b07813c<br>uuid: 7a831bc5-1948-30a7-0c73-304f2b364860<br>uuid: 4ce75f77-84cb-0101-75f0-f50e050e6d7a<br>uuid: 2289c71e-eb22-7e90-63ff-ca51e06afddb<br>uuid: ec72d717-7d2a-8798-bf4e-7e89c787784e<br>uuid: 997836aa-84cc-e98c-ea7d-49126f4e4781<br>uuid: 286cad53-5d33-11d8-38ae-feebc44378eb<br>uuid: f7fffd0f-fad4-63f4-cf93-28400963ccdd<br>uuid: c2260f46-f854-8b47-28bf-8f8fab231f1c<br>uuid: df062556-0f2e-2d53-4012-d73299c0e5c2<br>uuid: c10ed0f8-b352-59c4-7835-33bd78efdb73<br>uuid: eb19b109-46d8-e877-5647-263e83e46f7b<br>uuid: fecb0314-a3b1-b488-05ce-59b74652bbc6<br>uuid: 16eb2b74-f71c-1b6b-d8b6-2b471bb28b6b<br>uuid: 701387b8-a8be-26a5-ec08-77bde26f388b<br>uuid: 0ee02c4b-a6df-c654-b4a6-6caea56e6a55<br>uuid: 294fda30-116a-8908-b61c-0999ef15ead6<br>uuid: f8ecdc65-4589-7e61-9837-4d9428558076<br>uuid: d9985132-b78b-e029-a344-624a2f7cacb2<br>uuid: ae7496a6-9118-e14b-8be9-4a4a688e4642<br>uuid: c3b95b21-fbb7-1056-42e9-efed10b27b74<br>uuid: a5dfaf27-5d79-1a27-4bbb-174713cec3a5<br>uuid: 527020ab-c673-7427-9843-f078f8d74abe<br>uuid: 5ea913c7-fbfb-c451-3944-74f018b005be<br>uuid: 70f8495c-0642-99b6-62ca-a2365c612322<br>uuid: 25ac7694-6eef-3a83-d0e7-0ed5e057173d<br>uuid: 7925dfbc-7a76-1a1d-507a-3f49322b0fec<br>uuid: f1f51ade-86df-2611-4a15-2cf3de8c07f4<br>uuid: 8b7b23be-2a50-6a4c-8ad3-b1b9f76871c6<br>uuid: bb04a9eb-365e-c678-b483-58420036b80d<br>uuid: b69f548f-0ce2-0fc5-af86-083db7348f79<br>uuid: 9d4a9794-b31d-7cd0-6984-a320ba1c433d<br>uuid: 5f5df0fd-5890-2fe1-e1f7-0d2934b1e1c7<br>uuid: c4dde32c-9161-e47d-c443-099094e6ee94<br>uuid: 37f26af3-1058-91ec-0e95-f29eb71fcf9f<br>uuid: 5230e489-3ad2-7568-f483-5ee632000ab0<br>uuid: 8a278ba1-fafb-fb98-e554-150985b55ee6<br>uuid: 9db695f1-5996-447b-63a8-2363abe00c37<br>uuid: 4ca5b155-47e9-9b45-082a-67be15c49f2d<br>uuid: 689eca3b-f826-0e50-4bf1-24c3ac8b6ec6<br>uuid: 00c0caad-a989-138f-e8bb-d8fcc3534b18<br>uuid: 317d20db-a068-e41e-e0ca-7cd77c48ff74<br>uuid: 07e441e9-bac1-b6ba-abb2-5ffd4df663f5<br>uuid: 10b7825d-3b27-3d39-8335-672d5a654522<br>uuid: 5351bcb4-8b7f-051b-4235-b1070e4aa9a6<br>uuid: ba3effd7-e03b-c1c0-07bb-2249952dcdfd<br>uuid: e636d69e-6898-3a49-88f8-ebed801036f0<br>uuid: 366d8664-b979-d0cd-25cc-b61c1f9d0f88<br>uuid: 1124d3e8-ea35-b248-1158-90d48def8643<br>uuid: 9993ce1b-93b8-8c03-c67c-4b1b544e44d5<br>uuid: ed920511-e91b-2dc1-1724-0da2b9b3326f<br>uuid: 57b9329d-31ba-7fe6-9731-8e31bc62b6ac<br>uuid: a4969d90-3d68-00d1-6514-bc9f68b75f93<br>uuid: 7caa0d70-c98c-fc96-3728-59efdb0b3d63<br>uuid: 796a4693-4937-b6d8-2299-0fb9244d231e<br>uuid: 0a47734e-07c3-4411-efc8-2ce4970e9fbd<br>uuid: 9073c872-5e98-ec7f-59f7-01a1cbfc592e<br>uuid: ec162522-4bca-92eb-b714-7d6d6311b916<br>uuid: d006b022-f553-2e22-4cb2-ffe97016d1e2<br>uuid: 20829fcc-a558-1f59-1e37-9141419cd78b<br>uuid: 725860e3-d587-4339-ca12-830094837e83<br>uuid: daf59c1e-c538-057a-a6f9-eab7e717a458<br>uuid: 70e9a1e9-22c6-4d7b-5b02-7bd0cea39df7<br>uuid: bab00c24-4c99-37f7-61eb-4edc3388311a<br>uuid: bbd351ac-d5ec-3416-49ad-7c36ab5aa213<br>uuid: f1fed928-5b43-01d9-726d-5a7ec40b5eb1<br>uuid: faacaa75-d4b8-9d61-91ab-3e402585811c<br>uuid: 481b0fe6-50a8-cee4-750e-97877a019241<br>uuid: 011b8846-eac5-dc4c-461c-8aa04f78632d<br>uuid: 52bfaaad-c6c9-7376-95b3-bc1d9c8ff83c<br>uuid: 96274d21-9d91-f83b-4423-4bf5ffede6db<br>uuid: 73d1f3bc-c9bc-be6b-ea50-91f02c5ba09c<br>uuid: 24645292-5b34-6b60-3a20-97ae41dc184e<br>uuid: a8bd2081-97c6-5404-e79d-8f087e88712b<br>uuid: 11b27585-cfe3-9d32-851e-3edd5058211e<br>uuid: 7accd8ba-6125-6cf6-3a45-09e12ce5a0e2<br>uuid: e9c9528a-3c60-df8e-8a4c-da9387153e0e<br>uuid: 8c82f0ea-e31c-fdb2-8a36-fbd34decfb75<br>uuid: cf8fa86e-c9ba-f086-0b2a-4a98096c2c46<br>uuid: 5235be31-5c32-bfce-a558-931a1c353085<br>uuid: e3d26648-a7ea-5c70-9179-4f3e08e3ebad<br>uuid: cc830336-b906-c098-b38d-a3cccf405f27<br>uuid: 744654ce-0ccc-7b52-2fdf-456959210687<br>uuid: b4143ff4-fd23-f0ff-47b1-4d7690d20202<br>uuid: bfc1239a-a2db-1e75-4a37-398c3aed3ee3<br>uuid: aae2a079-5646-ab82-86c8-1d88dbaa65d3<br>uuid: 866022fd-a491-6db1-91d7-ea3d22eb3452<br>uuid: f7093984-1f71-b660-7c04-0cfc303c544a<br>uuid: 70fd5a47-e9ea-e71d-6fe4-8d1453016739<br>uuid: 408fb66f-cf5e-7411-0a79-022118c7cd03<br>uuid: 07f3fe23-e0d5-6e3d-3c8e-e37ab7816584<br>uuid: 5ee0488c-a20d-5c57-71e5-ddf9eeb77316<br>uuid: 19bd7d5a-db91-41a6-30aa-4326e953c930<br>uuid: 1e7699e6-b60a-e9e7-b73a-bc9883090e9d<br>uuid: 961fa2fd-2a92-ad98-44c6-7054aa5b1b6e<br>uuid: 9842c8a4-ab02-276d-877b-8d8480d20e2b<br>uuid: a5938412-c0bc-d86f-8097-255609fa9bd8<br>uuid: 4505c9f2-6643-4b07-5ee2-e9f49326c84a<br>uuid: 7e4a31f9-7406-aa4d-f118-e6b5109ed980<br>uuid: 009f28fb-f0ce-935e-2d96-941399c04b5d<br>uuid: 4f754486-f456-6682-4763-685c3274e89f<br>uuid: b6df1095-001d-f592-6f5e-001217c92a97<br>uuid: 49e44df0-53ab-5c10-dab7-7d4f41dbb4d8<br>uuid: a569c647-038b-fc02-d7d5-1029fa7f39a7<br>uuid: a5488b97-84f2-8f5d-5340-a2d51c2294ab<br>uuid: 4b72445b-0ebe-c85a-bf85-1ef737b589b5<br>uuid: 4ffb486b-7c0a-bf7e-086e-047bc8164b9b<br>uuid: 52f355cd-dc69-70d5-0d52-ee122d0fb7f1<br>uuid: d02e06f7-bafb-d8f6-810a-d2b3d9d2e748<br>uuid: 68041eac-281a-3f8d-6669-a75655a829a0<br>uuid: 19d05c91-4a2b-bddc-b2c7-1abe367cfd63<br>uuid: be581a29-5896-d150-d3fe-11ecbdd90ca3<br>uuid: 9afc13b8-92b2-7b5c-b6a7-4826f511684d<br>uuid: 41e23146-c96d-1d98-a223-d73e1606c152<br>uuid: 5e8fed3e-ccf6-0b31-f1e7-3ed2d857f28a<br>uuid: 56bf9d16-f503-5dbd-c915-75facc1b06a0<br>uuid: 67a3c0fc-0bb7-3c37-0217-522007e20ee4<br>uuid: 01fbc335-9719-04c4-cffa-67fa030c7e21<br>uuid: 18a6ef7b-4ece-72f4-e4a7-3a35916a948c<br>uuid: e381c492-835b-7517-b522-119cfa9dd98b<br>uuid: 94077201-b339-2019-33ac-5da977e043a3<br>uuid: f2f6f475-d585-d2dd-4b5a-e1bcd2ab95ad<br>uuid: 49d6ca1b-0e51-ef47-bfd2-6e0cd084b3fe<br>uuid: 4c69ff95-7015-f1cf-6f66-62a5126dfa3f<br>uuid: 0b3d53d3-4fa1-dfcb-57b3-651e1316c9b0<br>uuid: 0bd7f40f-7862-c3a3-8067-cb58384a9248<br>uuid: 609ea76f-e7de-a6c4-925c-35a42f63068b<br>uuid: a8050495-a223-b1fe-aa16-07a6fdd3bd4e<br>uuid: e34f3f8f-af34-62b5-2cbf-65a6984dbbdf<br>uuid: 186c96f1-e23f-41e9-08f0-a43fa9d5b72c<br>uuid: 4948c449-6f01-0857-aa2c-10145274ccf4<br>uuid: 14c565d9-dfac-bf87-d16c-1b9bc09adfcf<br>uuid: 0ff126aa-0c51-c47b-2b44-26e54818aebf<br>uuid: cdcdd20a-b00f-136b-0ac2-cf3339dc381d<br>uuid: 2d285a93-ab1b-37e3-3fd6-9a40fe161e9d<br>uuid: 72faf50e-fb90-577a-edfc-7b3cabef7126<br>uuid: e2ede762-fd3f-b756-b00d-40032d1ac893<br>uuid: 7c9ee937-0334-6a5f-9d74-c76b4272284b<br>uuid: e67244b8-b68c-ae7a-f6f3-254c3c455a91<br>uuid: c7b9a6df-1553-7999-3722-4cd7d2b7698b<br>uuid: b551a646-bc7c-c95f-6a7e-6bd2d07fef2c<br>uuid: 43fee674-b111-e166-3aab-fe7dffebc3d1<br>uuid: 4207d2e7-5550-a157-da49-1b3963736f4d<br>uuid: 1c3e5b18-5399-6555-13dd-16f37a011dd2<br>uuid: f9d235c1-9edf-9271-436c-80c9ce80973e<br>uuid: 02b7f3e7-42d2-f1c9-b31b-0d7778f35ed7<br>uuid: a401f4d0-5dd9-80fd-59b4-cf0f7db61ea5<br>uuid: 03317361-f4cd-5033-6784-d7ced8f535de<br>uuid: bd9baf16-4af6-a88a-f81d-8859d15406dc<br>uuid: c49c8e4d-e009-1a7d-0e50-25ea452ded9b<br>uuid: 6d066fe0-f94c-15d5-0c75-0c248166c786<br>uuid: a4aeb24c-73b9-e28e-be0f-3a7cc6a71459<br>uuid: 0018fd3e-c634-c6a3-f9e1-248eafeb1e00<br>uuid: f9d8a818-deec-681c-7dcf-86e37fbc7cae<br>uuid: 54efbc8c-7259-9628-5017-3391744ecb3f<br>uuid: dad5b76d-183f-f799-ea99-eef0fa282ce5<br>uuid: 024bd2cc-fe49-7768-0916-e07e55ed8caa<br>uuid: 2a6018c1-4bff-e119-e15a-41cd498558f9<br>uuid: cc9d53fb-f5ec-fb3b-5ed7-43cc5a8cdcea<br>uuid: a6801f3a-8f63-10f0-0f05-e9082fb91775<br>uuid: 2cb7b9a0-a0ef-2293-6a63-d3fb8d8f5ddb<br>uuid: 38f8428f-a113-e6f0-5087-93dacfd1e49a<br>uuid: 2bbdd400-d1c6-1959-9545-f7cc2fdeeae7<br>uuid: a3776c82-7b52-9eb2-44de-4cbbf8a34334<br>uuid: 0684b48b-541f-e587-a26e-c3867ba97456<br>uuid: 9c601f77-3a86-f4f9-d7d1-4a01194f9d04<br>uuid: f1998f80-45d9-3556-4dce-e6e62efc29e3<br>uuid: c46bdb27-2f42-f6c9-7ff5-b0e21550d676<br>uuid: d4b49b78-64c7-f3b7-d8a9-2890e6aa7e2e<br>uuid: c1dff6d0-60ea-becb-25ec-e767a8c9bf52<br>uuid: ea90e093-b3bf-0024-bdcb-528d6126cc32<br>uuid: 101b97a3-506e-7052-0957-9b370c9179ae<br>uuid: c626cfb1-2a9d-967e-80a6-95cb7632ad80<br>uuid: 2cfdb1cb-9e8b-612c-220b-89286dc340d5<br>uuid: 32489405-e88c-096c-ad57-c47763c16fac<br>uuid: 2da51740-2d58-1368-06b6-8e6f30d1a198<br>uuid: 753f1c8d-89f7-4f0f-2f8d-81815e1eb562<br>uuid: 85b1047d-0323-d10a-d573-d10035da9b7f<br>uuid: 546464fb-7315-71ce-4bf6-d76dcf2b01f8<br>uuid: ed503607-e845-3edc-d4d9-0e8515357c12<br>uuid: 3e53dff5-433e-566f-e706-fdefd96bbb3d<br>uuid: ed5b3d8f-d583-02bd-697e-4b3b9e92ef10<br>uuid: 7cc4c784-406a-c21d-74e1-0fb910cde81a<br>uuid: 06f5c350-c27a-08b9-7c81-7f57d3a65bd8<br>uuid: 9610599e-1f74-36c2-14e5-a03597188e3d<br>uuid: c52c8b28-07b8-cdb1-2cc7-e875b47de917<br>uuid: f4590db5-767f-bfec-8729-4605340b961a<br>uuid: fb27c54c-d319-992e-bba3-0e2703c90bd9<br>uuid: 53afba67-d7bf-2573-8bd0-190d2ec377be<br>uuid: 07be0b33-2897-33a0-1ed5-51f561d08802<br>uuid: b301ef58-033c-2b59-fc00-53211a193a2c<br>uuid: 2755b47a-29d2-2f3c-98b6-f64945306640<br>uuid: 18f113b5-2ea2-8b76-5248-87b25f77ff90<br>uuid: 2e16cc4c-05fa-7580-02ac-17d3a3b9b675<br>uuid: be786cf5-b7da-a67a-6270-1afb36aef049<br>uuid: ad1bf590-2777-e992-fd25-d00b93d83388<br>uuid: ffcfac0b-9a6f-b86a-6f96-dd622c4775dd<br>uuid: b0d54076-8304-cd78-1d31-76aa8eddc3f7<br>uuid: a9beafa0-766e-79d1-2762-03ecac0a69cb<br>uuid: cc9b9bcb-cd70-4143-206e-f202cc218d75<br>uuid: 27069b75-22ab-c7db-d0e2-9d0b0bcf5bce<br>uuid: 3d675429-8d64-2e02-ca43-c3661aaceb7c<br>uuid: d691d2da-f439-9928-bb19-882ed0aa44e9<br>uuid: 3c8f5861-29cc-7cb6-2489-a0353afe3a0c<br>uuid: 83a6d6f0-cbe4-5b13-dbf9-1c5deff676d9<br>uuid: a4f6544f-806b-fbfa-2555-dd2c500a0a9e<br>uuid: 7d7ee748-81b7-11a8-0306-c2ae515373f9<br>uuid: 3ba3ec12-c52a-520b-6908-e8bc0b4675df<br>uuid: 2d8bf21c-2dc6-97d2-c3af-305ab7eeb376<br>uuid: 92318642-5416-e63f-2745-c3d8a5b0860f<br>uuid: 91d9c247-fc11-beaa-dd83-942a2ab786d6<br>uuid: bdb8142d-b082-5a50-3ee4-9e772624f738<br>uuid: 9eb80e73-ccfb-b0ad-f0cf-642ed277dd6d<br>uuid: c665fbca-4304-329a-639f-6563f055265d<br>uuid: 7569de06-89f2-81c9-e3c5-3703a30fcc55<br>uuid: 2a32a685-d9ca-0587-f46a-68bf022b141f<br>uuid: 3ee7d816-507f-01b9-6fae-941a19b44a06<br>uuid: 8bf57610-f59e-f24e-f24f-c7347b1fef96<br>uuid: 16bb23bd-5ce2-663d-0ceb-5b2e7cc00659<br>uuid: 9a27eeeb-c4cb-64f0-6930-0ab87dae50ba<br>uuid: 4746e2a0-67ef-5ca7-7f27-ca2231e5ffaa<br>uuid: c99044cb-1e22-6b4b-4674-144dac196e8e<br>uuid: f11cdd92-7806-1b41-e72f-69c2fa85265f<br>uuid: 5ab1d2b3-aef8-e122-1b68-3eb080f414dc<br>uuid: dc86f506-5d36-7722-9594-8fbda5d240d2<br>uuid: ef135409-a859-13b2-967b-962c6fd75d26<br>uuid: aea2d4c8-1580-a92d-f506-af8345eef2d9<br>uuid: a5a10025-98a1-700c-26df-6dcf2478d0db<br>uuid: a12c9022-457b-8b4e-2915-5e07e508266b<br>uuid: a1bf90d5-26b9-1f7a-248a-bf54de808c3e<br>uuid: d21df432-d6a7-f767-343a-e341e6358ede<br>uuid: 9f0f545e-a1e8-53e9-c890-5d1d84aebdf1<br>uuid: 9cecc3df-7e9e-1732-a029-ea37da98d725<br>uuid: 794e83a7-cb36-318a-41dd-b536416c4102<br>uuid: 53a7063e-1167-c572-9f54-a405e3c1956f<br>uuid: 8fde0c94-1a45-f9a9-d7f3-9832df86492f<br>uuid: df090f6e-ab1b-6e39-79f8-4c8c5b90d25d<br>uuid: 0397a05f-0f5f-f331-2e07-f19ddf14102b<br>uuid: 24cad9a1-346b-2a75-4331-85ad408e75db<br>uuid: 7ac86aca-90cd-e821-8522-a633b2421b00<br>uuid: 3880d348-3909-8a7b-7530-39f51ba55b55<br>uuid: 652d1f87-d00a-3451-30b6-b5593d6de8ab<br>uuid: 89d53ca8-31a2-4396-7608-d2a5fa079b9c<br>uuid: a8dd8dc2-4c4d-8274-0277-ff5172ac8c52<br>uuid: ea02bb80-7c14-1dca-9a64-b4dda092fa44<br>uuid: ba231b51-ecef-f9a6-b7db-9adb731953e6<br>uuid: 71e869a0-29e6-e152-3ac1-e432625ab63d<br>uuid: 28db20dc-d747-2e01-c66a-3f14c717950e<br>uuid: 4fa97f22-6c61-6aff-9c74-952f9312feb8<br>uuid: dc827064-0d4a-7b23-3b25-803c0859716f<br>uuid: 03e699ba-3b43-21ac-eab3-bc02bdf8cb5e<br>uuid: 2241126e-eadf-1cce-68ca-ebf5c1c34dc0<br>uuid: 19a7c3c8-3c4f-60a9-37ec-6c4b56449950<br>uuid: fbeb0cbf-8b4f-d7fd-a165-a6468061e99e<br>uuid: 0a48a490-0767-c22b-d8ba-2379baff93da<br>uuid: 15faa366-bab8-1a8b-ce89-1217cd1bc89d<br>uuid: cf62cfd1-86aa-f125-556e-51fa5379a9d4<br>uuid: fea4423b-af88-38b2-fd5e-8cda99670e46<br>uuid: 7260cfec-acc8-597f-e9ec-302a83645496<br>uuid: a032a552-1c3b-76d9-8e02-3133cc68b1d6<br>uuid: f6226ad9-21ee-6a83-5bb3-8b2055de6fff<br>uuid: 5cfaa99e-3a3c-c5e9-d2d5-af11f6764bc1<br>uuid: 13523461-af0c-e29c-fa3a-3e3d2c074276<br>uuid: e4fa3038-eaba-9b91-3b8f-9d4241dd2693<br>uuid: f56200b8-864d-a818-bc17-b326dc41e935<br>uuid: 360516f3-43c6-23ac-1f78-0f28f800ec58<br>uuid: fd0b8b6f-0ecf-88de-501d-ca6ab6720c2a<br>uuid: cba7ab34-77ed-0105-6439-6f1d29983efd<br>uuid: a805849e-cbb4-0e84-407b-8f51aeb4e8f8<br>uuid: 390d23f2-a223-da3d-7427-407bcbb1e6fd<br>uuid: 2485f7e9-4217-6550-56f1-7603f2efd0d5<br>uuid: 6d594971-01d7-67dd-0867-0f9db6dc6204<br>uuid: 87bac199-6e84-f055-33d6-030cd71ffd7f<br>uuid: 831db706-6384-81de-76a2-172821dafd8e<br>uuid: 1e663759-8600-849a-fe98-52c3ccfbad6f<br>uuid: f53bbd19-429c-3fec-d888-74cc810be0bb<br>uuid: 64a29f0a-6227-49f1-1417-760dfd616e51<br>uuid: 903fedcd-1e0c-7b59-3bc3-dd9e9f7243d1<br>uuid: 62a98e19-a3f1-3b0a-1f18-a52586d3bd61<br>uuid: 687a2b07-ebe9-d2ac-f1cc-2b62b50484e2<br>uuid: 99300ec3-3c34-1e08-2fd6-6db2f2981d94<br>uuid: 09f6491c-bc04-91a4-ea25-1d74870dc5c1<br>uuid: b7825a12-57db-7d45-08c6-1e2759394bb3<br>uuid: 3c6cb7a4-37df-e982-bf62-f7476af1e9b8<br>uuid: ab180f46-124e-9926-6826-ada58ff2d9ce<br>uuid: 879e5c0b-59df-b46a-40cd-e97b4e4947d3<br>uuid: a26eccea-3593-433d-ec63-966099d7f91a<br>uuid: ab96ac6b-1c5f-af9e-0e76-592e8aeb72a5<br>uuid: 7cb5fc58-7099-9a75-4574-9e78629f4e5f<br>uuid: b82ed71c-138a-117b-7467-509798c53a0c<br>uuid: 8520b993-e862-0a81-51e6-728b2a809105<br>uuid: a505c4ec-1ded-ef1d-64d7-279b6f499b97<br>uuid: fe149655-5b20-5c42-6e90-0b1cc02041c8<br>uuid: 4997fc19-0fcf-891a-e74c-e40e7a95cd79<br>uuid: 190ff213-b471-9ace-e092-dccf889a6e56<br>uuid: 55756e2b-3efd-5bd5-609d-6bd6905d0447<br>uuid: 88727676-4d94-4acb-9f46-6a1f077a4631<br>uuid: c777e47a-6f94-80bd-6f99-6eb48612f92c<br>uuid: 882f5db8-e528-5a10-ecd1-a816fa77d867<br>uuid: cc8aae36-004f-588b-c04b-a0a5f770823e<br>uuid: cd9d0eae-4f79-9c5f-3845-03fdaa7e9c83<br>uuid: fcb02010-be2d-e484-15e0-bae48ccba490<br>uuid: aaf3ed63-126a-5057-654e-502975b03f7f<br>uuid: 477e461a-76b8-bd27-c496-e63da9200a2c<br>uuid: fb823060-da24-92f8-b40b-b2d7555e7bef<br>uuid: e71043e6-080d-9985-d929-e76647181ea1<br>uuid: 59d1a5c7-264d-36f2-0cea-81b8a01b9658<br>uuid: 404a1148-8af0-1c42-a249-785a7778e371<br>uuid: 501aacc0-89d6-12cf-6ba6-15739364781b<br>uuid: 2d9cf368-631f-d284-8736-61c3c530c846<br>uuid: 56c81c43-0224-a51a-46e3-df92312c47c4<br>uuid: 450642e0-199e-dc31-1b76-152c3b04669f<br>uuid: 8ea6c5a8-1201-d136-d781-43a336da5602<br>uuid: e9694f59-3422-79e5-d544-990cd075a702<br>uuid: bcdb0c60-3c8d-82df-fdab-ce4a553e0eb7<br>uuid: ff1d5ec2-4203-6e1c-d47a-b196bf372150<br>uuid: d3a5b7de-778d-39b3-fce4-d46534cd9745<br>uuid: 2803117f-257c-f57f-78d0-4f212d4e6ef9<br>uuid: af657b7a-d2a8-b844-187d-a53caf98e04f<br>uuid: 66e1326a-af2e-acf5-64b9-f9e26d30d3fe<br>uuid: c61f0d16-563f-66b4-f250-739e51ed1050<br>uuid: 1b5f9513-44a0-4615-2063-32ebdb075d24<br>uuid: 2ab1871c-5d35-0d63-bf78-b354003f14a4<br>uuid: b61cb7a1-9276-c2d3-2b0a-fde3f515024d<br>uuid: af17d6cc-aed2-b450-7c10-f503a33ad370<br>uuid: 4f7b3b5d-14bf-0db8-aba4-93189463fd86<br>uuid: 4a9de734-46ba-9508-6762-e22fc5c45312<br>uuid: 40e320e3-16c1-c7f5-f3c3-c53187b0e016<br>uuid: ccf0cb7a-bfdd-6fa8-647a-df4638986b6d<br>uuid: 76c23c7a-b38e-e637-9675-ef2ecbd343de<br>uuid: 88bf7987-8ca3-c554-8aee-f92f0921a20e<br>uuid: c52244f9-ae8a-ed4d-7356-8ab512f4555e<br>uuid: 3fd4225a-cb2a-9785-b26d-354209492d5a<br>uuid: 8a3ae888-332b-3d91-fb5a-32cad60b2ed7<br>uuid: 51f6ce6c-a16b-bf9b-d4e3-2937fd14220f<br>uuid: 2b5963af-67a3-559a-16a0-6b4c1d8b5371<br>uuid: 101aabb2-1085-3da9-da1f-69912b7737a2<br>uuid: bb8a7f77-1f5c-5c5d-5f94-e63678ada9cf<br>uuid: b7babe13-39b1-4c60-5b72-cfb0f0511388<br>uuid: 289a2a77-e624-3871-5d8b-0a8e46dc5e45<br>uuid: 5c4c2c22-4b0f-168c-1399-6f31323ea92e<br>uuid: f5c78545-83aa-56c4-50d3-2f80063294b5<br>uuid: 1b7c2b72-6e5d-8c32-c015-15662b785c23<br>uuid: 02f0a07d-cec9-a1da-e308-66e59e31eb6a<br>uuid: 7a69a021-ce6f-3bcf-68c5-454c4e0abc87<br>uuid: ebfecd2f-f116-9be4-87b9-f6f143acaec1<br>uuid: 5d0cb063-c1df-c5f6-3235-0671ebad38d9<br>uuid: b0c62df1-44e4-88b3-4cc3-4a4e7417c13f<br>uuid: dd79e5b0-e6e7-c9bc-06b7-5a2cd8ea3bf4<br>uuid: 6bd13468-6d89-b7dd-1822-50d1a8a67c0c<br>uuid: e7da36be-a3bd-29ee-f21a-abbe7cca0be6<br>uuid: 80c889d0-f6d0-c3af-4abc-36d9f6b8745b<br>uuid: b50cb90e-8cfc-b221-612b-efc0ac0beb3c<br>uuid: b93709c6-847e-0f2f-ae2b-4838909458e8<br>uuid: e2c2828c-cd69-671f-214e-27bed0e9106d<br>uuid: de54cae3-f86b-3086-705b-a075cb7f7870<br>uuid: 000d5aa5-d043-f806-3b27-79780e51836c<br>uuid: e1507abb-99a1-800e-4913-b2dfb816526b<br>uuid: e370364b-11d0-14cc-dcaa-6e7db1a65fc6<br>uuid: 12cac681-4c8a-86b0-2e73-230c3b5f3cbb<br>uuid: c9efc43f-f639-16e5-a7ff-0ac35041e859<br>uuid: b45eff4d-bd05-676d-520c-b8837e83cfd4<br>uuid: dd1f41d3-569f-179a-5b62-aa4e0f922c91<br>uuid: 41298357-3d31-fa83-0ca1-0656501e5890<br>uuid: 5c729531-a93b-004e-e710-fac796d5d5ae<br>uuid: a9a32e5c-93e9-b0f3-9aff-511484ef30a6<br>uuid: b6da3dc7-5243-a321-7089-0be1e3597f99<br>uuid: 63e4c060-6bdb-5201-4d15-3f4b08064e4d<br>uuid: 5ea6e174-cf84-4f2a-3391-65d542aeeaaf</p><p>There is an established pattern where UICollectionViewLayout talks directly to the collection view’s delegate to get additional layout info e.g. the size of a header in a given section.</p><p>This pattern is established by Apple’s flow layout, and it is used by Pinterest and I’m sure others. It is dangerous when used with ASDK because we update asynchronously, so<br>for instance if you delete a section from your data source, the layout won’t find out until later and in the meantime it may ask the delegate about a section that doesn’t exist!</p><p>The solution is to capture this kind of information from the data source immediately when a section is inserted, and make it available to the layout as we update the UICollectionView so that everyone is on the same page.</p><p>Enter: ASSectionUserInfo</p><p>Internally, we use a private object ASCollectionSection to represent one version of a section of items and supplementaries. If the user wants, they can provide us with an ASSectionUserInfo object to accompany the section, which will be read synchronously when the section is inserted.</p><h2 id="Usage-During-Layout"><a href="#Usage-During-Layout" class="headerlink" title="Usage During Layout"></a>Usage During Layout</h2><p>The collection view will make these section infos available in the same way that finished nodes are currently available.</p><h4 id="Sequence-Diagram"><a href="#Sequence-Diagram" class="headerlink" title="Sequence Diagram:"></a><a href="https://www.websequencediagrams.com/?lz=dGl0bGUgcHJlcGFyZUxheW91dCAtIHNlY3Rpb24gbWV0cmljcwoKQ1YtPgAYBjoAHw4KbG9vcCBmb3IgZWFjaAAxCAogICAgCiAgICAATQYtPkNWOgBOCEluZm9BdEluZGV4OgAkBUNWLQBUClJldHVybiBQSU1hc29ucnlTACsKCgBFDQAOFDogY29sdW1uQ291bnQAgQAFADQUAFwSACYQAEYed2lkdGhPZkMAZgUAgT0NAEgmADsFAIIRDQCCUwhVc2UAgmsJZW5kCgoAgjgHAII6BihPSykK&amp;s=napkin" target="_blank" rel="noopener">Sequence Diagram:</a></h4><p><img src="https://www.websequencediagrams.com/cgi-bin/cdraw?lz=dGl0bGUgcHJlcGFyZUxheW91dCAtIHNlY3Rpb24gbWV0cmljcwoKQ1YtPgAYBjoAHw4KbG9vcCBmb3IgZWFjaAAxCAogICAgCiAgICAATQYtPkNWOgBOCEluZm9BdEluZGV4OgAkBUNWLQBUClJldHVybiBQSU1hc29ucnlTACsKCgBFDQAOFDogY29sdW1uQ291bnQAgQAFADQUAFwSACYQAEYed2lkdGhPZkMAZgUAgT0NAEgmADsFAIIRDQCCUwhVc2UAgmsJZW5kCgoAgjgHAII6BihPSykK&amp;s=napkin" alt></p><h2 id="Creation-When-Inserting-Sections"><a href="#Creation-When-Inserting-Sections" class="headerlink" title="Creation When Inserting Sections"></a>Creation When Inserting Sections</h2><p>The section infos for any inserted/reloaded sections are queried synchronously, before the node blocks for their items. The top part of this diagram is the same as the current behavior but I think it’s useful info =)</p><h4 id="Sequence-Diagram-1"><a href="#Sequence-Diagram-1" class="headerlink" title="Sequence Diagram:"></a><a href="https://www.websequencediagrams.com/?lz=dGl0bGUgSW5zZXJ0aW5nL1JlbG9hZGluZyBTZWN0aW9ucwoKRGF0YSBTb3VyY2UtPkNWOiBpACoFABkIQXRJbmRleGVzOgpDVi0-Q2hhbmdlU2V0IAAzBUNvbnRyb2xsZXIAHRsAURFlbmRVcGRhdGVzADQgAB4MAGIYLT4AehFiZWdpbgAFNACBYxlsb29wIGZvciBlYWNoIHMAgjgGIGluZGV4CiAgIACBAhJDVjoAHwhJbmZvAIJABzoAKAVDVgCBLQcAgnEGAA8aAIMQDACDFwZSZXR1cm4gaWQ8QVMAgz0HVXNlckluZm8-AFQIAIF-EwAWIQCBUg5pdGVtIGluAIFgCACBXQUAgU0Zbm9kZUJsb2NrAIQkB1BhdGgAgWIGAIFXFQARHgCBWRlub2RlIGJsb2NrAE8MAIFRGgAhD2VuZAplbmQAhBktAIUcCwCEYxAAhW0cAIUPGwCGWwYKAIMaCgCDeQgKCg&amp;s=napkin" target="_blank" rel="noopener">Sequence Diagram:</a></h4><p><img src="https://www.websequencediagrams.com/cgi-bin/cdraw?lz=dGl0bGUgSW5zZXJ0aW5nL1JlbG9hZGluZyBTZWN0aW9ucwoKRGF0YSBTb3VyY2UtPkNWOiBpACoFABkIQXRJbmRleGVzOgpDVi0-Q2hhbmdlU2V0IAAzBUNvbnRyb2xsZXIAHRsAURFlbmRVcGRhdGVzADQgAB4MAGIYLT4AehFiZWdpbgAFNACBYxlsb29wIGZvciBlYWNoIHMAgjgGIGluZGV4CiAgIACBAhJDVjoAHwhJbmZvAIJABzoAKAVDVgCBLQcAgnEGAA8aAIMQDACDFwZSZXR1cm4gaWQ8QVMAgz0HVXNlckluZm8-AFQIAIF-EwAWIQCBUg5pdGVtIGluAIFgCACBXQUAgU0Zbm9kZUJsb2NrAIQkB1BhdGgAgWIGAIFXFQARHgCBWRlub2RlIGJsb2NrAE8MAIFRGgAhD2VuZAplbmQAhBktAIUcCwCEYxAAhW0cAIUPGwCGWwYKAIMaCgCDeQgKCg&amp;s=napkin" alt></p><!-- Reference -->]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20230220rewrite_sqlite</title>
      <link href="/2023/02/20/20230220rewrite-sqlite/"/>
      <url>/2023/02/20/20230220rewrite-sqlite/</url>
      
        <content type="html"><![CDATA[<h1 id="重写sqlite遇到的问题"><a href="#重写sqlite遇到的问题" class="headerlink" title="重写sqlite遇到的问题"></a>重写sqlite遇到的问题</h1><p>记录注意点</p><h2 id="stat返回问题"><a href="#stat返回问题" class="headerlink" title="stat返回问题"></a>stat返回问题</h2><p>#include &lt;sys/stat.h&gt;</p><p>stat(filename, &amp;st) 当成功时 = 0, 否则 = -1</p><h2 id="fopen模式为a-时的问题"><a href="#fopen模式为a-时的问题" class="headerlink" title="fopen模式为a+时的问题"></a>fopen模式为a+时的问题</h2><p>fopen模式为a+时，fseek失效，其会继续从后面补充。</p><p>解决方法: stat判断文件是否存在，不存在使用 w+; 存在使用 r+;</p><h2 id="fwrite"><a href="#fwrite" class="headerlink" title="fwrite"></a>fwrite</h2><p>每次要写入时，都需要重置位置坐标: fseek到指定位置后写入。</p><h2 id="fgets-fread"><a href="#fgets-fread" class="headerlink" title="fgets/fread"></a>fgets/fread</h2><p>在方法 <code>get_page</code> 时，误将fread 写成fgets。</p><p>fread 为将内容读取到指针内存中；fgets 为将内容通过文本文件读取到指针内存中。</p><p>当内容出现uint32_t = 10，也就是<code>0A</code>，fgets 识别为<code>\n</code>，并且接下来的内存都置为<code>\0</code>。</p><blockquote><p>根据断点查看对比hex16进制内容时 <code>po *(uint32_t*)((char*)node+6)</code> 内容都是对应得上的，并且文本文件也是能看到数据是存在的。但是一读取到0A数据时，就发现之后的内存都为<code>\0</code>了。所以直接断定为读取方式为文本方式读取。\<br>fopen使用<code>rb+</code>/<code>wb+</code> 仍然没有作用，写入fwrite没有错误，那么就是写入发生了错误!</p></blockquote><h2 id="插入算法"><a href="#插入算法" class="headerlink" title="插入算法"></a>插入算法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">uint32_t</span> LEAF_NODE_RIGHT_SPLIT_COUNT = (LEAF_NODE_MAX_COUNT+<span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">uint32_t</span> LEAF_NODE_LEFT_SPLIT_COUNT = (LEAF_NODE_MAX_COUNT+<span class="number">1</span>) - LEAF_NODE_RIGHT_SPLIT_COUNT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">leaf_node_split_and_insert</span><span class="params">(Cursor* cursor, <span class="keyword">uint32_t</span> key, Row* value)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int32_t</span> i = LEAF_NODE_MAX_COUNT; i &gt;= <span class="number">0</span> i--) &#123;</span><br><span class="line">    <span class="keyword">void</span>* destination_node;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= LEAF_NODE_LEFT_SPLIT_COUNT) &#123;</span><br><span class="line">      destination_node = new_node;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      destination_node = old_node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">uint32_t</span> index = i % LEAF_NODE_LEFT_SPLIT_COUNT;</span><br><span class="line">    <span class="keyword">void</span>* destination = leaf_node_cell(destination_node, index);</span><br><span class="line">    <span class="keyword">if</span> (i == cursor-&gt;row_num) &#123;</span><br><span class="line">      serializedData(leaf_node_value(destination_node), index);</span><br><span class="line">      *leaf_node_key(destination_node, index) = key;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &gt; cursor-&gt;row_num) &#123;</span><br><span class="line">      <span class="built_in">memcpy</span>(destination, leaf_node_cell(old_node, i<span class="number">-1</span>), PAGE_SIZE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">memcpy</span>(destination, leaf_node_cell(old_node, i), PAGE_SIZE);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20230214fired</title>
      <link href="/2023/02/14/20230214fired/"/>
      <url>/2023/02/14/20230214fired/</url>
      
        <content type="html"><![CDATA[<h1 id="辞退"><a href="#辞退" class="headerlink" title="辞退"></a>辞退</h1><h2 id="一聊"><a href="#一聊" class="headerlink" title="一聊"></a>一聊</h2><p>年后回来，因为要再次申请落户，我就问人事可以了么？毕竟这个等的真的是好久好久了。人事说再等等，她要请示下人事。</p><p>过到这周四晚上，伟哥来找我聊天。进来的时候他问到工作怎么样，我觉得进度还好，基本都OK。他转头问了些别的，我看到伟哥的欲言又止，我知道我这么多年经常问的那句话”伟哥啥时候毕业我”，要成立了。</p><p>“由于我做不出好的产品”/“没有做好管理”等，他希望我达到管理要好，自身要维护多款产品 - 不管维护多不多，总要做好一款产品。他没料想到我生活的拮据，穷得时刻想着要是被毕业可就立马还不起房贷车贷了；没聊想到在做管理期间的无数对接:多个服务的主力开发，轮轴转；对外对接甲方客户，电话能打一下午还不好挂电话；本身管理开会、管理团队和管理事务；手中负责最重要的《网迹》iced转ts工作；本身<code>取综经理</code>头衔对外技术对接、实施方案等等。不行了不行了，真的尽力了。</p><p>最累的时候，头都晕了， 幸好我身体贼棒，而且信心佳，懂释放压力；公司在最困难的时候也没有放弃员工，平时也很很照顾: 买房首付支助、买房年终加钱帮助、人才落户帮助(还没成功，说资质材料需要补充)等等。算下来一年税前也到27左右，所以别走了重新认识团队的代价，还行，多回馈。</p><p>去年伟哥说续签，给人才落户审核机会，卖身三年，我老婆说，可以可以，卖了卖了，可惜一直没有能落下来，都尝试3次了(第三次我有点忘了啥时候点击<code>上报</code>了)。</p><p>伟哥这次来找我，那肯定是已经讨论过，最终下定主意了。那就是直接跳过拉扯，嘿嘿，直接到辞职条件。伟哥的意思是这次有90%的机会，让我和老婆两人都落，不管公司出钱啥的都给整好；同时公司该还的钱还了、年终没了(年终是去年努力的奖励)、辞退金没了、股份退还 - 没了，等等等都没了。我想了想，如果90%夫妻都落，我认了，平常的价格可得不到，同时还给资历浅的老婆增加证书。</p><p>接下来的聊天就是问一些东西，我也顺便问问我大致辞退原因(这次聊天中，伟哥是说产品力、没有做出好的产品；最后一次商议时和伟哥聊了很多，最终能清楚知道离开原因: 另一个产品替代，我手中无事可做，我之前未能做出再次突破，所以毕业了)。我能接受条件，伟哥也知道我之前的努力，我也知道这么多年伟哥的照顾，他说好聚好散，我也说好聚好散。</p><h2 id="二聊"><a href="#二聊" class="headerlink" title="二聊"></a>二聊</h2><p>接下来几天我等着人事找我，赶紧办理嘛，落袋为安。落户是个虚无缥缈的，不像钱，钱是跑不掉的，努力赚会有的；落户这次不落，好得好几年呐，好几年后年龄长些，还不一定顺利。心绪繁杂，迟迟未找到我，于是我又赶快去问人事。人事说她不能定，得问人事总监，OK，当天晚上人事总监(下称N)联系到我，我跑下去和他交流了一番。</p><p>和N聊了很久，我倒是从她这听出来我是因为能力不行辞退，那我就稍微辩论了下。去年也是超努力，去年解决的内容甚至于除了我，只能伟哥能完成了，整个公司研发+技术，只有我和伟哥。再聊了聊赔偿方案，她说n+1直接确定就好了，90%能落户她也不能确定。我说伟哥给俺说的，说不定伟哥有手段咧，嘎嘎，毕竟钱我能挣，但是近期就有机会落户的机会我可不能不把握住啊。我说那要不然喊下伟哥，N说好，然后伟哥有事木有去一起交流，嘎嘎，那俺再等等。</p><p>这几天家里知道在办落户，也是满心期待，也提醒我尽快和公司沟通。我呢，不敢让父母亲知道我是被毕业了换来的尝试机会，不然他们得担心，然后就说快了快了，咱们不能急，稳住稳住，嘿嘿。然后数天夜不能寐，睡得都很浅，丫头心里也很急，她公司继续对待恶心。我也多安慰安慰她，这几天我被毕业也没告诉她。要是我在她还在公司期间帮她落户，那对她而言就多了很多选择和把握。所以那段时间，夫妻都是心力交瘁，满心等待。</p><p>又过了几天，公司这里人事问了没回应，每天回家就和家人说”就快了就快了，明天应该就有回应了”/“今天我又找问了谁，又发信息给谁”/“没回可能是什么原因把”。这周内都一直没有消息，到周五的时候发信息给伟哥，他说上次我和人事讨论，我需要还清公司的款项，之后再办理。我说OKOK，有结果就简单了。因为具体讨论还没定论没结果，所以我也没法知道我该做什事。赶紧和老妈打电话借走妈妈最后的5万，跟老妈说不要告诉老爸，那天也和二姐打电话，二姐让我不要担心，实在不行，她那还可以借款 - 无抵押3.9年利率。二姐这个太给力了，无抵押只要3.9%年利率，能贷款量大就好了，目前她说只能维持过渡的量。万般不舍把老妈治病钱借来，赶紧把当前事落下来。</p><p>从开始第一次谈话，过去了一周，周一时问人事和财务打声招呼，人事回了声”等会去核对”。然后一直都没有进展，我发过去，人事<code>已读不回</code>，然后2月14号时，我直接找到财务姐姐说还10w款项。她惊问”你咋啦，不做啦？”，额，是也不是，结果是，主语不是。俺也不好声张，就说”不是，凑足钱还钱心里舒坦[呲牙]”。然后两笔钱分开还，这个情人节我把10w先还了，然后转账单子也转发给人事，问剩下怎么处理。</p><p>人事还是没有回。我心里是焦急的，2月10号发工资，其他人有年终奖的也都发了，我是啥也没有，啥也不是，坐卧不安。公司没什么大的事了，我赶紧学习，但是心里没有着落。他们是还在讨论吧，我这么安慰自己，和家人。然后又过了几天，实在心里憔悴，我做了接下来的事:越过伟哥，找到陆老师交流。时间2月16日。</p><h2 id="三聊"><a href="#三聊" class="headerlink" title="三聊"></a>三聊</h2><p>和陆老师交流了很久，他说他对这个事不太清楚，不过似乎知道我是要走的。他也交流了我的过往可圈可点，还需加力的地方。我也说了这次不得已过来找陆老师: 我敢来找您，是因为您的为人；我不该来找您，是因为越过伟哥，这绝对不对；但是我绝对应该来找您，因为我没有退路了，我妈治病钱都拿出来了，我还不清楚接下来是走是留，什么时候走，好不好找工作等等等。我有难处，需要说出来，我没有退路了，我这个小家风雨飘摇了。</p><p>和陆老师交流许久，他大致清楚现在状况，不过他还不清楚相关细节，我就先回来了，我尽力而为。当晚也和丫头和老爸说了，我连陆老师都去问了，应该就快有消息了吧，当晚睡得还是迷迷蒙蒙。第二天下午，丫头说，还是没有消息呀，她公司这么恶心人，她也是很心急。我知道，这时候要忍住，但是也确实无奈，可能他们还没有讨论好具体细节，我在隔天2月17号，又再次询问伟哥交流。他说等会他忙完找我。</p><p>快下班的时候，伟哥、人事总监过来喊我讨论具体细节，他们为了防止录音，把我手机放桌子上了。这无所谓，和他们共事这么久，相信他们为人，我可没有做录音的打算。这次是具体到时间、操作、细节等。</p><h2 id="四聊"><a href="#四聊" class="headerlink" title="四聊"></a>四聊</h2><p>伟哥先说明他之前以为90%把握，可能做不到，N说她能做的就是再一次提交审核 - 多次审核不通过可能造成公司没有审核义务。我说只有一次机会，还有别的补偿么？因为如果这样，一次性体验券，不通过的话，不如选”N+1赔偿方案”。人事感觉还想尽力就用这个敷衍过去，没有给出补充方案，说公司也是多次审核。我说不行，这方案我不能选，难度太大，这么多年出生入死，无数次的拼搏，斩落战功也是赫赫。伟哥也没再藏着，直接和我摊牌最终方案，考虑到我的难处，还公司的另一部分钱不用还了，并且在职时间给我推迟到3月底，让我有充足机会去面试冲刺CPP开发。</p><p>心里估算下来大概公司要出6/7w，相比”N+1方案”相当于3w买一次再抽奖一次的机会。这一次他们也给我提建议，先让我和孩子先落，老婆的资料确实不够。我想着也是，回头查看资料说明，人才落户中配偶资历应该相当，外加稳定工作。那就是说之前每次失败，都是因为”随调”但是老婆资历不够的原因。我觉得把握更大了，反正实在不行，十年后夫妻投靠落户不还是可以的嘛，并且我落了和老婆相同享受优待。之后我吐槽上次和人事交流中感受到，我在他们看来是我能力不够，我不服，我坐在这位置，就说明了能力绝对够顶。在这行业，身体要好，知识要高，素质要好(我要外出的)，做人做事都要顶尖，忍耐性要强，学习力要拔萃。他说是的，不然他也不会再和我谈，直接”N+1”简单。</p><p>我说是因为产品力不够么，我就开开玩笑，我说这么多年我重来，别的事也不掺和(不揽脏活累活)做出OK产品，我能留下来么？他想了想，嘿嘿不行。我知道了，看来最主要原因还是这波裁员，并且有基本重叠功能的项目。之前公司是部门经理，去别的项目做小弟，他们也不好安排，所以索性砍项目的同时也把多余的我去掉罢。</p><p>我也没想着能多好安身，只是要给自己找到方向，有个方向就好，方向前往必然会有曙光。这次谈话吐槽吐槽这么多年来，也同时感慨不能再为伟哥挡压力了。这次是真的好聚好散。</p><p>会后找个没人的地方打电话给丫头，告诉她目前情况，这事先不告诉老爸。她这时才知道，他们痛快答应我的要求是因为我要离开这公司了。<br>她当时没听懂还说，你不是答应卖给公司三年吗，咋能立马辞职。对公司也算是前途未知的解脱；对我来说也是新的征程。事业上双输，未来上双赢吧。</p><p>当天晚上睡觉终于能睡得踏实点了。</p><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>下周一2月20号由于人事菇凉有点忙，到周二开始办理，OK，我觉得是稳的。</p><p>2月21号当晚龙抬头，也是2月21号早上修改相关资料，重点是配偶一栏”暂不随调”，整理相关资料(孩子入学等信息)妥当；中午的时候在”个人简介”一栏中抄产品经理的描述，最终确定每个资料，然后在上报前对信息进行打印一份出来，并且签上自己的名字 - 表明这次最后一次，没有退路了。</p><p>这个结束后，N也要求我填写一个<code>离职申请</code>，自己主动请辞。</p><p>希望这回通过吧，我没有退路了。通过或者失败，我回头再补充上。</p>]]></content>
      
      
      
        <tags>
            
            <tag> fire </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年新春</title>
      <link href="/2023/02/02/20230202forspringfestival/"/>
      <url>/2023/02/02/20230202forspringfestival/</url>
      
        <content type="html"><![CDATA[<h1 id="回顾新春"><a href="#回顾新春" class="headerlink" title="回顾新春"></a>回顾新春</h1><p>先来个流水账: 年前想着做游戏赚钱，首先把opengl入门，最基础部分。学完之后没有做记录，很快就接近忘了，想着下次深入学习时再做记录。由于穷-现金入不敷出，老想着赚钱，程序员最好的副业那就是做游戏了，于是把cocoscreator学习了下。基本能做游戏，但是尚未有方向，暂时搁置先。接着学习了下Socket知识，并且配套了<a href="https://github.com/akerdi/tinyhttpd" target="_blank" rel="noopener">文章</a>, 甚是有成就。年前把破车卖了，趁购置税减半贷款买了新车。</p><p>过年爸爸妈妈都在，于是想着懒得回家堵车，也没玩几天，或者说手上没钱，回去也没得年过就待在上海了。到了除夕，真就整栋楼只剩我们一户，爸爸还是每天早起晚归做保安，为了五斗米折腰，不过过年拿住户的红包倒是拿了两三百，年后老妈看放开疫情，旅游火热跑回去导游，爸爸也辞职回家看孩子。</p><p>我放假前一天很郑重其事的说早起，引导孩子。得，生病加北京出差(熬夜)起得晚，老婆又在那说说说。我就一直打混场，多睡一会，她却不依不饶得寸进尺，最后撂下一句: 你们江家的孩子自己管，她不管了。说完她继续去上班了(我早放一天假)。这谁听了也恼火，为此晚间还生她的气。</p><p>白天和老妈聊天，晚上要和丫头交流下。晚上的时候和老婆聊不到一块，她就说我要说到做到，那我说她也很多没做到，我说赚500万那就一定要赚到啊，尽可能，尽力呗。最后聊不到一块，睡去了。</p><p>第二天教阿黄读书，我教比较严肃，阿黄紧张又那哭，她来插嘴我忍不住(昨天交涉不通，我还生着气；本来不生气的，好好沟通，没有沟通成功，那我就开始生气了，小事情都沟通不了，要大作，搞毛)敲桌子让她别插嘴，没礼貌。观棋不语都不懂，她教就她教，我教她又来插嘴。然后她在很冷下着毛毛雨摔门出去，我冲出去警告她立刻回来，不回来我就我就。她没听，直接走了。</p><p>把我气的，什么事！没事要生事，小题大作，没到节假日，就闹脾气，那么多年指导，现在父母亲在还闹脾气。大过年的，搞什么鬼。我继续搞东西，阿黄也让他继续学习。我跟老妈说，别气着，先别管她。过了很久还是没回来，老妈说下去找，我说，我去吧。</p><p>心里想着她可能去的方向，往她公司方向走过去一大半没找到。我心里已经做了很多挣扎、做了很多打算，找不到，就不找了吧，这是最后一次找了，我累了。每每快乐假期都这样，我妈身体不好还来气，这老婆没用，我要往前冲，她还来拉后腿，该滚蛋就滚蛋吧。那天拿着伞很冷，走在街头，冷冷清清的，零零散散的人在这灰蒙蒙的下午来来往往走着。大家都知道回家过年，放缓心情。我累了。</p><p>往回走着，突然看到街对面人，然后走过去陪她走着，就这样撑着伞走着，无声的走着，在公园转了一大圈，然后一起回去吃饭。当天下着小雨，第二天是零下气温，路上一只野猫也知道必须要找到干净、有饭吃的地，一路跟着我们，一路喵，走在前面开路以为能回家。是啊，猫都懂家，所以我也不能说放弃就放弃这只猴子。</p><p>回去的时候老爸刚好在，我就让大家帮忙，让大家开导开导。之前觉得大姐比较苦，但是人家搞着搞着该有的都有，虽然去年被骗钱，但是生活上还好；二姐夫之前听说搞幺蛾子，我在群里直接开怼，现在他们也不错；反观我自己，倒更是成了笑柄。</p><p>那天晚上大家坐着说了好久，该说的都说了，不该讨论的也讨论了。反正有错都要认，认了下次不准犯，原则问题不准再犯。晚上的时候煤气灶坏了，我那里修呀修，妈妈在那洗碗，突然老妈说赶快扶她，她白天被气着药没即时吃，站不住，扶着台子都要倒掉了。我半跪着修灶赶紧跪在那抱住，让丫头赶紧帮忙扶着，拿药吃。拿个凳子坐缓和了好久才好点。</p><p>妈妈病已经这么严重了，我一直都不知道。家里的很多难处苦处都是蒙着。上海这起点高，我一直没混好。爸爸身体慢慢也在变老，他们还老是逞强。</p><p>有时自己真的无能为力，户口还没落，钱也没赚到，唉，里外不是人，父亲责任没做好、儿子责任也没做好。</p><p>只能寄希望于今年的运气了，该做的，该学的，都做了。</p><p>接下来几天还算平稳，爸爸还是早出晚归，就为了补贴家用。我在像狗一样活着，父母亲也还在劳累着，用爸爸话说，给人当保安，也就跟狗一样的，12小时时长，中午不能睡，手机不能玩，给户主赔笑脸。</p><p>接下来几天，白天帮帮妈妈的忙，加紧学习，初四带一家子(爸爸在做保安不能走)跑去外滩吹冷风。玩了三个小时，车停到bfc，然后用闲鱼付了20块钱。当时找车可麻烦了，简直是跑断腿啊，终于找到了车子，出来的时候车子一直往上开，动力还是很强的。直到扫车牌出来才安心没有多扣费，嘿嘿。玩到三小时，试验了停车优惠。</p><h2 id="最近目标"><a href="#最近目标" class="headerlink" title="最近目标"></a>最近目标</h2><p>最近把数据库重新过一遍，争取完全掌握？一遍？不够不够，完全掌握，自己写一个完整的数据库出来才够。</p><p>完全理解数据库原理的话，我想去外面看看自己还值多少钱。阶段性目标吧。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 回顾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20230112thought</title>
      <link href="/2023/01/12/20230112thought/"/>
      <url>/2023/01/12/20230112thought/</url>
      
        <content type="html"><![CDATA[<h1 id="想法"><a href="#想法" class="headerlink" title="想法"></a>想法</h1><p>2022年过去，躲了新冠3年，最终还是没躲过去。以前疫情低谷时，出门都不用带口罩，就是这么随意；疫情紧张时，外面戴口罩，回家就自由不用戴口罩，空气很新鲜，觉得口罩看起来还很新就挂起来继续用，就这样都没得。</p><p>当听到政府一条条放开疫情政策发出来，直到发出最后所有进出不设关卡的政策时，大家都能知道，所有人都躲不过了。这时候我知道整个上海温度都升高了，空气都会弥漫着病毒。</p><p>我回到家就让大家近期注意，尽量晚得，或者说尽量分开感染。一个周末，阿黄穿的少大中午玩他自己写的打飞机游戏，觉得他肯定冷，赶紧赶去爷爷房间。我转头继续和老婆睡午觉。下午起床就听到爷爷说阿黄发冷，去睡了。然后晚上头晕，吐得被子全是晚饭要求阿黄吃的食物。阿黄偷偷和妈妈说不要和爸爸说。这货，你生病和你平常总是尿裤子不同，赶紧生病好起来呀，岂可修。</p><p>这时候我就担心是新冠，但是行为又很不同 - 可能对于小孩是来得快去得快。那天我让大家都戴口罩，争取如果是真的生病，则间隔生病。爷爷觉得跑不掉一开始没有戴口罩，我还是让老爸口罩戴起来，晚上爷爷说我们还上班，爷爷戴着口罩和阿黄睡 - 这小屁孩还不能一个人睡，我们还要工作，所以做了那个决定。没办法，接受了。第二天早上阿黄好一些，下午的时候和爷爷去跑步，然后就好了？我觉得这也太快了，不太像新冠，心里有点嘀咕，当时也没有给阿黄做抗原。</p><p>接下来的一周公司人越来越少，不是同事自己中了就是同事家庭中了，基本都回去了，只剩下零星的几人。</p><p>周二的时候，猴头菇也中了，发冷头晕，骨头痛，一直额头贴冷巾。她隔两天后退下去就一直咳嗽，咳了近15天才好。老爸说，躲不了躲不了，我说尽可能间隔生病。知道躲不了，但是间隔的话，就有人能解决生活问题，或者说突发状况(谁能知道这病毒对不同体质人有哪些不同反应)。丫头还说我冷落、无情，没办法，家长就是无论如何，家庭都要管好。后来大家也都理解我的做法，毕竟谁也不知道期间会不会突发状况，我的是稳妥做法。</p><p>老爸接着也中奖，浑身发冷，第二天老爸就基本好多了，他三针，丫头两针(丫头加大姨妈)，阿黄两针。我从周二回来，一开始在爷爷房间的另一个床睡。后来老爸也中奖，丫头好点，我就跑去小房间临时床睡。期间他们好点，我就时不时回公司搞。</p><p>周六晚接妈妈来上海，让老妈来的时候疫情还没放开，现在倒舍不得她来，来的时候上海已经是毒窟了。妈妈来的时候以为上海很冷穿的太多，然后带了太多太多东西，她居然电梯上摔下来。幸好安全到达，左脚又弄肿了。把我和老爸气的呀。带了一堆没用的没价值的东西，啥不好吃的零食啊、好几条围脖啊、竹制工具啊、一大锅汤啊。我的天，我和老爸都晕了。老妈安全到就好，还是赶紧休息。出门在外，人到达才是目标。</p><p>周日我也终于中奖了，发冷，脚底冰凉没有暖和好，因此导致感冒症状持续稍久。当晚头晕，第二天倒是恢复一些，没有工作电脑(阿黄上课、丫头工作)，只能去公司拿电脑。周一周会参会，时间很久；工作有些问题没解决在单独一个教室搞下，但是下午着实顶不住，需要回家休息下(刚好换车，公司停车需要换证件，于是找到物业搞了好久才好)。回去后稍微搞下工作事情，头实在是很沉，睡过去了。晚上吃了些东西，又是早早睡觉，当天晚上睡觉浑身还是很疼，特别左边牙龈疼的睡不着。睡尼玛，凌晨4点起来打游戏。接下来也是好久一直咳嗽。</p><p>老妈来了，基本也是跑不掉的，周二就觉得浑身冷，阿黄就一直和老妈睡(阿黄想玩老妈的手机游戏)。老妈的症状也是一样的发冷、头晕、浑身疼。咳嗽倒是和老爸一样不怎么咳嗽，就我和丫头一直咳嗽。</p><p>老爸之前问去隔壁小区当保安，周六老妈来的，老爸早上5点多就出发去当保安。因为老妈来，老爸想搞些钱，补贴家用，于是就在附近找了当保安的工作。一直起早贪黑，有一晚顶替人手，待在别的岗亭。不顶替的时候，都是白天班，晚上的班一直是另一个保安，另一个保安在那个保安亭睡省的住宿，所以老爸上白天班倒是清闲些。那天去另一个岗亭顶替人手还是很担心，我想去帮老爸，老爸又不让我去，我和妈妈去找老爸看看环境，觉得不是很好，老爸就一个劲让我们回去不用担心。</p><p>白天上班、晚上又那值班(睡在一个破椅子–睡得不舒服)，第二天又是白班。哎，还是小江太辣鸡了，穷鬼，全家身上都没什么积蓄啊，太穷太穷。还要年迈的父母亲帮助，，，加把劲吧。</p><p>这次唯一幸运的是，全家都健康，没出现重大损失，实是大幸。现在的我，离生活更近，也更理解工作与生活的平衡。</p><h2 id="辞旧迎新"><a href="#辞旧迎新" class="headerlink" title="辞旧迎新"></a>辞旧迎新</h2><p>2022年已经过去，回顾下。</p><p>2021年下定决心使用Nodejs生活，放弃其他语言，比如当时觉得想学的GO语言。GO很好和我有关系么？Nodejs哪个实现不了它的功能？所以放弃他。我曾经多年的C 超集开发经验，终于还是要捡回来。学习了用C实现shell， 用C实现lisp。</p><p>2022年反反复复回顾学习C-Lisp，同时多学了数据库C-SQLITE 基础入门。将shell、lispy、sqlite花比较大精力写了文章。将C-Lisp翻译为JavaScript版本，这是我比较大的自豪。</p><p>写了的文章，这许久给我攒了50多星，感觉到自己的进步，他人的认同。年底顺便把OpenGL入门，cocoacreator也简单学了些，最后最后还把Socket入门，终于知道网络编程的详细过程。不搞C语言，太多知识都是一知半解。</p><p>2023年，把数据库彻底深入，Socket自己实现一些小工具，最后的最后往C++的金融服务器方向。靠自己做的工具赚钱有点难，拿高工资还是很有希望的。争取学习一年后，看2024年初能试下拿几个金融服务器开发的Offer。</p><p>今年年初，有机会花点时间面试下、拿下中级软考、年底拿下中级职称，加油。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221226xuanhao</title>
      <link href="/2022/12/26/20221226xuanhao/"/>
      <url>/2022/12/26/20221226xuanhao/</url>
      
        <content type="html"><![CDATA[<h1 id="选号"><a href="#选号" class="headerlink" title="选号"></a>选号</h1><p>车买好了，但是一直使用临牌走地面，全是红灯还是很麻烦。想着12月的车子，这个时间上牌相当于老了一岁，就想再买个临牌混到2023年，岂不美汁汁？在等待数天后，有天开会碰到我们公司产品老铁，他对选牌也有研究，就问他。他说可以呀，拿出手机来就可以操作了。</p><p>他帮我打开 交管12123 - 更多 - 新车选号 - 选择城市 - 上海，然后根据购买车子的信息填写对应的信息，如<code>合格证编号</code>、<code>品牌型号</code>(这个填写完整的品牌型号，例如<code>本田GJK12iSKX</code>)、<code>车辆识别代号</code>等等。</p><p>接下来<code>本人确认信息无误</code>后，可以</p><ol><li>随机20选1，可以五组，看中哪项选一个。他的规则是一段时间放一段的号，沪A、沪B选择，但是那些号码真的没那么喜人</li><li>还有一个是自选号码，也是5个，要是都没有中那没得搞了。规则是直接编5个自选号码，优先级从上至下。千万不要编什么沪AX8888啥的，这个时候借助淘宝估计有作用，我猜的。</li></ol><p>我怎么做的？手机上我先随机选了4个号，发现都不喜人，然后顶部Tab栏切换为自编号码，期间时间不很多，也是要快些操作的，自编了几个号，居然中了自己喜欢的那个。</p><p>哎呀，那个高兴呀。感谢了产品老铁后，出来发现这个号码需要在12月22号含当天之前上牌，否则两年都不许网上选号，啊哈，没看清条款，我预约了2023年的1月4号上牌。不过至少学会怎么网上选号了，下次就会了。</p><p>这个号码很喜欢，在了解说来年上牌只是影响车子的卖车，而不是影响任何其他因素，如6年免检时间减少一年，那就没关系了，优先考虑那个号码。接着我打电话到12345市民热线，第一次打市民热线，他帮我提交了工单。我的述求是要么车牌号码推迟到明年1月4号，因为没看清条款，或者我只能预约到2023/1/4的上牌时间改为2022/12/22之前。</p><p>12/20号时公安局警员打电话过来给出了解决方案，车牌时间是公众资源无法修改，上牌可以就近去上，有便民服务点，随时可以上。</p><p>于是第二天早上我就赶紧去附近上了，宋园路。便民服务点9点上班，首先缺少环保认证，这个简单，我就扫个二维码操作下就好了，工作人员会给你的。然后我问了下我有沪牌退牌单，能上牌吧？她说：啥？你退牌单不换为额度单上不了，带上退牌单去千阳路220号操作下。</p><p>幸好没有1月4号去莘庄上牌，否则离得好远，要先把退牌单去掉的。我赶紧开车过去，把退牌单，包括两份材料的复印件给工作人员，然后她跟我说整好了没别的东西，我就赶紧回来(因为上午没请假，按照他人指示一个小时就好了，上班时间8:30, 岂不是9:30就好了？我直接开上高架不就到公司了，美汁汁)，此时时间快10点了。我把材料给上牌的工作人员，然后把车子拍照做成行驶证，交了245块钱。然后在那等行驶证和绿本。工作人员说我的车架号和派出所提供的伪造车架号相似，正在派出所处验证，所以等的时间拉长。啊，我有点麻木，没办法了。结果到了11点多才到公司，只能到时说忘记打卡了，晚上多搞会，弥补早上的时间。</p><p>中午下去吃饭，顺便让同事教一下把车牌上上去，原来很简单。他是单向的，最后加个扣子就完成了。可以可以，这样我就可以上高架了，哇卡卡卡卡</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221210getcar</title>
      <link href="/2022/12/10/20221210getcar/"/>
      <url>/2022/12/10/20221210getcar/</url>
      
        <content type="html"><![CDATA[<h1 id="提车"><a href="#提车" class="headerlink" title="提车"></a>提车</h1><p>当买车下去后，过个3/5天就可以在上海交管app上提交预约新车上牌。然后预约的时间都是在10天后，那么期间只能开着临牌走地面了。如果像我这样到了周日才准备上牌的，那就得开10天的地面，我滴妈耶。</p><p>周六早上一家人打车去，花费27块，因为做地铁过去也要12块了，还要绕来绕去1个小时，算了算了。</p><p>到了之后我们进店里面，首先先签字确认已知悉保养、首保、车子质保等等信息，然后拿到一个文件袋车子的材料，里面两把车钥匙包括车子条形码。跟销售问了问相关东西，也大致知悉车子的机油保养，就好了，木有了。</p><p>我跟销售说我可能开不过去加油，还不熟练，你帮我开过去加油。于是销售上车教了教我基本东西，也没听出来啥。然后开车的时候，觉得没有网上说的车子很吵啥啥啥的，可能是开了15年的307之后都会更好接受吧。新车质感还行，也更敢开，毕竟买了保险，而且是临牌不怕扣分。</p><p>回去的时候载家人回去，刚出发的路段一点点紧张，接着就好多了。路上导航还导错，一家人都说转弯转的都要晕车了: 肯定不是我开车问题，肯定来的时候做的电车的问题，嗯，没错的。</p><p>到家后和门卫大叔聊聊天，就说临牌要开一段时间了。他也多问问信息，我跟他说过之前的破车是3000块，这个车落地现在花费也才1w。下车的时候和阿黄一起把车子的塑料膜给撕掉，阿黄也很喜欢这个小车车，干活可勤快了，即使下着毛毛雨也要整一整。</p><p>周日的时候丫头去打针，这就是我开车外出的理由，带上家人一起去徐汇转个一圈回来，不错不错，新车开起来开心，动力可足了，即使开了小绿叶省油模式。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 提车,car </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20221128salecar</title>
      <link href="/2022/12/05/20221128salecar/"/>
      <url>/2022/12/05/20221128salecar/</url>
      
        <content type="html"><![CDATA[<h1 id="卖车买车"><a href="#卖车买车" class="headerlink" title="卖车买车"></a>卖车买车</h1><p>之前网上使用懂车帝看车时点了下飞度试驾，没开过飞度试驾又不要钱肯定去呗，然后拿着破307去估值转转，找借口出去开车。约的周六中午前往，想把大家都拉去转转。</p><p>前一天晚上联系老板说，可以将存的一些钱来还借款、某份钱时，老板说不急，先留着用，再三推迟暂时留着的钱留在了身上。</p><p>然后周六的时候，就把家里的老婆喊上，把阿黄喊上，去普陀那里看车。</p><blockquote><p>没钱的时候总喜欢喊上家人去外面转转，反正花不了什么钱，而且没钱没法消遣，开车出去转转已经是最省钱的事了。想着没法给家人更多，只能说’穷转’解决苦闷。哦，以后有钱也会这样，只是说以后是以后的事，嘿嘿。</p></blockquote><p>第二天周六，中午。</p><p>把我的破307开到店里，然后记下驾照就安排试驾。试驾的是高配飞度，里面各种配置，不过对于我来说就是开开车。由于第一次自动挡，不好出发，还让驾乘师傅教了下: 踩刹车，右脚踩不要左脚踩；P档换成D档，对，按压档杆那个开关才可以切换；慢慢松开刹车，对，想快点就加油门。</p><p>欸，自动挡这么简单的么？不会熄火的么，我去。然后开始上道路，因为车多，不好控制距离，刚出发后轮压马路牙子了。不管他，往前，要快点就加速，慢点就踩刹车，转弯就做转弯不用管离合。啊，此时的我不在有离合，只需要关注悲欢就好了。转了个不大不小的中圈，转个一圈就回来，没有了。</p><p>试驾就是体验下，感觉还行，阿黄和老婆坐后边，感觉里边空间还算OK。当然车里感觉很多功能，如果我买肯定低配的，用不上那么多。</p><p>接着谈价格优惠等等。算的时候比我之前去漕宝路那家本田好多了，没有啥5000咨询费，不诚实，直接不联系。车子说868那个版本，但是还有个改款908，有天窗!想改车有点闲钱总是可以的，但是改天窗不行，这种乱改违法的嘛，改了不能上路。</p><p>谈价格我肯定问下我车子多少能置换，4s说我那个太老，没人要，只能免费退牌拿额度单。我去，我还想说我的车能顶个5000、10000的我立马下单的咧。二手拍车估值2000，那就直接问这个车子能优惠多少吧。</p><p>他给到6000优惠；然后上牌1000我说自己来，收了300临牌费；保险3900左右；贷6w，利息3个点；我觉得不值，我想我的车至少置换3000今天说不定就可以下手了。他听到这个，说去问下经理，然后转身不久就回来了。回答说，今天能决定，那就车子他也不要了，优惠同样给到你。</p><p>我当时没听清，反正没理清，后来丫头告诉我说，就是说优惠到9000，同时车子我自己拿到外面去卖也可以。我觉得这个优惠很心动，特么漕宝路优惠5000，然后5000咨询费又拿回去，这不特么傻逼才跟他买么。打电话叫外援 - 华容。我问华容OK不，他对本田研究不深，只能自己拿主意了。查看了懂车帝大致报价，觉得价格还行，然后和老婆合计。老婆很在乎老公，累点也觉得值得，只要我觉得能下手，毕竟这个价钱还算出得起。和她聊到未来也不会有太多优惠，年底购置税就不减半了，早买晚买都一样，就和销售签合同了。其实手上就只有3w，刚好首付，别的真的一毛都没有了。手上没钱真是内心比较纠结的，想着自己累点吧，早买晚买优惠没多少，就这样自己也同意了。</p><p>因为其他税费都没有，加送200*5的4s抵用券，全车脚垫，贴膜，倒车雷达，首保等，付完5000定金，定的车是10月车，只有一台，白色。</p><p>第二天周日又跑过来签合同，这么麻烦我都想全款了。</p><p>周一中午没吃饭就开车去浦东卖车(闲鱼有车商3000拍下，周一中午过户)，饭没吃就开车去浦东。我车的油还好多，老心疼。开车送过去的时候，跑120码感觉方向盘有点控不住，虚位很大，降到110都还觉得有点问题(后来和同事聊到说是没有做动平衡，5000车坐200动平衡，才不做嘞)，然后那天有点热，坐车里，开最大空调居然没用，我去，前段时间还好用的呢。</p><p>到了之后车商才开着轰隆隆的破车过来，然后他带我去二手交易市场。他说开起来有点没力，抬起车身看了说三元催化给换掉了，然后说退款。我去，我请假跑来，又没卖车，烦死。后来我说2200成交，不成交我走了，他直接微信2200钱转过来。接着上楼做过户手续。给了大本，驾驶证、身份证(未满一年换牌，无法保留原车牌，所以不用居住证)就好了。我也没别的事了，叮嘱过几天寄退牌单来，就做地铁回去了。下楼转了一大圈又回来附近地铁，转眼就打雷下大雨了。</p><p>那天中午2天多回家，老爸给我炒了面。不一会本田那说贷款过了，过去新车那交首付钱，顺便看下新车。过去后先跑去看车，我的新车，有天窗，里面都是新的。下着雨呢，不舍得被雨淋，坐到车里赶紧把门关上。然后稍稍摸摸，视频拍一拍后边车门，打开看了下就又关上，下雨呢，没法详细看。带我来的大哥也在车里等着，不能因为爱车、大下雨的还在那巴巴看车的样子丢了面子，今天来看车主要就是看一看，交车还得后面跟提车一起的。</p><p>转身回到载我来的车子，广汽本田-冠道。听过25%偏置碰撞成绩细碎，不过坐在里面还是很享受的，这大下雨的，随便坐在什么的车里都是这种舒适吧。回到店里，把钱交了，然后就开着小电驴回家了。接下来的几天就是开着这破电驴上下班，可冷了。这冷风就是在我把车卖了，然后冷风就开始吹了，可恶，冷死了。</p><p>接下来一两周开电驴上班顺路把阿黄送去学校，每天早上还是挺忙的，不过充实。</p><p>几天后有个让我难受的，是有天通知让还调整社保基数的钱。啊，累，一年来超级努力，早出晚归、到处出差没有所得，比他人拼命、劳累没有任何所得。不患寡而患不均，不是要我出差，是我不出差的话，只能换部门级别的才能搞定遇到的这些问题。当时答应调整基数，最终是要还的，没想到来的那么快，早知道不订车了，哈哈。难受，自己还在囚牢，老婆也还在囚牢，希望再来一个月，能破除这<code>囚牢</code>。是的，有点想，有时间出去看看自己还值多少钱吧。当前先把小副业搞起来，撸一些小游戏出来，然后辅助我学习c的底层技术，我想多学点，绝对不会错的。加把劲吧，小江。</p><p>最近想着赚钱，就睁开眼看看社会，看的比较清这社会原本的模板，一直以为很高大上，其实还是一地鸡毛。只要是混社会的，管你多牛逼，他们只在乎钱，他们只会抖音里的低俗文化。亲近他们，让自己更亲近些，更好的伪装自己和他们一样。这样做的游戏，2c的理念才能更加贴近用户本身。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221123opengl</title>
      <link href="/2022/11/23/20221123opengl/"/>
      <url>/2022/11/23/20221123opengl/</url>
      
        <content type="html"><![CDATA[<h1 id="学习OpenGL"><a href="#学习OpenGL" class="headerlink" title="学习OpenGL"></a>学习OpenGL</h1><p>学习OpenGL是我一直以来的想法，我喜欢游戏，使用游戏引擎能快速的出游戏。但是作为程序员，觉得从开头学好有助于理解，并且特别是其中的shader是什么，怎么写的，这个在游戏引擎中是没有说明的，所以我打算打好基础后，然后再使用游戏引擎快速的去开发。</p><p>开发游戏是为了赚钱，将自己的乐趣转化为现金让我能学到更多知识。我需要钱来支撑我的学习，比如linux的制作，烧录到硬件，这是一直以来让我觉得很酷的事。</p><p>所以我特地花了一段时间狠狠静下心来学习，跟着<a href="https://learnopengl.com/" target="_blank" rel="noopener">教程</a>一步步学习完基础，仅学完基础。目前需要先出产游戏，所以暂时先不继续深学，之后遇到瓶颈时再回头，以下是我作为初学者的学习脚本:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">学习环境:</span><br><span class="line"></span><br><span class="line">机器: Mac 10.13.6</span><br><span class="line">IDE: VSCode</span><br><span class="line">管理: CMake</span><br></pre></td></tr></table></figure><p>目录结构:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/.vscode/</span><br><span class="line">/.vscode/launch.json // 实现启动项</span><br><span class="line">/.vscode/tasks.json // 实现任务</span><br><span class="line">/includes/</span><br><span class="line">/includes/glad/</span><br><span class="line">/includes/KHR/</span><br><span class="line">/lib/glew32s.lib //</span><br><span class="line">/lib/glfw3.lib //</span><br><span class="line">/src/glad.c         // glad文件</span><br><span class="line">/.gitignore         // git 忽略文件</span><br><span class="line">/CMakeLists.txt     // 编译文件</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221121window_cmake</title>
      <link href="/2022/11/20/20221121window-cmake/"/>
      <url>/2022/11/20/20221121window-cmake/</url>
      
        <content type="html"><![CDATA[<h1 id="使用windows开发gcc"><a href="#使用windows开发gcc" class="headerlink" title="使用windows开发gcc"></a>使用windows开发gcc</h1><p>使用windows开发gcc重要在于系统很方便，这里记录以备之后要用windows开发gcc，能快速还原当时的配置。</p><h2 id="使用mingw64开发"><a href="#使用mingw64开发" class="headerlink" title="使用mingw64开发"></a>使用mingw64开发</h2><p>配置环境变量: 此电脑 - 属性 - 高级系统设置 - 环境变量 - Path(编辑) - 增加mingw64的bin目录位置(我这里是<code>D:\msys64\mingw64\bin</code>)</p><h2 id="安装cmake"><a href="#安装cmake" class="headerlink" title="安装cmake"></a>安装cmake</h2><p>正常安装cmake，同样环境变量增加cmake的bin目录(我这里是<code>C:\Program Files\CMake\bin</code>)</p><h2 id="使用cmake"><a href="#使用cmake" class="headerlink" title="使用cmake"></a>使用cmake</h2><p>由于使用的是mingw64，所以不能直接调用cmake，而应该使用语句: <code>cmake -G &quot;MinGW Makefiles&quot; .</code></p><p>并且windows某些原因无法在vscode的Tasks中编辑cmake详细参数，所以这个命令我使用手敲的。这也就是说，文件不增加的情况下，直接F5执行make；如果代码文件有修改，则cmake需要先手动执行一遍上面的语句来修改Makefile。</p><p>cmake 目前就是这种方法操作，有更好的方法可以联系交流。</p><h2 id="配置F5断点调试"><a href="#配置F5断点调试" class="headerlink" title="配置F5断点调试"></a>配置F5断点调试</h2><p>目录:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/.vscode/launch.json</span><br><span class="line">/.vscode/tasks.json</span><br><span class="line">/CMakeLists.txt</span><br><span class="line">/main.c</span><br><span class="line">/.gitignore</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">launch.json:</span><br><span class="line">&#123;</span><br><span class="line">  &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">  &quot;configurations&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;Launch&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;lldb&quot;, // vscode插件需要下载对应的插件</span><br><span class="line">      &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">      &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/clispy.exe&quot;, // program启动声明需要调用的exe文件</span><br><span class="line">      &quot;args&quot;: [],</span><br><span class="line">      &quot;stopAtEntry&quot;: false,</span><br><span class="line">      &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,</span><br><span class="line">      &quot;environment&quot;: [],</span><br><span class="line">      &quot;externalConsole&quot;: true,</span><br><span class="line">      &quot;MIMode&quot;: &quot;lldb&quot;,</span><br><span class="line">      &quot;setupCommands&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Enable pretty-printing for gdb&quot;,</span><br><span class="line">          &quot;text&quot;: &quot;-enable-pretty-printing&quot;,</span><br><span class="line">          &quot;ignoreFailures&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;preLaunchTask&quot;: &quot;make&quot; // 断点启动前执行的任务，对应tasks的label。</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">tasks.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;version&quot;: &quot;2.0.0&quot;,</span><br><span class="line">  &quot;options&quot;: &#123;</span><br><span class="line">    &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tasks&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;label&quot;: &quot;cmake&quot;, // 单任务，为launch.json 的preLaunchTask做调用</span><br><span class="line">      &quot;command&quot;: &quot;cmake&quot;,</span><br><span class="line">      &quot;args&quot;: [</span><br><span class="line">        &quot;-G&quot;,</span><br><span class="line">        &quot;&apos;MinGW Makefiles&apos;&quot;,</span><br><span class="line">        &quot;.&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;label&quot;: &quot;make&quot;,  // 单任务，为launch.json 的preLaunchTask做调用</span><br><span class="line">      &quot;command&quot;: &quot;make&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;label&quot;: &quot;CMake Build&quot;, // 多任务，为launch.json 的preLaunchTask做调用</span><br><span class="line">      &quot;dependsOn&quot;:[&quot;cmake&quot;, &quot;make&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CMakeLists.txt</span><br><span class="line"></span><br><span class="line">cmake_minimum_required(VERSION 2.8)</span><br><span class="line"></span><br><span class="line"># 声明编译工具目录</span><br><span class="line">set (CMAKE_C_COMPILER &quot;d:/msys64/mingw64/bin/gcc.exe&quot;)</span><br><span class="line">set (CMAKE_CXX_COMPILER &quot;d:/msys64/mingw64/bin/g++.exe&quot;)</span><br><span class="line">project(clispy)</span><br><span class="line"></span><br><span class="line">set(CMAKE_BUILD_TYPE DEBUG)</span><br><span class="line">set(clispy_VERSION_MAJOR 1)</span><br><span class="line">set(clispy_VERSION_MINOR 0)</span><br><span class="line">set(SRC_LIST mpc.c main.c )</span><br><span class="line"></span><br><span class="line">add_executable(clispy $&#123;SRC_LIST&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.gitignore</span><br><span class="line"></span><br><span class="line">game</span><br><span class="line">*.DSYM</span><br><span class="line">CMakeFiles</span><br><span class="line">cmake_install.cmake</span><br><span class="line">CMakeCache.txt</span><br><span class="line">Learngl</span><br><span class="line">.vscode/settings.json</span><br><span class="line">.vscode/launch.json</span><br><span class="line">.vscode/tasks.json</span><br><span class="line">!.vscode/</span><br><span class="line">*.out</span><br><span class="line">Makefile</span><br><span class="line">*.exe</span><br></pre></td></tr></table></figure><p>剩下就是执行<code>cmake -G &quot;MinGW Makefiles&quot; .</code> 然后<code>按F5</code>执行了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221120杭州出差</title>
      <link href="/2022/11/20/20221120%E6%9D%AD%E5%B7%9E%E5%87%BA%E5%B7%AE/"/>
      <url>/2022/11/20/20221120%E6%9D%AD%E5%B7%9E%E5%87%BA%E5%B7%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="记录杭州出差"><a href="#记录杭州出差" class="headerlink" title="记录杭州出差"></a>记录杭州出差</h1><p>第一次到杭州, 其中有很多话要说。</p><p>今年以来，对于我最大的执念就是能落户。这是在年初上级对我的肯定，给我的好处，嘿嘿。不久就进入了上海的封控，期间提交了审核，审核反馈资料有问题，在解封后前往查询，意思是说社保不满2倍的原因。</p><p>现在直到快12月份了，还没落实，心里刺挠着，不过这个没办法，自己能力差。能力差？这点运气差的意思吧。</p><p>给了好处，那就是要努力搞东西。这半年来，消沉一些，因为实在是穷，还买上一辆车，多少每月多花一些钱。工作上也是认人维诺，处处提防。因为穷，好好做好分内事，别被辞了。工作上东西也多，而且组内成员变动频繁。韩信点兵，多多益善。韩信也架不住组内天天人员变动；对应我这里，团队磨合，经常性变动也顶不住啊。上次安徽省厅回来，测试组长把我所有成员换了，所有啊，然后又说这是临时的。我的天，你哪来的自信，你来带队啊？然后会上似乎他也想以他为主的意思。那行，我稍稍退后点，我干活，但是直到会后，也没说他什么角色？这？功劳他担着，苦劳我承着这是？我都这么穷了还来耗我一笔！我任务也多，有时这个应用，有时另一个应用，来回切。别人都是一个服务，还是小服务，我咋就这么多？？？</p><p>我当时是部门管理，想着人手不够，我先顶着，问题也是尽可能不上升到伟哥那。不过nodejs实在是招不到合适的人，难。以前OC遍地，各个强的一批，现在普通js都招不到。大公司疯狂裁员，小公司人才一个都不想来。顶着顶着，自己手上的重要应用出了问题: 最核心采集动作总有问题，但是在公司内部又很难试验出来。因为部署在外的都是吃其他公司的数据包。超级大的应用，就我一个，又是需求，又是其他服务需要修改，真是没时间改正这个，所以也是因为这个前往安徽省厅去解决回来。</p><p>解决完该问题，杭州又说很多问题，包括说遇到的采集、入库问题，并且就快验收时刻，没办法，我前往去检验吧。</p><p>他们是安排我什么身份去杭州的？服务采集、入库有问题，以该服务有问题前往解决该服务问题的。我是怎么安排自己身份去杭州的？我是安排自己是取综负责人，前往解决总的服务遇到的问题。</p><p>当天过去，技术同学带我去市局，疫情高分险区来的，需要7天后。得，先去很远的萧山，幸好能进去，当天就排查出各个服务的大致问题。第二天基本解决掉问题后，要去解决最麻烦的市局服务器问题。但是这个又无法进去，只能干等下周再进去了。</p><p>中间就是远程解决公司需求，但是那网速着实无法操作，一个屏幕确实无法干活，开发难受。</p><p>这几天下来着实想老婆倾述，压力大，东西无法完成: 进不去客户那！公司那边需求也无法完成，卡的受不了！我说老婆过来杭州转转，离得近，而且有住所，你也没来过，周末过来转转呗。得，阿黄生病，要上课啥的也不允许外出。人在事业没有起色、财务无法满足的情况下，确实想找个依靠，或者喘息一下。</p><h2 id="周六杭州看车"><a href="#周六杭州看车" class="headerlink" title="周六杭州看车"></a>周六杭州看车</h2><p>周六依着技术给的地址，去二手车市场转转？和谁？同住的销售。他可有意思了。他说他在杭州多年，超级熟悉这座城市，熟悉销售以及客户。在前天晚上的时候，他就扒拉扒拉推销自己，因为我还没到市场环节，所以目前只能应声附和。周六两人骑自行车到了目的地，居然没有二手车市场。对面倒是有卖新车的。两人一路过去，看了BYD王朝系列，得，我开油车；去了丰田，看到一款小车，税费不错，对比上海要5000手续费的，感觉很不错；又去看了姨妈巾、别克、上汽大众等等牌子的；最后进了奥迪。</p><p>去看大众时，我是奔着高尔夫去的，然后才知道大众也是分类型的，于是上汽大众里面没有高尔夫。往前走，也有牌子写着大众，我心想这回应该是一汽大众了吧。进去一看，原来是奥迪。奥迪，不一样的，一分钱一分货，进去的前台妹子超级好看，我多看了4眼，恨不得看透了她，嘿嘿，我是男人嘛。然后人那么多，收起目光，去看看车。那些车的质感在车门身上就已经透露了 - 厚实。摸过日系车，就知道德系的厚实了。然后去看了很贵的车，5/60万那种的，哇，坐进去都超级好。中间还有零食面包，这简直就不是普通品牌能有的待遇。有钱真好。</p><p>一路上就是看看车，销售同学知道我不买就随便看看，他就一直喊我去他来时推荐的一个按摩店。我秉承着，我的目的就是来看看车，上海的时候没时间嘛，再看一会去按摩咯。所以也一直被我拉着，我就像是来自乡下的瘪三处处好奇看着。这瘪三很穷，但是买了上海房子和车牌，比较奇葩，哈哈。每进一个店，销售同学都让我扫码，这太坏了，一直让我干活。事后才知道，原来他的码是黄的！他不敢扫。我第一次遇到黄码的，嘎嘎，所以我也是错误吐槽他老是让我扫码。我也是随意吐槽下，毕竟我还真没遇到过黄码这些特殊情况，哈哈。</p><h2 id="周六杭州按摩"><a href="#周六杭州按摩" class="headerlink" title="周六杭州按摩"></a>周六杭州按摩</h2><p>走了很远，然后往前走了段，来到杭州有名的”水晶湾”附近。白天看很正常，人也稀疏，我们是去附近的一个按摩店的，他跟我说，晚上结束下来看看，我说好啊，见识市面就是我此行目的。我以前真的很没见识的，简直就是乡巴佬。</p><p>【胤元道】按摩本不舍得花费那99块，但是想到试试吧，没按摩过，然后也能解决晚餐，进去后才知道销售老哥真能找，花得值。大厅进去后坐电梯上去，人不多，和泡汤一样先拖鞋，然后去分配的房间。这个房间有三个泡脚的座位，但是实际只有你一个人。进去我也不会整，大屏幕一直播放广告，妈的最后才知道可以切换，和TV电视一样。过好一会，来了按摩洗脚的云南小妹，叫花木兰？一听就知道是化名，那我就叫田小新吧。揉揉脚，泡泡脚，按摩脚，还有用像洗衣粉一样的磨脚；还有刮脚；然后用油磨脚、用火罐拔脚底。然后揉揉肩、按摩背、人在背上跪着按摩等等。啊，有钱真好，让我泛起了赚大钱的想法了。正经的是这样按摩，那不正经的，我就更喜欢了。按好75分钟一下就过去了。按好也就是晚上吃饭了，有好大一块牛肉、皮皮虾、鸡汤等等，自助。因为销售老哥的关系，看视频看到晚上10点多，没事干，就看荒野生存大奖，有意思。晚上回去又是骑自行车，出发前先去看下有名的”水晶湾”，门前全是经理、还有治安警察，小门边还有好多漂亮的小妹。啊，麻蛋，我这么努力就是为了这种生活的！！！我也要当老板，我也要有自己的生意自己赚钱。</p><p>没钱，10点多体验体验骑自行车回去吧，这按摩之后也没见得骑车更有劲了、更顺滑了，就是一次体验，白白让年轻的我火气更旺，可恶。</p><p>这种体验就是赚量、赚新客来临。一般来这消费的，也不会看中我们这些小虾小蟹。这和之前看的一个视频: 开网吧，网费不贵，充多少送多少，活动价送网费。但是真正赚钱的是提供的其他附属消费，比如卖饭、零食、面包、烟酒、饮料等等，这才是来财的。所以，学了好的东西，使用好的东西来制作一个平台，提供流量，然后去推介附属的商品。真正买平台的，是不赚钱的。</p><p>这周六过得很有意思，嘿嘿。周日窝在房间写写代码、打打LOL，周日也很快就过去了。</p><p>到了下一周也没什么可写的，进市局排查，还是物理上的问题，和我本服务没关系。然后有些小需求、小bug也是当场改掉，大一点的由于网络是真的卡，就没法搞，只能回公司整了。</p><h2 id="杭州找舍友"><a href="#杭州找舍友" class="headerlink" title="杭州找舍友"></a>杭州找舍友</h2><p>期间本来想说不去找大学同学，但是想想确实多年不见。不找的原因，是因为自己还没有混好，而且他们也有自己的生活、家人啥的，见面不得花时间啥的；但是想想机会来之不易，大学舍友，在杭州，都在市区，联系好当天就见见面。</p><p>流星雨，外号白面书生，喜爱去图书馆。这点很强，我没能跟上他的步伐，现在混的很不错。华中科大硕士毕业，一个念想和他差距甚大。不过在外摸爬滚打也是混足了社会的毒打。当天晚上蹭他饭吃，喝酒喝了好一些。他还是和大学一样不胖；我却被社会毒打得成了胖子。他在知名国企上班，福禄甚高；我在私企拼命，早出晚归，就为了五斗米折了腰；</p><p>差距甚大，研究生应该是学了很多底层的东西吧，而我也才在21年开始自学底层的知识，其他时间都是学了很多没用的使用工具的知识。</p><p>没有念想，随意聊着，说说近况，回忆回忆，一晚上很快就过去了。临走地铁分别，感觉还是不舍的，真是老同学了，以前还是比较聊得来。对他的回忆可有意思了: 他睡我对床，他同床啊林哥晚上总是打呼噜，夹角就是我俩，晚上睡不着我俩还聊聊天，然后为了改变状态，他就摇摇床，然后啊林哥就会消停会；还有个他的超级好运，双十一第一期的时候，他摇到了双十一3888的大红包。我们几个都觉得这个肯定不会中奖，都没玩，他在床上搞搞，然后中奖了，他激动的从床上来下让我们来看。我过去看的时候确实中奖了，不过也不知道能不能兑换、需要什么其他附属条件。过了几天他买了个相机，使用了那个优惠券。给力给力，原来还真有中奖这种事，我以前以为都是骗人的。</p><p>以上是找舍友的经历，多年未见，不知道各位同学怎么样，我应该是混的最差的。我这组织委员当的够差的，全靠苟住，不然真的上海也待不住的。也正因此一直以来都没有在班级露面。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>以上是杭州的经历，最后就是回来也没什么好写的。杭州我用自行车走了好几次，发展上不及上海的10分之一，个人觉得。但是消费确实真贵，上海路边街边很多小吃，都不会贵到离谱或者路上找不到来吃。我自行车从西湖南边一路骑到东站，路上稀稀落落没找到几家可口的店家。房价看了下也好贵，如果真的再搞一套，我想上海搞完再去苏州搞一套。杭州也没有太多玩的，因为自己不熟悉。多说一句，杭州的链家比合肥那的数量多了好多好多倍，感觉合肥那的属于还没开发一般。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20221025recent</title>
      <link href="/2022/10/25/20221025recent/"/>
      <url>/2022/10/25/20221025recent/</url>
      
        <content type="html"><![CDATA[<h1 id="闲谈"><a href="#闲谈" class="headerlink" title="闲谈"></a>闲谈</h1><p>很久没有没有写博客，我把博客当做日记，之前时间是: 写了[buildyourownsqlite]、[jslispy]等的教学记录；紧接着是工作-忙累；学习OpenGL；带娃；考完摩托车驾照。</p><h2 id="完成两本书的编写"><a href="#完成两本书的编写" class="headerlink" title="完成两本书的编写"></a>完成两本书的编写</h2><p>首先是完成两本书的编写，真是耗费我许多精力，因为我需要先尝试、确定的我自己完完全全掌握，尽可能吃透这两门技术然后才能写。不仅如此，jslispy原本融入了编译前端和编译后端两部分，这两块知识现如今很好的融合，写一门语言，完全由一个1000行不到的代码即可实现。</p><p>我花了很多精力，我得到的更多。jslispy脱胎于之前所学clispy，而且不依靠第三方，让我感受到莫大鼓舞。</p><p>实现sqlite又让我更精进，目前打算再再次的重写一遍，甚至用js实现一遍，暂未确切规划。未来有时间一定会完成。</p><h2 id="处理公司工作"><a href="#处理公司工作" class="headerlink" title="处理公司工作"></a>处理公司工作</h2><p>之前出差解决的问题，目前还是能遇到。我做了很多优化的情况下还有问题，看来还是代码有问题呀。并且这个问题由CEO在一个群里提出，之前一直拖的问题(因为项目大，只有我一个人，无法找到根源问题)目前要彻底根治。那好，又不是解决不掉，帮我把其他事务去掉，我安全全力做必然能解决掉这历史问题。</p><p>去掉了很多对外对接，虽然团队新人又是重新换一波，项目也紧急上线，但是不用对接其他项目，取综不用超级多的对接的情况下，我觉得对付还是游刃有余。</p><p>当时周五找到问题代码，还是来源于代码不可读、代码不可断点调试的iced。我简直去他喵的iced。我用不好他，我就要骂他。</p><p>反正吧，冷静下来，就觉得是<code>无能狂怒</code>可以解释最近的被吐槽的状态: 东西写好，还没发去用。我在已有的测试用例情况下，全部是采集、入库、上报、统计非常快且正常。</p><p>冷静冷静。。。</p><h2 id="学习OpenGL"><a href="#学习OpenGL" class="headerlink" title="学习OpenGL"></a>学习OpenGL</h2><p>为什么学习OpenGL？我缺钱。你不是想更强大，要学习编译原理、linux系统吗？这个耗时耗力情况下，一年半学习时间投入才能初入linux系统的学习(我不聪明嘛)，学完刚开始还是只能当学徒做好工作，拿工资。</p><p>我最近钱实在是穷过头，我需要快速有机会拿到钱。拿到钱，来养我的爱好完全合理。我学习OpenGL做游戏，我要赚钱，我必须要赚钱。窝囊着天天可怜巴巴的等着发工资，30多岁的人了，是挺傻逼的。</p><p>我需要钱。。。</p><h2 id="带娃"><a href="#带娃" class="headerlink" title="带娃"></a>带娃</h2><p>带娃是项技术活，这调皮娃有时可皮了，不过其实很懂事，跟他说他也很听话。让他学习，然后去玩，他就会去完成，虽然中间会咪咪摸摸慢吞吞，不过这只会打扰他更慢下去玩。</p><p>不能想着只打，不能只玩，嘎嘎，，在边缘互相来回试探，引导。</p><h2 id="考摩托驾照"><a href="#考摩托驾照" class="headerlink" title="考摩托驾照"></a>考摩托驾照</h2><p>今年年初的时候和华容一起报的考摩托车，因为疫情所以一直耽搁，后来华容都考完了，我还在摸鱼。想想不能拖那么久，不如一次性给他整掉，所以不长的时间里一次性整掉了。</p><p>学摩托车是因为机动车没有里程焦虑，再贵也比四个轮便宜。车入门1w，而且质量都很不错那种；保险一两百；油费超便宜。他唯一的不好就是肉包铁了，但是想着自己跑慢点，稳点，而且现在是学，别想那么多。家里摩托车回家也可以开，不会总是走路。买四轮车了，回家不就行了？1100多里程咧，我估计不会开回去。</p><h3 id="体检"><a href="#体检" class="headerlink" title="体检"></a>体检</h3><p>之前有记录，现在体检要面签，总之就是要排队拍照和简单体检120RMB，然后上交材料，接着收到快递的面签单。收到单子的时候，和联系人说可以了。</p><h3 id="考试"><a href="#考试" class="headerlink" title="考试"></a>考试</h3><p>考试这个也拖了很久，没时间学习呀。总之在一个周五晚上刷了一晚，接着周六刷了很久之后，第二天周日上午早早去考试。考摩托车是科一科四一起的，有个老大爷也去考试，我两门都考完了，他还在原地，看来老了的话，确实记忆力会下降。科一科四其实也是难的，容易不小心点错，麻烦。不过有个好处是，这个考试离家里不远，实在是再好不过。</p><h3 id="预约学车"><a href="#预约学车" class="headerlink" title="预约学车"></a>预约学车</h3><p>跟联系人说安排教练，先是开车好远到闵行，诶，有免费停车，可以可以。然后先熟悉熟悉，毕竟我是真没开过车，就老爸给我讲启动，然后偷偷跑到县里办事，就都没开过。上手豪爵摩托，先转几圈，然后试着练过桩。刚开始练好难，压离合、手刹，教练来说1挡怠速过就好，嗯，可以可以，，还行，就是车子很重，而且车窜动的厉害，大概熟悉一下午。第二天周日教练把我喊到金山卫那边熟悉考场。我大概上午过去，练到中午，没多少次练习，不过觉得大概OK了。跟一堆的人一起练车，车子是没多少时间可以摸到了，嘎嘎。</p><p>然后决定下周就考试，周四来模拟300RMB，周五考试.</p><p>周四周五请假一天半来解决，这里就可以好好说说，有意思的。</p><p>周四早早就过来，开车走另一条路，也是不那么熟悉，但最终还是顺利到达。上车前必须上厕所，然后到了后都还是很急小便。来了后就先熟悉熟悉，和一个小姐姐聊得来，一起练车。早上是另一波人练车，他们就几人，然后可以使用真实车辆、广播来走好几圈。上午我们十几人用练习用的车，也是很抢手，没什么机会上车。倒是有辆车规格不同考试车，很少人用，我就尽量上手去跑，去熟悉，毕竟我真没摸过摩托车。</p><p>中午十一点半和那个小姐姐在小吃店整了1个泡面+2香肠+1面包，终于吃饱。她说他家里弟弟摩托车想给她骑，她又不想要那种，就是有个小摩托，有机会可以带她儿子附近转转之类的。我外乡人，没有车牌啊，嘎嘎。</p><p>下午的时候大家一起上熟悉真实考试车辆，毕竟300RMB了。前两个都通过了，我上车后觉得喇叭声音也太大了，而且这个豪爵确实好开，很顺。半坡起步的时候熄火了，然后我没有退档，1挡启动，然后算我挂掉。模拟嘛，继续科三，科三是顺利的，简单的。</p><p>十几人轮第二次的时候，头几个跑还有声音，突然就没声音了。估计包场时间过了，得只练了一回有声音的。接下来在没有声音的基础上，我们继续熟悉这辆车，到后面更少人练了就加油多练几次，争取更熟悉考试车。花钱了嘛。</p><p>大概下午5点多，人也都要走了，我就回车里了。</p><p>今天我是带了毛毯、羽绒服过来，准备睡车上。时间还早，去附近看下有没有宾馆，长什么样。觉得不远的我，一路走过去3、4公里，走了好远终于才到了，路上经过农村居民楼群、经过一个大桥(有个外卖员因为没有换电站导致电瓶车没电，走上去和他聊了会，他说换电的锂电能跑100多功能，这么实惠还没什么大车哦)、经过钢铁直销点(有停车，发现本田雅阁车，哇，好喜欢)、经过五菱宝骏店(这些车那么破还卖5w、6w，好赚钱)、然后就来到小市集了。这是个小市集，松隐路附近。</p><p>我从头走到尾，又折返熟悉路况。宾馆也不看了，感觉还是试试睡在我车里吧。吃了个水饺，充了很多电，感觉够用了，就回去了。买了些水、食物、花露水(晚上果然很多蚊子)等，出发。回去前做个核酸，认不得路，看到一位阿姨，问路告知我在前方，她骑自行车走了，我估计是找不得做核酸的路，没想到那个阿姨骑得慢等我，告知我那个不容易的地方，不然我估计做不上核酸还白走好远了。这也是郊区，才更能遇到好心的，相对的，自我觉得的。</p><p>走回去好黑，走了好久，害怕路上遇到野狗，拿了根朽烂的短木棍，一点用都没有，但总比啥都没有好吧！前面走了那么远超级累了，到了最后一个直道，诶嘿，有灯，心里踏实多了。然后拐弯进去驾校那段路，那是真的黑漆漆的。我开着手机灯，还担心只有这里有光，这不更是总目葵葵嘛，生怕找不到攻击目标，紧张紧张。</p><p>最后一段100多米路走完到车上，上了车，终于感觉到了安全感。野外，只有充满油的机械车能给我安全感。回来时，肚子不是很舒服，型号附近就有厕所，还有水源，方便； 回到车上坐副驾，这个座椅不能放平，腰不舒服，靠一会可以，睡觉那真是不行了；车窗不能全关，开一点点，但是老车不知道为什么会有刺鼻的气味，门一开就没了，关上一会就又有。没办法，四个门的窗户都开缝，然后右边门都不关，留缝隙，这样气味终于是没了；紧接着蚊子又有，花露水管上；对面路灯超级刺眼，能怎么办，羽绒服的帽子盖头上挡着。我以为路灯11点就关了，没想到居然亮到了白天，我去；副驾放倒最低，脚搁着不舒服，不仅悬空，而且空间不够有点蜷缩；翻身不方便，头枕睡觉头会麻。</p><p>问题还挺多的，味道解决、后排全平、这样才算是能在车上睡。</p><p>晚上9点多的时候，对面是个健身、座椅地，黑乎乎的看不清。我看见一男一女小年轻进去好久好久，不可能过来聊天的吧！黑漆漆，蚊子多，除了那种事，谁会在那呆很久很久哦。过了很久很久，1小时多吧，他们才慢吞吞的，出发。可恶，那里太黑了，不然我就能看到现场的盘缠大战。免费的，超级好的。</p><p>这个大戏过去，我也去睡了，半夜肚子痛，幸好厕所很近，半夜起身真是超级冷。</p><p>早上6点多就有人来了，刚好昨天小姐姐停车在我旁边，我就直接和她进去报名了。</p><h3 id="考试-1"><a href="#考试-1" class="headerlink" title="考试"></a>考试</h3><p>报名的时候，要防护衣服，手套 = 12RMB，买了吧。然后发现他们要照片，我去，那个也要吗？我看了教练给我发的，确实才发现那个不起眼的字样，没办法了，省钱住车上，最后让同城直送花了140RMB，我去。算了算了，考完，这事过了就过了，花点小钱了。</p><p>递交身份证、花费报名考试费10RMB左右，然后等待。叫号的时候我是第二个递交身份证的，居然是第一个上，小姐姐第一个递交的是我后一个。</p><p>我上的时候刚好就是昨天练习的车子3号。先起步的4号车科二两次都挂了，我开始出发。</p><p>启动的时候要空挡启动，差点顺序错成先挂挡再起步，就完蛋了。</p><p>顺利过单边桥。绕桩时心里鼓励自己稳住，不能失败，然后绕桩也是顺利，接着到半坡起步。进入半坡时，三轮也到那里，然后呼叫台让三轮让我先考，因为我不知道我脚能不能离开地面，幸好先让我，感谢感谢。我把车停到半坡时，不小心挂到二挡，赶紧降档不然没力气上不去。然后油门加上去后发现力气不足，感觉想窜动，赶紧再加一点油门。然后前轮有点飞起来，不过下了坡后报科二过了，然后进入科三的开头就挂了。那我就把车开回去，考科三就好了。</p><p>轮到我时，还是一样的流程:按喇叭，绕一圈，启动、挂挡。启动后，换二挡直接通过半坡。要到半坡需要经过科三考试路径，我看到他们在考试，但是不管了，直接过去(考试通过时，在场的执勤小哥说他们在考试，我怎么可以从那边经过！我说我不知道，我考试时紧张迷糊。反正我过了，我才不管类，某些事是考场的安排了，我负责自己考试加油，没办法了)。科三全部走完，科三是超级简单的，停下后，关掉钥匙，放下脚撑，<code>科三通过</code>.</p><p>考试就这样结束了，终于完成。10点左右照片也带来了，资料也给了，就回去公司工作去了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 闲谈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220827recent</title>
      <link href="/2022/08/28/20220827recent/"/>
      <url>/2022/08/28/20220827recent/</url>
      
        <content type="html"><![CDATA[<h1 id="20220827Recent"><a href="#20220827Recent" class="headerlink" title="20220827Recent"></a>20220827Recent</h1><h2 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h2><p>最近孩子来了，学习尽头没那么足了。以前可以加班熬夜，现在只想着赶紧回去陪孩子，但是回去后，孩子都是睡着了。在公司吃饭能按时吃，搞点东西回家，路上还不堵车，还是离公司远了些。</p><p>小学开学临近，想着给阿黄在闲鱼搞点学习用品，实惠又好用，还能和孩子一起去拿。还没去拿呢，就被安排去合肥搞东东。</p><h2 id="外派"><a href="#外派" class="headerlink" title="外派"></a>外派</h2><p>上上周日到的，整两周工作日，顺便记录下。</p><p>刚来的时候觉得，应该就是备份、把复杂的分析版替换为及其简单的采集板就好了。这不在公司都搞好了的嘛。大约三天就好了吧，想天真了。</p><p>刚来先备份，搞了个2T硬盘把以前的所有数据进行备份。备份了整整三天啊，这个要是在我来之前搞好的话，能省很多时间。这几天过来顺便把机器部署了解好：三台64G+4T/4T/4T机器、64G+32T机器、64G+235G的ssd硬盘+Raid5的4T/4T/4T硬盘。硬盘都是sas盘。等待备份完毕，给ssd服务器主硬盘做好Raid1，然后内存加满，硬盘Raid5塞满6个4T盘。3台64G那个机器冗余两个，搬到1个上去。大容量盘不动，就当作备份服务器。</p><p>等到备份好、装好服务，这周基本快结束。上架试下，没想到代码跑不起来: 这里的包都是别的公司的，服务一直吃公司的细粮，来这里吃别的公司的粗粮终于吃出毛病了。入2144个包，100个就卡住了。分公司学长坐不住了。淡定，改下不就好了 - [下载、上报、入库、再次尝试上报]这些都在一个进程，需要把[下载、上报]单独挪到一个进程不就不会出现啦。等到改好再去整下，这时候他们一直说要做到的 - 不管你能不能入库，在这之前你必须先上报，必须上报，无条件。</p><p>代码中更改这流程还挺麻烦的，不管了，想想也是合理。动手改完后，觉得不错不错，这样别的地市也都能满足这类采集的需求，至少要满足到能达到最终目标 - 入不了库，给包挪个位置保存好，记录好即可。</p><p>接下来实测，发现一个进程入包，及其之慢。我觉得这个不动他会好点，至少也是能上的。分公司学长也一起去尝试，客户那，看着上传速度 - 245kb/s。客户说没有限速，这不可能，怎们的也是2M2M上的才是怎么会这么慢。晚上打来电话说，最近安全排查，确实控制了上传速度。本来就想好了搞起来多线程，继续开搞吧。</p><p>那天晚上远程公司电脑，字小的，屏幕小的，唉。然后多进程只是会限制流程代码，不会触碰到逻辑代码。这是又高效、又简单、又安全。晚上和伟哥基础这个理论实现了最少配置方案，只需要一个配置即可自动伸缩扩容，岂不美哉。根据这个，我们也是做好了备案，来不及可以上备案。当晚搞到很晚终于落实下去，自测OK。啊，好久没那么累了，离得远确实麻烦。真的简单实现的话，只需要配置下，几秒就能初步实现，回去公司再完善，不过本着开发人员的折腾性质还是盯着压力和伟哥搞完这套。</p><p>至少这套方案是挺完善的。完成后，伟哥也是蛮高兴这种理论。</p><p>这个理论回想起来正如以前上上上家公司思考的方案，支持多进程，完成各自事务。感觉不错。</p><p>你说，这么做应该好很多很多了吧。没，打电话让地市开始上传 - 地市为了快，把整个文件夹拉进ftp，而且包特别大。这，这，这，，，</p><p>好，复用我的去除资源快速上传方案，解决包大的问题；目录，行，recursive遍历，文件夹空了就删了文件夹；</p><p>又发现ftp链接慢，又解决链接慢问题；本身多进程吃了很多ftp链接，免不了，那就加大<code>max_clients</code>的大小；然后又发现链接多了会报错，说找不到更多端口，那就修改链接端口数。</p><p>啊，看来对于这套流程还不那么的熟悉。备份还没加呢，为了不动到最近月底的紧急事项都不只能延后处置。</p><h2 id="合肥体会"><a href="#合肥体会" class="headerlink" title="合肥体会"></a>合肥体会</h2><p>说说最近到合肥的感触。</p><p>合肥美女真多，我喜欢这类熊丰腰细的，脸还红扑扑、Q弹弹的。看的我真是着迷这个城市，打算有机会定居。不过可能最近城市在建，到处都是不方便，而且人文素质确实低很多。网上有称合肥为”霸都”，我觉得更像乱都。车子胡乱穿梭、人也胡乱穿梭；城市楼破败在建；黑灰黄产业屡禁不绝。</p><p>乱在其中，肯定会有利。学校在市中心不远，以后有钱，我就天天在学校周边逛游，我非得找好多个漂亮妹子不可！让可爱妹子给别人照顾，我可不放心！</p><p>这里的房价感觉就是中心高了些，中介是真的少，会谈的话，价格肯定是有机会谈的。除了吃住外，其他真的是挺实惠。打车实惠；ktv实惠；房子也没那么贵；找妹子肯定妥妥的能找到超级漂亮的。</p><p>和学长聊天，他说他在上海呆着挺累，也就回安徽了，合肥整两套房，舒舒服服。搞什么别的东西，还能找到关系啥的。其实是挺羡慕的。不是谁都能回到小城市能搞个副总当当的，还能机关单位套近乎。上海确实累，累的弯下了腰，不过却是更加有机会些。我个靠自己的能有现在也确实是运气好，没有找公司的认知，也能碰到不错的公司，和超级好的上司。这在其他城市是不可能的，说不定早就一个萝卜一个坑占满了位置，没得位置蹲了。</p><p>所以羡慕归羡慕，学长劳苦过来我没看见，不过肯定是艰苦过的。</p><p>我现在算是享受着他们努力后的红利，他们也是享受自己那份成绩带来的红利。</p><p>躺平，我这年龄还没到，要更加努力才是。</p><p>许久未找到年轻的感觉了，不能怪我光逮着一个人耗，这不其他人都不愿意外出，一起转悠转悠超开心的。</p><h2 id="期间看电视体会"><a href="#期间看电视体会" class="headerlink" title="期间看电视体会"></a>期间看电视体会</h2><p>没看电视剧很久了，这回看到电视剧解说《大染坊》。感受颇深！能学的很多，比如刚开局一定要活下去，一生跪三人，三人都是他的命运转折点。善意能折射到生活，福报迟早会到。学习的年纪一定要学到超级好(这点电视剧开挂了哈，小乡镇偷学到的，大城市他人能学的都比不了，开挂开挂)；遇到好的伙伴和导师，在创业初期就是要拼搏，市场基本是零和游戏，可以为了生存杀掉他人份额，但是不能赶尽杀绝；团结团队，让同事、属下当家人，一起奋斗而不是被动养家糊口；有好处要记着付出之人，让他人能感受到组织的，不会抛弃这份事业；有大事要下属配合，要先给甜头，然后安排事(电视剧安排的这事要依形式而定)，让他人觉得义不容辞；合理的安排人，让人在其”位”；要能得到第一桶金，这桶金能让人神无旁骛的专攻一件事(这个很重要)；到了管理层，就要考虑管理层的事务，这是后话；</p><p>还有很多可学，但是我得归纳也是只言片语，我没有更多时间去回顾，当我走到自己去创业的时候，我会回头再看看这类的解说，好好体会下。哪天我也是管理层了，不是运用”蛮力”的时候，再去学学真正的管理层的事务把。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>很久没有写博客，着实是公司要做的事多，自己的生活事也多，细碎，零碎。最近背感觉会酸软，再加把油搞完数据库，，算了，搞完数据库，我还想折腾下硬件。我想做个安卓系统，初级的那种也行。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20220801最近生活</title>
      <link href="/2022/08/01/20220801%E6%9C%80%E8%BF%91%E7%94%9F%E6%B4%BB/"/>
      <url>/2022/08/01/20220801%E6%9C%80%E8%BF%91%E7%94%9F%E6%B4%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="最近生活"><a href="#最近生活" class="headerlink" title="最近生活"></a>最近生活</h1><p>最近生活的由很多细碎组成:</p><ul><li>不断线上上课、考试, 为了拿中级职称，最终目的还是落户</li></ul><p>这个花费巨大，不断不断地支出，饭都没得吃也得交这个钱。每次上课都是乱糟糟的签到，刷课倒还好，考试也有得”复习”，但是《继续学习》sacee网站就很麻烦，必须签到完、看完视频、及时考试。之前考试是下午，这个的考试居然不一样，搞得我好几场考试都错过，现在还在眼巴巴等着补考。</p><ul><li>新买了辆车，熟悉手动挡</li></ul><p>他们说手动挡有乐趣，我说我没钱所以买了手动挡。不要说什么手动挡比自动挡更不容易坏，不是，因为手动挡车贩子不收，我在闲鱼就成功淘到了一个。也不知道耐不耐用，买来就用，怕车把我扔路上，就换了对轮胎。</p><ul><li><p>叫儿子学习</p></li><li><p>也因此学习编译原理、数据库落下一些，他的学习总是静不下来，和我以前多动症差不多，不过可以归纳为不知道学习的重要性和没人带领入门。短时间只能揠苗助长，瞬间长大了却会有后患。没办法，之前没能一直待在身边，现在只能按部就班多交流才能获得亲切感，才能水到渠成的灌输知识。</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 闲聊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220710buycar</title>
      <link href="/2022/07/13/20220710buycar/"/>
      <url>/2022/07/13/20220710buycar/</url>
      
        <content type="html"><![CDATA[<h1 id="买车"><a href="#买车" class="headerlink" title="买车"></a>买车</h1><h2 id="查资料"><a href="#查资料" class="headerlink" title="查资料"></a>查资料</h2><p>上海封城4.1~6.1，期间还在还2201的车牌贷；借钱家人应急；所以钱一直没有筹够，却心心念念有个车车心里该多开心。这段时间把很多汽车知识给理解了下，闲鱼2000~15w都看了遍，也不断翻阅着”懂车帝”里面的视频。看着一个个车评的讲解、呐喊，真是心痒难耐啊。</p><p>先看的丰田锐志，看了很老的版本和2013版本。一开始看觉得好强，比现在大家评论慢吞吞的卡罗拉好很多。但是看到后面，价格似乎还行，但是注意到了一点: 油耗巨高。开车那么高的油耗，出门都不舍得启动哦。而且基于其实际价格太饱满，所以后面就放弃了这款。(如果油耗不高的话，那真的心喜)</p><p>接着看了丰田的雅力士，当然雅力士超级超级保值，所以看了很多致炫的内容。内饰啥的无所谓，但是作为备选吧，他中庸的个性感觉就是用来备选用的，先考虑其他的，都不考虑，而且必买，那才会轮到这货。这个也不适合看二手车，和新车价格所差无几，用了一年才差5000块？那我不如咬咬牙上全新的，是吧。</p><p>看了雅力士，加点钱就可以上卡罗拉，雅力士10年还要3w、4w，而且质量还参差不齐。</p><p>卡罗拉入门款就好了，不要想着混动，那有啥用。卡罗拉大家都称之为马路三大妈，如果到了这个价位，那也可以作为备选吧。备选吧。</p><p>还有个同等对比的-飞度，说实在，一开始我一直觉得这货有什么好看的。致炫中庸不就好了？听说飞度安全性不够好、简配、价格还巨高。但是自从看了它的人性化的设计，有用的配置，巨耐用的发动机，久经耐用的离合器等等，每个都值得推敲。我看了相关大部分的视频，真是着魔啊。最早一批的飞度当时想着可能都要报废了，闲鱼当时聊着看到一个1w的最早版本的飞度，跟他说疫情后第一时间过去看。疫情之后考虑到车龄非常老，而且价格还在1w，所以一直没有联系。</p><p>上面看下来，本田、丰田的二手都很不满意。其在新车面前没有丝毫的优势，拿出来这么多钱了，已经不差这点钱了，不如直接上全新。但是上全新，新手磕碰定然难免，包括其他品牌。所以又继续看了标志206/307两厢、现代、比亚迪f0等等便宜的车子。</p><p>疫情之后天开始巨热了。出门手都晒红了，后面穿衣服时却又超级热。车牌贷最后两个月，咬咬牙给他过过去再买，忍住。</p><p>7月初，无事看到东本思域这款车。他的车优惠小，而且是东本(网上说广本品控更好嘛，小小信一下)，然后看到之前一直有说的广本的车型: 型格。我说这名字取的我都不想买，以为啥玩意。但是看到他对标思域，信手看下吧。看了之后立马入坑，Integra硬地瓜，而且看了《极速拍档》的描述: 买菜运动王。这称号很接地气，手痒难耐，恨不得入手一台快乐的大玩具。真的，我和朋友聊天就和他们聊这款车，让他们也感受这款硬地瓜，好像我即将也能拥有一样。</p><p>思域落地最丐的是14w，型格最丐居然有个手动挡，12.99，优惠8000，购置税减半，再讲讲价12应该能落地。啊，如果是首付，拿出3w左右，每个月大致3k左右。</p><p>为了心动的车车，可以的。过几天说不定可以去店里试驾，问问看。手动挡听说还要等半年呢，半年后，手上也能有更多积蓄。</p><hr><p>所以手上多一些积蓄，房子不要留着做缓冲？没有个3w开车能放心？睡得着觉？阿黄和爸爸这几天刚好过来，要上小学，支出更大些了，不要留一些？最近考职称至少用到7k，不要留出来？考职称用来落户的！公司说给一定股份购买，买什么股票！买公司股份不香？不要留出钱来买？</p><p>啊，车子不重要，练手w把块就好了不是吗？过度！过度！过度！</p><h2 id="前往看车"><a href="#前往看车" class="headerlink" title="前往看车"></a>前往看车</h2><p>为了家人、为了更重要的房子和落户，牌子有个车子挂着就好了。当时已是7月5/6号，一直看车子花费时间较多，不如索性就上车吧，行动起来了。</p><p>继续闲鱼看，看到一辆08年飞度，很远啊在浦东迪士尼附近。蓝色飞度，前档换掉、车漆全部有过修补。闲鱼上聊得卖家似乎是个女的，然后说忙让我和他老公进行看车。于是后边都是联系他老公的了。</p><p>问能否前往指定验车地点(v268验车，能上架检查)，我报销100来回邮费，说太远不去。让我过去看车，感受下底盘。那行吧，别是自用好车，错过了，在淘宝购买检车服务(价格388，由于外环外外外，加了100邮费，超级大热天，确实补一下吧，第一次花钱买教训)。7月6号下午请假过去看车。中午吃完饭就开电驴到龙华，那天气热的呀。龙华11号线到浦东康新公路地铁站。下车后好热好热，一路联系检车师傅和卖家。不舍得花打车钱，骑了个共享单车过去(回来是卖家载我回来，我说不用不用，我自己骑回去，眼睛勾勾看着我骑过来的车子。最终车子没骑回来，导致出了10块挪车费，感觉真亏。)，大热天啊，死命的踩，酸死了，手晒死了。到了之后汗一直流，给师傅和卖家买了水。然后就在一个公园看车。检车师傅从头看到尾，路试了下。卖家递烟几次，师傅都随意回着，问些话师傅也不回，因为我在。最终给我答案是前右装过，动到水箱；底盘压缩机处磕过，都裂了，并且焊接也是很简单的处理了下。底盘比较散，估计有很多橡胶件、球头等都需要更换。刮擦比较多。</p><p>我是一点都不懂，也没摸车，因为我不会开呀。师傅给的这些回答我也着实不太懂，太专业。我偷偷问了下师傅，师傅只能说，也可以买，但是没有升起来无法看底盘。我觉得前面撞车难免，刮擦也无所谓，我对外观不看重，压缩机撞到，和发动机、变速箱等不相关应该还好。师傅简单发我微信文字，反正我看着还是迷迷糊糊。我和卖家也说了，卖家也在那解释。回去时和卖家说，既然是夫妻过户，能提供下结婚证么，虽然有点涉及隐私，不过由于之前种种都不透明，所以希望卖家帮助下提供下。卖家说多年了，结婚证自己找不到。</p><p>路上和老婆说了很久，觉得说不定可以买。老婆不断给我发: 感觉不太好，再找找看。这是重点，要画起来。</p><p>下地铁的时候，又被地铁乘务人员关心: 我头晕的不行，1.8米的大个子想个泥巴一样。在自己车子上怕了好久好久才好一点点。电驴吹了下风感觉好多了。</p><p>到家的时候，检测师傅和我说，这车还是很多问题，能砍价。师傅说的砍我现在回想，应该是拿关公大刀来砍，我当时拿着铅笔转刀和卖家说到了15600.当时感觉居然砍下来1000，实在是太好了，我就要有车车了，和卖家约定第二天过户，我的假都请好了，然后我说要闲鱼拍下付款第二天过户完就收货么(看出我有多真s诚b么)，卖家说明天过完户再给吧(这个救我大把时间，否则还得扯皮)。下午老婆回来了，她买了自己的吃的，那我只能下楼去吃了。我跑去内环饺子店，卧槽，感觉想吃的一款面点了之后看了眼后面的价格: 58。立马退出店里，巨他妈贵，有钱佬采取点。去了排挡吃了个黄山菜饭。口干舌燥的，总觉得哪里不对。因为卖家种种不透明，后面也说什么隐私不好公开结婚证，反正闲鱼聊天时，就说来试车。人过来试车了，反正我也不懂车，1w多小贵也不是不能用说不定就买了。吃饭时也看着检测师傅发来的pdf报告，详尽多了。看不懂文字，还看不懂图文？定义中强调是事故车。之前看文章说事故车也不是不能买，前提是懂车人能决定。我不懂车，我身边谁懂？哦，满舅。喂，满舅。</p><p>满舅说，1w多的小车又这么老？飞度？老飞度也老。要买二手车，最好就掏3、4w近年限的车，到时不开了也好转手。那个太老了，又说到有事故，小事故？小事故不是事故哦。这么说也有道理，我不断地翻着检测师傅发来的报告: 事故车。反正卖家着实不诚实，闲鱼中不诚实卖家我遇到两个: 这个卖车的和那个卖键盘的。我假设我现在用了一段时间了，我想把他卖了，他值多少钱？事故车，不好意思6k。嗯，我必定亏1w。同意满舅的话后，立马和卖家联系: 不好意思，你也知道我还车牌贷，买车的钱是我妈的，我妈听说是事故车说这钱不给，要给自己出。卖家说这个不是事故，是小事故，没事没事，不买就不买吧。</p><p>为了知道小事故还想买，事后觉得是花了检测费500，好多啊。检测师傅说也能开，不过要大大的砍价，那就是砍价砍得不行的问题。满舅也说，500块，就当教训费，破小财消灾。事后也和检测师傅问了，他说确实没必要，没砍下来多少，着实不值。不过检测师傅这些都不会再我最终做决定之前和你说，确实，他就是个检测师傅，我得懂车，买个15/20/30w的二手车，找检测师傅才有用滴。</p><p>回到家和老婆、老爸、老妈都说了，也说了原委。老婆下午回来的时候听我说要买，也在劝我<code>再找找看?</code>。听我最终决定，终于唏嘘一口气: 当时的我就像蛮牛，根本听不进去。嘿嘿。</p><p>晚上的时候回想满舅说的，买3/4w车车，那就是怕被骗，如果是5k块车呢(国三标志307三厢自动挡)？还送2k保险？于是我又约定周六早上早早去浦东看车。公司的时候说出来大家笑了笑，我也觉得很搞笑，然后住川沙同事说周六和我一起去看车，而且看的出来他周末很闲，没事干，而且很热情。早早约定周六前往。</p><p>周五晚上老爸来了，把一老一小带回家，稍微整了整早早睡下。</p><p>周六早上以为有做核酸，8点多才出发。10点到川沙上了公司老铁的豪车。他的车车是领克05.我知道领克是国内的车，看起来估计是15w左右的吧，没想到落地都要20w了。一路过去也是老远了，他性格比较腼腆，而且他刚来公司不太久，认识朋友少点，多亲近下挺好。一路上，他对自己车的看法是自己喜欢低调些，买的时候就按自己喜欢的来了。他对自己性能车的相当信任，发动机吉利肯定拿的volvo的，安全性也好，跑的性能强、稳、省油时同样出色。不错不错。不过由于我是买老车，所以老车里，外资的还是可靠些的。也交流了下看法，买房重要些，毕竟我家穷的多，父母也没有固定收入，老车正常开，与我比较好的。</p><p>跑到卖家老哥(下称雨哥)小区到了后，让雨哥上车，去一个小道拿车。方法是老车出来，同事领克05进去。我这才知道，这个停车位不用花钱，但是需要占着，期间我们在换的时候还有人伸头来看是否能停进去。把车放旁边看了下，先看了发送机舱，整体都干爽，前头肯定是没有撞过的: 5000块老车撞过要我我也懒得修。内饰，伊拉克，味道也是比较重，雨哥偶尔抽烟看来；内饰老，都没关系。后保险杠说撞过，塑料件无所谓，后备箱全尺寸轮胎，还有各种工具。他顺手教我轮胎测胎压、打气，部分维修保养之类的，能教的都教了(包括后面过完户又教了一遍)。静态我觉得能接受，说实在，去掉保险就是按3000的车子来算的。3000你要啥自行车。</p><p>接着我们开出去找个小道试试车，我先上来试下。手动挡嘛感觉安全点，我这么多年也没忘光，能开一段，不过感觉没那么顺，然后让同事老铁试试。那天很热的哈，几个人都超级热的，空调一开始没凉快，后来跑着跑着又很凉快(后来雨哥跑去买雪种，自己换，让我也懂自己换雪种，嘿嘿，老车能学会东西)。同事老铁想着尽可能帮我试，看看顺不顺畅。不过雨哥说我开起来比较谨慎，同事老铁试车比较猛，哈哈。稍稍试下就好了，然后我开回去，当然倒车还是让雨哥来。雨哥也说后面有些别的人说保险过户，车算4000，相当于在当前基础还砍。我觉得砍得这么狠真没必要。交易是相互的，双方满意才行，地板价了还砍真说不过去。5000块是雨哥定的价，比市场底还低了，我不能要价。要我定价格我卖，及时一年两检，我还是会定8000，最多给你砍下去。当时后门有时拉不开，雨哥直接开去修理店，不过当时又可以。就冲这个，尽可能在5000块基础还解决使用问题，我赶紧给我老婆打电话要钱。直接拍下付款。真没话说，你可以感觉出来的，雨哥不是想卖车，他只是个多了辆车车的雨哥呀。谁要伤害他我立马闲鱼买你东西砍你一刀，嘿嘿。</p><p>这天就这么定了。接下来是等过户。晚上回去，我就说OK，完全信任，家人不用担心，我不会买错，绝对。</p><h2 id="买车过户"><a href="#买车过户" class="headerlink" title="买车过户"></a>买车过户</h2><p>周一有工作忙下，定的周二过户。这也是一番故事，容我娓娓道来。</p><p>早上我今早起，要去浦东，地铁需要换站，我就把电驴开到交通大学站(少换一个站点)。别说，感觉起来女孩子活泼很多，我想多找一个这里的妹子，真，啧。咔，这一段过，下一段。</p><p>一路到沪南公路2638号车管所，说阳性封了。我和雨哥人生地不熟，一脸懵无奈跑到浦西的二分所。少了个车管所，全部车都跑来，排了三个街道。我提前先下车人先去大门问下。看到说要预约，我们啥都不懂，预约啥哦。很无奈，但是看到旁边站着一个姐姐，她好像是等谁，不过她懂办车流程。有个大哥问过她，她随意答着，我知道她不是车贩啥的，所以我也诚恳的询问我的业务: 我买二手车沪牌过户，都是大牌。她简单的回答，去二手车交易所。哦，这不就是我给雨哥说应该去的，然后雨哥也不懂，我们才跑来车管所的嘛。然后我赶紧和雨哥说了，然后去的顾戴路3318号(去前先打电话问了不用预约，直接来)。诶，这里离我公司500米远，好近啊。</p><p>到大门的时候看门大爷说找黄牛了么(这种确实需要黄牛，中间有些步骤麻烦，经理公司全权帮助搞定，办事人员对接个人觉得烦的，他们更愿意对接黄牛)？自己搞的话就车子停对面，先办手续，最好找黄牛。旁边一个大叔过来，说700。问能少点么？答不行(我昨天问了淘宝，淘宝要900，更贵呢!).我说那行，一问，我缺了居住证，得，和雨哥又屁颠屁颠跑回我家去。半路车子不够油，我和雨哥说了，加一些，一人一半，我也出，嘿嘿(本来油价贵，雨哥浦东能搞好的话，剩下我自己加就好了，没想到浦西还跑来跑去，嘿嘿)。加了100块。到家拿到东西后我们跑去中山北路2907号(这路不太熟，我和他还转了好一会才终于到目的地)。这里我来转过二手车市场。</p><p>11:30入门右转，一堆二手车问: 车出不出(出个蛋蛋，雨哥卖我的)。没有卖不出的车，只有卖不出的价。往前开，然后有个绿色衬衫老哥，背湿一片。说750，我们刚在那700，就砍了下价。不过想到今天办完明天就省了时间，我说这样，我不讲价，但是我跟着学习点。他说行啊，我们就继续开整了。入门往右开，一直到底，里面有个拦车杆，说来过户的，贴个单，单上雨哥手机号(卖家手机号)。进去后停在一个车库，剪旧车牌，并且拓印(找的车库的老师傅，我就750包所有费用，其余全部是黄牛出钱，这个师傅跟黄牛要60，嘿嘿)。拓印的时候(在发动机舱左上角有车架号)，老师傅说这车子最不喜欢，很浅很浅。拓了很多次看不清，我跑过去手机射灯给他终于好了。然后出来上4楼办证大厅，左边门直走到底。我拿出身份证、额度单、居住证(外地户口要)；雨哥是相关证件。我和他都拍好头像、手机验证码等，整好后到下午14:30分前回来这里等就好了。我和雨哥下楼吃饭，AA。我点的西红柿、鸭胗26，啊，好贵啊。中间也聊了很多，然后没地方去，我们又回去，当然啦，我多买水，毕竟顺利过户更重要嘛，今天43度天气让卖家跑来跑去，过意不去。他们这里做事确实正如雨哥所说，进来就是赚钱，和电脑城、手机城一样，一直忙忙碌碌。中午一直等到14:30，我没事干手机又没电(线在车上)，就闭目下；雨哥忙，开导少妇不要离婚，业务广(调侃下，主要觉得他心地好，心术正)，嘿嘿。然后说验车单好了，给了我一个打印单。听黄牛指挥，我跟雨哥跑楼下去验车。另一个胖胖的验车师傅拿到我们给的车钥匙后，一顿操作，行云流水(当喜欢的东西成职业后，所有都是流程化，没有喜怒悲哀。如果这行业是窑子，再漂亮的美女对他们这境界来说就是行走骷髅，那老哥带给我真是这种感觉。)。我们车从另一个门出去，左拐就是验车(前面保时捷、理想的车子，二手车啥都能交易。)。轮到我们时，人下车，发动机舱拍、前拍拍后拍拍(我的行驶证刚好把我拍进去作为图片)，好了下一辆。看吧，就是豪无人性的流水线，嘿嘿。跟着我们又绕了一圈回来到刚才的车库，因为没别地方放车。</p><p>然后我们把拓号和旧车牌架拿上去，给到小屋子于是又是一阵索然无味的等待。大概3点半多喊我去选牌。之前我有了解过选牌: 新车可以网上选号，不给力可以线下再选一次；二手车只能线下选一次。沪A、沪B开头无论如何也比其他的要好，我跟带我的小妹妹说你熟，能帮我选个好号码吗，不然你手气好帮我选下。她说就是20选1，在电梯门口边的机器上操作。好吧，我点了停止，啊，流水线化操作的20个毫无人性的字母数字，不太给力，不选不行，选了不给力。后来看到英文dry，那就这个吧: 沪DRY279. 选完小妹妹就走下一个流程了，我和雨哥继续聊天。</p><p>过了好一会告诉我说东西都好了，交了750块。身份证、居住证、行驶证、临时车牌都给到。然后说等一会会，说不定车牌到了。多等了2、3分钟果然我的铁皮到了。然后我说，大哥，帮我装呗，我真啥都不会，感谢感谢。那个老哥又跑下去帮我装好车牌。我和雨哥在那个车库感受着蒸桑拿的体验，然后边过户保险。上车雨哥教了我大致的东东，这些都是学车师傅没教的。本来想让雨哥带我走下，顺便去做个小保养，但是市区路太窄无法练习。所以让雨哥帮我开回家里垃圾堆边的车位上，我和他一起骑自行车前往2.7公里的交通大学作分别。</p><p>晚上我们又做了下过户保险，还是没成功，我没保险更不敢开出去了。先放几天吧。晚上和家人下来熟悉下车车，这也是我们家第一辆车，以后可以为家人遮风挡雨啦。以前爸爸妈妈坐别人家车的时候，都是拘束的，我知道。爸爸就是上车、下车，坐车就是别人的车顺道挤一挤，无感情游记。妈妈坐别人车，也会晕车，所以听我说要买车，说我有多少多少，给你添点。啊，有个自己的车了，真的可以开了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220701生活琐碎</title>
      <link href="/2022/07/01/20220701lesson/"/>
      <url>/2022/07/01/20220701lesson/</url>
      
        <content type="html"><![CDATA[<p>解封期间，天天想着买车买车。天天算着钱，什么时候够把车牌贷还清、手上还有多少钱、哪里还能搞钱。</p><p>这都是穷，嘿嘿。疫情解封前一天晚上，已经可以下来转转了，和老婆出去走了走。时不时就和老婆谈理想，算钱。房子是大头，一定要留出余地比如3、5个月的冗余来还房贷。</p><p>不算留给阿黄学习的钱，不算借给大姐的钱，得7月份才还完车牌贷。本来算好4月开始就要现金还房贷，然而封控期间，丫头公司也是不稳定，各种让其主动请假、扣钱(难，丫头疯狂学习考证，我就多好言照顾。希望早日考完证，要是能落户，这样基本以后找工作也好找)。</p><p>6.1号开始，我就去各个地方置办需要的物资: 鼠标购买顺利；键盘闲鱼淘的时候，回来一用Command键有问题，跟卖家大吵一架，那个傻逼女的(身体、精神有病，外资外包做iOS，还挺闲，那么清闲工资还26/27k，我的天，外面赚钱这么好赚么？羡慕，可能是自己能力太辣鸡吧，赚不到就酸，哈哈)以为二手出去的东西，坏了我就得认，屌你哦。当时买的时候觉得可以信任，6.1刚解封不敢上楼当场试，立马回来试一下就发现了问题。好言问怎么解决，开口就回答二手不退，把我气的。当晚很热打字、微信语音吵架。吵得老婆跑过来想接话，让我不要那么凶人家女生。这我更不能忍，不能让我老婆被坏女人骗。后来老婆自己生气，跑去洗头去了。我倒是和这娘皮吵架完了，她要给我工作内推(估计丫头听到这个都要懵了，还有这操作，自己瞎操心了，哈哈)，键盘问题就我当做花个20请她喝奶茶，其他的退回去。算了，当做少20消灾。自己花时间淘、自取、还亏20，这次认栽。后面又闲鱼买了键盘，全新没用过，这就不会有问题了，这是后话。</p><p>期间，那女的说疫情期间别人300要跟她买，现在我要退要赔；赔你妈哦，产品页上说没任何问题，就算卖1000别人，别人发现问题也要退，同样卖不出去，傻屌。后来我去还键盘的时候和他男朋友聊天，他们和我们一样也是外地来打拼(不实诚就是不对哈)，男的在字节跳动写安卓，女的一开始说在外企花旗，诶，要是能拉我一把进外企那就挺不错，后来才知道在一个外资外包。字节加班不当人，我管理团队离职的几个技术、能力着实不够好，都能轻松进去20k，我都怕了国内的企业(个人认为除了百度、腾讯、好的国企外都不行)。能进花旗可以，但是她内推外包那就算了，可不兴打零工啊。和那个男的聊天2小时后，又骑着我的小电驴回去了。回去就把那傻逼女的拉黑了，感觉没用，人是挺傻逼的。</p><p>后面闲鱼上又淘了原木床，2.7k砍价到2.3k，然后找小程序”万师傅”花了350，到家让师傅再帮我移个床100，打车补贴(距离太近中级面包车不拉，加费40多才有中面师傅抢单)，所以是350+150搬家费用。当天老婆躺了会超级开心，想买个凉席三件套。她说你看我看中的罗莱400多，优惠完299。我就想着趁这机会好好给她推荐闲鱼: “你看闲鱼这个更实惠，淘宝买你还得等两天，这个当天给你搞定，还超级实惠。我选的这种不优惠的，就是因为料足，优惠不下去了。”。我满口答应办好这事，当天中午卖家回应，当场就给提回来，把她开心的。她真诚的说，真的哈，被俺打动了: “不喜欢闲鱼，原因是不好拿、当面去拿又心虚、又怕被骗。到我这，真香定律。”</p><p>着实的，闲鱼买那种实在的东西超级好，比如这类几乎全新的，床这类经久耐用的。2米的实木床睡起来真舒服，之前500块淘宝买的席梦思和这种乳胶床垫简直没法比，毕竟500对比5000价格在这摆着。嘿嘿。</p><p>这么好的床，都让我每天想早早回去睡觉了，爱睡觉了。</p><p>再来说说落户的事，6月初解封，赶紧和人事说去柜台问。那天早早过去发现自己过来就可以问了，不用等人事。直接柜台询问原因，知道原因了: 今年基数就是要2倍。去年不清楚原因，可能是今年政策改变了。</p><p>当天晚上就和伟哥商量了，给了名额，但是基数不够还是不能落户，这还是捉急，嘿嘿。等了两天，伟哥和老板、人事交流，决定提升工资和社保基数的方案，当然年底的年终要影响。老实说，能困住我的只有户口。如果要钱，我去别的创业公司，工资估计能翻倍。但是落户可就不一定了，要走居转户，也得再等三年。如果能落下来，将这个困境解脱，简直感谢公司。</p><p>落户的事情，目前还是要继续缴纳2倍基数社保，这个急不得，没办法。现在有两倍，居转户也好整。</p><p>接下来是中级职称。伟哥说中级职称帮助很大，之前忙着学c(伟哥说学c对我来说意义不大，不过他不了解的是，生存能力差，则必须加强能力。如果nodejs增删改查，其他同学玩得更溜。当前我手上很多大问题都是学了新的知识才得以解决的。)，而且拍车牌、还贷、等等用钱，7.1号之前买课程基本都要掏光我现金了，不过想到这个是公司全力培养的，全力配合的。大家一起上的话，更容易，别到时只有我一个人，那就不好上了，所以赶紧350一门课(一门12分，要够90分)，赶紧凑够来。</p><p>目前时不时看看手机里的二手车，我把丐中丐版飞度看了，觉得不安全；又看上了大号飞度-缤智；然后觉得东本思域也是好东西；最近又迷上了烂仔王-型格-6mt版本。不是见异思迁，而是，没钱随便看看，有钱真好。</p><p>今年定的目标一定要努力实现: 工资上30k或者产品卖出100w。什么产品？还在摸索中，哈哈。</p><p>说回钱，目前是想买车，毕竟大热天、大下雨的，早买早享受，反正之后买价格一样，多花一丢丢而已。但是，阿黄学习、还房贷、还首付借的钱却比我车车更重要。我累点无所谓，家人健康更重要。</p><p>所以，目前还没拿定主意，很想买个几千块的二手车，不过说实话，买错了就浪费的几千块。如果晚几个月，别到时不好订车，只能希望下个月攒个一笔钱，先定下车，之后入手。不能急不能急。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 20220701, 琐碎 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220610学习工作遇到的问题</title>
      <link href="/2022/06/10/20220610lession/"/>
      <url>/2022/06/10/20220610lession/</url>
      
        <content type="html"><![CDATA[<h1 id="Learn"><a href="#Learn" class="headerlink" title="Learn"></a>Learn</h1><h2 id="写sqlite遇到的问题"><a href="#写sqlite遇到的问题" class="headerlink" title="写sqlite遇到的问题"></a>写sqlite遇到的问题</h2><h3 id="小心指针写错"><a href="#小心指针写错" class="headerlink" title="小心指针写错"></a>小心指针写错</h3><p>有方法: <code>(void*)(*leaf_node_value)(void* node, uint32_t cell_num)</code></p><p><code>void(*serialize_row)(void* target, Row* source)</code></p><p>调用时居然没有报类型错误: serialize_row(*leaf_node_value(destination_node, index), value), 此处传入的target是对象类型，居然没有报错。正确的是: <code>serialize_row(leaf_node_value(destination_node, index), value)</code></p><h3 id="传入Row-但是入参是uint32-t-则会被转为数字"><a href="#传入Row-但是入参是uint32-t-则会被转为数字" class="headerlink" title="传入Row* 但是入参是uint32_t 则会被转为数字"></a>传入Row* 但是入参是uint32_t 则会被转为数字</h3><p>入参会直接拷贝: <code>void(*leaf_node_split_and_insert)(Cursor* cursor, uint32_t key, uint32_t value)</code> 如果传入leaf_node_split_and_insert(cursor, key, value); 这个value是Row*对象，则会直接拷贝地址转为uint32_t值。</p><h2 id="docker宿主机模式"><a href="#docker宿主机模式" class="headerlink" title="docker宿主机模式"></a>docker宿主机模式</h2><p>遇到个问题: 服务要使用ssh连接本机，但是使用全局ip，会走网关，网关管理方(其他公司)似乎将速度降的很慢，于是就想着使用127.0.0.1。</p><p>docker有个属性: <code>network_mode: host</code>，这将直接把适配了环境的服务，单独将网络服务拉到和宿主机一致。</p><p>既然和宿主机网络一致了，那就不能使用虚拟网卡: networks, 并且相同的docker-compose.yml 文件中的服务，要是有数据库之类的，就无法使用同一个网络服务，于是使用127.0.0.1:${db_port}:${db_port}，都不走外网端口。</p><p>当前处理方案示例:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  mongo:</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:27017:27017</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">DB_HOST=127.0.0.1</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">DB_PORT=27017</span></span><br><span class="line"><span class="attr">    network_mode:</span> <span class="string">host</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20220420生活琐碎</title>
      <link href="/2022/04/20/20220420lesson/"/>
      <url>/2022/04/20/20220420lesson/</url>
      
        <content type="html"><![CDATA[<p>从4.1日起开始居家办公，时不时全员核酸，至今已经接近一个月时间了。疫情居家着实比较麻烦，好处也是有的。</p><p>先对比下好处吧: 省却了早晚电动车15公里的路程；早饭吃的相对更早了些。</p><p>坏处: 由于还在学习期，所以晚间大块学习时间没有了；工作狂，没得表现自己很努力的样子了；办理事情拖了很长时间了；由于居家办公，导致效率降低、工作时间倒是延长些，挤占了部分学习时间了</p><p>3月尾的时候老妈打电话过来说大姐被骗钱，于是和二姐拼了点钱赶紧给大姐资助过去。本来3月份刚好足额还车牌贷款钱，还欠房贷首付10w；啊，瞬间手上又木有了。因为知道大姐肯定一两年内肯定没钱还的，唉。蛋疼的是，事后才知道大姐银行贷款20多w，居然连丈夫不知道，其他人更不知道了；而且大姐夫在我大姐还带着俩孩子，刚搬到17年高点买入的房子不熟悉情况下让我大姐赶紧去挣钱。早知道这情况不能借出去那么多，3w最多了，拿不回来不会那么心痛。(当时只想着大姐别想不开，哭成这样了，没问，先解决眼前事情再说)</p><p>唉，他这家庭，大雷。</p><p>诺，3月没钱，支付宝就没啥钱，不敢屯啥吃的，一个包菜就搞了我45块, 8元1斤啊。囤了点肉，幸好老婆也买了些能放久点的。3.31下午感觉不放心，又去超市走走，超市能吃的都被别家买空了。感觉上班不敢走太久，就草草回去了，以为4.1 封控到4.5就结束了。到了4.20还遥遥无期。</p><p>3月中下旬给老婆办好人才档案(托人)，赶紧开始人才落户申请，没想到提示失败，而且封控期间无法询问。和人事交流有可能title 写得不好？(xx经理)，改成研发经理再次申请，没想到过没几天又给打回来了。不理解。公司其他人社保基数没我高都能过，在想会不会是老婆的学历、工作简历比较奇葩，但是人事说再怎么奇葩也是要写上去的；随迁随调，就是看她现在是否工作。当前不宜再尝试，得等解封之后去柜台询问了。</p><p>从年后工作，管理岗转为技术岗，而且技术都是维护一些产品。nodejs 胶水完全没有挑战、没有技术含量。考虑到能落户，这个对我吸引力还是很好的。做做那些也没啥。不做管理，每天下班不用搞更多，没安排就随便了，学习时间更多一些，拼命把c学好。当然，做那些没有价值的产品让我觉得和公司方向等格格不入，整天变得唯唯诺诺？反正不那么自信倒是有的。</p><p>一直隐忍，因为落户对我来说至关重要。等待老婆人才档案好，开始好转；然而被打回了之后心情超级低落，后来释怀心结就放开了。不就是落户嘛，目前120积分阿黄能上学。上海不欢迎我，我努力学好操作系统知识，以后我赚钱注册公司到其他省份去。所以更加努力学习c相关知识。</p><p>啊，年前~3/4月份着实让我体验了久违的难过，我居然也会唯唯诺诺，唉，胶水语言害人，感觉很像我18年OC找工作的那段心里情感。</p><p>哦，还有就是真的穷，穷让人难受。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 琐碎 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220328es</title>
      <link href="/2022/03/28/20220328es/"/>
      <url>/2022/03/28/20220328es/</url>
      
        <content type="html"><![CDATA[<h1 id="es"><a href="#es" class="headerlink" title="es"></a>es</h1><h2 id="es-使用curl"><a href="#es-使用curl" class="headerlink" title="es 使用curl"></a>es 使用curl</h2><pre><code>$ alias curles=&apos;curl  -u elastic:elasticpassword&apos;$ curles -XPUT &quot;http://localhost:9200/movies/movie/1&quot; -d&apos;&apos;$ curles -X POST &quot;http://172.16.60.162:9200/_analyze&quot; -d &apos;{&quot;analyzer&quot;:&quot;standard&quot;, &quot;text&quot;:&quot;Like X 国庆放假的&quot;}&apos; -H &quot;Content-Type: application/json&quot;</code></pre><h2 id="为es-增加stopword-和词汇"><a href="#为es-增加stopword-和词汇" class="headerlink" title="为es 增加stopword 和词汇"></a>为es 增加stopword 和词汇</h2><h3 id="增加stopword-和词汇的操作"><a href="#增加stopword-和词汇的操作" class="headerlink" title="增加stopword 和词汇的操作"></a>增加stopword 和词汇的操作</h3><pre><code>$ docker cp ${dockerId}:/usr/share/elasticsearch/plugins/ik/config config// 支持往custom/mydic.dic 写入对应合并关键词、custom/ext_stopword.dic$ mkdir config/custom &amp;&amp; touch config/custom/mydict.dic &amp;&amp; touch config/custom/ext_stopword.dic$ docker cp config ${dockerId}:/usr/share/elasticsearch/plugins/ik // 拷贝配置文件回elastic$ docker restart ${dockerId} // 重启elastic</code></pre><h3 id="↑支持的plugins语法"><a href="#↑支持的plugins语法" class="headerlink" title="↑支持的plugins语法"></a>↑支持的plugins语法</h3><p>语法如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">新案件</span><br><span class="line">不要</span><br><span class="line">不可</span><br></pre></td></tr></table></figure></p><h2 id="search-max-open-scroll-context"><a href="#search-max-open-scroll-context" class="headerlink" title="[search.max_open_scroll_context]"></a><code>[search.max_open_scroll_context]</code></h2><p>PUT 更新下配置即可:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT --user elastic:123456 &quot;http://localhost:9200/_cluster/settings&quot; -H &apos;Content-Type: application/json&apos; -d &apos;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;persistent&quot;: &#123;</span><br><span class="line">    &quot;search.max_open_scroll_context&quot;: 1024</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;transient&quot;: &#123;</span><br><span class="line">    &quot;search.max_open_scroll_context&quot;: 1024</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&apos;</span><br></pre></td></tr></table></figure><h2 id="FORBIDDEN-12"><a href="#FORBIDDEN-12" class="headerlink" title="FORBIDDEN/12"></a><code>FORBIDDEN/12</code></h2><p>该表示为磁盘空间已不足90%，可以配置使用磁盘空间比例，但是推荐扩容磁盘大小，90%已经是比较危险的使用大小了。</p><p>扩容磁盘大小后，将所有索引再重置下，否则只能读，不能创建或者更新等操作:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT --user elastic:123456 &quot;http://localhost:9200/_all/_settings&quot; -H &apos;Content-Type: application/json&apos; -d &apos;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;index.block.read_only_allow_delete&quot;: null</span><br><span class="line">&#125;&apos;</span><br></pre></td></tr></table></figure><h2 id="Data-too-large"><a href="#Data-too-large" class="headerlink" title="Data too large"></a><code>Data too large</code></h2><p><code>Data too large</code> 表明了ES内存已达到当前数据存储上线。</p><p>解决方案目前是两个:</p><ol><li>扩容机器数据内存；</li><li>设置熔断驱逐数据；</li></ol><p>这里记录2中设置熔断驱逐数据:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">docker-compose.yml</span><br><span class="line">services:</span><br><span class="line">  elasticsearch:</span><br><span class="line">    volumes:</span><br><span class="line">      - ./elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml</span><br><span class="line"></span><br><span class="line">elasticsearch.yml</span><br><span class="line">cluster.name: &quot;docker-cluster&quot;</span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line">indices.breaker.total.use_real_memory: false</span><br><span class="line">indices.breaker.total.limit: 60%</span><br><span class="line">indices.fielddata.cache.size: 45%</span><br><span class="line">indices.requests.cache.size: 20%</span><br><span class="line">indices.breaker.fielddata.limit: 35%</span><br><span class="line">indices.breaker.request.limit: 50%</span><br><span class="line">network.breaker.inflight_requests.limit: 50%</span><br><span class="line">indices.breaker.accounting.limit: 50%</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/weixin_42715225/article/details/113258998" target="_blank" rel="noopener">参考文档1</a></p><p><a href="https://segmentfault.com/a/1190000022568882" target="_blank" rel="noopener">参考文档2</a></p><h3 id="Data-too-large解决记录"><a href="#Data-too-large解决记录" class="headerlink" title="Data too large解决记录"></a><code>Data too large</code>解决记录</h3><p><code>Data too large</code> / <code>429 Too Many Requests</code> 这个问题由来已久。之前考虑是关闭某些年份数据，但是仍然会报那个问题。</p><p>思考就是数据加载到内存后，如果继续增加，而没有把旧数据驱逐，则肯定会超过内存数据大小，于是对应上述方案: 增加内存，让他不到达最大内存(好处是都加载到内存，快)；驱逐旧数据，加载新数据。</p><p>查看数据: <code>GET /_stats/fielddata?fields=*</code></p><blockquote><p>fielddata中的memory_size_in_bytes表示已使用的内存总数，而evictions(驱逐数据)为0.且经过一段时间观察，字段所占内存大小都没有变化。由此推断，当下缓存处于无法有效驱逐的状态。</p></blockquote><p>最重要的是设置好fielddata cache大小和熔断点大小<code>indices.fielddata.cache.size</code> 和<code>indices.breaker.fielddata.limit</code></p><p>参考文档总结中挺有帮助的:</p><ul><li>系统默认的indices.fielddata.cache.size 是不限制大小的，本意是想通过报错告知维护者需要做配置，是否搜素的数据有误。</li><li>fielddata.limit 的配置需要比fielddata.cache.size稍大。而fielddata缓存到达fielddata.cache.size的时候就会启动自动清理机制。expire配置不建议使用。</li><li>indices.breaker.request.limit限制查询的其他部分需要用的内存大小。indices.breaker.total.limit限制总(fieldData+其他部分)大小。</li><li>创建mapping时，可以设置fielddata format控制缓存数据格式。</li></ul><p>ES需要高速内存读取，首要达到硬件内存通过集群扩容大于数据大小。此时体现在数据快速读取，大量人员内存操作的场景。<em>如果是人员人数不多，非必要大量数据高速存取场景，则可通过ES熔断机制驱逐旧数据，达到存取平衡。</em></p><p>故，非超大型查询场景是可以不采用集群方案(超大型集群调节熔断配置)，单节点可以满足配置中熔断数据(根据<code>ES_JAVA_OPTS</code> 比例值)。</p><p>此处描述配置作用:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cluster.name                            集群名称</span><br><span class="line">network.host                            网络配置</span><br><span class="line">network.breaker.inflight_requests.limit 请求中熔断器</span><br><span class="line">indices.fielddata.cache.size            类型为text进行sort/aggs时加载fielddata到内存</span><br><span class="line">indices.requests.cache.size             shard request cache热点请求cache</span><br><span class="line">indices.memory.index_buffer_size        索引操作大小(default:10%)</span><br><span class="line">indices.breaker.total.use_real_memory   可以更加精准的分析内存状况，避免 OOM</span><br><span class="line">indices.breaker.total.limit             配置总内存大小</span><br><span class="line">indices.breaker.fielddata.limit         field 内存数据加载大小</span><br><span class="line">indices.breaker.request.limit           防止单个请求内存溢出</span><br><span class="line">indices.breaker.accounting.limit        已请求完的请求所占用内存占比</span><br></pre></td></tr></table></figure><p>查看是否配置成功及查询现有配置:</p><pre><code>alias escurl=&apos;curl --user ${esuser}:${espass}&apos;escurl -XGET &quot;http://${eshost}:9200/_nodes/_all/settings?pretty&quot;</code></pre><blockquote><p>参考说明 <a href="https://blog.csdn.net/u013200380/article/details/109285118" target="_blank" rel="noopener">https://blog.csdn.net/u013200380/article/details/109285118</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> es </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220311管理回顾</title>
      <link href="/2022/03/11/20220311manager-review/"/>
      <url>/2022/03/11/20220311manager-review/</url>
      
        <content type="html"><![CDATA[<h1 id="管理回顾"><a href="#管理回顾" class="headerlink" title="管理回顾"></a>管理回顾</h1><h2 id="问题来源"><a href="#问题来源" class="headerlink" title="问题来源"></a>问题来源</h2><p>之前在管理岗位上做了两年，由于摊子有点大，20来人，且人员有点复杂，所以其中比较大的精力都是花在兜旋上。出大错改为出小错，出小错改为小麻烦小毛病。还有就是化解问题，让那些问题尽可能在我身上化解，小部分流到上级老大那去。</p><p>项目上，我们组多且杂，细碎。</p><p>在任中，由于身处漩涡中，未能察觉外部压力来源，且忙于事务及知识进修，无法找到问题根绝点，同时管理能力也是初学，进行了几次的管培开拓一些眼界后，当前时间回顾才算有效。</p><p>年初的时候，我老大喊我去聊天，他接回一部组织管理岗，我平转到技术岗。对我工作而言，没有人事问题的烦扰，项目问题就变得简单多了，倒是担心老大CTO+一部的管理事务和技术事务太多，怕他顶不住。我能顶住部分，也是尽力帮助到。</p><p>昨天大掌柜喊我去聊天。大掌柜怕我转岗心情复杂，会消极，误解组织的一些调动。其实还好，我的适应性还是很OK的，对于进来公司这个大组织有自己的期望，而且获得栽培，现在相当于重新寻找目标，换个角度处理事务。</p><p>可能未来到公司的前几年于我确实是相当黑暗的，目前重新开始，确实有光明有希望的。</p><p>当前合作三年，对公司业务等才熟悉一小半，身处另一个经理角色也是要重新审视，好好对付。</p><p>由于之前寻找方向时候的需求，重新学C。虽然现在工作中没有使用必要，但感谢幸好有这想法，C对我太重要。我不讨厌OC，只是无法稳定，无法活命。周围转悠了一圈，有点活命的底子了，这时候回来C继续往下搞，我确定是未来主方向了。</p><p>大掌柜喊我聊天还有一个原因，自己感觉的出来。上周周会中，我对项目的把控没有以前强，因为我觉得必须把该项目把控权交出去，那部分任务先给产品挑着，我先应付身上细碎项目，花主要精力攻克。大掌柜也因此引出今天的主题: 我之前身处管理岗，对所掌握的事务有帮助，回思原因，帮助老大慢慢化去Web组的毒，这样至少也是减轻老大部分压力。是的，大掌柜肯定知道老大事务多，多个人去帮助。应该的，那是在我掉入黑暗时伸手拉我出来的大侠。</p><p>Web组管理是有些问题的，项目多、细碎，都要做，人员不能合理填补到对应项目，就会驳杂，而且来回调动，就会乱；人员调动，且人员经验也是现成培养，就出现项目进行到一半，重头开始，那么无法做到量变(量变是这个量是成熟的通关才能算成分子，否则不能计算为其中一个量)，那就更无法引起质变；由于此，项目大目标没有，那就没有可拆分目标，那需求多变就形成了现象。</p><p>和大掌柜一起结合现有现象的讨论中，我脑中就蹦出来思想: Web组毒来源于没有长期规划，目标不清晰。</p><p>这个毒我深有所感。我这两年来回窜，正是源此。为什么这么说: 我个人是有长期规划的，我有我未来要成为什么样的人，大致有个目标，虽然赚钱目标不清哈；我分解我每年要实现的路，我分解阶段性目标都有清晰规划，我严格遵守目标规划，目标能分解到每周、每日、及部分能使用的时间，所以近年来我进步是看得见的。</p><p>而作为项目的长期规划？没有，的确没有，产品也由于不够熟悉且任务也多，到时也无法投身化解，这个毒是需要项目经理角色，联合产品(等同甲方爸爸)与老大集体讨论分析得到了目标，才能慢慢去化解的。</p><p>得到目标有啥用？我这么讲你估计是清楚: 有清晰的目标，项目上下一致得到认可，老大说不错，需要和大掌柜交流拿到资源投入，按期按规划达到阶段性目标再到接近大目标。有大目标我就能分解需求。有资源，我就拿到了专属的人去做。人才不够好？挑选可培养的，由老带新，将人一个一个培养出来，将身上项目一个一个剥离出来。</p><p>有完整项目，有完整小单位，就能解决乱的问题。项目没有目标，那就会出现我无法获得资源，我无法调节人才，我做不出东西!嗯，对的。因果。</p><p><img src="/css/images/220311/manager_review01.jpg" alt="manager_review01"></p><h2 id="实施"><a href="#实施" class="headerlink" title="实施"></a>实施</h2><p>当前与产品交流，觉得有些道理。从现有几个项目一个一个的来拆解，给他设定三年、两年计划，有个清晰的目标来计划与实施。</p><p>当前预留两周时间想想，到时一起头脑风暴下，知道病根接下来慢慢治好来，别急。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220221关于21年总结</title>
      <link href="/2022/02/21/20220221%E5%85%B3%E4%BA%8E21%E5%B9%B4%E6%80%BB%E7%BB%93/"/>
      <url>/2022/02/21/20220221%E5%85%B3%E4%BA%8E21%E5%B9%B4%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>21年已经过去了，当前22年工作已经过去两周，新的一年和老的一年肯定还是一样的。不一样的地方有一个，对我很重要，等会说。</p><p>21年是买房年，2月份开始看房，3月末开始走流程。幸好很顺利的在4月份审核完毕，8月份银行贷款下来。如果4月份开始走流程，结果肯定大不一样，银行全都收紧。提前还款，压力大一些，不过当前都还是走公积金扣款，其他钱一下来就赶紧还之前借的。年底前把二姐的钱还了，舒了一口气。然后在走拍车牌。当时想着车牌要很难拍到，找黄牛把钱加到9999，回头一想，不行，我要先还另一个首付的钱，急不得，改成5500，没想到在1月份中了。</p><p>有惊喜，也有惊吓。本想再熬5、6个月，把另一个首付借的钱还了，没想到就中了；推荐我的大学同学都还没中，气得他想要换个商家。惊喜是，提早也行，不过车慢慢来了，或者买个便宜的，反正时间是一年。</p><p>当时过年都没钱，不敢回去。在自己家里7、8天学习。太冷了，就待在屋子里吹空调。老婆大姨妈推迟来，把我们俩整的吓到了。以往每次她都提前7天，这回突然晚来。那两天丫头心里失落，好多钱要还，自己不是上海户口，要丢工作，这压力不是一般大。我也有点大，首付钱、车牌钱、开始每月要还房贷现金了、阿黄也要来上海。人到30岁，上有老下有小，还挺难过的。心里确实难过，陪老婆公园走走，说我们俩身体真真好，一不小心就能中，别人都中不了。今年要加把油赚钱了，赚钱重重要要。规划一大堆，没想到大姨妈还是来了。丫头高兴的，大姨妈来串门了。我都整蒙了，不是不来了么，女孩子真奇怪。</p><p>这就是去年跟钱有关的回忆。嬉笑怒骂中又度过一个年头。具体可以看看去年的其他文章，坎坷。</p><p>21年决定了不学习Golang，理由是其跨平台确实不错，工具度很高，不过对于我来说，其路线还是走的业务层。总会有年龄限制，光速调头，忍着啥都忘光，重新开始 cpp 和c 的学习。</p><p>先把cpp 学了一遍，跟着thecherno 把opengl 学到第12课，发现里面好多知识需要在c 里面有。感觉还是要补一下c的知识。cpp 把基础知识都过过，然后学习<code>阮一峰</code>阮老师的教程把c的也学了两边，做了一次笔记算是半入门。</p><p>半入门不够，于是学了<code>用c实现一个shell</code>；<code>buildyourownlisp</code>；墙裂推荐<code>buildyourownlisp</code>，学完它的第10张，我自己学会写了一个小工具: postftp。完整学完那个课程后，期间复写了几十次。感觉还有不够深入了解的地方，不过基本都中。当前在做个自己的笔记，把学习他的90%理解再往上提升一下。</p><p>接下来还是按照github 的学习安排，走数据库底层路线。</p><p>今年有机会，把数据库整的明明白白来。展望的2022年，技术方向就是数据库学通。</p><p>2022年，开年由于过去自己努力，然后刚好阿黄快上学，老大喊我聊天。里面说到落户问题，啊哈，我当时就跟老大说，人才落户觉得不可靠，我的社保基数不够2倍，没奢望过，一直努力把社保基数拉上去后，再过3年就有机会落户了。然后老大说不用2倍，人才通道有优惠政策，可以落，而且给这个名额，也希望我今后帮公司更加强大。</p><p>我去，真的可以么，上海户口我奢望了很多年了。没有这顶大山压着我，我特么绝对不会那么悲催，这么多年真的被这个气的。怕离职社保断了；怕这怕那，就是户口问题、买房问题。这真的是我的枷锁啊，把这道枷锁打开，真的没有能困住我的东西了。</p><p>当前还在办理中，还在走流程中。居转户是只能我和孩子落，人才是可以把菜逼老婆也带上来。</p><p>这两天被菜逼老婆气到。交流下水冲到厕所木门上会导致木门腐烂更严重，她来疯狂跟狗一样说这说那，真的有点傻逼。有点不想带这货。而且身在福中不知福，享受着自己生活的美好，自己有多菜，知识有多垃圾没有一点逼数。</p><p>唉，傻逼老婆，真特么傻逼的可以。我瞎眼了当时。不对，是我傻逼，我傻逼的可以。500w多买一个老婆的打算，下降，100w开始找妹子(没钱不好找)。今后钱分开来，我自己赶紧存够自己去潇洒，妈的。</p><p>好吧，这就是2021，和2022的开头。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20220218too_many_open_files</title>
      <link href="/2022/02/18/20220218too-many-open-files/"/>
      <url>/2022/02/18/20220218too-many-open-files/</url>
      
        <content type="html"><![CDATA[<h1 id="too-many-open-files"><a href="#too-many-open-files" class="headerlink" title="too_many_open_files"></a>too_many_open_files</h1><p>前方技术传过来服务报错: too many open files，这个第一眼看出来就是服务器句柄消耗空了。但是我这里无法定位，所以需要精确到是哪些文件被打开，然后我找找附近代码即可。</p><h2 id="下载lsof-离线包"><a href="#下载lsof-离线包" class="headerlink" title="下载lsof 离线包"></a>下载lsof 离线包</h2><p>首先离线原因，我需要lsof的离线安装。</p><p>centos: <code>yum install yum-utils -y</code> 下载后能得到yumdownloader 工具</p><p>然后使用yumdownloader 下载lsof 包: <code>yumdownloader lsof --resolve --destdir=/root/mytest</code></p><p>–resolve 会下载对应依赖；–destdir 会将rpm包下载到对应文件夹。</p><p>接下来将该安装包拖到内网服务器。</p><h2 id="rpm安装该包"><a href="#rpm安装该包" class="headerlink" title="rpm安装该包"></a>rpm安装该包</h2><p><code>rpm -ivh *.rpm</code></p><h2 id="使用docker-ps-查找对应的容器"><a href="#使用docker-ps-查找对应的容器" class="headerlink" title="使用docker ps 查找对应的容器"></a>使用docker ps 查找对应的容器</h2><p>推荐使用对应容器查找方案，单独隔离，如果打印很多，那该进程肯定是满的。</p><p><code>docker ps</code></p><h2 id="根据docker-容器找到实际进程pid"><a href="#根据docker-容器找到实际进程pid" class="headerlink" title="根据docker 容器找到实际进程pid"></a>根据docker 容器找到实际进程pid</h2><pre><code>docker inspect -f &apos;{{ .State.Pid }}&apos; ${docker 容器名 / dockerId}</code></pre><p>这个能获取实际进程pid</p><h2 id="打印所有open-的句柄"><a href="#打印所有open-的句柄" class="headerlink" title="打印所有open 的句柄"></a>打印所有open 的句柄</h2><p><code>lsof -p ${pid}</code></p><p>列出所有打开的句柄。 lsof: list open file</p><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>没有结尾，搞定收工</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20220208gccbuild</title>
      <link href="/2022/02/11/20220208gccbuild/"/>
      <url>/2022/02/11/20220208gccbuild/</url>
      
        <content type="html"><![CDATA[<p>第一次gcc windows 打包。以为超级难，使用 -static，但是报一堆错误。</p><p>最终使用加入dll 动态包打包的。</p><hr><p>首先我开发时使用 <code>gcc *.c -lcurl -o app</code> 在Cgywin 是能正常执行使用的。新哥教我双击要能使用，那么就使用 <code>everything</code> 一个个找出里面的需要的库文件，而且在新哥那边嫖来了公司统一打包环境，好处就是随着公司统一第三方版本升级，和我当前使用的差不太多。</p><p>新哥指导下打包成功后在本地出现app.exe, 但是双击或者 cmd 中执行是失败的, 说明库文件没找对。新哥可能太久不记得怎么操作了，不行了，得麻烦春哥了。</p><p>接着请教春哥，春哥当晚很晚给我把动态库找齐，放在一起执行。我自己操作了下也成功，满意的回家了。</p><p>这里写个插曲: 春哥给我整好后，我把app.exe 拖到桌面，双击，唉，春哥，运行不起来啊(他已经回去了)。春哥想了又想，我给他截了个图，他看到了他的那些可爱的动态库去哪了。诶，这货双击执行还需要那些个玩意嘛。哦，明白了，经常下载exe安装包，里面就有这些，我自己试下，哦，soga，真有意思。</p><p>这是该app, 好用着呢: <a href="https://github.com/akerdi/postftp" target="_blank" rel="noopener">https://github.com/akerdi/postftp</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> gcc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220122拍沪牌</title>
      <link href="/2022/01/25/20220122paihupai/"/>
      <url>/2022/01/25/20220122paihupai/</url>
      
        <content type="html"><![CDATA[<h1 id="20200122拍到沪牌啦"><a href="#20200122拍到沪牌啦" class="headerlink" title="20200122拍到沪牌啦"></a>20200122拍到沪牌啦</h1><p>周六早早到公司加班，这周其实一直有看闲鱼卖车的。12点左右觉得差不多就出来了吧，就上app上看了下，小心翼翼。但是看到的界面和往常不一样，居然真中了，我第一时间还是不敢相信，确认了下，激动地喊出来了。</p><p>我上个月本来想9999套餐，最终觉得牙齿花太多，改成5500的六个月，居然省下来了。想想不能急，赶紧挨个打电话过去。先给老婆打电话，这货也开心，不过也觉得好多钱要花了。然后打电话给老妈，跟家人说，老妈说给我们香火祝愿，等会要回去还愿，告诉观音中了。老妈说9w大家凑一凑，直接还掉，不要贷款了。过了一会，我还是决定贷款，因为年终奖还没发，车牌钱，这周就要拿出来，算了，选6个月的。有打电话给推荐拍牌的哥们，店铺赔给他好多钱，还没中，我倒是中了，哈哈。打电话给同桌，嘿嘿，改天一起去找找二手车。</p><h2 id="走贷款"><a href="#走贷款" class="headerlink" title="走贷款"></a>走贷款</h2><p>直接在app上找，因为我还算凑得出钱，就选的中国银行6个月。过没一会，别的银行打电话过来，我以为是中国银行，无情拒绝，毕竟不是app推荐，不太放心。</p><p>周末中国银行打电话说在住处附近不远办理，周一上午赶紧和老婆和上司说了晚会到，办理下东西。到了那里二楼，我签字，丫头签字，拍照，又把丫头卖了一遍。搞好两人赶紧回公司，啊，挺冷的，电瓶车。</p><p>周二早上就说通过了贷款，当前就等统一打款后去领额度啦，哈哈。</p><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>这几天想了想，每天至少30，有点多，我估计在还款有点难受(车牌、房子首付借款、房贷)。之后生病一定小心，不然就没钱了。</p><p>在闲鱼发了下说把拍照租出去，得，被举报。我用的词还被人抄了，一模一样，我写错字人家都懒得改，这样人家都没被举报，我去。</p><p>但是最近想想，车牌不就是配车的嘛，有机会去淘些二手车，开一段时间，然后再卖掉，再换，哈哈。</p><p>最近先去小区排队，不然放车临时的好贵。</p><p>明年好好赚钱咯，赶紧把欠贷还掉，给家人多攒点钱，安安稳稳了，现在。</p><h2 id="过年前一天领取牌照"><a href="#过年前一天领取牌照" class="headerlink" title="过年前一天领取牌照"></a>过年前一天领取牌照</h2><p>最后一天上班，公司中午放假，正好下午去领取牌照。中午先回家，留下公司吃剩下的披萨给猴子吃。车子已走了15公里，直接出发去福州路108号。</p><p>本来以为一下就到了，应该不远。但是内环路有小有车多，红绿灯也超级多，而且都开到东方明珠了。冷，但是激动啊，今天老子是去领车牌额度的。</p><p>到了后，这就是法租界附近的楼群，气派，楼外还有小哥拦人问是否拍车牌，精准打击: 那些线下来问车牌拍卖的，肯定有机会找这小哥代拍。但是现在大多数都引流到线上办理拍牌。进去后，以为走错，里面都是各种拍卖砖石；手表；包包等等。进入到里堂拿号，等待叫号。有个特点，暖和，空调开的是超级暖和的。</p><p>个人车牌叫号慢，公司快，不晓得为啥。叫到号后，上前出示身份证即可。工作人员在一大扎票票里面找到了我的那张，然后携带着本次拍牌未中奖发票和一个信封给到我。就这样结束了。外边还有什么拍中车牌纪念物等等，都是无关痛痒的。出发回去，拍的时候激动，那10s，找代拍拍中后也激动，到手了就没那么激动了。兴奋值一下就没了。</p><p>回去想了很多，车子男人肯定喜欢啊，但是，花费还是很高的。打听了相关租车牌、买车随车租等等，其实主要还是保值+自己出行方便。缺点肯定也是有的，对于刚起步的我来说，停车费用、保险费用、用车费用等。当前还是市内通行，其实能载人的话，黄A更合适，但是黄A贵啊，而且只能载一个人，冬夏天、雨天也都难受。但是停车是真的超级方便，绝对不堵车，直接中间穿过去就好了，看到停着电瓶车的，也是直接怼进去就好了，给力。嗯，有点想要个蓝A，或者黄A。有钱肯定黄A搞起。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 拍沪牌 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220124brew_install</title>
      <link href="/2022/01/24/20220124brew-install/"/>
      <url>/2022/01/24/20220124brew-install/</url>
      
        <content type="html"><![CDATA[<h1 id="brew-install-问题集锦"><a href="#brew-install-问题集锦" class="headerlink" title="brew install 问题集锦"></a>brew install 问题集锦</h1><p>20220124 使用brew安装ffmpeg, 由于黑苹果brew 很久没更新，导致很多包很能下，特此记录.</p><h2 id="证书过期"><a href="#证书过期" class="headerlink" title="证书过期"></a>证书过期</h2><p>首先遇到证书过期问题:</p><p>原因是本地openssl 有两个库。当时使用curl 忽略https 证书问题下载了<a href="mailto:openssl@1.0" target="_blank" rel="noopener">openssl@1.0</a>(<code>HOMEBREW_CURLRC=1 brew install openssl@1.0</code>), 然后使用软链接(<code>ln -sfn /usr/local/opt/openssl@1.0 /usr/local/opt/openssl</code>)挂钩。</p><p>后由于太麻烦，还是使用的ffmpeg</p><pre><code>echo &quot;--insecure&quot; &gt; ~/.curlrc &amp;&amp; HOMEBREW_CURLRC=1 &amp;&amp; export HOMEBREW_CURLRC 将配置写入调用brew 时: HOMEBREW_CURLRC=1 brew install ffmpeg</code></pre><h2 id="其中isl库下载地址无了"><a href="#其中isl库下载地址无了" class="headerlink" title="其中isl库下载地址无了!"></a>其中isl库下载地址无了!</h2><p>下载地址无了，我先找到另一个下载点，配置并make install 了(tar -jxvf isl-0.24.tar.xz &amp;&amp; cd isl-0.24 &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install)，但是我重新install ffmpeg 还是会卡在那.</p><p>使用brew edit isl，修改里面的url 为目标地址，这样就能够识别了。记得对比下sha 256(<code>shasum -a 256 ${filepath}</code>)</p><h2 id="git-库下载报错"><a href="#git-库下载报错" class="headerlink" title="git 库下载报错"></a>git 库下载报错</h2><p><code>Cloning into SSL certificate problem: certificate has expired</code></p><p>解决方法: <code>git config --global http.sslVerify false</code>， 关闭部分ssh校验</p><h2 id="其他库下载出现网络断掉问题"><a href="#其他库下载出现网络断掉问题" class="headerlink" title="其他库下载出现网络断掉问题"></a>其他库下载出现网络断掉问题</h2><p>单独下载对应的库，下次下载时，会略过该库。</p>]]></content>
      
      
      
        <tags>
            
            <tag> brew_install </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220119hr</title>
      <link href="/2022/01/19/20220119hr/"/>
      <url>/2022/01/19/20220119hr/</url>
      
        <content type="html"><![CDATA[<h1 id="2022年01月人力资源做错思考回顾"><a href="#2022年01月人力资源做错思考回顾" class="headerlink" title="2022年01月人力资源做错思考回顾"></a>2022年01月人力资源做错思考回顾</h1><ul><li>对人员绩效考评中应该有所预估，如果是有问题，有所动作的基础上。应该正确处理绩效考评数值，不做得过且过给予分数。</li><li>跟人员的交流中，要占据主动方。表达不好的点应该无限放大错误带来的影响，强硬强调自己的立场，主观上更加能主动站住立场。</li><li>如果对方在绩效中的确有问题，那么应该坚持己见，早过打算。并且应该找到hr，以其为主导人，我为中间人进行交涉(合作之前先想到对答过程及可能的预算和可能的最坏情况，如果是最坏情况，需要和上级及时沟通)。</li><li>对来年度可能有离职倾向的员工，应预估提前交流，如果有此打算，则应该保留有年终奖分红限度。不如将更多红利给当前的员工。</li><li>对于对方在明显站不住脚的情况下，谈判立场应该化被动为主动。</li></ul><p>比如对方问你现在怎么处理，那就回答你说现在情况大家都清楚了，既然已经到这地步了，肯定也是回不去。当前签完就走，而不是一直拖着。对方说，那不能这么处理，公司有什么打算。回答说，公司打算还得看你现在怎么说；你比如说主动提离职，那就继续聊(前提是前置处理措施公司漏了，比如绕过了人事，研发给了些不对的好处)；如果是公司辞你，那就没有好处，并且如果是下个公司审核打电话来公司，公司也不会给与好的回复，走正常流程就是。</p><p>这样就把被动选择权给到对方去选择。选择公司辞你，那就走正当的交涉；一般人都走主动提离职，那就是看什么条件，你选择什么要求。能不能达到就看上面的回复了。</p><p>这次我做的不对的是:</p><ol><li><p>绩效在当时没有回顾到年终可能辞走人的思考，给对方加了不少分，而且还是关键分。导致我在谈判的时候多了些顾虑。</p></li><li><p>当时谈判的时候，拉绩效单，我手动填写，其实这时就可以修改该分值。我也没有脑子(最近忙东西没睡好觉?有点)，写成之前调剂分值的分数了。</p></li><li><p>上面的顾虑，导致我在谈判时，少了很多主动性，而且我还不断给其些许福利，这是我做的更不对的地方！！！我应该更成熟，而不是还是小男孩的心理！！！</p></li><li><p>我在谈判的时候hr应该站出来做主动性，我从旁协助才是，不应该我成为了主导了。可能我主导的时候会多少占有一些心理。</p></li><li><p>关于人员的绩效，一定遵循能力多少享受多少，有开人行为需要第一时间介入。最好风险把控在试用期间。</p></li></ol><p>以上是我当时的错，路上反思还有，但是未记录下来，有空回顾时再补充。有错，思想、逻辑、执行有误一定要及时纠正!!!</p>]]></content>
      
      
      
        <tags>
            
            <tag> hr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220112lispy</title>
      <link href="/2022/01/12/20220112lispy/"/>
      <url>/2022/01/12/20220112lispy/</url>
      
        <content type="html"><![CDATA[<h1 id="编译原理"><a href="#编译原理" class="headerlink" title="编译原理"></a>编译原理</h1><p>之前学过输入语法转AST，AST转换另一种语法格式。这其实是自然语言组织能力，比如中文转成英文来说。</p><p>语言是表达能力，计算机操作需要在表达能力上，实现语法格式并能操作运行。</p><p>当前篇幅用于描述学习文章: <code>BuildYourOwnLisp</code> 过程中遇到的点，过程。这个系列会出多个文章描述，会对应到学习文章对应的章节。</p><h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><p><code>BuildYourOwnLisp</code> 这篇文章在目前我学习入门c 里面是相当之精妙的，各种用法都是灵活运用，前提还是需要c 语言基础的，基础部分看<a href="2021/11/30/2021learnc/">learnc</a>。</p><p>基础入门之后，就可以在这篇文章带领下学学c 的深入使用，并且可以感受到编译原理的基础。</p><p>里面用到<code>mpc</code>的库，这个库是剥离AST表达式的点，然后直接学习真实的制作一门小型语言。<code>mpc</code>后期我会再出一篇文章，并且以此修改自己的程序以支持。</p><p>之前在豆瓣上看到有人评论说到该篇文章精髓都在mpc 里面，其实是不对的，这是两个阶段，两个层面。</p><p>好了，不多说了，直接进入正式环节。</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>分析 buildyourownlisp 这本书，我们从大致的大纲开始。</p><ol><li>mpc 库解析用户输入，词法分析后得到mpc 自带的ast 树形结构。</li><li>使用mpc_ast_t 得到带有tag、content 的属性进入到 <code>lval*(*lval_read)(mpc_ast_t*)</code> 方法进行转换成lval对应结构</li><li>使用已转换过结构的lval 传递给下一个方法: <code>lval*(*lval_eval)(lenv*, lval*)</code></li><li><code>lval* (*lval_expr_eval)(lenv*, lval*)</code> 内部执行波兰式语句.</li></ol><p>上面即为前11章内容，第10章Q-Expression - Quote 表达式将Symbol 某个统一入口方法识别。</p><p>第11章开始，带入lenv 环境变量的逻辑。前11章之前，都是很好理解，我们直接从方法实现往下。</p><p>我们先讲完前10章，感受下简单。第11章将会第10章之后衔接。</p><h2 id="lval-read"><a href="#lval-read" class="headerlink" title="lval_read"></a>lval_read</h2><p>(跳过 mpc库使用，这个库在一开始使用后，都不再在本篇幅出现。)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">mpc_parser_t</span>* Number = mpc_new(<span class="string">"number"</span>);</span><br><span class="line">  <span class="keyword">mpc_parser_t</span>* Symbol = mpc_new(<span class="string">"symbol"</span>);</span><br><span class="line">  <span class="keyword">mpc_parser_t</span>* Sexpr = mpc_new(<span class="string">"sexpr"</span>);</span><br><span class="line">  <span class="keyword">mpc_parser_t</span>* Expr = mpc_new(<span class="string">"expr"</span>);</span><br><span class="line">  <span class="keyword">mpc_parser_t</span>* Lispy = mpc_new(<span class="string">"lispy);</span></span><br><span class="line"><span class="string">  mpca_lang(MPCA_LANG_DEFAULT,</span></span><br><span class="line"><span class="string">    "</span>                                            \</span><br><span class="line">    number : /-?[<span class="number">0</span><span class="number">-9</span>]+/ ; \</span><br><span class="line">    symbol : <span class="string">'+'</span> | <span class="string">'-'</span> | <span class="string">'*'</span> | <span class="string">'/'</span> ; \</span><br><span class="line">    sexpr : <span class="string">'('</span> &lt;expr&gt;* <span class="string">')'</span> ; \</span><br><span class="line">    expr : &lt;number&gt; | &lt;symbol&gt; | &lt;sexpr&gt; ; \</span><br><span class="line">    lispy : /^/ &lt;expr&gt;* /$/ ;</span><br><span class="line">    <span class="string">",</span></span><br><span class="line"><span class="string">    Number, Symbol, Sexpr, Expr, Lispy);</span></span><br><span class="line"><span class="string">  puts("</span>Lispy Version <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="number">.5</span><span class="string">");</span></span><br><span class="line"><span class="string">  while (1) &#123;</span></span><br><span class="line"><span class="string">    char* input = readline("</span>lispy&gt; <span class="string">");</span></span><br><span class="line"><span class="string">    add_history(input);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mpc_result_t r;</span></span><br><span class="line"><span class="string">    if (mpc_parse("</span>&lt;<span class="built_in">stdin</span>&gt;<span class="string">", input, Lispy, &amp;r)) &#123;</span></span><br><span class="line"><span class="string">      lval* val = lval_read(r.output);</span></span><br><span class="line"><span class="string">      lval* x = lval_eval(val);</span></span><br><span class="line"><span class="string">      lval_println(x);</span></span><br><span class="line"><span class="string">      lval_del(x);</span></span><br><span class="line"><span class="string">      mpc_ast_delete(r.output);</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      mpc_err_print(r.error);</span></span><br><span class="line"><span class="string">      mpc_err_delete(r.error);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    free(input);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  mpc_cleanup(5, Number, Symbol, Sexpr, Expr, Lispy);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>以上还会增加Q表达式、识别String、Comment 输入等。</p><p>我们直接从S表达式开始。</p><p>lval_read 我愿意拆开来, S表达式、Q表达式放到一起: lval_expr_read，其他走 lval_read.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FORLESS(lessCount) for (int i = 0; i &lt; lessCount; i++)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strlength</span><span class="params">(<span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strlen</span>(s)+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> &#123; LVAL_ERR, LVAL_NUM, LVAL_SYM, LVAL_SEXPR, LVAL_QEXPR &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lval</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">lval</span> <span class="title">lval</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lval</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> type;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">long</span> num;</span><br><span class="line">  <span class="keyword">char</span>* err;</span><br><span class="line">  <span class="keyword">char</span>* sym;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> count;</span><br><span class="line">  lval** cell;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NEWLVAL lval* v = malloc(sizeof(lval));</span></span><br><span class="line"></span><br><span class="line"><span class="function">lval* <span class="title">lval_err</span><span class="params">(<span class="keyword">char</span>* err)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_ERR;</span><br><span class="line">  v-&gt;err = <span class="built_in">malloc</span>(strlength(err));</span><br><span class="line">  <span class="built_in">strcpy</span>(v-&gt;err, err);</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_num</span><span class="params">(<span class="keyword">long</span> num)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_NUM;</span><br><span class="line">  v-&gt;num = num;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_check_num</span><span class="params">(<span class="keyword">char</span>* numstr)</span> </span>&#123;</span><br><span class="line">  errno = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// 10进制转换，如果错误、out of range 则errno会报错</span></span><br><span class="line">  <span class="keyword">long</span> num = strtol(numstr, <span class="literal">NULL</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> errno != <span class="number">0</span> ? lval_err(<span class="string">"Invalid number!"</span>) : lval_num(num);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_sexpr</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_SEXPR;</span><br><span class="line">  v-&gt;count = <span class="number">0</span>;</span><br><span class="line">  v-&gt;cell = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_qexpr</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_QEXPR;</span><br><span class="line">  v-&gt;count = <span class="number">0</span>;</span><br><span class="line">  v-&gt;cell = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// lval删除内存空间:</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_del</span><span class="params">(lval* v)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_expr_del</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    lval_del(v-&gt;cell[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(v-&gt;cell);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_del</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_NUM: <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_ERR: <span class="built_in">free</span>(v-&gt;err); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SYM: <span class="built_in">free</span>(v-&gt;sym); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SEXPR: lval_expr_del(v); <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">lval* <span class="title">lval_read</span><span class="params">(<span class="keyword">mpc_ast_t</span>* t)</span></span>;</span><br><span class="line"><span class="comment">// 识别 &gt;(program)、sexpr、qexpr</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_read</span><span class="params">(<span class="keyword">mpc_ast_t</span>* t)</span> </span>&#123;</span><br><span class="line">  lval* x;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t.tag, <span class="string">"&gt;"</span>) == <span class="number">0</span>) &#123; x = lval_sexpr(); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strstr</span>(t.tag, <span class="string">"sexpr"</span>)) &#123; x = lval_sexpr(); &#125;</span><br><span class="line">  <span class="comment">// 将子借点数据添加进x，如果子节点也是其他表达式，则也会被纳入x</span></span><br><span class="line">  FORLESS(t-&gt;children_num) &#123;</span><br><span class="line">    <span class="comment">// 过滤无用字符</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;children[i]-&gt;content, <span class="string">"("</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;children[i]-&gt;content, <span class="string">")"</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;children[i]-&gt;content, <span class="string">"&#123;"</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;children[i]-&gt;content, <span class="string">"&#125;"</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="comment">// 过滤mpc 带有的regex字符</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;children[i]-&gt;tag, <span class="string">"regex"</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    x = lval_add(x, lval_read(t-&gt;children[i]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 单独处理number / symbol 的转换</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_read</span><span class="params">(<span class="keyword">mpc_ast_t</span>* t)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strstr</span>(t-&gt;tag, <span class="string">"number"</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> lval_check_num(t-&gt;content);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strstr</span>(t-&gt;tag, <span class="string">"symbol"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> lval_symbol(t-&gt;content);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其他交给lval_expr_read</span></span><br><span class="line">  <span class="keyword">return</span> lval_expr_read(t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_print</span><span class="params">(lval* v)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_expr_print</span><span class="params">(lval* v, <span class="keyword">char</span> open, <span class="keyword">char</span> close)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">putchar</span>(open);</span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    lval_print(v-&gt;cell[i]);</span><br><span class="line">    <span class="keyword">if</span> (i != (v-&gt;count<span class="number">-1</span>)) &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(<span class="string">' '</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">putchar</span>(close);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_print</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_NUM: <span class="built_in">printf</span>(<span class="string">"%i"</span>, v-&gt;num); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_ERR: <span class="built_in">printf</span>(<span class="string">"%s"</span>, v-&gt;err); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SYM: <span class="built_in">printf</span>(<span class="string">"%s"</span>, v-&gt;sym); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_FUN: <span class="built_in">printf</span>(<span class="string">"&lt;Function&gt;"</span>); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SEXPR: lval_expr_print(v, <span class="string">'('</span>, <span class="string">')'</span>); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_QEXPR: lval_expr_print(v, <span class="string">'&#123;'</span>, <span class="string">'&#125;'</span>); <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_println</span><span class="params">(lval* v)</span> </span>&#123; lval_print(v); <span class="built_in">putchar</span>(<span class="string">'\n'</span>); &#125;</span><br></pre></td></tr></table></figure><p>以上还有 <code>lval*(*lval_add)(lval* x, lval* a)</code>，其将a加入到x的cell中:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">lval* <span class="title">lval_add</span><span class="params">(lval* x, lval* a)</span> </span>&#123;</span><br><span class="line">  x-&gt;count++;</span><br><span class="line">  x-&gt;cell = <span class="built_in">realloc</span>(x-&gt;cell, <span class="keyword">sizeof</span>(lval*)*x-&gt;count);</span><br><span class="line">  x-&gt;cell[x-&gt;count<span class="number">-1</span>] = a;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在开始使用lval_eval, lval_eval 遇到S表达式，去lval_expr_eval 执行，其他原样返回:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从v(S表达式/Q表达式)中取出其cell中的第i个元素</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_pop</span><span class="params">(lval* v, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 拿到指针</span></span><br><span class="line">  lval* x = v-&gt;cell[i];</span><br><span class="line">  <span class="comment">// 通过内存折叠，去掉这个空位</span></span><br><span class="line">  <span class="comment">// 也可以写作: lval** a = &amp;v-&gt;cell[i]; lval** b = &amp;v-&gt;cell[i+1]; memmove(a, b, ...);</span></span><br><span class="line">  memmove(&amp;v-&gt;cell[i], &amp;v-&gt;cell[i+<span class="number">1</span>], <span class="keyword">sizeof</span>(lval*)*(v-&gt;count-i<span class="number">-1</span>));</span><br><span class="line">  <span class="comment">// 由于折叠了一个元素，realloc v-&gt;cell</span></span><br><span class="line">  v-&gt;count--;</span><br><span class="line">  v-&gt;cell = <span class="built_in">realloc</span>(v-&gt;cell, <span class="keyword">sizeof</span>(lval*)*v-&gt;count);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// take动作是pop之后，删除v，不需要v了</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_take</span><span class="params">(lval* v, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  lval* x = lval_pop(v, i);</span><br><span class="line">  lval_del(x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这个LASSERT也是精髓</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LASSERT(arg, cond, err) <span class="meta-keyword">if</span> (!(cond)) &#123; lval_del(arg); return lval_err(err); &#125;</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_op</span><span class="params">(lval* v, <span class="keyword">char</span>* op)</span> </span>&#123;</span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    LASSERT(v, v-&gt;cell[i]-&gt;type == LVAL_NUM, <span class="string">"Function op passed invalid format type"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 拿出第一个参数来做运算。之后会销毁其他所有内存对象</span></span><br><span class="line">  lval* x = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 如果没有其他参数，而且op为-, 则表示该对象为取反</span></span><br><span class="line">  <span class="keyword">if</span> (v-&gt;count == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(op, <span class="string">"-"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    x-&gt;num = -x-&gt;num;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 轮训v</span></span><br><span class="line">  <span class="keyword">while</span> (v-&gt;count) &#123;</span><br><span class="line">    lval* y = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"+"</span>) == <span class="number">0</span>) &#123; x-&gt;num += y-&gt;num; &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"-"</span>) == <span class="number">0</span>) &#123; x-&gt;num -= y-&gt;num; &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"*"</span>) == <span class="number">0</span>) &#123; x-&gt;num *= y-&gt;num; &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"/"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 除数不能为0</span></span><br><span class="line">      <span class="keyword">if</span> (y-&gt;num == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 这里复用x的指针</span></span><br><span class="line">        lval_del(x); lval_del(y);</span><br><span class="line">        x = lval_err(<span class="string">"Division By Zero!"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      x-&gt;num /= y-&gt;num;</span><br><span class="line">    &#125;</span><br><span class="line">    lval_del(y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 删除v</span></span><br><span class="line">  lval_del(v);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_eval</span><span class="params">(lval* v)</span></span>;</span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_eval</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 进入到执行阶段，首先将子集全部执行。</span></span><br><span class="line">  <span class="comment">// 这样如果他是S表达式，其会先处理内部的数据，得到答案后返回给外层，再统一结算，得到最终结果</span></span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    v-&gt;cell[i] = lval_eval(v-&gt;cell[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 测试如果出现LVAL_ERR，则直接返回该err</span></span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    <span class="keyword">if</span> (v-&gt;cell[i]-&gt;type == LVAL_ERR) &#123;</span><br><span class="line">      <span class="keyword">return</span> lval_take(v, i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 判断是否S表达式为空，或者只有一个，都直接返回</span></span><br><span class="line">  <span class="keyword">if</span> (v-&gt;count == <span class="number">0</span>) <span class="keyword">return</span> v;</span><br><span class="line">  <span class="keyword">if</span> (v-&gt;count == <span class="number">1</span>) <span class="keyword">return</span> lval_take(v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 拿出第一个元素，第一个元素必定是 LVAL_SYM</span></span><br><span class="line">  lval* f = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (f-&gt;type != LVAL_SYM) &#123;</span><br><span class="line">    lval_del(f); lval_del(v); <span class="keyword">return</span> lval_err(<span class="string">"S-Expression must start with Symbol!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 这里就是结果了</span></span><br><span class="line">  lval* res = buildin_op(v, f-&gt;sym);</span><br><span class="line">  <span class="comment">// 此处仅释放f；v的释放由buildin_op处理。</span></span><br><span class="line">  <span class="comment">// 原因是接下来还有好多buildin_x 内部要处理v，都有内部去控制删除了。</span></span><br><span class="line">  lval_del(f);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_eval</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (v-&gt;type == LVAL_SEXPR) <span class="keyword">return</span> lval_expr_eval(v);</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="S-Expression"><a href="#S-Expression" class="headerlink" title="S-Expression"></a>S-Expression</h2><p>S表达式指的是 <code>(...)</code> 这种格式的内容，S表达式内涵其他表达式，他在eval 中一遇到就会被执行，而且是一直往内层执行，返回结果给外层计算。</p><p>上面的使用方式就包括了S表达式，这里不重述。</p><p>对应buildyourownlisp 中的第9章。这个做完你能得到基本多层运算规则。+-*/ 计算器。</p><p>学完这章，你可以做到:</p><pre><code>+ 1 (* 7 5) 3(- 100)/</code></pre><h2 id="Q-Expression"><a href="#Q-Expression" class="headerlink" title="Q-Expression"></a>Q-Expression</h2><p>Q表达式指的是 <code>{...}</code>这种格式的内容，他如果需要被执行，则需要其他的buildin方法辅助主动执行，否则其只是对元素等进行挂载保存，直到收到buildin方法。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123; LVAL_ERR, ... LVAL_QEXPR &#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_qexpr</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_QEXPR;</span><br><span class="line">  v-&gt;count = <span class="number">0</span>;</span><br><span class="line">  v-&gt;cell = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_del</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">case</span> LVAL_SEXPR:</span><br><span class="line">    <span class="keyword">case</span> LVAL_QEXPR:</span><br><span class="line">      lval_expr_del(v);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_read</span><span class="params">(<span class="keyword">mpc_ast_t</span>* t)</span> </span>&#123;</span><br><span class="line">  lval* x;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(t-&gt;tag, <span class="string">"&gt;"</span>) == <span class="number">0</span>) &#123; x = lval_sexpr(); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strstr</span>(t-&gt;tag, <span class="string">"sexpr"</span>)) &#123; x = lval_sexpr(); &#125;</span><br><span class="line">  <span class="comment">// 增加识别Q表达式</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strstr</span>(t.tag, <span class="string">"qexpr"</span>)) &#123; x = lval_qexpr(); &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 同时lval_print 增加识别Q表达式打印</span></span><br></pre></td></tr></table></figure><p>以上是Q表达式的录入方案，他就是为了能将自己保存到Q表达式里面，等待被执行。从这里也可以很明显区分出S表达式-Q表达式的区别: S表达式在lval_eval中直接执行；Q表达式相当于元素，直接放回。</p><p>以下开始实现Q表达式执行:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首先改造lval_err</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_err</span><span class="params">(<span class="keyword">char</span>* fmt, ...)</span> </span>&#123;</span><br><span class="line">    NEWLVAL;</span><br><span class="line">    v-&gt;type = LVAL_ERR;</span><br><span class="line">    va_list va;</span><br><span class="line">    va_start(va, fmt);</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> ERR_LENGTH = <span class="number">512</span>;</span><br><span class="line">    v-&gt;err = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*ERR_LENGTH);</span><br><span class="line">    vsnprintf(v-&gt;err, ERR_LENGTH<span class="number">-1</span>, fmt, va);</span><br><span class="line">    v-&gt;err = <span class="built_in">realloc</span>(v-&gt;err, <span class="keyword">sizeof</span>(<span class="keyword">char</span>)*strlength(v-&gt;err));</span><br><span class="line">    va_end(va);</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">ltype_name</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_ERR: <span class="keyword">return</span> <span class="string">"&lt;Error&gt;"</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_NUM: <span class="keyword">return</span> <span class="string">"&lt;Number&gt;"</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SYM: <span class="keyword">return</span> <span class="string">"&lt;Symbol&gt;"</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SEXPR: <span class="keyword">return</span> <span class="string">"&lt;S-Expression&gt;"</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_QEXPR: <span class="keyword">return</span> <span class="string">"&lt;Q-Expression&gt;"</span>;</span><br><span class="line">    <span class="keyword">default</span>: <span class="keyword">return</span> <span class="string">"&lt;Unknown Function&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 改造LASSERT ##__VA_ARGS__ 粘性宏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LASSERT(arg, cond, fmt, ...) <span class="meta-keyword">if</span> (!(cond)) &#123; lval* err = lval_err(fmt, ##__VA_ARGS__); lval_del(arg); return err; &#125;</span></span><br><span class="line"><span class="comment">// 增加几个帮助宏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LASSERT_NUM(func, arg, expect) LASSERT(arg, arg-&gt;count == expect, <span class="meta-string">"Function '%s' passed invalid number of argument. "</span> \</span></span><br><span class="line">  <span class="string">"Got %i, Expected %i"</span>, func, arg-&gt;count, expect)</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LASSERT_TYPE(func, arg, i, expect) LASSERT(arg, arg-&gt;cell[i]-&gt;type == expect, <span class="meta-string">"Function '%s' passed invalid type at index: %i. "</span> \</span></span><br><span class="line">  <span class="string">"Got %s, Expected %s"</span>, func, i, ltype_name(arg-&gt;cell[i]-&gt;type), ltype_name(expect))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LASSERT_NOT_EMPTY(func, arg, i) LASSERT(arg, arg-&gt;cell[i]-&gt;count != 0, <span class="meta-string">"Function '%s' at index:%i passed '&#123;&#125;' empty arguments!"</span>, func, i)</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_head</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  LASSERT_NUM(<span class="string">"head"</span>, v, <span class="number">1</span>);</span><br><span class="line">  LASSERT_TYPE(<span class="string">"head"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  LASSERT_NOT_EMPTY(<span class="string">"head"</span>, v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// take拿出该Qexpr, 形如将v删除</span></span><br><span class="line">  lval* x = lval_take(v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 将除0 以外的元素清空</span></span><br><span class="line">  <span class="keyword">while</span> (x-&gt;count &gt; <span class="number">1</span>) &#123; lval_del(lval_pop(x, <span class="number">1</span>)); &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_tail</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  LASSERT_NUM(<span class="string">"tail"</span>, v, <span class="number">1</span>);</span><br><span class="line">  LASSERT_TYPE(<span class="string">"tail"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  LASSERT_NOT_EMPTY(<span class="string">"tail"</span>, v, <span class="number">0</span>);</span><br><span class="line">  lval* x = lval_take(v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 删除第0个，其他保留</span></span><br><span class="line">  lval_del(lval_pop(x, <span class="number">0</span>));</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 直接将元素改为Q表达式</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_list</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  v-&gt;type = LVAL_QEXPR;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_eval</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  LASSERT_NUM(<span class="string">"eval"</span>, v, <span class="number">1</span>);</span><br><span class="line">  LASSERT_TYPE(<span class="string">"eval"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  lval* x = lval_take(v, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 先改为S表达式</span></span><br><span class="line">  x-&gt;type = LVAL_SEXPR;</span><br><span class="line">  <span class="comment">// 运行该表达式</span></span><br><span class="line">  <span class="keyword">return</span> lval_eval(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 作用是把多个元素合并为一个，全部拼接</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_join</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  FORLESS(v-&gt;count) &#123;</span><br><span class="line">    LASSERT_TYPE(<span class="string">"join"</span>, v, i, LVAL_QEXPR);</span><br><span class="line">  &#125;</span><br><span class="line">  lval* x = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">while</span> (v-&gt;count) &#123;</span><br><span class="line">    lval* y = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (y-&gt;count) &#123;</span><br><span class="line">      <span class="comment">// 将内部元素依次加到x中</span></span><br><span class="line">      x = lval_add(lval_pop(y, <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    lval_del(y);</span><br><span class="line">  &#125;</span><br><span class="line">  lval_del(v);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin</span><span class="params">(lval* v, <span class="keyword">char</span>* op)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"head"</span>) == <span class="number">0</span>) &#123; <span class="keyword">return</span> buildin_head(v); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"tail"</span>) == <span class="number">0</span>) &#123; <span class="keyword">return</span> buildin_tail(v); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"list"</span>) == <span class="number">0</span>) &#123; <span class="keyword">return</span> buildin_list(v); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"eval"</span>) == <span class="number">0</span>) &#123; <span class="keyword">return</span> buildin_eval(v); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"join"</span>) == <span class="number">0</span>) &#123; <span class="keyword">return</span> buildin_join(v); &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strstr</span>(<span class="string">"+-*/"</span>, op)) &#123; <span class="keyword">return</span> buildin_op(v); &#125;</span><br><span class="line">  lval_del(v);</span><br><span class="line">  <span class="keyword">return</span> lval_err(<span class="string">"UnKnown Function: %s"</span>, op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_eval</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  lval* res = buildin(v, f-&gt;sym);</span><br><span class="line">  <span class="comment">// lval* res = buildin_op(v, f-&gt;sym);</span></span><br><span class="line">  lval_del(f);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上就是Q表达式。</p><p>这章结束，你可以实现如:</p><pre><code>list 1 2 3 4{head (list 1 2 3 4)}eval { head (list 1 2 3 4) }tail { tail tail tail }eval (tail { tail tail { 5 6 7 } } )eval (head {(+ 1 2) (+ 10 20)})</code></pre><h2 id="lenv"><a href="#lenv" class="headerlink" title="lenv"></a>lenv</h2><p>这章开始，更牛逼的来了: 环境变量的引入！</p><p>首先enum 增加 LVAL_FUN，其作用是在 lval_expr_eval中原先是Symbol的类型，改为获取为了LVAL_FUN:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 增加LVAL_FUN 类型</span></span><br><span class="line"><span class="keyword">enum</span> &#123; ... LVAL_FUN &#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lenv</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> lenv lenv;</span><br><span class="line"><span class="keyword">typedef</span> lval*(*lbuildin)(lenv* e, lval* v);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lval</span> &#123;</span></span><br><span class="line">  ...</span><br><span class="line">  lbuildin fun;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lval_del</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">case</span> LVAL_FUN: <span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_fun</span><span class="params">(lbuilin fun)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_FUN;</span><br><span class="line">  v-&gt;fun = fun;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 增加lval_copy 为lval 做copy使用</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_copy</span><span class="params">(lval* a)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = a-&gt;type;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_NUM: v-&gt;num = a-&gt;num; <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_FUN: v-&gt;fun = a-&gt;fun; <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_ERR: v-&gt;err = <span class="built_in">malloc</span>(strlength(a-&gt;err)); <span class="built_in">strcpy</span>(v-&gt;err, a-&gt;err); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SYM: v-&gt;sym = <span class="built_in">malloc</span>(strlength(a-&gt;sym)); <span class="built_in">strcpy</span>(v-&gt;sym, a-&gt;sym); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LVAL_SEXPR:</span><br><span class="line">    <span class="keyword">case</span> LVAL_QEXPR:</span><br><span class="line">      v-&gt;count = a-&gt;count;</span><br><span class="line">      v-&gt;cell = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(lval*)*v-&gt;count);</span><br><span class="line">      FORLESS(v-&gt;count) &#123;</span><br><span class="line">        <span class="comment">// 将a所有子集复制到v中</span></span><br><span class="line">        v-&gt;cell[i] = lval_copy(a-&gt;cell[i]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 增加lenv 结构</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lenv</span> &#123;</span></span><br><span class="line">  <span class="comment">// 环境变量中保存所有syms 和所有vals 数据</span></span><br><span class="line">  <span class="keyword">int</span> count;</span><br><span class="line">  <span class="keyword">char</span>** syms;</span><br><span class="line">  lval** vals;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_del</span><span class="params">(lenv* e)</span> </span>&#123;</span><br><span class="line">  FORLESS(e-&gt;count) &#123;</span><br><span class="line">    <span class="built_in">free</span>(e-&gt;syms[i]);</span><br><span class="line">    lval_del(e-&gt;vals[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// lenv_get 作用是lval_eval 在类型为symbol时查找对应的实际数据的拷贝。</span></span><br><span class="line"><span class="comment">// 避免直接使用symbol在执行时需要硬编码。可以分开实现。</span></span><br><span class="line"><span class="comment">// 这里采用轮训方式，简单实现为主，没有使用hash table</span></span><br><span class="line"><span class="function">lval* <span class="title">lenv_get</span><span class="params">(lenv* e, lval* k)</span> </span>&#123;</span><br><span class="line">  FORLESS(e-&gt;count) &#123;</span><br><span class="line">    <span class="comment">// 遇到相同的，则返回e-&gt;vals 对应数据的拷贝对象</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(e-&gt;syms[i], k-&gt;sym) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> lval_copy(e-&gt;vals[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> lval_err(<span class="string">"Unbound Function: %s"</span>, k-&gt;sym);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_put</span><span class="params">(lenv* e, lval* k, lval* v)</span> </span>&#123;</span><br><span class="line">  FORLESS(e-&gt;count) &#123;</span><br><span class="line">    <span class="comment">// 找到了就更换</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(e-&gt;syms[i], k-&gt;sym) == <span class="number">0</span>) &#123;</span><br><span class="line">      e-&gt;vals[i] = lval_copy(v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 找不到添加该元素</span></span><br><span class="line">  e-&gt;count++;</span><br><span class="line">  e-&gt;syms = rellaoc(e-&gt;syms, <span class="keyword">sizeof</span>(<span class="keyword">char</span>*)*e-&gt;count);</span><br><span class="line">  e-&gt;vals = <span class="built_in">realloc</span>(e-&gt;vals, <span class="keyword">sizeof</span>(lval*)*e-&gt;count);</span><br><span class="line">  e-&gt;syms[e-&gt;count<span class="number">-1</span>] = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*strlength(k-&gt;sym));</span><br><span class="line">  <span class="built_in">strcpy</span>(e-&gt;syms[e-&gt;count<span class="number">-1</span>], k-&gt;sym);</span><br><span class="line">  e-&gt;vals[e-&gt;count<span class="number">-1</span>] = lval_copy(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 首个参数改为lenv</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_op</span><span class="params">(lenv* e, lval* v, <span class="keyword">char</span>* op)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_head</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_tail</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_list</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_eval</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">return</span> lval_eval(e, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_join</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_add</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_op(e, v, <span class="string">"+"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_sub</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_op(e, v, <span class="string">"-"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_mul</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_op(e, v, <span class="string">"*"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_div</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_op(e, v, <span class="string">"/"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首个入参是环境变量</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_eval</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  lval* f = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (f-&gt;type != LVAL_FUN) &#123;</span><br><span class="line">    lval* err = lval_err(<span class="string">"S-Expression not start with Function! receive type: %s"</span>, ltype_name(f-&gt;type));</span><br><span class="line">    lval_del(f); lval_del(v);</span><br><span class="line">    <span class="keyword">return</span> err;</span><br><span class="line">  &#125;</span><br><span class="line">  lval* res = f-&gt;fun(e, v);</span><br><span class="line">  <span class="comment">// lval* res = buildin(v, f-&gt;sym);</span></span><br><span class="line">  <span class="comment">// lval* res = buildin_op(v, f-&gt;sym);</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_eval</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (v-&gt;type == LVAL_SYM) &#123;</span><br><span class="line">    lval* f = lenv_get(e, v);</span><br><span class="line">    lval_del(v);</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (v-&gt;type == LVAL_SEXPR) <span class="keyword">return</span> lval_expr_eval(e, v);</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义lenv_add_buildins 将lenv 环境变量添加到全文lenv中</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_add_buildin</span><span class="params">(lenv* e, <span class="keyword">char</span>* op, lbuildin fun)</span> </span>&#123;</span><br><span class="line">  lval* sym = lval_sym(op);</span><br><span class="line">  lval* funValue = lval_fun(fun);</span><br><span class="line">  lenv_put(e, sym, funValue);</span><br><span class="line">  lval_del(sym); lval_del(funValue);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_add_buildins</span><span class="params">(lenv* e)</span> </span>&#123;</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"head"</span>, buildin_head);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"tail"</span>, buildin_tail);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"list"</span>, buildin_list);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"eval"</span>, buildin_eval);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"join"</span>, buildin_join);</span><br><span class="line"></span><br><span class="line">  lenv_add_buildin(e, <span class="string">"+"</span>, buildin_add);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"-"</span>, buildin_sub);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"*"</span>, buildin_mul);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"/"</span>, buildin_div);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Lispy Version 0.0.0.0.11"</span>);</span><br><span class="line">  <span class="comment">// 创建lenv 环境变量，让其在整个生命周期中体现出环境值</span></span><br><span class="line">  lenv* e = lenv_new();</span><br><span class="line">  lenv_add_buildins(e);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">    lval* x = lval_eval(e, res);</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这里可以做到和之前一致的输入与输出，不过其执行是以上下文环境的方案查找对应的方法。重点是 lval_eval 中使用 == LVAL_SYM 找出在环境变量找出的对应的buildins 或者表达式。</p><p>下面添加一个def 来将输入的形参和实参绑定，并且也是通过lval_eval 转变出来:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// def &#123;a b c d&#125; 1 2 3 4</span></span><br><span class="line"><span class="function">lval* <span class="title">buildin_def</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  LASSERT_TYPE(<span class="string">"def"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  lval* syms = v-&gt;cell[<span class="number">0</span>];</span><br><span class="line">  FORLESS(syms-&gt;count) &#123;</span><br><span class="line">    LASSERT(v, syms-&gt;cell[i]-&gt;type == LVAL_SYM, <span class="string">"Function '%s' passed invalid format argument."</span></span><br><span class="line">    <span class="string">"Got %s, Expect %s"</span>, <span class="string">"def"</span>, ltype_name(syms-&gt;cell[i]-&gt;type), ltype_name(LVAL_SYM));</span><br><span class="line">  &#125;</span><br><span class="line">  LASSERT(v, syms-&gt;count == v-&gt;count<span class="number">-1</span>, <span class="string">"Function '%s' passed invalid number of arguments."</span></span><br><span class="line">  <span class="string">"Symbols %i, Values %i"</span>, <span class="string">"def"</span>, syms-&gt;count, v-&gt;count<span class="number">-1</span>);</span><br><span class="line">  FORLESS(syms-&gt;count) &#123;</span><br><span class="line">    lenv_put(e, syms[i], v-&gt;cell[i+<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> lval_sexpr();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_add_buildins</span><span class="params">(lenv* e)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"def"</span>, buildin_def);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一步之后，你可以做到:</p><pre><code>def {x} 100def {y} 200xy+ x ydef { a b } 5 6+ a bdef { arglist } { a b x y }arglistdef arglist 1 2 3 4list a b x y</code></pre><h2 id="第十二章-函数"><a href="#第十二章-函数" class="headerlink" title="第十二章:函数"></a><strong>第十二章:函数</strong></h2><p>这章超级重要，超级super 给力，内容不是很多，适应下。<br>这章过后，之后基本关于c的简单多了，喘口气? 别急，让我们赶紧开始吧！</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数，延续使用LVAL_FUN, 不过 lval 增加formals, 保存环境变量中的参数，body保存环境变量中的执行语句，以及增加一个lenv 作为局部变量</span></span><br><span class="line"><span class="comment">// 且LVAL_FUN中的 buildin 和函数要区分开，有lbuildin 则为内建方法，另外的则为lambda表达式:</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lval</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> type;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">long</span> num;</span><br><span class="line">  <span class="keyword">char</span>* err;</span><br><span class="line">  <span class="keyword">char</span>* sym;</span><br><span class="line"></span><br><span class="line">  lbuildin buildin; <span class="comment">// 内建方法</span></span><br><span class="line"></span><br><span class="line">  lenv* env; <span class="comment">// 对象所属局部变量</span></span><br><span class="line">  lval* formals; <span class="comment">// 参数列表</span></span><br><span class="line">  lval* body; <span class="comment">// body执行参数列表</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> count;</span><br><span class="line">  lval** cell;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_fun</span><span class="params">(lbuildin fun)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_FUN;</span><br><span class="line">  v-&gt;buildin = fun;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_lambda</span><span class="params">(lval* formals, lval* body)</span> </span>&#123;</span><br><span class="line">  NEWLVAL;</span><br><span class="line">  v-&gt;type = LVAL_FUN;</span><br><span class="line">  v-&gt;buildin = <span class="literal">NULL</span>; <span class="comment">// 记得一定置空，否则会出现野指针</span></span><br><span class="line">  v-&gt;lenv = new_lenv();</span><br><span class="line">  v-&gt;formals = formals;</span><br><span class="line">  v-&gt;body = body;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_del</span><span class="params">(lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_FUN:</span><br><span class="line">      <span class="comment">// 只需要处理def 出来的变量</span></span><br><span class="line">      <span class="keyword">if</span> (!v-&gt;buildin) &#123;</span><br><span class="line">        lenv_del(v-&gt;env);</span><br><span class="line">        lval_del(v-&gt;formals);</span><br><span class="line">        lval_del(v-&gt;body);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_copy</span><span class="params">(lval* x)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">switch</span> (v-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> LVAL_FUN:</span><br><span class="line">      <span class="comment">// x 有buildin则代表</span></span><br><span class="line">      <span class="keyword">if</span> (a-&gt;buildin) &#123;</span><br><span class="line">        v-&gt;buildin = x-&gt;buildin;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 保证buildin是NULL, 否则变出来野指针了</span></span><br><span class="line">        v-&gt;buildin = <span class="literal">NULL</span>;</span><br><span class="line">        v-&gt;env = lenv_copy(x-&gt;env);</span><br><span class="line">        v-&gt;formals = lval_copy(x-&gt;formals);</span><br><span class="line">        v-&gt;body = lval_copy(x-&gt;body);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lenv</span> &#123;</span></span><br><span class="line">  lenv* pair; <span class="comment">// 增加父环境变量</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lenv_get</span><span class="params">(lenv* e, lval* k)</span> </span>&#123;</span><br><span class="line">  FORLESS(e-&gt;count) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (e-&gt;pair) &#123;</span><br><span class="line">    <span class="keyword">return</span> lenv_get(e-&gt;pair, k);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> lval_err(<span class="string">"Unbound Symbol: %s"</span>, k-&gt;sym);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 增加一个lenv copy</span></span><br><span class="line"><span class="function">lenv* <span class="title">lenv_copy</span><span class="params">(lenv* e)</span> </span>&#123;</span><br><span class="line">  lenv* n = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(lenv));</span><br><span class="line">  n-&gt;count = e-&gt;count;</span><br><span class="line">  n-&gt;pair = e-&gt;pair;</span><br><span class="line">  n-&gt;syms = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>*)*n-&gt;count);</span><br><span class="line">  n-&gt;vals = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(lval*)*n-&gt;count);</span><br><span class="line">  FORLESS(n-&gt;count) &#123;</span><br><span class="line">      n-&gt;vals[i] = lval_copy(e-&gt;vals[i]);</span><br><span class="line">      n-&gt;syms[i] = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*strlength(e-&gt;syms[i]));</span><br><span class="line">      <span class="built_in">strcpy</span>(n-&gt;syms[i], e-&gt;syms[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_put</span><span class="params">(lenv* e, lval* k, lval* v)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// def 用在将环境变量保存在顶层。只要保证while 循环到顶层即可。</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_def</span><span class="params">(lenv* e, lval* k, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (e-&gt;pair) &#123; e = e-&gt;pair; &#125;</span><br><span class="line">  lenv_put(e, k, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_var</span><span class="params">(lenv* e, lval* v, <span class="keyword">char</span>* op)</span> </span>&#123;</span><br><span class="line">  LASSERT_TYPE(<span class="string">"def"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  lval* syms = v-&gt;cell[<span class="number">0</span>];</span><br><span class="line">  FORLESS(syms-&gt;count) &#123;</span><br><span class="line">    LASSERT(v, syms-&gt;cell[i]-&gt;type == LVAL_SYM, <span class="string">"Function '%s' passed invalid format argument."</span></span><br><span class="line">    <span class="string">"Got %s, Expect %s"</span>, <span class="string">"def"</span>, ltype_name(syms-&gt;cell[i]-&gt;type), ltype_name(LVAL_SYM));</span><br><span class="line">  &#125;</span><br><span class="line">  LASSERT(v, syms-&gt;count == v-&gt;count<span class="number">-1</span>, <span class="string">"Function '%s' passed invalid number of arguments."</span></span><br><span class="line">  <span class="string">"Symbols %i, Values %i"</span>, <span class="string">"def"</span>, syms-&gt;count, v-&gt;count<span class="number">-1</span>);</span><br><span class="line">  FORLESS(syms-&gt;count) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, <span class="string">"def"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      lenv_def(e, syms[i], v-&gt;cell[i+<span class="number">1</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      lenv_put(e, syms[i], v-&gt;cell[i+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> lval_sexpr();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_def</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_var(e, v, <span class="string">"def"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_put</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> buildin_var(e, v, <span class="string">"put"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">buildin_lambda</span><span class="params">(lenv* e, lval* v)</span> </span>&#123;</span><br><span class="line">  LASSERT_NUM(<span class="string">"\\"</span>, v, <span class="number">2</span>);</span><br><span class="line">  LASSERT_TYPE(<span class="string">"\\"</span>, v, <span class="number">0</span>, LVAL_QEXPR);</span><br><span class="line">  LASSERT_TYPE(<span class="string">"\\"</span>, v, <span class="number">1</span>, LVAL_QEXPR);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//    形参↓    运行↓</span></span><br><span class="line">  <span class="comment">// \ &#123; x y &#125; &#123; + x y &#125;</span></span><br><span class="line">  lval* formals = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  lval* body = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">  lval_del(v);</span><br><span class="line">  <span class="comment">// 生成lambda表达式</span></span><br><span class="line">  <span class="keyword">return</span> lval_lambda(formals, body);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// lval_expr_eval 执行换成 lval_call</span></span><br><span class="line"><span class="function">lval* <span class="title">lval_call</span><span class="params">(lenv* e, lval* v, lval* f)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (f-&gt;buildin) <span class="keyword">return</span> f-&gt;buildin(e, v);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> count = v-&gt;count;</span><br><span class="line">  <span class="keyword">int</span> total = f-&gt;formals-&gt;count;</span><br><span class="line">  <span class="keyword">while</span> (v-&gt;count) &#123;</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;formals-&gt;count == <span class="number">0</span>) &#123;</span><br><span class="line">      lval_del(v);</span><br><span class="line">      <span class="keyword">return</span> lval_err(<span class="string">"Function '%s' passedd too many argument!"</span></span><br><span class="line">                      <span class="string">"Got %i, Expect %i"</span>,</span><br><span class="line">                      <span class="string">"call"</span>, count, total);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 此处将fun中的形参拿出，同时将参数对应上</span></span><br><span class="line">    <span class="comment">// 然后保存到f-&gt;env 环境变量中</span></span><br><span class="line">    lval *sym = lval_pop(f-&gt;formals, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// def &#123; addCurry &#125; (\ &#123; x y &amp; last &#125; &#123; eval (join (list + x y) (head last) ) &#125;)</span></span><br><span class="line">    <span class="comment">// addCurry 10 20 40 30 -&gt; 10 + 20 + 40 = 70</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(sym-&gt;sym, <span class="string">"&amp;"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (f-&gt;formals-&gt;count != <span class="number">1</span>) &#123;</span><br><span class="line">        lval_del(sym);</span><br><span class="line">        lval_del(v);</span><br><span class="line">        <span class="keyword">return</span> lval_err(<span class="string">"Function '%s' pass invalid format argument!"</span></span><br><span class="line">                        <span class="string">"Symbol '&amp;' must followed by only one symbol!"</span></span><br><span class="line">                        <span class="string">"Got %i, Expect %i"</span>,</span><br><span class="line">                        <span class="string">"call"</span>, f-&gt;formals-&gt;count, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      lval *syms = lval_pop(f-&gt;formals, <span class="number">0</span>);</span><br><span class="line">      lval *vals = buildin_list(f-&gt;env, v);</span><br><span class="line">      lenv_put(f-&gt;env, syms, vals);</span><br><span class="line">      lval_del(sym);</span><br><span class="line">      lval_del(syms);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    lval *val = lval_pop(v, <span class="number">0</span>);</span><br><span class="line">    lenv_put(f-&gt;env, sym, val);</span><br><span class="line">    lval_del(sym);</span><br><span class="line">    lval_del(val);</span><br><span class="line">  &#125;</span><br><span class="line">  lval_del(v);</span><br><span class="line">  <span class="comment">// 这里的作用，是在上面执行后，仍然还有 `&amp; x`</span></span><br><span class="line">  <span class="comment">// 其实参数已经写完，只剩复数参数，那么直接给其复制空参数即可执行了</span></span><br><span class="line">  <span class="keyword">if</span> (f-&gt;formals-&gt;count != <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(f-&gt;formals-&gt;cell[<span class="number">0</span>]-&gt;sym, <span class="string">"&amp;"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;formals-&gt;count != <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> lval_err(<span class="string">"Function '%s' pass invalid format argument!"</span></span><br><span class="line">                      <span class="string">"Symbol '&amp;' must followed by only one symbol!"</span></span><br><span class="line">                      <span class="string">"Got %i, Expect %i"</span>,</span><br><span class="line">                      <span class="string">"call"</span>, f-&gt;formals-&gt;count, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    lval_del(lval_pop(f-&gt;formals, <span class="number">0</span>));</span><br><span class="line">    lval *syms = lval_pop(f-&gt;formals, <span class="number">0</span>);</span><br><span class="line">    lval *vals = lval_qexpr(); <span class="comment">// 空参数</span></span><br><span class="line">    lenv_put(f-&gt;env, syms, vals);</span><br><span class="line">    lval_del(syms);</span><br><span class="line">    lval_del(vals);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 说明参数全，开始运行</span></span><br><span class="line">  <span class="keyword">if</span> (f-&gt;formals-&gt;count == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 为当前fun的局部环境变量增加父级环境变量</span></span><br><span class="line">    f-&gt;env-&gt;pair = e;</span><br><span class="line">    <span class="comment">// 执行时，将环境变量传入，相当于提前有了相关的环境变量</span></span><br><span class="line">    <span class="comment">// 执行语句是body，拷贝一份给 buildin_eval 去执行</span></span><br><span class="line">    <span class="keyword">return</span> buildin_eval(f-&gt;env, lval_add(lval_qexpr(), lval_copy(f-&gt;body)));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> lval_copy(f);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lval* <span class="title">lval_expr_eval</span><span class="params">(lenv* e, lval* v, <span class="keyword">char</span>* op)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  lval* res = lval_call(e, v, f);</span><br><span class="line">  <span class="comment">// lval* res = f-&gt;fun(e, v);</span></span><br><span class="line">  <span class="comment">// lval* res = buildin(v, f-&gt;sym);</span></span><br><span class="line">  <span class="comment">// lval* res = buildin_op(v, f-&gt;sym);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lenv_add_buildins</span><span class="params">(lenv* e)</span> </span>&#123;</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"\\"</span>, buildin_lambda);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"def"</span>, buildin_def);</span><br><span class="line">  lenv_add_buildin(e, <span class="string">"="</span>, buildin_put);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上就是在环境变量lenv这章之后，增加的lambda 表达式以及执行方案。</p><p>这章之后你可以做到:</p><pre><code>def {add-mul} (\ {x y} {+ x (* x y)}) // ()add-mul 10 20 // 210add-mul 10 // (\ {y} {+ x (* x y)})def {add-mul-ten} (add-mul 10)add-mul-ten 50 // 510\ {args body} {def (head args) (\ (tail args) body)}def {fun} (\ {args body} {def (head args) (\ (tail args) body)})fun {add-together x y} {+ x y}fun {unpack f xs} {eval (join (list f) xs)}fun {pack f &amp; xs} {f xs}def {uncurry} pack // ()def {curry} unpack // ()curry + {5 6 7} // 18uncurry head 5 6 7 // {5}def {add-uncurried} + // ()def {add-curried} (curry +) // ()add-curried {5 6 7} // 18add-uncurried 5 6 7 // 18</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> lispy, 编译原理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220111c_debug</title>
      <link href="/2022/01/11/20220111c-debug/"/>
      <url>/2022/01/11/20220111c-debug/</url>
      
        <content type="html"><![CDATA[<h1 id="Windows-c-debug"><a href="#Windows-c-debug" class="headerlink" title="Windows c debug"></a>Windows c debug</h1><p>使用 windows vscode 进行c debug:</p><p>下载<code>C/C++</code> 插件, 首先先生成执行文件: <code>gcc main.c add.c -ledit -g -o add</code></p><p>此时会生成add.exe 文件。</p><p>然后项目根目录生成.vscode - launch.json, 内容为:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"(gdb) Attach"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"cppdbg"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [],</span><br><span class="line">      <span class="attr">"stopAtEntry"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"program"</span>: <span class="string">"$&#123;fileDirname&#125;/add"</span>,</span><br><span class="line">      <span class="attr">"cwd"</span>: <span class="string">"$&#123;fileDirname&#125;"</span>,</span><br><span class="line">      <span class="attr">"environment"</span>: [],</span><br><span class="line">      <span class="attr">"externalConsole"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"MIMode"</span>: <span class="string">"gdb"</span>,</span><br><span class="line">      <span class="attr">"setupCommands"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"description"</span>: <span class="string">"为gdb启用整齐打印"</span>,</span><br><span class="line">          <span class="attr">"text"</span>: <span class="string">"-enable-pretty-printing"</span>,</span><br><span class="line">          <span class="attr">"ignoreFailres"</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按F5 即可启动。</p><p>当前办法是每次构建需要自己先执行下生成命令，然后按F5. 之后优化。</p><h1 id="Mac-c-debug"><a href="#Mac-c-debug" class="headerlink" title="Mac c debug"></a>Mac c debug</h1><p>操作如同上面, 不过可以增加一个Task简约操作:</p><p>tasks.json<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"tasks"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"cppbuild"</span>,</span><br><span class="line">      <span class="attr">"label"</span>: <span class="string">"C/C++: gcc 生成活动文件"</span>,</span><br><span class="line">      <span class="attr">"command"</span>: <span class="string">"/usr/bin/gcc"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [<span class="string">"-g"</span>, <span class="string">"$&#123;file&#125;"</span>, <span class="string">"mpc.c"</span>, <span class="string">"-ledit"</span>, <span class="string">"-o"</span>, <span class="string">"$&#123;fileDirname&#125;/ss"</span>],</span><br><span class="line">      <span class="attr">"options"</span>: &#123;</span><br><span class="line">        <span class="attr">"cwd"</span>: <span class="string">"$&#123;fileDirname&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"problemMatcher"</span>: [</span><br><span class="line">        <span class="string">"$gcc"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"group"</span>: <span class="string">"build"</span>,</span><br><span class="line">      <span class="attr">"detail"</span>: <span class="string">"编译器: /usr/bin/gcc"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>此时 Shift+Command+p 点击 <code>Tasks: Run Task</code>. 这样会生成如手工生成的文件: <code>gcc mpc.c ss.c -g -ledit -o ss</code></p><p>然后附以launch.json:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"(lldb) Attach"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"cppdbg"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [],</span><br><span class="line">      <span class="attr">"stopAtEntry"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"program"</span>: <span class="string">"$&#123;fileDirname&#125;/ss"</span>,</span><br><span class="line">      <span class="attr">"cwd"</span>: <span class="string">"$&#123;fileDirname&#125;"</span>,</span><br><span class="line">      <span class="attr">"environment"</span>: [],</span><br><span class="line">      <span class="attr">"externalConsole"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">"MIMode"</span>: <span class="string">"lldb"</span>,</span><br><span class="line">      <span class="attr">"setupCommands"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"description"</span>: <span class="string">"为gdb启用整起打印"</span>,</span><br><span class="line">          <span class="attr">"text"</span>: <span class="string">"-enable-pretty-printing"</span>,</span><br><span class="line">          <span class="attr">"ignoreFailres"</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上mac就能初步享受断点开发了。操作繁琐一些，先使用再看看。</p><blockquote><p>更新vscode 的cpp插件出现<code>Unable to start debugging. LLDB exited unexpectedly with exit code 134 (0x86).</code>报错。原始是cpp插件不是正式版，点击切换为正式发行版即正常。</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> c_debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20220111recent</title>
      <link href="/2022/01/11/20220111recent/"/>
      <url>/2022/01/11/20220111recent/</url>
      
        <content type="html"><![CDATA[<p>今年开年的1.1 1.2 1.3 在家里将编译原理学到第九章，其他时间都和大学同学玩游戏。太冷了，骑车40分钟到公司，所以偷懒待家里。玩一会学一会。其实事后是很后悔的，那些时间都浪费了。</p><p>我设想以后如果放假，我可以背着公司的笔记本去星巴克偷电。带上一缸水，中午回来吃饭，反正我下次就去那边，顺便带上小猴。猴头菇她就很乖，第一天咪咪摸摸整吃的花掉，后面超级努力学习。这回我输给她了。</p><p>1.4号出发去北京，搞下北京现勘服务。北京报告说安卓手机打不开，我当天下午到了，看了一眼队长机子大致知道怎么回事了，当天是整不了了，第二天才能进特殊网络去整。回去宾馆的几天，天天学到很晚那个编译原理。</p><p>第二天我将网络调通，多个网也都通。队长要求发一个新的版本才能回去，我远程不好开发，让远在公司的同事搞好，我指导改哪里哪里。在宾馆整理下文档；远程参与一些会议；死命学习编译原理，哈哈。</p><p>周六去更新。来接送的是另一个队的警官，他一路带我去机房，我跟他说下面等30分钟，我在机房20多分钟等待开通网络(与另一个人对接，等待其开通该特殊网络)，然后花了2分钟感觉没问题可以登录了。下来后，发现另一个网络打不开？又劳烦那个警官配合打开队长办公室，拿到实验室钥匙，进去后查看日志，发现这个服务器机器是人为的手动关闭。我之前就发现这个服务器经常被关闭，以为俺的服务导致的，原来是人为操作。</p><p>北京平日两天一个核酸，幸好只捅喉咙，要是天天捅鼻子，那就真遭罪。上周还去了趟故宫，在城里转了下(当然没有进需要门票的地方，没money)。嘿嘿，十年前来的，这次自己来转转。</p><p>这次收获是，时间比较的充裕，学了两大章节编译原理，还差4章学完。不过花在学习上稍稍少了点，多点的话，都能到下一个章节了!懒鬼，嘿嘿。</p><p>下周一，再次前往甲方爸爸办公室，确认安卓新版申请上架，答复是2~3天才能签名过，于是就获允先回到上海了。中午12:16打到车，赶13:00 的火车，因为这个只要4个小时就到。赶在了10几分钟前到北京南。</p><p>这次去北京不同点是什么?回来的路途中我买了充裕的食物，泡面加好多香肠，哈哈，以前穷的路上都不舍得买点食物，公司又不报销。觉得现在心里更放松了，哈哈。</p><p>到家太晚了，就不去公司了(有个职称评级的会)，远程听。</p><p>晚上的时候，猴头菇说没安排？那我说了，我想装逼，她说不行不行，她有安排了，她要读日语！那可不行，给我个装逼的机会吧。于是，猴头菇听着我装逼给她讲《编译原理》，在凳子上瞌睡，算了，给她丢到床上睡觉吧，睡神猴。</p><p>忙碌的开年，就这样开启了。</p><p>听老铁说，开年忙碌、休闲会影响到整年的，唉，无所谓了，今年就是赚钱还钱，买车牌，买车。年年不都如此？</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20211226makeshell</title>
      <link href="/2021/12/26/20211226makeshell/"/>
      <url>/2021/12/26/20211226makeshell/</url>
      
        <content type="html"><![CDATA[<h1 id="实现一个Shell"><a href="#实现一个Shell" class="headerlink" title="实现一个Shell"></a>实现一个Shell</h1><h2 id="简单熟悉下C"><a href="#简单熟悉下C" class="headerlink" title="简单熟悉下C"></a>简单熟悉下C</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> b = <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">char</span>* <span class="built_in">string</span> = <span class="string">"我喜欢吃饭"</span>;</span><br><span class="line"><span class="keyword">double</span> money = <span class="number">10.36</span>;</span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">earnMoney</span><span class="params">(<span class="keyword">int</span> day)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> day * <span class="number">5.9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">sayword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span>* word = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">5</span>);</span><br><span class="line">  word[<span class="number">0</span>] = <span class="string">'a'</span>;</span><br><span class="line">  word[<span class="number">1</span>] = <span class="string">'k'</span>;</span><br><span class="line">  word[<span class="number">2</span>] = <span class="string">'e'</span>;</span><br><span class="line">  word[<span class="number">3</span>] = <span class="string">'r'</span>;</span><br><span class="line">  word[<span class="number">4</span>] = <span class="string">'\0'</span>; <span class="comment">// 0 / NULL</span></span><br><span class="line">  <span class="keyword">return</span> word</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">////////////</span></span><br><span class="line"><span class="comment">// - unistd.h</span></span><br><span class="line"><span class="comment">// 等待线程信号返回</span></span><br><span class="line"><span class="comment">// WNOHANG如果pid指定的子进程没有结束，则waitpid()函数立即返回0，而不是阻塞在这个函数上等待；如果结束了，则返回该子进程的进程号。</span></span><br><span class="line"><span class="comment">// WUNTRACED如果子进程进入暂停状态，则马上返回。</span></span><br><span class="line"><span class="keyword">pid_t</span> (*waitpid)(<span class="keyword">pid_t</span>, <span class="keyword">int</span>* status, <span class="keyword">int</span> option); <span class="comment">// status获取同步内部状态；option [WNOHAND | WUNTRACED]</span></span><br><span class="line"><span class="comment">// 孵化、衍生一个新的process</span></span><br><span class="line"><span class="keyword">pid_t</span> (*fork)(<span class="keyword">void</span>);</span><br><span class="line"><span class="comment">// 执行</span></span><br><span class="line"><span class="keyword">int</span> (*execvp)(<span class="keyword">const</span> <span class="keyword">char</span>* command, <span class="keyword">char</span>* argv[]); <span class="comment">// -1代表返回的错误</span></span><br><span class="line"><span class="comment">// 更新程序执行目录上下文</span></span><br><span class="line"><span class="keyword">int</span> (*chdir)(<span class="keyword">const</span> <span class="keyword">char</span>* path); <span class="comment">// 成功则返回0；失败返回-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////</span></span><br><span class="line"><span class="comment">// - string.h</span></span><br><span class="line"><span class="comment">// char*比较</span></span><br><span class="line"><span class="keyword">int</span> (*<span class="built_in">strcmp</span>)(<span class="keyword">const</span> <span class="keyword">char</span>* s1, <span class="keyword">const</span> <span class="keyword">char</span>* s2); <span class="comment">// 返回0代表s1 == s2</span></span><br><span class="line"><span class="comment">// 分解 .e.g. "node -v".split(" ") -&gt; "node", "-v"</span></span><br><span class="line"><span class="keyword">char</span>* (*strtok)(<span class="keyword">char</span>* __str, <span class="keyword">const</span> <span class="keyword">char</span>* __sep); <span class="comment">// 返回当前分解出的单词</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////</span></span><br><span class="line"><span class="comment">// - stdlib.h</span></span><br><span class="line"><span class="comment">// 分配内存</span></span><br><span class="line"><span class="keyword">void</span>* (*<span class="built_in">malloc</span>)(<span class="keyword">size_t</span>);</span><br><span class="line"><span class="comment">// 重新分配内存</span></span><br><span class="line"><span class="keyword">void</span>* (*<span class="built_in">realloc</span>)(<span class="keyword">void</span>* __ptr, <span class="keyword">size_t</span> __size);</span><br><span class="line"></span><br><span class="line"><span class="comment">///////////</span></span><br><span class="line"><span class="comment">// - stdio.h</span></span><br><span class="line"><span class="comment">// 获取输入</span></span><br><span class="line"><span class="keyword">char</span> (*getchar)(<span class="keyword">void</span>);</span><br></pre></td></tr></table></figure><h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><p>malloc的堆数据一定记得清理。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">aker_process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span>* line = aker_getLine();</span><br><span class="line">  <span class="keyword">char</span>** args = aker_getArgs(line);</span><br><span class="line">  <span class="keyword">int</span> status = aker_exec(args);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(args);</span><br><span class="line">  <span class="built_in">free</span>(line);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="获取用户输入"><a href="#获取用户输入" class="headerlink" title="获取用户输入"></a>获取用户输入</h3><p>设置buffer大小，当需要更多buffer时，再次申请扩容即可。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_LINE_BUFFER_SIZE 64</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">aker_getLine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> bufferSize = AKER_LINE_BUFFER_SIZE, position = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> *line = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>) * bufferSize);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"aker&gt; "</span>);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">if</span> (c == EOF) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"退出中...\n"</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"欢迎下次使用\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'\n'</span>) &#123;</span><br><span class="line">      line[position] = <span class="string">'\0'</span>; <span class="comment">// 字符串结尾符</span></span><br><span class="line">      <span class="keyword">return</span> line;</span><br><span class="line">    &#125;</span><br><span class="line">    line[position] = c;</span><br><span class="line">    position++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position &gt;= bufferSize) &#123;</span><br><span class="line">      bufferSize += AKER_LINE_BUFFER_SIZE;</span><br><span class="line">      line = <span class="built_in">realloc</span>(line, <span class="keyword">sizeof</span>(<span class="keyword">char</span>) * bufferSize);</span><br><span class="line">      <span class="keyword">if</span> (line == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"aker_getLine realloc error!\n"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="用户输入分解为多个字符"><a href="#用户输入分解为多个字符" class="headerlink" title="用户输入分解为多个字符"></a>用户输入分解为多个字符</h3><p>原理同上</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_ARG_BUFFER_SIZE 20</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_ARG_SEP_TOKEN <span class="meta-string">" \t\n\r"</span></span></span><br><span class="line"><span class="function"><span class="keyword">char</span>** <span class="title">aker_getArgs</span><span class="params">(<span class="keyword">char</span>* line)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> position = <span class="number">0</span>, bufferSize = AKER_ARG_BUFFER_SIZE;</span><br><span class="line">  <span class="keyword">char</span> **args = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>*) * AKER_ARG_BUFFER_SIZE);</span><br><span class="line">  <span class="keyword">char</span> *token = strtok(line, AKER_ARG_SEP_TOKEN);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (token != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    args[position] = token;</span><br><span class="line">    position++;</span><br><span class="line">    <span class="keyword">if</span> (position &gt;= bufferSize) &#123;</span><br><span class="line">      bufferSize += AKER_ARG_BUFFER_SIZE;</span><br><span class="line">      args = <span class="built_in">realloc</span>(args, <span class="keyword">sizeof</span>(<span class="keyword">char</span>*) * AKER_ARG_BUFFER_SIZE);</span><br><span class="line">      <span class="keyword">if</span> (!args) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"aker_getArgs realloc error!\n"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    token = strtok(<span class="literal">NULL</span>, AKER_ARG_SEP_TOKEN);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  args[position] = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建进程执行分解的命令"><a href="#创建进程执行分解的命令" class="headerlink" title="创建进程执行分解的命令"></a>创建进程执行分解的命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_launch</span><span class="params">(<span class="keyword">char</span> **args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">pid_t</span> pid, wpid;</span><br><span class="line">  <span class="keyword">int</span> status;</span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> (pid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"aker_launch fork error!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pid == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (execvp(args[<span class="number">0</span>], args) == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"aker child exec fail!\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      wpid = waitpid(pid, &amp;status, WUNTRACED);</span><br><span class="line">    &#125; <span class="keyword">while</span> (WIFEXITED(status) == <span class="number">0</span> &amp;&amp; WIFSIGNALED(status) == <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// WIFEXITED(status) 如果子进程正常结束，他就返回真；否则返回假；</span></span><br><span class="line">    <span class="comment">// WEXITSTATUS(status) 如果WIFEXITED(status)为真，则可以用该宏取得子进程exit()返回的结束代码。</span></span><br><span class="line">    <span class="comment">// WIFSIGNALED(status) 如果子进程因为一个未捕获的信号而终止，他就返回真；否则返回假；</span></span><br><span class="line">    <span class="comment">// WTERMSIG(status) 如果WIFSIGNALED(status)为真，则可以用该宏获得导致子进程终止的信号代码；</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="执行cd-exit-命令"><a href="#执行cd-exit-命令" class="headerlink" title="执行cd / exit 命令"></a>执行<code>cd / exit</code> 命令</h3><p>…完成内置命令</p><h3 id="选取历史命令-A-B"><a href="#选取历史命令-A-B" class="headerlink" title="选取历史命令^[[A / ^[[B"></a>选取历史命令<code>^[[A / ^[[B</code></h3><p>…</p><h2 id="完整实现"><a href="#完整实现" class="headerlink" title="完整实现:"></a>完整实现:</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;editline/readline.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_cd</span><span class="params">(<span class="keyword">char</span>** args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (args[<span class="number">1</span>] == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入路径!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// int (*chdir)(const char* path);</span></span><br><span class="line">  <span class="comment">// 成功则返回0；失败返回-1</span></span><br><span class="line">  <span class="keyword">if</span> (chdir(args[<span class="number">1</span>]) != <span class="number">0</span>) &#123;</span><br><span class="line">    perror(<span class="string">"aker chdir()"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_exit</span><span class="params">(<span class="keyword">char</span>** args)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"waiting for your next coming!"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_help</span><span class="params">(<span class="keyword">char</span>** args)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"commands for a new shell!\n"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"cd / exit / help / ... and more for discover!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> (*aker_buildins[])(<span class="keyword">char</span>** args) = &#123;</span><br><span class="line">  &amp;aker_cd,</span><br><span class="line">  &amp;aker_help,</span><br><span class="line">  &amp;aker_exit</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>* aker_buildinStr[] = &#123;</span><br><span class="line">  <span class="string">"cd"</span>,</span><br><span class="line">  <span class="string">"help"</span>,</span><br><span class="line">  <span class="string">"exit"</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_builtinSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">sizeof</span>(aker_buildinStr) / <span class="keyword">sizeof</span>(aker_buildinStr[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_launch</span><span class="params">(<span class="keyword">char</span> **args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">pid_t</span> pid, wpid;</span><br><span class="line">  <span class="keyword">int</span> status;</span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> (pid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"aker_launch fork error!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pid == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// int (*execvp)(const char* command, char* argv[]);</span></span><br><span class="line">    <span class="comment">// -1 代表返回的错误</span></span><br><span class="line">    <span class="keyword">if</span> (execvp(args[<span class="number">0</span>], args) == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"aker child exec fail!\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      wpid = waitpid(pid, &amp;status, WUNTRACED);</span><br><span class="line">    &#125; <span class="keyword">while</span> (WIFEXITED(status) == <span class="number">0</span> &amp;&amp; WIFSIGNALED(status) == <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// WIFEXITED(status) 如果子进程正常结束，他就返回真；否则返回假；</span></span><br><span class="line">    <span class="comment">// WEXITSTATUS(status) 如果WIFEXITED(status)为真，则可以用该宏取得子进程exit()返回的结束代码。</span></span><br><span class="line">    <span class="comment">// WIFSIGNALED(status) 如果子进程因为一个未捕获的信号而终止，他就返回真；否则返回假；</span></span><br><span class="line">    <span class="comment">// WTERMSIG(status) 如果WIFSIGNALED(status)为真，则可以用该宏获得导致子进程终止的信号代码；</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aker_exec</span><span class="params">(<span class="keyword">char</span> **args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (args[<span class="number">0</span>] == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"you have no input anything!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; aker_builtinSize(); i++) &#123;</span><br><span class="line">    <span class="keyword">char</span> *command = aker_buildinStr[i];</span><br><span class="line">    <span class="comment">// int (*strcmp)(const char* s1, const char* s2);</span></span><br><span class="line">    <span class="comment">// 相等0; 大于 0；小于 0；</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(command, args[<span class="number">0</span>]) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (aker_buildins[i])(args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> aker_launch(args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_ARG_BUFFER_SIZE 20</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_ARG_SEP_TOKEN <span class="meta-string">" \t\n\r"</span></span></span><br><span class="line"><span class="function"><span class="keyword">char</span>** <span class="title">aker_getArgs</span><span class="params">(<span class="keyword">char</span>* line)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> position = <span class="number">0</span>, bufferSize = AKER_ARG_BUFFER_SIZE;</span><br><span class="line">  <span class="keyword">char</span> **args = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>*) * AKER_ARG_BUFFER_SIZE);</span><br><span class="line">  <span class="keyword">char</span> *token = strtok(line, AKER_ARG_SEP_TOKEN);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (token != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    args[position] = token;</span><br><span class="line">    position++;</span><br><span class="line">    <span class="keyword">if</span> (position &gt;= bufferSize) &#123;</span><br><span class="line">      bufferSize += AKER_ARG_BUFFER_SIZE;</span><br><span class="line">      args = <span class="built_in">realloc</span>(args, <span class="keyword">sizeof</span>(<span class="keyword">char</span>*) * AKER_ARG_BUFFER_SIZE);</span><br><span class="line">      <span class="keyword">if</span> (!args) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"aker_getArgs realloc error!\n"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    token = strtok(<span class="literal">NULL</span>, AKER_ARG_SEP_TOKEN);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  args[position] = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> args;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用getchar 方法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AKER_LINE_BUFFER_SIZE 64</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">aker_getLine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> bufferSize = AKER_LINE_BUFFER_SIZE, position = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> *line = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>) * bufferSize);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"aker&gt; "</span>);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">if</span> (c == EOF) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"退出中...\n"</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"欢迎下次使用\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'\n'</span>) &#123;</span><br><span class="line">      line[position] = <span class="string">'\0'</span>;</span><br><span class="line">      <span class="keyword">return</span> line;</span><br><span class="line">    &#125;</span><br><span class="line">    line[position] = c;</span><br><span class="line">    position++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (position &gt;= bufferSize) &#123;</span><br><span class="line">      bufferSize += AKER_LINE_BUFFER_SIZE;</span><br><span class="line">      line = <span class="built_in">realloc</span>(line, <span class="keyword">sizeof</span>(<span class="keyword">char</span>) * bufferSize);</span><br><span class="line">      <span class="keyword">if</span> (line == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"aker_getLine realloc error!\n"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用getline 方法</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">aker_getLine1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> size = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> *line = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"aker&gt;"</span>);</span><br><span class="line">  <span class="keyword">if</span> (getline(&amp;line, &amp;size, <span class="built_in">stdin</span>) &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (feof(<span class="built_in">stdin</span>)) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"退出中...\n"</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"欢迎下次使用\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      perror(<span class="string">"aker"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> line;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用readline 方法</span></span><br><span class="line"><span class="comment">// gcc -std=c99 shell5.c -ledit -o shell5</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">aker_getLine2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span>* line = readline(<span class="string">"aker&gt;"</span>);</span><br><span class="line">  <span class="keyword">if</span> (!line) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"退出中...\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"欢迎下次使用\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> line;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">aker_process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *line;</span><br><span class="line">  <span class="keyword">char</span> **args;</span><br><span class="line">  <span class="keyword">int</span> status;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    line = aker_getLine();</span><br><span class="line">    args = aker_getArgs(line);</span><br><span class="line">    status = aker_exec(args);</span><br><span class="line">    add_history(line);</span><br><span class="line">    <span class="built_in">free</span>(args);</span><br><span class="line">    <span class="built_in">free</span>(line);</span><br><span class="line">  &#125; <span class="keyword">while</span> (status);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"end!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  aker_process();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="学习资料"><a href="#学习资料" class="headerlink" title="学习资料"></a>学习资料</h2><p><a href="https://brennan.io/2015/01/16/write-a-shell-in-c/" target="_blank" rel="noopener">学习来源</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> c, shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一次Node_Docker使用Puppeteer大量僵司进程排查</title>
      <link href="/2021/12/21/20211221%E4%B8%80%E6%AC%A1Node-Docker%E4%BD%BF%E7%94%A8Puppeteer%E5%A4%A7%E9%87%8F%E5%83%B5%E5%8F%B8%E8%BF%9B%E7%A8%8B%E6%8E%92%E6%9F%A5/"/>
      <url>/2021/12/21/20211221%E4%B8%80%E6%AC%A1Node-Docker%E4%BD%BF%E7%94%A8Puppeteer%E5%A4%A7%E9%87%8F%E5%83%B5%E5%8F%B8%E8%BF%9B%E7%A8%8B%E6%8E%92%E6%9F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h1><p>原因是之前上线一个由Nodejs，使用原镜像使用debian打包，添加nodejs/puppeteer作为业务需求的服务。该服务使用量不是很大，但是经常会出现cpu特别大，并且内存一直无法释放问题。之前的操作就是时不时重启下。</p><p>一直没有时间专门处理这个业务bug，这会想起，给他解决掉，同时也发现该非常好的Blog。想着一次解决，能免于用户的不满回馈。</p><h2 id="错误展现"><a href="#错误展现" class="headerlink" title="错误展现"></a>错误展现</h2><p>也正出现如参考Blog出现的，<code>$ps -ef</code> 会展示:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root xx 1 0 <span class="variable">$&#123;time&#125;</span> [chrome] &lt;defunct&gt;</span><br><span class="line">root xx 1 0 <span class="variable">$&#123;time&#125;</span> [chrome] &lt;defunct&gt;</span><br><span class="line">root xx 1 0 <span class="variable">$&#123;time&#125;</span> [chrome] &lt;defunct&gt;</span><br></pre></td></tr></table></figure><p><code>&lt;defunct&gt;</code>正是表明该子进程挂了，但是父进程没有为子进程做回收动作。<code>子进程退出后绝大部分资源已经被释放可供其他进程使用，但是内核的进程表中没有槽位释放。</code></p><h3 id="进程与fork"><a href="#进程与fork" class="headerlink" title="进程与fork"></a>进程与fork</h3><p><code>fork()</code>(孵化、衍生)，作用是生成一个新的进程，父子进程都从fork处继续执行。</p><blockquote><p>子进程是父进程的副本，子进程拥有父进程数据空间、堆、栈的复制副本，fork采用了copy-on-write技术，fork操作几乎瞬间可以完成。只有在子进程修改了相应的区域才会进行真正的拷贝。</p></blockquote><h3 id="孤儿进程"><a href="#孤儿进程" class="headerlink" title="孤儿进程"></a>孤儿进程</h3><blockquote><p>一个父进程已经终止，开启的子进程还活着的进程被称为孤儿进程(orphan process)。没人管的孤儿进程会被进程PID为1的进程接管。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"before fork, pid=%d\n"</span>, getpid());</span><br><span class="line">  <span class="keyword">pid_t</span> childPid;</span><br><span class="line">  <span class="keyword">switch</span> (childPid = fork()) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1</span>: &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"fork error, %d\n"</span>, getpid());</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"in child process, pid=%d\n"</span>, getpid());</span><br><span class="line">      sleep(<span class="number">100000</span>); 子进程sleep 不退出</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>: &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"in parent process, pid=%d\n child pid=%d\n"</span>, getpid(), childPid);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译运行上面代码: <code>$gcc fork_demo.c -o fork_demo; ./fork_demo</code></p><p>输出结果如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">before fork, pid=21629</span><br><span class="line">in parent process, pid=21629, child pid=21630</span><br><span class="line">in child process, pid=21630</span><br></pre></td></tr></table></figure><p>使用<code>ps -ef | grep &quot;216&quot;</code>查看进程信息:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">root         1     0  0 12月12 ?      00:00:53 /usr/lib/systemd/systemd --system --deserialize 21</span><br><span class="line">ya       21630     1  0 19:26 pts/8    00:00:00 ./fork_demo</span><br></pre></td></tr></table></figure><blockquote><p>可以看到此时孤儿子进程21630的父PPID已经变为了顶层的PID为1的进程。</p></blockquote><p>以上正是我当前遇到的，我就到此说明完整问题了。此处重点，会由PID 为1的进程接管。</p><h3 id="PID-为-1-的进程"><a href="#PID-为-1-的进程" class="headerlink" title="PID 为 1 的进程"></a>PID 为 1 的进程</h3><blockquote><p>Linux中内核初始化以后会启动系统的第一个进程，PID为1，也可以称之为init进程或者根(ROOT)进程。</p></blockquote><p>init进程有下面这几个功能:</p><ul><li>如果一个进程的父进程退出来，那么这个init进程便会接管这个孤儿进程。</li><li>如果一个进程的父进程未执行wait/waitpid就退出了，init进程会接管子进程并自动调用wait方法，从而保证系统中的僵司进程可以被移除。</li><li>传递信号给子进程</li></ul><h3 id="为什么Nodejs不适合做Docker镜像中PID为1的进程"><a href="#为什么Nodejs不适合做Docker镜像中PID为1的进程" class="headerlink" title="为什么Nodejs不适合做Docker镜像中PID为1的进程"></a>为什么Nodejs不适合做Docker镜像中PID为1的进程</h3><blockquote><p>在Nodejs的官方最佳实践里有写到”Node.js was not designed to run as PID 1 which leads to unexpected behaviour when running inside of Docker.”</p></blockquote><p><img src="/css/images/node_docker_puppeteer01.png" alt="p0"></p><h3 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a>解决方式</h3><h4 id="解决方式二-使用专门的init进程"><a href="#解决方式二-使用专门的init进程" class="headerlink" title="解决方式二: 使用专门的init进程"></a>解决方式二: 使用专门的init进程</h4><p>直接使用解决方式二</p><blockquote><p>Nodejs提供了两种方案，第一种是使用docker官方的轻量级init系统，如下所示</p></blockquote><p><code>docker run -it --init your_docker_image_id</code></p><p>或者docker-compose.yml version: “2.2” (使用2.2版本，其支持init)</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    init:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>即可正确支持。</p><p>最终效果:</p><p><img src="/css/images/node_docker_puppeteer02.jpg" alt="p1"></p><p>另一种是使用tini程序启动，由tini进程去fork出新进程。</p><p>在Dockerfile中增加替换Entry入口:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ENV TINI_VERSION v0.19.0</span><br><span class="line">ADD https://github.com/krallin/tini/releases/download/$&#123;TINI_VERSION&#125;/tini /tini</span><br><span class="line">RUN chmod +x /tini</span><br><span class="line">ENTRYPOINT [&quot;/tini&quot;, &quot;--&quot;]</span><br></pre></td></tr></table></figure></p><p>仅是入口修改，tini 进程会接管启动传入的程序，这样顶层Pid 1 就不会为Nodejs</p><p>这样就如: <code>/tini -- node app.js</code>，首先生成tini 为pid=1的启动项，tini 运行后面的入参为fork 后的程序执行，比如可以调用<code>execvp(&quot;node&quot;, &quot;node app.js&quot;)</code></p><p>(debian中便捷方案:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install -y tini</span><br><span class="line">ENTRYPOINT [&quot;/usr/bin/tini&quot;, &quot;--&quot;]</span><br></pre></td></tr></table></figure></p><p>), 效果一样</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>pid为1的不能为Nodejs、网络Java、网络Go等。</p><p>为了使io不被打断去支撑更多的服务链接，如果有fork动作，上述进程则直接跳过不等待。</p><p>自己不接管子程序的回收(没有<code>wait/waitpid</code>)，那就找pid为1的进程帮助回收，那要是pid也为自己怎么办？于是pid为1的进程不能为上述进程(包括其他语言的相关框架哈)。</p><p>例如: Nodejs没有去wait/waitpid 管理子进程状态.那么在Docker启动中，使用init进程接管pid，由init去handle没人管理的僵司进程，这时便能解决本次问题。</p><hr><p>上面解释、注解90%为原Blog内容，本机自己实操基本雷同，但是不如Blog老师的文章，请看到的直接前往Blog老师地址:</p><p><a href="https://blog.51cto.com/u_14621228/2462108" target="_blank" rel="noopener">完全参考Blog - 一次 Docker 容器内大量僵尸进程排查分析</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> debian, puppeteer, node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>learnjava</title>
      <link href="/2021/12/16/20211216learnjava/"/>
      <url>/2021/12/16/20211216learnjava/</url>
      
        <content type="html"><![CDATA[<p>这里记录一写java的学习点，知识点零散，仅为自己记录。</p><h2 id="Filter-和Interceptor"><a href="#Filter-和Interceptor" class="headerlink" title="Filter 和Interceptor"></a>Filter 和Interceptor</h2><p>Filter:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    HttpServletRequest req = (HttpServletRequest)request;</span><br><span class="line">    HttpServletResponse res = (HttpServletResponse)response;</span><br><span class="line">    ConfigProperties config = SpringUtil.getBean(ConfigProperties.class);</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (cookie) &#123;</span><br><span class="line"><span class="comment">// 查看用户数据是否存在；用户是否禁用，更新用户使用时间点</span></span><br><span class="line">      chain.doFilter(request, response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      response.getWriter().write(<span class="string">"no authenticate"</span>);</span><br><span class="line">      res.setStatus(HttpStatus.UNAUTHORIZED.value());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 然后在FilterConfig中进行绑定，并设置中间件前后置</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterConfig</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Bean</span> <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">registerAuthFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FilterRegistrationBean&lt;AuthFilter&gt; registration = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;();</span><br><span class="line">    registration.setFilter(<span class="keyword">new</span> AuthFilter());</span><br><span class="line">    registration.addUrlPatterns(<span class="string">"/*"</span>);</span><br><span class="line">    registration.setName(<span class="string">"AuthFilter"</span>);</span><br><span class="line">    registration.setOrder(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> registration;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Interceptor:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先创建一个annotation:</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RoutePermissions &#123;</span><br><span class="line">  <span class="function">String <span class="title">permissions</span><span class="params">()</span> <span class="keyword">default</span> "<span class="keyword">public</span>"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建一个interceptor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoutePermissionsInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    RoutePermissions routePermissions = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (handler <span class="keyword">instanceof</span> HandlerMethod) &#123;</span><br><span class="line">      routePermissions = (RoutePermissions)((HandlerMethod)handler).getMethodAnnotation(RoutePermissions.class);</span><br><span class="line">      <span class="comment">// 如果该配置项没有permissions, 默认为admin，谁都可以进入</span></span><br><span class="line">      <span class="comment">// TODO 该用户是否为admin</span></span><br><span class="line">      <span class="keyword">if</span> (routePermissions == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      String permissions = routePermissions.permissions();</span><br><span class="line">      <span class="keyword">if</span> (!StringUtils.isEmpty(permissions)) &#123;</span><br><span class="line">        <span class="comment">// TODO logic</span></span><br><span class="line">        <span class="comment">// 判断是否有权限</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        response.getWriter().write(<span class="string">"no permissions"</span>);</span><br><span class="line">        <span class="function">response <span class="title">setStatus</span><span class="params">(HttpStatus.FORBIDDEN.value()</span>)</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最后在WebMvcConf中注册下</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConf</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Bean</span> <span class="function"><span class="keyword">public</span> RoutePermissionsInterceptor <span class="title">myRoutePermissionInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RoutePermissionsInterceptor interceptor = <span class="keyword">new</span> RoutePermissionsInterceptor();</span><br><span class="line">    <span class="keyword">return</span> interceptor;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptor</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">    registry.addInterceptor(myRoutePermissionInterceptor());</span><br><span class="line">    ...registry.addInterceptor(...other interceptors);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="作用"><a href="#作用" class="headerlink" title=":: 作用"></a>:: 作用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">list.add(<span class="string">"a"</span>);</span><br><span class="line">list.add(<span class="string">"b"</span>);</span><br><span class="line">list.add(<span class="string">"c"</span>);</span><br><span class="line">list.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其中list.forEach可以改写成以下代码:</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">  System.out.println(list.get(i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者等于以下代码:</span></span><br><span class="line"><span class="keyword">for</span> (String s : list) &#123;</span><br><span class="line">  System.out.println(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.zhihu.com/question/302776698/answer/533952179" target="_blank" rel="noopener">抄录-java中的::是什么意思？ - 无措的回答 - 知乎</a></p><h2 id="Lambda表达式和函数式接口"><a href="#Lambda表达式和函数式接口" class="headerlink" title="Lambda表达式和函数式接口"></a>Lambda表达式和函数式接口</h2><blockquote><p>仅仅有一个未实现方法的接口，可以直接写作<code>(参数列表)-&gt;{方法体}</code>这种形式</p></blockquote><p>例如:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FuncA</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String str)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么上面这种接口就可以直接写作:</p><pre><code>FuncA funcA = (str)-&gt; {  System.out.println(&quot;hello&quot;);}</code></pre><blockquote><p>同时System.out.println 的参数和传递的参数element的类型完全匹配，所以可以简化为:</p></blockquote><p><code>.forEach(System.out::println)</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>learnc</title>
      <link href="/2021/11/30/20211130learnc/"/>
      <url>/2021/11/30/20211130learnc/</url>
      
        <content type="html"><![CDATA[<h1 id="C-简短过一遍"><a href="#C-简短过一遍" class="headerlink" title="C 简短过一遍"></a>C 简短过一遍</h1><h2 id="C-语言编译"><a href="#C-语言编译" class="headerlink" title="C 语言编译"></a>C 语言编译</h2><pre><code>gcc hello.c -o hello // gcc -std=c99 hello.c./hello</code></pre><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="字符类型"><a href="#字符类型" class="headerlink" title="字符类型"></a>字符类型</h3><pre><code>char c = &apos;B&apos;; // ASCII B = 66</code></pre><p>字符类型使用一个字节(8位)存储。</p><p><code>&#39;\a&#39;(警报) &#39;\b&#39;(退格键) &#39;\n&#39;(换行符) &#39;\r&#39;(回车符) &#39;\t&#39;(制表符) &#39;\v&#39;(垂直分隔符) &#39;\0&#39;(NULL)</code></p><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><h4 id="指针-1"><a href="#指针-1" class="headerlink" title="指针"></a>指针</h4><pre><code>int *intPtr;</code></pre><h4 id="指向指针的指针"><a href="#指向指针的指针" class="headerlink" title="指向指针的指针"></a>指向指针的指针</h4><pre><code>int **foo;</code></pre><h4 id="取出指针对应空间值"><a href="#取出指针对应空间值" class="headerlink" title="取出指针对应空间值"></a>取出指针对应空间值</h4><pre><code>void increase(int *p) {    *p = *p +1;}</code></pre><h4 id="amp-运算符"><a href="#amp-运算符" class="headerlink" title="&amp;运算符"></a>&amp;运算符</h4><pre><code>int x = 1;increase(&amp;x);</code></pre><p>&amp; 运算符与 * 运算符互为逆转</p><pre><code>int i = 5;if (i == *(&amp;i)) // TRUE</code></pre><h4 id="指针变量的初始化"><a href="#指针变量的初始化" class="headerlink" title="指针变量的初始化"></a>指针变量的初始化</h4><blockquote><p>声明指针变量之后，编译器会为指针变量本身分配一个内存空间，但是这个内存是随机分配的。</p></blockquote><pre><code>int *p; // 声明了指针*p = 1; // *p 对应了某个随机地址，未知空间，此时赋值为了1的字面量</code></pre><p>正确的做法是给与以已分配好的的地址:</p><pre><code>int *p;int i;p = &amp;i;*p = 13;</code></pre><blockquote><p>为了防止读写未初始化的指针变量，初始化时设为NULL</p></blockquote><pre><code>int *p = NULL;</code></pre><h4 id="指针的运算"><a href="#指针的运算" class="headerlink" title="指针的运算"></a>指针的运算</h4><p>指针运算，表示指针的移动。</p><pre><code>short *j;j = (short *)0x1234;j = j + 1; // 0x1236;</code></pre><p>使用场景: for循环时，根据偏移，相加指针得到下一位(指针相减，得到距离位数).</p><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>main 方法</p><p>参数传递，参数的传值引用</p><h4 id="函数指针"><a href="#函数指针" class="headerlink" title="函数指针"></a>函数指针</h4><pre><code>void print(int a) {    printf(&quot;%d\n&quot;, a);}void (*print_ptr)(int) = &amp;print;</code></pre><p>调用时如: <code>(*print_ptr)(10); // print(10);</code></p><blockquote><p>比较特殊的是，C 语言还规定，函数名本身就是指向函数代码的指针，通过函数名就能获取函数地址。也就是说，<code>print</code> 和 <code>&amp;print</code> 是一回事。</p></blockquote><pre><code>if (print == &amp;print) // true</code></pre><p>因此，上面代码的<code>print_ptr</code> 等同于 <code>print</code>。</p><pre><code>void (*print_ptr)(int) = &amp;print;void (*print_ptr)(int) = print;if (print_ptr == print) // true</code></pre><p>所以，对于任意函数，都有五中调用函数的写法:</p><pre><code>print(10)(*print)(10)(&amp;print)(10)(*print_ptr)(10)print_ptr(10)</code></pre><h4 id="extern-说明符"><a href="#extern-说明符" class="headerlink" title="extern 说明符"></a>extern 说明符</h4><h4 id="static-说明符"><a href="#static-说明符" class="headerlink" title="static 说明符"></a>static 说明符</h4><h4 id="const-说明符"><a href="#const-说明符" class="headerlink" title="const 说明符"></a>const 说明符</h4><h4 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h4><pre><code>va_listva_startva_argva_end</code></pre><p><code>printf</code> 正是可变参数实现的示例，为什么 <code>int(*printf_ptr)(const char* format, ...)</code> 不需要提供给va_start 以个数？</p><p>因为printf已经在format中读取了个数。</p><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><pre><code>int scores[100]; // 声明数组int a[5] = {22, 36, 38, 99, 122}; // 声明并且赋值int a[100] = {0}; // 声明并设为0值int a[15] = {[2] = 29, [9] = 7, [14] = 48}; // 声明并设置对应位置，其余0值inta a[] = {22, 37, 222}; // 自动判别数组大小</code></pre><h4 id="数组长度"><a href="#数组长度" class="headerlink" title="数组长度"></a>数组长度</h4><pre><code>int a[] = {22, 37, 222};int arrLen = sizeof(a); // 12长度计算:sizeof(a) / sizeof(a[0]); // 3</code></pre><h4 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h4><pre><code>int board[10][10];</code></pre><h4 id="数组的地址"><a href="#数组的地址" class="headerlink" title="数组的地址"></a>数组的地址</h4><pre><code>int a[5] = {11, 22, 33, 44, 55};int* p = &amp;a[0];int* p = a; // 等同于</code></pre><blockquote><p>数组是一连串连续储存的同类型值，只要获得起始地址(首个成员的内存地址)，就能推算出其他成员的地址。</p></blockquote><h4 id="已声明数组不可修改"><a href="#已声明数组不可修改" class="headerlink" title="已声明数组不可修改"></a>已声明数组不可修改</h4><pre><code>int a[5] = { 1, 2, 3, 4, 5};int b[5] = a; // 报错int b[5];b = a; // 报错</code></pre><blockquote><p>指针指向可以改，但是内存地址不可修改</p></blockquote><h4 id="数组指针的加减法"><a href="#数组指针的加减法" class="headerlink" title="数组指针的加减法"></a>数组指针的加减法</h4><p>数组指针加减法其实就是内存地址之前的移动。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">5</span>] = &#123;<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">55</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, *(a+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 例子中遍历等于数组向下一个成员内存地址移动。`*(a+i)`取出该地址的值</span></span><br></pre></td></tr></table></figure><blockquote><p>由于数组名与指针是等价的，所以 <code>a[b] == *(a+b)</code></p></blockquote><p>常使用的遍历方案:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">55</span>, <span class="number">999</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *p = a;</span><br><span class="line"><span class="keyword">while</span> (*p != <span class="number">999</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, *p);</span><br><span class="line">p++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>遍历数组一般都是通过数组长度比较，但也可以通过数组起始地址和结束地址比较来实现:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span>* start, <span class="keyword">int</span>* end)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (start &lt; end) &#123;</span><br><span class="line">total += *start;</span><br><span class="line">start++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">5</span>] = &#123;<span class="number">20</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">39</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> arrSize = <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(arr[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%i\n"</span>, sum(arr, arr+arrSize));</span><br></pre></td></tr></table></figure><h4 id="数组的复制"><a href="#数组的复制" class="headerlink" title="数组的复制"></a>数组的复制</h4><p>由于数组名是指针，不能简单复制数组名。如:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* a;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">3</span>] = &#123;<span class="number">1</span> ,<span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">a = b;</span><br></pre></td></tr></table></figure></p><p>上面写法不是复制数组，只是将a、b指针指向b原先指向的地址。</p><p>复制最简单的就是元素逐个复制:</p><pre><code>for (i = 0; i &lt; N; i++)    a[i] = b[i];</code></pre><p>另一种方法是使用<code>memcpy()</code>函数(include string.h):</p><pre><code>memcpy(a, b, sizeof(b));</code></pre><h4 id="函数参数数组"><a href="#函数参数数组" class="headerlink" title="函数参数数组"></a>函数参数数组</h4><blockquote><p>数组名是一个指针，如果只传数组名，那么函数只知道数组开始地址，而不知道结束地址。也称之为<code>数组降低为指针</code>。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_array</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> length)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum = sum_array(a, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>多维数组，需要告知未知数组大小:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_array</span><span class="params">(<span class="keyword">int</span> a[][<span class="number">4</span>], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum = sum_array(a, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>上面展示的是必须告知未知的那个数组大小。</p><h4 id="变长数组作为参数"><a href="#变长数组作为参数" class="headerlink" title="变长数组作为参数"></a>变长数组作为参数</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_array</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> a[n])</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum = sum_array(n, a);</span><br></pre></td></tr></table></figure><p>变长数组中，n作为参数必须放在a[n]前，这样运行时才能确定数组a[n]的长度。</p><pre><code>int sum_array(int a[][4], int n);int sum_array(int n, int m, int a[n][m]);</code></pre><h4 id="数组字面量作为参数"><a href="#数组字面量作为参数" class="headerlink" title="数组字面量作为参数"></a>数组字面量作为参数</h4><pre><code>int a[] = {2, 3, 4, 5};int sum = sum_array(a, 4);int sum = sum_array((int []){2, 3, 4, 5}, 4);</code></pre><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>C语言没有单独的字符串类型。字符串即字符数组。</p><p>  char *word = { ‘H’, ‘e’, ‘l’, ‘l’, ‘o’, ‘\0’ }; // char word[] = “Hello”;</p><p>字符末尾必须添加<code>\0</code>(ANSII NULL) 表示字符结束，这样只要发现<code>\0</code>，那么就知道字符串结束了。</p><p>  char localString[10];</p><p>上面示例声明了一个10个字符的字符数组。由于必须留一个位置给<code>\0</code>,所以最多只能容纳9个字符的字符串。</p><h4 id="字符串的声明"><a href="#字符串的声明" class="headerlink" title="字符串的声明"></a>字符串的声明</h4><p>  char s[50] = “hello”; // s长度，其余为 \0</p><p>字符数组的长度，不能小于字符串的实际长度:</p><p>  char s[5] = “hello”;</p><p>上面示例中，字符串数组<code>s</code>的长度是5，小于字符串”hello”的实际长度6。</p><p>编译时不报错，实际只会有5个字符写入到内存中，再长也是只有5个字符。</p><p>  char s[5] = “hello!”;</p><p>此时编译器会Warning，并且会继续往后打印，直到出现<code>\0</code>.</p><p>原因是编译期间，代码识别为5的长度，后面也只会申请5个单位长度的字符数组大小。</p><p>有趣的是，char s[5] 在申请完内存空间后，会单独再申请一个int 为<code>5</code>的内存空间。</p><pre><code>char* s = &quot;Hello, world&quot;;s[0] = &apos;z&apos;; // 错误char* s1 = &quot;Hello, world&quot;;s[0] = &apos;z&apos;; // 成功</code></pre><blockquote><p>指针声明的数组，系统会将字符串的字面量保存在内存的常量区，这个区是不允许用户修改的。声明为数组时，编译器会给数组单独分配一段内存，字符串字面量会被编译器解释成字符数组，逐个字符写入到这段新分配的内存中，这段内存是允许修改的。</p></blockquote><h4 id="字符串修改"><a href="#字符串修改" class="headerlink" title="字符串修改"></a>字符串修改</h4><pre><code>char* s = &quot;Hello&quot;;s = &quot;World&quot;; // 正确，指针指向不同内存地址肯定可以char s[] = &quot;hello&quot;;s = &quot;world&quot;; // 报错</code></pre><p>指针指向另一块内存空间，这个好理解，肯定OK。但是数组的<code>=</code>相当于赋值，C语言规定，数组变量是一个不可修改的左值，即不能用赋值运算符为他重新赋值。</p><p>正确赋值方式:</p><pre><code>char s[10];strcpy(s, &quot;abc&quot;);</code></pre><h4 id="strlen"><a href="#strlen" class="headerlink" title="strlen"></a>strlen</h4><p>注意strlen 和sizeof 是两个不同的概念:</p><pre><code>char s[50] = &quot;hello&quot;;printf(&quot;%d\n&quot;, strlen(s)); // 5printf(&quot;%d\n&quot;, sizeof(s)); // 50</code></pre><h4 id="strcpy"><a href="#strcpy" class="headerlink" title="strcpy"></a>strcpy</h4><p><code>char* (*strcpy)(char dest[], const char source[]);</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">strcpy</span><span class="params">(<span class="keyword">char</span>* dest, <span class="keyword">const</span> <span class="keyword">char</span>* src)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (*dest++ = *source++);</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> str[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">strcpy</span>(str, <span class="string">"hello, world"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="strncpy"><a href="#strncpy" class="headerlink" title="strncpy"></a>strncpy</h4><p><code>char* (*strncpy)(char*dest, char* src, size_t n);</code></p><h4 id="strcat"><a href="#strcat" class="headerlink" title="strcat"></a>strcat</h4><p><code>char* (*strcat)(char* s1, const char* s2);</code></p><h4 id="strncat"><a href="#strncat" class="headerlink" title="strncat"></a>strncat</h4><p><code>char* (*strncat)(char* dest, const char*src, size_t n);</code></p><pre><code>strncat(str1, str2, sizeof(str1) - strlen(str1) - 1); // 平常用法</code></pre><p>n 代表str1 最大还可拼接单位: str1 内存空间 - str1 已占用长度 -1 就是后面还可拼接长度。(-1 代表 <code>\0</code>: strlen 不算<code>\0</code>)</p><h4 id="strcmp"><a href="#strcmp" class="headerlink" title="strcmp"></a>strcmp</h4><p><code>int (*strcmp)(const char* s1, const char* s2);</code></p><h4 id="strncmp"><a href="#strncmp" class="headerlink" title="strncmp"></a>strncmp</h4><p><code>int (*strncmp)(const char* s1, const char* s2, size_t n);</code></p><pre><code>char s1[12] = &quot;hello world&quot;;char s2[12] = &quot;hello C&quot;;int status = strncmp(s1, s2, 5); // 0 相同</code></pre><h4 id="sprintf-snprintf"><a href="#sprintf-snprintf" class="headerlink" title="sprintf, snprintf"></a>sprintf, snprintf</h4><p><code>int (*sprintf)(char* s, const char* format, ...);</code></p><pre><code>char first[6] = &quot;hello&quot;;char last[6] = &quot;world&quot;;char s[40];sprintf(s, &quot;%s %s&quot;, first, last); // s = hello world</code></pre><p><code>int (*snprintf)(char* s, size_t n, const char* format, ...);</code></p><pre><code>snprintf(s, 4, &quot;%s %s&quot;, &quot;hello&quot;, &quot;world&quot;); // hel</code></pre><h3 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h3><p>栈: 系统管理的内存，存放在栈上；堆heap: 用户手动创建，用户手动管理。</p><h4 id="void-指针"><a href="#void-指针" class="headerlink" title="void 指针"></a>void 指针</h4><pre><code>int x = 10;void* p = &amp;x;int* q = p;</code></pre><h4 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h4><p><code>void* (*malloc)(size_t size)</code></p><p><code>malloc</code>函数用于分配内存，该函数向系统要求一段内存，系统就在”堆”里面分配一段连续的内存块。原型定义在头文件<code>stdlib.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span>* a = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">50</span>);</span><br><span class="line"><span class="built_in">puts</span>(a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"111----%p\n"</span>, a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"111====%s\n"</span>, a);</span><br><span class="line"><span class="built_in">strcpy</span>(a, <span class="string">"我喜欢小钮"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"222----%p\n"</span>, a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"222====%s\n"</span>, a);</span><br><span class="line"><span class="keyword">char</span> arr[] = <span class="string">"我喜欢小可爱"</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">a[i] = arr[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"333----%p\n"</span>, a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"333====%s\n"</span>, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>数组char<em> a 不能被直接 `</em>a = “新的数组”`, 应该采用上面两种方式来内存写入。</p></blockquote><blockquote><p>C语言也因此规定，数组变量是一个不可修改的左值，即不能用赋值运算符为它重新赋值。</p></blockquote><h4 id="free"><a href="#free" class="headerlink" title="free"></a>free</h4><p><code>void (*free)(void* block)</code></p><p><code>free</code>用于释放<code>malloc</code>函数分配的内存，将这块内存还给系统以便重新使用，否则这个内存块会一直占用到程序运行结束。</p><pre><code>int* p = (int*)malloc(sizeof(int));*p = 12;free(p);</code></pre><h4 id="calloc"><a href="#calloc" class="headerlink" title="calloc"></a>calloc</h4><p><code>void* (*calloc)(size_t n, size_t size)</code></p><p><code>calloc</code>函数的作用与<code>malloc</code>相似，也是分配内存块。</p><blockquote><p>区别亮点</p></blockquote><ol><li><code>calloc</code>接受两个参数，第一个参数是某种数据类型的值的数量，第二个是该数据类型的单位字节长度。</li><li><p><code>calloc</code>会将所分配的内存全部初始化为<code>0</code>。<code>malloc</code>不会对内存进行初始化，如果想要改为<code>0</code>值，则额外调用<code>memset()</code>函数。</p><pre><code>int* p = calloc(10, sizeof(int));// 等同于int* p = malloc(sizeof(int)*10);memset(p, 0, sizeof(int)*10);</code></pre></li></ol><p><code>calloc</code>分配的内存块，也要使用<code>free</code>释放。</p><h4 id="realloc"><a href="#realloc" class="headerlink" title="realloc"></a>realloc</h4><p><code>void* (*realloc)(void* block, size_t size)</code></p><p><code>realloc</code>函数用于修改已经分配的内存块的大小，放大或者缩小，返回一个指向新的内存块的指针。如果分配不成功，返回NULL。</p><pre><code>int* b;b = malloc(sizeof(int)*10);b = realloc(b, sizeof(int)*2000);</code></pre><h4 id="restrict说明符"><a href="#restrict说明符" class="headerlink" title="restrict说明符"></a>restrict说明符</h4><blockquote><p>声明指针变量时，可以使用<code>restrict</code>说明符，告诉编译器该块内存区域只有当前指针一种访问方式，其他指针不能读写该块内存。这种指针成为”受限指针”(restrict pointer)。</p></blockquote><pre><code>int* restrict p;p = malloc(sizeof(int));</code></pre><h4 id="memcpy"><a href="#memcpy" class="headerlink" title="memcpy"></a>memcpy</h4><p><code>void* (*memcpy)(void* restrict dest, void* restrict source, size_t n)</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"Goats!"</span>;</span><br><span class="line"><span class="keyword">char</span> t[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">memcpy</span>(t, s, <span class="keyword">sizeof</span>(s)); <span class="comment">// 拷贝7个字节，包括终止符</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>, t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>memcpy</code>可以取代<code>strcpy</code> 进行字符串拷贝，而且是更好的方法，不仅更安全，速度也更快，它不检查字符串尾部的<code>\0</code>字符。</p></blockquote><pre><code>char* s = &quot;hello world&quot;;size_t len = strlen(s) + 1;char* c = malloc(len);if (c) {    // strcpy 写法    strcpy(c, s);    // memcpy 写法    memcpy(c, s, len);}</code></pre><blockquote><p>使用void指针，也可以自定义一个复制内存的函数:</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">my_memcpy</span><span class="params">(<span class="keyword">void</span>* dest, <span class="keyword">void</span>* src, <span class="keyword">int</span> byte_count)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (byte_count--) &#123;</span><br><span class="line">*dest++ = *src++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="memmove"><a href="#memmove" class="headerlink" title="memmove"></a>memmove</h4><p><code>void* (*memmove)(void* dest, void* source, size_t n)</code></p><blockquote><p><code>memmove</code>函数用于将一段内存数据复制到另一段内存。它跟<code>memcpy</code>主要区别是，它允许目标区域与原区域有重叠。如果重叠，原区域内容会被更改。</p></blockquote><pre><code>int a[100];memmove(&amp;a[0], &amp;a[1], 99*sizeof(int));</code></pre><p>另一个例子:</p><pre><code>char x[] = &quot;Home Sweet Home&quot;;// 输出Sweet Home Homeprintf(&quot;%s\n&quot;, (char*) memmove(x, &amp;x[5], 10));</code></pre><h4 id="memcpy-1"><a href="#memcpy-1" class="headerlink" title="memcpy"></a>memcpy</h4><p><code>int (*memcmp)(const void* s1, const void* s2, size_t n)</code></p><pre><code>char* s1 = &quot;abc&quot;;char* s2 = &quot;acd&quot;;int r = memcmp(s1, s2, 3);</code></pre><h3 id="struct-结构"><a href="#struct-结构" class="headerlink" title="struct 结构"></a>struct 结构</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fraction</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> numerator;</span><br><span class="line">  <span class="keyword">int</span> denominator;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fraction</span> <span class="title">f1</span>;</span></span><br><span class="line">f1.numerator = <span class="number">22</span>;</span><br><span class="line">f1.denominator = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Car</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span>* name;</span><br><span class="line">  <span class="keyword">float</span> price;</span><br><span class="line">  <span class="keyword">int</span> speed;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Car</span> <span class="title">saturn</span> = &#123;</span><span class="string">"Saturn SL/2"</span>, <span class="number">16000.00</span>, <span class="number">175</span>&#125;; <span class="comment">// struct Car saturn = &#123;.speed=172, .name="Saturn SL/2"&#125;;</span></span><br><span class="line">saturn.speed = <span class="number">168</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span> title[<span class="number">500</span>];</span><br><span class="line">  <span class="keyword">char</span> author[<span class="number">100</span>];</span><br><span class="line">  <span class="keyword">float</span> value;</span><br><span class="line">&#125; b1 = &#123;<span class="string">"Harry Potter"</span>, <span class="string">"J. K. Rowling"</span>, <span class="number">10.0</span>&#125;,</span><br><span class="line">  b2 = &#123;<span class="string">"Cancer Ward"</span>, <span class="string">"Aleksandr Solzhenitsyn"</span>, <span class="number">7.85</span>&#125;;</span><br><span class="line"></span><br><span class="line">`<span class="keyword">typedef</span>` 为<span class="class"><span class="keyword">struct</span>结构指定一个别名:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">cell_phone</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> cell_no;</span><br><span class="line">  <span class="keyword">float</span> minutes_of_charge;</span><br><span class="line">&#125; phone;</span><br><span class="line"></span><br><span class="line">phone p = &#123;<span class="number">5551234</span>, <span class="number">5</span>&#125;;</span><br></pre></td></tr></table></figure><h4 id="struct-的复制"><a href="#struct-的复制" class="headerlink" title="struct 的复制"></a>struct 的复制</h4><blockquote><p>struct 变量的使用复制运算符<code>=</code>，复制给另一个变量，这时会生成一个全新的副本。系统会分配一块新的内存空间，大小与原来的变量相同，把每个属性都复制过来，即原样生成了一份数据。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cat</span> &#123;</span> <span class="keyword">char</span> name[<span class="number">30</span>]; <span class="keyword">short</span> age; &#125; a, b;</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcpy</span>(a.name, <span class="string">"Hula"</span>);</span><br><span class="line">a.age = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">b = a;</span><br><span class="line">b.name[<span class="number">0</span>] = <span class="string">"M"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>, a.name); <span class="comment">// Hula</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>, b.name); <span class="comment">// Mula</span></span><br></pre></td></tr></table></figure><blockquote><p>上面示例是有前提的，就是struct 结构的属性必须定义成字符数组，才能复制数据。如果指针数组，只是指针的复制，内存地址指向相同地址:</p></blockquote><p><code>struct cat { char* name; short age; } a, b;</code></p><h4 id="struct-指针"><a href="#struct-指针" class="headerlink" title="struct 指针"></a>struct 指针</h4><p>struct 变量传入函数，类似 <code>=</code> 的对象拷贝，传值操作时:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">happy</span><span class="params">(struct turtle* t)</span> </span>&#123;</span><br><span class="line">  (*.t).age = (*t).age + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">happy(&amp;myTurtle);</span><br></pre></td></tr></table></figure><p><code>(*t).age</code> 这样的写法很麻烦。C语言引入了一个新的箭头运算符(<code>-&gt;</code>)，可以从struct指针上直接获取属性，大大增强了代码的可读性。</p><p><code>t-&gt;.age = t-&gt;age + 1;</code></p><h4 id="struct-位字段"><a href="#struct-位字段" class="headerlink" title="struct 位字段"></a>struct 位字段</h4><h4 id="struct-弹性数组成员"><a href="#struct-弹性数组成员" class="headerlink" title="struct 弹性数组成员"></a>struct 弹性数组成员</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">vstring</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> len;</span><br><span class="line">  <span class="keyword">char</span> chars[];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">vstring</span>* <span class="title">str</span> = <span class="title">malloc</span>(<span class="title">sizeof</span>(<span class="title">struct</span> <span class="title">vstring</span>)+<span class="title">n</span>*<span class="title">sizeof</span>(<span class="title">char</span>));</span></span><br><span class="line">str-&gt;len = n;</span><br><span class="line">str-&gt;chars = <span class="string">"我喜欢吃饭"</span>;</span><br></pre></td></tr></table></figure><h3 id="typedef命令"><a href="#typedef命令" class="headerlink" title="typedef命令"></a>typedef命令</h3><blockquote><p>typedef命令用来为某个类型起别名。<code>typedef type name;</code></p></blockquote><pre><code>typedef unsigned char BYTE;BYTE c= &apos;z&apos;;</code></pre><blockquote><p>typedef 可以为指针起别名:</p></blockquote><pre><code>typedef int* intptr;int a = 10;intptr x = &amp;a;</code></pre><blockquote><p>typedef也可以用来为数组类型起别名:</p></blockquote><pre><code>typydef int five_ints[5];five_ints x = {11, 22, 33, 44, 55};</code></pre><blockquote><p>typedef 为函数起别名:</p></blockquote><pre><code>typedef signed char (*fp)(void); // 类型别名fp是一个指针，代表函数 signed char(*)(void)</code></pre><h3 id="Union-结构"><a href="#Union-结构" class="headerlink" title="Union 结构"></a>Union 结构</h3><h3 id="Enum类型"><a href="#Enum类型" class="headerlink" title="Enum类型"></a>Enum类型</h3><p><code>enum colors {RED, GREEN, BLUE};</code></p><h3 id="预处理器-Preprocessor"><a href="#预处理器-Preprocessor" class="headerlink" title="预处理器(Preprocessor)"></a>预处理器(Preprocessor)</h3><p><code>#define</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRINT_NUMS_TO_PRODUCT(a, b) &#123; \</span></span><br><span class="line">  <span class="keyword">int</span> product = (a) * (b); \</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; product; i++) &#123; \</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i); \</span><br><span class="line">  &#125; \</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="运算符-运算符"><a href="#运算符-运算符" class="headerlink" title="#运算符, ##运算符"></a><code>#</code>运算符, <code>##</code>运算符</h4><h4 id="不定参数的宏"><a href="#不定参数的宏" class="headerlink" title="不定参数的宏"></a>不定参数的宏</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> X(a, b, ...) (10*(a) + 20*(b), __VA_ARGS__)</span></span><br><span class="line">X(<span class="number">5</span>, <span class="number">4</span>, <span class="number">3.14</span>, <span class="string">"Hi!"</span>, <span class="number">12</span>)</span><br><span class="line"><span class="comment">// 替换成:</span></span><br><span class="line">(<span class="number">10</span>*(<span class="number">5</span>)+<span class="number">20</span>*(<span class="number">4</span>)), <span class="number">3.14</span>, <span class="string">"Hi!"</span>, <span class="number">12</span></span><br></pre></td></tr></table></figure><pre><code>#define X(...) #_VA_ARGS__printf(&quot;%s\n&quot;, X(1, 2, 3)); // &quot;1, 2, 3&quot;</code></pre><h4 id="undef"><a href="#undef" class="headerlink" title="#undef"></a>#undef</h4><p><code>#undef</code>指令用来取消已经使用<code>#define</code>定义的宏。</p><pre><code>#define LIMIT 400#undef LIMIT</code></pre><h4 id="include"><a href="#include" class="headerlink" title="#include"></a>#include</h4><h4 id="if-endif"><a href="#if-endif" class="headerlink" title="#if ...#endif"></a><code>#if ...#endif</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FOO 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> FOO</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="number">3.1415</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"define\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> FOO == 2</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"never enter!\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"not define\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p><code>gcc -DDEBUG=1 foo.c</code> 可以在编译期间指定宏:</p><pre><code>#if DEBUG// enter#endif</code></pre><h4 id="ifdef-endif"><a href="#ifdef-endif" class="headerlink" title="#ifdef...#endif"></a><code>#ifdef...#endif</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> EXTRA_HEPPY</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"I'm extra happy!\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"I'm just regular\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><h4 id="defined-运算符"><a href="#defined-运算符" class="headerlink" title="defined 运算符"></a>defined 运算符</h4><p><code>#ifdef</code> 指令，等同于<code>#if defined</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> FOO</span></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined FOO</span></span><br></pre></td></tr></table></figure><h4 id="ifndef…-endif"><a href="#ifndef…-endif" class="headerlink" title="#ifndef…#endif"></a>#ifndef…#endif</h4><p><code>#ifndef</code> 等同于 <code>#if !defined</code></p><h4 id="预定义宏"><a href="#预定义宏" class="headerlink" title="预定义宏"></a>预定义宏</h4><h4 id="line"><a href="#line" class="headerlink" title="#line"></a><code>#line</code></h4><h4 id="error"><a href="#error" class="headerlink" title="#error"></a><code>#error</code></h4><blockquote><p><code>#error</code> 指令用于让预处理器抛出一个错误, 终止编译。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __STDC_VERSION__ != 201112L</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">error</span> Not C11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>如果编译器不适用C11标准，就终止编译。GCC编译器会想下面这样报错:</p><pre><code>$ gcc -std=c99 newish.cnewish.c:14.2: error: #error Not C11</code></pre><h4 id="pragma"><a href="#pragma" class="headerlink" title="#pragma"></a><code>#pragma</code></h4><h3 id="I-O-函数"><a href="#I-O-函数" class="headerlink" title="I/O 函数"></a>I/O 函数</h3><h4 id="缓存和字节流"><a href="#缓存和字节流" class="headerlink" title="缓存和字节流"></a>缓存和字节流</h4><h4 id="printf"><a href="#printf" class="headerlink" title="printf"></a>printf</h4><h4 id="scanf"><a href="#scanf" class="headerlink" title="scanf"></a>scanf</h4><pre><code>int i, j;float x, y;scanf(&quot;%d%d%f%f&quot;, &amp;i, &amp;j, &amp;x, &amp;y);</code></pre><p><code>scanf()</code>返回值是一个整数，表示成功读取的变量的个数。</p><blockquote><p><code>scanf() 读取%s 字符串时需要注意数组溢出风险:</code></p></blockquote><pre><code>char name[11];scanf(&quot;%10s&quot;, name);</code></pre><h4 id="赋值忽略符"><a href="#赋值忽略符" class="headerlink" title="赋值忽略符"></a>赋值忽略符</h4><p>有时用户舒服可能不符合预期格式:</p><p><code>scanf(&quot;%d-%d-%d&quot;, &amp;year, &amp;month, &amp;day);</code></p><p>上面示例用户输入<code>2020-01-01</code>, 就会正确读出年月日。问题用户可能输入其他格式: <code>2020/01/01</code></p><p>为了避免上述情况，<code>scanf()</code> 提供一个赋值忽略符<code>*</code>. 只要把<code>*</code>加到任何占位符的百分号后面，解析就会被抛弃:</p><p><code>scanf(&quot;%d%*c%d%*c%d&quot;, &amp;year, &amp;month, &amp;day);</code></p><h4 id="sscanf"><a href="#sscanf" class="headerlink" title="sscanf"></a>sscanf</h4><p><code>sscanf</code>从字符串读取，而不是如<code>scanf</code>从用户输入读取。</p><pre><code>fgets(str, sizeof(str), stdin);sscanf(str, &quot;%d%d&quot;, &amp;i, &amp;j);</code></pre><h4 id="getchar-putchar"><a href="#getchar-putchar" class="headerlink" title="getchar / putchar"></a>getchar / putchar</h4><pre><code>char ch;ch = getChar();// 等同于scanf(&quot;%c&quot;, &amp;ch);</code></pre><p>例子, 计算某一行的字符长度:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(getchar() != <span class="string">'\n'</span>)</span><br><span class="line">len++;</span><br></pre></td></tr></table></figure><pre><code>putchar(ch);// 等同于printf(&quot;%c&quot;, ch);</code></pre><h4 id="gets-puts"><a href="#gets-puts" class="headerlink" title="gets / puts"></a>gets / puts</h4><h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><p><code>FILE* fp;</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">FILE* fp;</span><br><span class="line"><span class="keyword">char</span> c;</span><br><span class="line">fp = fopen(<span class="string">"hello.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line"><span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">c = fgetc(fp);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c\n"</span>, c);</span><br><span class="line">fclose(fp);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>fopen()</code>打开指定文件，返回一个FILE指针。它相当于将指定文件的信息与新建的文件指针<code>fp</code>相关联，在FILE结构内部记录了这样一些信息: 文件内部的当前读写位置、读写报错的记录、文件结尾指示器、缓冲区开始位置的指针、文件标识符、一个计数器(统计拷贝进缓冲区的字节数)等等。同时，它还为文件建立一个缓冲区。由于存在缓冲区，也可以说<code>fopen()</code>函数<strong>打开一个流</strong>，后继读写文件操作都是流模式。</p></blockquote><blockquote><p><code>fgetc()</code> 已调用，文件的数据块先拷贝到缓冲区。不同的计算机有不同的缓冲区大小，一般是512字节或是它的背书，如4096或16384.</p></blockquote><blockquote><p><code>fgetc()</code>从缓冲区读取数据，同时将文件指针内部的读写位置指示器，指向所读取字符的下一个字符。所有的文件读取函数都使用相同的缓冲区，后面再调用任何一个读取函数，都将从指示器指向的位置，即上一次读取函数停止的位置开始读取。</p></blockquote><blockquote><p>当读取函数发现已读完缓冲区里面的所有字符时，会请求把下一个缓冲区大小的数据块，从文件拷贝到缓冲区中。读取函数就以这种方式，读完文件的所有内容，知道文件结尾。</p></blockquote><h4 id="fopen"><a href="#fopen" class="headerlink" title="fopen"></a>fopen</h4><p><code>FILE* (*fopen)(char* filename, char* mode);</code></p><pre><code>fp = fopen(&quot;in.dat&quot;, &quot;r&quot;);if (fp == NULL) {    printf(&quot;Can&apos;t open file!\n&quot;);    exit(EXIT_FAILURE);}</code></pre><blockquote><p><code>fopen()</code>函数会为打开的文件创建一个缓存区。读模式下，创建的是读缓冲区；写模式下，创建的是写缓冲区；读写模式下，会同时创建两个缓冲区。C语言通过缓冲区，已流的形式，向文件读写数据。</p></blockquote><blockquote><p><code>fopen()</code>的模式字符串，默认是以文本流读写。如果添加<code>b</code>后缀(表示binary)，就会以”二进制流”进行读写。比如， <code>rb</code>是读取二进制数据模式，<code>wb</code>是写入二进制数据模式。</p></blockquote><blockquote><p>mode 模式有: <code>r w a r+ w+ a+</code>, 还有<code>x</code>后缀，表示独占模式(exclusive)。如果文件已经存在，则打开文件失败；如果文件不存在，则新建文件，打开后不再允许其他程序或线程访问当前文件。比如, <code>wx</code>表示以独占模式写入文件，如果文件已经存在，就会打开失败。</p></blockquote><h4 id="标准流"><a href="#标准流" class="headerlink" title="标准流"></a>标准流</h4><pre><code>stdin 0stdout 1stderr 2</code></pre><blockquote><p>如果标准输入不绑定键盘，而是绑定其他文件，可以再文件名前面加上<code>&lt;</code>, 跟在程序名后面。这叫做”输入重定向”(input redirection).</p></blockquote><pre><code>demo &lt; in.dat</code></pre><blockquote><p>上面示例中，<code>demo</code>程序代码里面的<code>stdin</code>, 将指向文件<code>in.dat</code>, 即从<code>in.dat</code>获取数据。</p></blockquote><blockquote><p>如果标准输出绑定其他文件，而不是显示器，可以在文件名前加上<code>&gt;</code>, 跟在程序名后面。这叫做”输出重定向”(output redirection).</p></blockquote><pre><code>demo &gt; out.dat</code></pre><blockquote><p>输出重定向<code>&gt;</code>会先擦去<code>out.dat</code>的所有原有的内容，然后再写入。如果希望写入的信息追加在<code>out.dat</code>的结尾，可以使用<code>&gt;&gt;</code>符号。</p></blockquote><pre><code>demo &gt;&gt; out.dat</code></pre><blockquote><p>标准错误的重定向符号是 <code>2&gt;</code>。其中的<code>2</code>代表文件指针的编号。</p></blockquote><p>各种重定向和合并在一条命令里面:</p><pre><code>demo &lt; in.dat &gt; out.dat 2&gt; err.txt</code></pre><p>重定向还有另一种情况，就是将一个程序的标准输出<code>stdout</code>，指向另一个程序的标准输入<code>stdin</code>，这时要使用<code>|</code>符号:</p><pre><code>random | sum</code></pre><h4 id="fclose"><a href="#fclose" class="headerlink" title="fclose"></a>fclose</h4><h4 id="EOF"><a href="#EOF" class="headerlink" title="EOF"></a>EOF</h4><h4 id="freopen"><a href="#freopen" class="headerlink" title="freopen"></a>freopen</h4><p><code>FILE* (*freopen)(char* filename, char* mode, FILE stream);</code></p><pre><code>freopen(&quot;output.txt&quot;, &quot;w&quot;, stdout);printf(&quot;helloc&quot;);</code></pre><blockquote><p>下面是<code>freopen</code>关联<code>scanf</code>例子</p></blockquote><pre><code>int i, i2;scanf(&quot;%d&quot;, &amp;i);freopen(&quot;someints.txt&quot;, &quot;r&quot;, stdin);scanf(&quot;%d&quot;, &amp;i2);</code></pre><h4 id="fgetc-getc"><a href="#fgetc-getc" class="headerlink" title="fgetc / getc"></a>fgetc / getc</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*fgetc)(FILE* stream);</span><br><span class="line"><span class="keyword">int</span> (*getc)(FILE* stream);</span><br></pre></td></tr></table></figure><blockquote><p><code>getc</code>一般用宏实现，而<code>fgetc</code> 一般是函数实现；返回值的类型是int，因为读取失败的情况下，他们会返回<code>EOF</code>, 这个值一般是<code>-1</code>.</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">FILE* fp;</span><br><span class="line">fp = fopen(<span class="string">"hello.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line"><span class="keyword">int</span> c;</span><br><span class="line"><span class="keyword">while</span> ((c = getc(fp)) != EOF)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, c);</span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fputc-putc"><a href="#fputc-putc" class="headerlink" title="fputc / putc"></a>fputc / putc</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*fputc)(<span class="keyword">int</span> <span class="keyword">char</span>, FILE* stream);</span><br><span class="line"><span class="keyword">int</span> (*putc)(<span class="keyword">int</span> <span class="keyword">char</span>, FILE* stream);</span><br></pre></td></tr></table></figure><h4 id="fprintf"><a href="#fprintf" class="headerlink" title="fprintf"></a>fprintf</h4><p><code>int (*fprintf)(FILE* stream, const char* format, ...);</code></p><p><code>fprintf</code>可以替代<code>printf</code>:</p><pre><code>printf(&quot;hello, world\n&quot;);fprintf(stdout, &quot;hello, world\n&quot;);</code></pre><h4 id="fscanf"><a href="#fscanf" class="headerlink" title="fscanf"></a>fscanf</h4><p><code>int (*fscanf)(FILE* stream, const char* format, ...);</code></p><pre><code>fscanf(fp, &quot;%d%d&quot;, &amp;i, &amp;j);</code></pre><blockquote><p><code>fscanf</code>可以连续读取，知道读到文件尾，或者发生错误(读取失败、匹配失败)，才会停止读取，所以<code>fscanf</code>通常放在循环里面:</p></blockquote><pre><code>while(fscanf(fp, &quot;%s&quot;, words) == 1)    puts(words);</code></pre><h4 id="fgets"><a href="#fgets" class="headerlink" title="fgets"></a>fgets</h4><p><code>char* fgets(char* str, int STRLEN, FILE* fp);</code></p><blockquote><p><code>fgets</code>读取STRLEN -1个字符后，获取遇到换行符与文件结尾，就会停止读取，然后再已经读取的内容末尾添加一个空字符<code>\0</code>，使之成为一个字符串。注意, <code>fgets</code>会将换行符(<code>\n</code>)存储进字符串。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">FILE* fp;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">1024</span>]; <span class="comment">// 数组必须足够大，足以放下一行</span></span><br><span class="line"><span class="keyword">int</span> linecount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"hello.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line"><span class="keyword">while</span> (fgets(s, <span class="keyword">sizeof</span> s, fp) != <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d: %s"</span>, ++linecount, s);</span><br><span class="line"></span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>循环读取用户的输入:</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> words[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"Enter strings (q to quit):"</span>);</span><br><span class="line"><span class="keyword">while</span> (fgets(words, <span class="number">10</span>, <span class="built_in">stdin</span>) != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (words[<span class="number">0</span>] == <span class="string">'q'</span> &amp;&amp; words[<span class="number">1</span>] == <span class="string">'\n'</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="built_in">puts</span>(words);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"Done."</span>);</span><br></pre></td></tr></table></figure><h4 id="fputs"><a href="#fputs" class="headerlink" title="fputs"></a>fputs</h4><blockquote><p><code>fputs</code>函数用于向文件写入字符串，和<code>puts</code>函数只有一点不同，那就是它不会在字符串末尾添加换行符。这是因为<code>fgets</code>保留了换行符，所以<code>fputs</code>就不添加了。<code>fputs</code>函数通常与<code>fgets</code>配对使用。</p></blockquote><p><code>int (*fputs)(const char* str, FILE* stream);</code></p><p>示例:</p><pre><code>char words[14];puts(&quot;Enter a string, please.&quot;);fgets(words, 14, stdin);puts(&quot;This is your string:&quot;);fputs(words, stdout);</code></pre><h4 id="fwrite"><a href="#fwrite" class="headerlink" title="fwrite"></a>fwrite</h4><blockquote><p><code>fwrite</code>用来一次性写入较大的数据块，主要用途是将数组数据一次性写入文件，适合写入二进制数据。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">size_t</span> (*fwrite)(</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">void</span>* ptr, <span class="comment">// 无类型指针</span></span><br><span class="line"><span class="keyword">size_t</span> size, <span class="comment">// 成员大小</span></span><br><span class="line"><span class="keyword">size_t</span> nmemb, <span class="comment">// 成员数量</span></span><br><span class="line">FILE* fp</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>要将整个数组arr 写入文件，可以采用下面的写法:</p><p><code>fwrite(arr, sizeof(arr[0]), sizeof(arr) / sizeof(arr[0]), fp);</code></p><p>示例:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tperson</span> &#123;</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">200</span>];</span><br><span class="line"><span class="keyword">int</span> height;</span><br><span class="line"><span class="keyword">char</span> nickname[<span class="number">100</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tperson</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125; person;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">person p = &#123;<span class="string">"akerdi"</span>, <span class="number">180</span>, <span class="string">"900m"</span>&#125;;</span><br><span class="line">  person np = &#123;<span class="string">"littleshuai"</span>, <span class="number">190</span>, <span class="string">"-900m"</span>&#125;;</span><br><span class="line">  p.next = &amp;np;</span><br><span class="line">  FILE* fp;</span><br><span class="line">  fp = fopen(<span class="string">"p.txt"</span>, <span class="string">"wb"</span>);</span><br><span class="line">  fwrite(&amp;p.name, <span class="keyword">sizeof</span>(p.name), <span class="number">1</span>, fp); <span class="comment">// 大小、数量互换是相同的</span></span><br><span class="line">  fwrite(&amp;p.nickname, <span class="keyword">sizeof</span>(p.nickname), <span class="number">1</span>, fp);</span><br><span class="line">  fwrite(&amp;p.height, <span class="keyword">sizeof</span>(p.height), <span class="number">1</span>, fp);</span><br><span class="line">  fwrite(&amp;p.next-&gt;name, <span class="keyword">sizeof</span>(p.next-&gt;name), <span class="number">1</span>, fp);</span><br><span class="line">  fwrite(&amp;p.next-&gt;nickname, <span class="keyword">sizeof</span>(p.next-&gt;nickname), <span class="number">1</span>, fp);</span><br><span class="line">  fwrite(&amp;p.next-&gt;height, <span class="keyword">sizeof</span>(p.next-&gt;height), <span class="number">1</span>, fp);</span><br><span class="line"></span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  FILE* fp = fopen(<span class="string">"p.txt"</span>, <span class="string">"rb"</span>);</span><br><span class="line">  person p = &#123;&#125;;</span><br><span class="line">  person np = &#123;&#125;;</span><br><span class="line">  p.next = &amp;np;</span><br><span class="line">  fread(&amp;p.name, <span class="keyword">sizeof</span>(p.name), <span class="number">1</span>, fp);</span><br><span class="line">  fread(&amp;p.nickname, <span class="keyword">sizeof</span>(p.nickname), <span class="number">1</span>, fp);</span><br><span class="line">  fread(&amp;p.height, <span class="keyword">sizeof</span>(p.height), <span class="number">1</span>, fp);</span><br><span class="line">  fread(&amp;p.next-&gt;name, <span class="keyword">sizeof</span>(p.next-&gt;name), <span class="number">1</span>, fp);</span><br><span class="line">  fread(&amp;p.next-&gt;nickname, <span class="keyword">sizeof</span>(p.next-&gt;nickname), <span class="number">1</span>, fp);</span><br><span class="line">  fread(&amp;p.next-&gt;height, <span class="keyword">sizeof</span>(p.next-&gt;height), <span class="number">1</span>, fp);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,p.name);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,p.nickname);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p.height);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p.next-&gt;height);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,p.next-&gt;name);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,p.next-&gt;nickname);</span><br><span class="line"></span><br><span class="line">  fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  write();</span><br><span class="line">  read();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>👍🏻好示例</p><h4 id="fread"><a href="#fread" class="headerlink" title="fread"></a>fread</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">size_t</span> (*fread)(</span><br><span class="line"><span class="keyword">void</span>* ptr, <span class="comment">// 目标指针</span></span><br><span class="line"><span class="keyword">size_t</span> size, <span class="comment">// 成员大小</span></span><br><span class="line"><span class="keyword">size_t</span> nmemb, <span class="comment">// 成员数量</span></span><br><span class="line">FILE* fp</span><br><span class="line">);</span><br></pre></td></tr></table></figure><pre><code>double earnings[10];fread(earnings, sizeof(double), 10, fp);</code></pre><h4 id="feof"><a href="#feof" class="headerlink" title="feof"></a>feof</h4><blockquote><p>feof 函数判断文件的内部指针是否指向文件结尾。</p></blockquote><p><code>int (*feof)(FILE* fp);</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line">FILE* cfPtr = fopen(<span class="string">"clients.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line"><span class="keyword">while</span> (!feof(cfPtr)) &#123;</span><br><span class="line"><span class="built_in">fscanf</span>(cfPtr, <span class="string">"%d%s\n"</span>, &amp;num, name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %s\n"</span>, num, name);</span><br><span class="line">&#125;</span><br><span class="line">fclose(cfPtr);</span><br></pre></td></tr></table></figure><blockquote><p><code>feof()</code>为真时，可以通过<code>fseek()</code>、<code>rewind()</code>、<code>fsetpos()</code>函数改变文件内部读写位置的指示器，从而清除这个函数的状态。</p></blockquote><h4 id="fseek"><a href="#fseek" class="headerlink" title="fseek"></a>fseek</h4><blockquote><p>每个文件指针都有一个内部指示器(内部指针)，记录当前打开的文件的读写位置(file position)，即下一次读写从哪里开始。文件操作函数(比如<code>getc()</code>、<code>fgets()</code>、<code>fscanf()</code>和<code>fread()</code>等)都从这个指示器指定的位置开始按顺序读写文件。</p></blockquote><blockquote><p>如果希望改变这个指示器，将它移到文件的指定位置，可以使用<code>fseek()</code>函数。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*fseek)(</span><br><span class="line">FILE* stream,</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">int</span> offset, <span class="comment">// 正值(向文件末尾移动)、负值(向文件开始处移动)或0(不动)</span></span><br><span class="line"><span class="keyword">int</span> whence <span class="comment">// 位置基准，用来确定计算起点。它的值是三个宏(`stdio.h`): `SEEK_SET(文件开始处)`、`SEEK_CUR(内部指针的当前位置)`、`SEEK_END(文件末尾)`</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fseek(fp, <span class="number">0L</span>, SEEK_SET);</span><br><span class="line">fseek(fp, <span class="number">0L</span>, SEEK_END);</span><br><span class="line">fseek(fp, <span class="number">2L</span>, SEEK_CUR);</span><br><span class="line">fseek(fp, <span class="number">10L</span>, SEEK_SET);</span><br><span class="line">fseek(fp, <span class="number">-10L</span>, SEEK_END);</span><br></pre></td></tr></table></figure><pre><code>for (count = 1L; count &lt;= size; count++) {    fseek(fp, -count, SEEK_END);    ch = getc(fp);}</code></pre><blockquote><p><code>fseek()</code> 最好只用来操作二进制文件，不要用来读取文本文件。因为文本文件的字符有不同的编码，某个位置的准确字节位置不容易确定。</p></blockquote><h4 id="ftell"><a href="#ftell" class="headerlink" title="ftell"></a>ftell</h4><blockquote><p><code>ftell()</code> 函数返回文件内部指示器的当前位置。</p></blockquote><p><code>long int (*ftell)(FILE* stream);</code></p><blockquote><p><code>ftell()</code>可以跟<code>fseek()</code> 配合使用，先记录内部指针的位置，操作之后返回原来的位置。</p></blockquote><pre><code>long file_pos = ftell(fp);// ...fseek(fp, file_pos, SEEK_SET);</code></pre><blockquote><p>先将指示器定位到文件结尾，然后得到文件开始处到结尾的字节数:</p></blockquote><pre><code>fseek(fp, 0L, SEEK_END);long size = ftell(fp);</code></pre><h4 id="rewind"><a href="#rewind" class="headerlink" title="rewind"></a>rewind</h4><p><code>void (*rewind)(FILE* stream);</code></p><p><code>rewind(fp)</code>基本等价于<code>fseek(fp, 0L, SEEK_SET);</code>, 唯一区别是<code>rewind()</code>没有返回值，而且会清除当前文件的错误指示器。</p><h4 id="fgetpos-fsetpos"><a href="#fgetpos-fsetpos" class="headerlink" title="fgetpos() / fsetpos()"></a>fgetpos() / fsetpos()</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*fgetpos)(FILE* stream, <span class="keyword">fpos_t</span>* pos);</span><br><span class="line"><span class="keyword">int</span> (*fsetpos)(FILE* stream, <span class="keyword">const</span> <span class="keyword">fpos_t</span>* pos);</span><br></pre></td></tr></table></figure><p><code>fgetpos()</code> / <code>fsetpos()</code> 相当于位数比<code>fseek()</code>/<code>ftell()</code>的功能。long int 长度为4字节，能够表示范围最大为4GB，于是就有了这两个函数。</p><pre><code>fpos_t file_pos;fgetpos(fp, &amp;file_pos);// ...fsetpos(fp, &amp;file_pos);</code></pre><h4 id="ferror-clearerr"><a href="#ferror-clearerr" class="headerlink" title="ferror() / clearerr()"></a>ferror() / clearerr()</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*ferror)(FILE* stream);</span><br><span class="line"><span class="keyword">void</span> (*clearerr)(FILE* fp);</span><br></pre></td></tr></table></figure><blockquote><p><code>ferror()</code> 函数用来返回错误指示器的状态。可以通过这个函数，判断前面的文件操作是否成功。</p></blockquote><blockquote><p><code>clearerr()</code> 函数用来重置出错指示器。</p></blockquote><pre><code>FILE* fp = fopen(&quot;file.txt&quot;, &quot;w&quot;);char c = fgetc(fp);if (ferror(fp)) {    printf(&quot;读取文件: file.txt 时发生错误\n&quot;);}clearerr(fp);</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">fscanf</span>(fp, <span class="string">"%d"</span>, &amp;n) != <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (ferror(fp)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"io error\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (feof(fp)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"end of file\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clearerr(fp);</span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h4><blockquote><p><code>remove()</code>函数用于删除指定文件。正确返回<code>0</code>值。</p></blockquote><p><code>int (*remove)(const char* filename);</code></p><pre><code>remove(&quot;foo.txt&quot;);</code></pre><blockquote><p>注意，删除文件必须是在文件关闭的状态下。如果使用<code>fopen()</code>打开的文件，必须先用<code>fclose()</code>关闭后删除。</p></blockquote><h4 id="rename"><a href="#rename" class="headerlink" title="rename"></a>rename</h4><p><code>int (*rename)(const char* old_filename, const char* new_filename);</code></p><h3 id="变量说明符"><a href="#变量说明符" class="headerlink" title="变量说明符"></a>变量说明符</h3><h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><h4 id="const"><a href="#const" class="headerlink" title="const"></a>const</h4><h4 id="static"><a href="#static" class="headerlink" title="static"></a>static</h4><h4 id="auto"><a href="#auto" class="headerlink" title="auto"></a><del>auto</del></h4><h4 id="extern"><a href="#extern" class="headerlink" title="extern"></a>extern</h4><h4 id="register"><a href="#register" class="headerlink" title="register"></a>register</h4><blockquote><p><code>register</code>说明符向编译器表示，该变量经常使用，应该提供最快的读取速度，所以应该放进寄存器。</p></blockquote><p><code>register int a;</code></p><blockquote><p><code>register</code> 只对声明在代码块内部的变量有效。</p></blockquote><pre><code>register int a;int *p = &amp;a; // 编译器报错(设为register 的变量，不能获取它的地址)</code></pre><h4 id="volatile"><a href="#volatile" class="headerlink" title="volatile"></a>volatile</h4><h4 id="restrict"><a href="#restrict" class="headerlink" title="restrict"></a>restrict</h4><blockquote><p><code>restrict</code>说明符允许编译器优化某些代码。它只能用于指针，表明该指针是访问数据的唯一方式</p></blockquote><pre><code>int* restrict pt = (int*)malloc(10*sizeof(int));</code></pre><h3 id="多文件项目"><a href="#多文件项目" class="headerlink" title="多文件项目"></a>多文件项目</h3><h3 id="命令行环境"><a href="#命令行环境" class="headerlink" title="命令行环境"></a>命令行环境</h3><h4 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h4><pre><code>int main(int argc, char* argv[]) {    for (int i = 0; i &lt; argc; i++) {        printf(&quot;arg %d: %s\n&quot;, i, argv[i]);    }}</code></pre><h4 id="退出状态"><a href="#退出状态" class="headerlink" title="退出状态"></a>退出状态</h4><pre><code>echo $?</code></pre><h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h4><pre><code>int main() {    char* val = getenv(&quot;HOME&quot;);}</code></pre><h3 id="多字节字符"><a href="#多字节字符" class="headerlink" title="多字节字符"></a>多字节字符</h3><h4 id="Unicode简介"><a href="#Unicode简介" class="headerlink" title="Unicode简介"></a>Unicode简介</h4><h4 id="字符的表示方式"><a href="#字符的表示方式" class="headerlink" title="字符的表示方式"></a>字符的表示方式</h4><ul><li><code>\123</code>: 以八进制值表示一个字符，斜杠后面需要三个数字。</li><li><code>\x4D</code>: 以十六进制表示一个字符，<code>\x</code>后面是十六进制证书。</li><li><code>\u2620</code>: 以Unicode码点表示一个字符，码点以十六进制表示，<code>\u</code>后面需要4字符。</li><li><p><code>\U0001243F</code>: 以Unicode码点表示一个字符，<code>\U</code>后面需要8个字符。</p><pre><code>printf(&quot;ABC\n&quot;);printf(&quot;\101\102\103\n&quot;);printf(&quot;\x41\x42\x43\n&quot;);上面三行都会打印&quot;ABC&quot;.printf(&quot;\u2022 Bullet 1\n&quot;);printf(&quot;\U00002022 Bullet 1\n&quot;);上面两行都会打印&quot;• Bullet 1&quot;.</code></pre></li></ul><h4 id="多字节字符的表示"><a href="#多字节字符的表示" class="headerlink" title="多字节字符的表示"></a>多字节字符的表示</h4><h4 id="宽字节"><a href="#宽字节" class="headerlink" title="宽字节"></a>宽字节</h4><blockquote><p>所谓”宽字符”，就是每个字符占用的字节数是固定的，要么是2个字节，要么是4个字节。</p></blockquote><blockquote><p>宽字符有一个单独的数据类型wchar_t,每个宽字符都是这个类型。它属于整数类型的别名，可能是有符号的，也可能是无符号。</p></blockquote><blockquote><p>宽字符的字面量必须加上前缀”L”, 否则C语言会把字面量当做窄字符类型字符。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setLocale(LC_ALL, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">wchar_t</span> c = L'牛<span class="string">';</span></span><br><span class="line">printf("%lc\n", c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">wchar_t</span>* s = <span class="string">L"春天"</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%ls\n"</span>, s);</span><br></pre></td></tr></table></figure><h4 id="多字节字符处理函数"><a href="#多字节字符处理函数" class="headerlink" title="多字节字符处理函数"></a>多字节字符处理函数</h4><h5 id="mblen"><a href="#mblen" class="headerlink" title="mblen()"></a>mblen()</h5><p><code>int (*mblen)(const char* mbstr, size_t n);</code></p><blockquote><p>他返回该字符占用的字节数。</p></blockquote><pre><code>setLocale(LC_ALL, &quot;&quot;);char* mbs1 = &quot;春天&quot;;printf(&quot;%d\n&quot;, mblen(mbs1, MB_CUR_MAX)); // 3char* mbs2 = &quot;abc&quot;;printf(&quot;%d\n&quot;, mblen(mbs2, MB_CUR_MAX)); // 1</code></pre><h5 id="wctomb"><a href="#wctomb" class="headerlink" title="wctomb()"></a>wctomb()</h5><blockquote><p><code>wctomb</code>函数(wide charactor to multibyte) 用于将宽字符转为多字节字符。</p></blockquote><p><code>int (wctomb)(char* s, wchar_t wc);</code></p><pre><code>setLocale(LC_ALL, &quot;&quot;);wchar_t wc = L&apos;牛&apos;;char mbStr[10] = &quot;&quot;;int bBytes = 0;nBytes = wctomb(mbStr, wc);// mbStr 牛// nBytes 3</code></pre><h5 id="mbtowc"><a href="#mbtowc" class="headerlink" title="mbtowc()"></a>mbtowc()</h5><blockquote><p><code>mbtowc()</code> 用于将多字节字符转为宽字符。</p></blockquote><p><code>int (*mbtowc)(wchar_t* wchar, const char* mbchar, size_t count);</code></p><pre><code>setLocale(LC_ALL, &quot;&quot;);char* mbchar = &quot;牛&quot;;wchar_t wc;wchar_t* pwd = &amp;wc;int nBytes = 0;bBytes = mbtowc(pwc, mbchar, 3);// nBytes 3// *pwc &apos;&apos;牛</code></pre><h5 id="wcstombs"><a href="#wcstombs" class="headerlink" title="wcstombs()"></a>wcstombs()</h5><blockquote><p><code>wcstombs()</code>用来将宽字符串转换为多字节字符串。</p></blockquote><p><code>size_t (*wcstombs)(char* mbstr, const wchar_t* wcstr, size_t count);</code></p><pre><code>setLocale(LC_ALL, &quot;&quot;);char mbs[20];wchar_t* wcs = L&quot;春天&quot;;int nBytes = 0;nBytes = wcstombs(mbs, wcs, 20);// mbs 春天// nBytes 6</code></pre><blockquote><p>如果<code>wcstombs()</code>的第一个参数是NULL，则返回转换成功所需要的目标字符串的字节数。</p></blockquote><h5 id="mbstowcs"><a href="#mbstowcs" class="headerlink" title="mbstowcs()"></a>mbstowcs()</h5><blockquote><p><code>mbstowcs()</code>用来将多字节字符串转换为宽字符串。</p></blockquote><p><code>size_t (*mbstowcs)(wchar_t* wcstr, const char* mbstr, size_t count);</code></p><pre><code>setLocale(LC_ALL, &quot;&quot;);char* mbs = &quot;天气不错&quot;;wchar_t wcs[20];int nBytes = 0;nBytes = mbstowcs(wcs, mbs, 20);// wcs L&quot;天气不错&quot;// nBytes 4</code></pre><h1 id="完全参考"><a href="#完全参考" class="headerlink" title="完全参考"></a>完全参考</h1><p><strong>请直接跳转阮老师博文</strong></p><p><a href="https://www.wangdoc.com/clang" target="_blank" rel="noopener">阮一峰clang</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>211106北京紧急项目</title>
      <link href="/2021/11/08/20211106%E5%8C%97%E4%BA%AC%E7%B4%A7%E6%80%A5%E9%A1%B9%E7%9B%AE/"/>
      <url>/2021/11/08/20211106%E5%8C%97%E4%BA%AC%E7%B4%A7%E6%80%A5%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="北京项目紧急上线"><a href="#北京项目紧急上线" class="headerlink" title="北京项目紧急上线"></a>北京项目紧急上线</h1><p>21.10月，北京合作甲方想要在12号之前上线，于是分派借调手下两个同学，给已分出去的另一个经理以开发人手。刚开始两位同学在公司内帮助处理，但是很多环境等都得在现场，公司没有氛围和特殊环境等，于是两位同学(前端大四实习，脑子不错；后端是前端转nodes的脑子稍稍不好用的熟悉6个月的新手)刚开始不愿去北京，后面为了项目还是欣然前往。</p><p>起初我觉得应该不难，改一改，东西并不多。但是另一个经理想要自己的实现方案；我沟通过，以我的方法继续往下，这样能少走弯路，他没理会，算了，项目给到他，以他的方案决定。但是最后12号到了，再加1周，到了20号了，还是没好，客户那边也是急着。</p><h2 id="个人成果"><a href="#个人成果" class="headerlink" title="个人成果"></a>个人成果</h2><p>我在10.26号出发，花了9天时间处理完，这里进行一个记录，有意思的经历。</p><p>刚开始出发，目标是争取在3天处理完主要功能。之后剩下东西看还差多少，我3天处理完网络拓扑就可以走了，但是毕竟都来了，还是争取把剩下的整完。</p><h2 id="项目难度"><a href="#项目难度" class="headerlink" title="项目难度"></a>项目难度</h2><p>功能是uni app 做界面端，然后采用安卓离线打包；用户使用第三方jar包在安卓转换登录后，实现用户真实登录。后端是nodejs。用户使用功能都是完成的(Bug不必理会)。</p><p>仅仅是以上这样，看起来是极其简单的，然而关键是网络拓扑、和第三方合作、操作开发环境等，并且两个网段还在不同地点，来回都不便!</p><p>跟安卓通信的后台（后面称之为”密集网”），甲方爸爸手上拿着安卓，但是无法在电脑端使用浏览器网页登录管理界面处理结果数据。需要由另一个安全的网络后台（后面称之为”安全网”）来提供电脑端浏览后台服务。密集网和安全网之间的通信不是直连，而是由另一个厂商提供转接口(GET/POST接口)，同时提供文件摆渡服务(ftp服务，摆渡方案，所以不是及时的，延时有20s之久)。</p><p>之前的经理领着同学去的时候，方法全是骚操作: 安卓所有请求(rest api)转为GET+POST，就为了应对中间商的接口。安卓请求完密集网后台，然后相同操作再发送到对接的中间商的请求，请求体还不一样，极为不便。后台之前的rest api接口也是全部改为GET+POST。骚操作啊，很多都不能运行，数据不对，新创建数据库id都不对应等等情况。</p><p>10月8号他们三打电话过来说(之前也是一直打电话过来援助，这段时间我也超级忙-全国性比赛软件支持，天天很晚才能回去，家住的还很远，电瓶车40分钟)，说10.12号，客户必须能用上。</p><p>经理已经领着同学过去两三周，一点进展都没有。刚开始他们过去，住汉庭；现在他们待太久没有进展，舍不得跑去住简约宾馆；好惨。</p><p>10.24 我对接完了全国比赛的软件支持，周一开会，还是觉得我过去整好来。整个公司，伟哥他不能去，他更重要；其他组员没找到一个能顶这种玩意，只能我上了。出差肯定累的，但是扔两个同学搞不定回不来更麻烦，算了，出发吧。出发前，代码回退到他们刚碰到代码前的状态(相当于他们一两周干的所有都是错的)，服务器调通来(他们10.12号前调了3、4天不能调通的，我电话远程协助30分钟搞完)。</p><p>周二上午出发，这周刚好北京出现疫情，我捅鼻子的核酸只能顶2天，当天就去掉1天了。下午聚个会，总结下当前状态，下午我的核酸能用，他们不行，赶紧附近做了。我先上去摸摸东西，包括申请电脑，找对接人，申请开电脑。摸了摸相关网络环境，调了相关请求感受了下。下午晚些喊前端同学上来一起搞搞。大致了解相关东西，今天就这么多了。</p><p>当前我们3个人(那个经理刚开始待了3天多就离开了)，只有两台电脑，公司没有太多空闲电脑了，反正我待的这一边有电脑，另一个网络配一个电脑。无线网络？没有，都用流量吧。特殊的测试安卓手机？只有一个，在密集网。</p><blockquote><p>环境如: 安全网能看到同步结果，但是遇到问题，只有安卓手机和密集网能检查错误等。我一般待安全网，上去楼上就下不来，非得有人接，所以都不敢乱动。吃午饭都是尽可能搞定去吃。菜菜后端搞不定。太艰难，全靠自己理论基础远程教着操作，否则真的搞不定这次的挑战。环境复杂，开发、测试环境极其苛刻，生存状态极其艰难，aker，你好nan。</p></blockquote><h2 id="开始实施"><a href="#开始实施" class="headerlink" title="开始实施"></a>开始实施</h2><p>第二天根据第一天方案，完成了大部分东西，完成了数据同步方案，我给他们安排的任务很简单，就是调通图片上传，他们那能给我用curl把图片列表请求下来，同步curl把图片给下下来，文件同步部分他们先处理，我专门搞我这里的数据同步方案。我的方案初步完成。跟菜菜后端远程合作实在蛋疼，很难沟通，到了那种想喊sb，滚蛋再派一个人过来那种。菜到家了。今天给他们安排的，curl 密集网图片能上传，安全网能下载下来就是完成，今天也算顺利。</p><p>第三天，我核酸过了，不能进去，就待在宾馆写，昨天的设想，我也没有完成完全，今天把剩下的bug改好了，同时启动测试都很OK，确实在外，开发进度、思考度会降低。远程对接中，还要教配置文件启动相关，烦，前端脑子灵活，但是不会后端所有概念，菜菜后端教操作太麻烦，都不想花时间教他操作。同时他们俩也是分在两个网络。今天大致印证开发方案正确即可，同时要求他们完成的文件方案完成好来。至少今天让他们把请求接口都写好了，代码请求。今天完成文件请求，至少有进展，我的数据请求缺少配置文件，他们不会改配置文件，哎，菜，脑子不会转，算了，今天到这里了。</p><p>第四天 29号，上午他们被喊去公司竞标，留下我一人继续搞搞可能的需求。中午回来的时候，北京技术负责人也来了，我们这三人跑去他这蹭了一顿饭，嘿嘿。下午2点继续开始。今天任务很简单，彻底把数据请求全部弄通。今天我去安全网，两边网络把镜像更新后，开始调试，解决缺少配置文件等。6点前一直测试，各种调试解决问题等。下午6点后，突然就行不通了，各种测试，然后请求第三方帮助。直到晚上才知道，我们做的测试中间服务器是他们的测试机，周五6点下班准时关机，于是我们就不通了，我去，脑裂。</p><p>第五天，周六，周末不能休息，赶紧搞好回去，而且周末他们人少，可以快点多搞点。今天我和菜菜后端去安全网，前端同学去密集网。他们外派驻场还挺舒服的，周中上班就是打游戏，没啥事干，周末来了看场就是吃吃饭，还是打游戏。哇，有这时间，我把clang、cpp 都过完了。我咋这么忙哦，我去。算了，加把油，加油落户咯，这个重点加把劲。</p><p>周六把昨天不能调通的地方解决掉，两个网把镜像同步后发现基本都OK，数据请求方面算是全部通了。下午让菜菜后端学着写文件请求下载，咪咪摸摸老半天，半个单词写不下来。算了算了，自己搞吧，我都把过程描绘了好几遍，硬是不懂，太鸡儿菜了。我给人描述东西都是极其好理解的，毕竟我的说话、沟通方式等都是不错的，听不懂的，都是脑子不好用的。真的。</p><p>周日31号，没想到没办法在11.1号之前完成这个回去。尽可能的了，今天还是要忙东西，今天忙着把图片的方案完成来，完成大部分，还有些bug，算了， 进度算是85%吧。</p><p>周一11.1号继续出发，搞定他。周一和周二完成图片方案，而且优化了对接的图片列出、下载方案。周二终于在晚间由我们两个同学测试完成。</p><p>周三的时候，上午继续压力测试，有bug继续修改，其中还是会有小问题，产品中展示问题、逻辑bug、对付第三方特殊策略的bug等。下午的时候进入测试环境，基本没太大问题，今晚和前几晚努力一样，多拼命多搞好一些问题，就不会太多后续的了。包括周二、周三发现上线的问题，我们快速去对付。安卓增加包、测试中正常；增加一个我们不需要的服务，然后进行调试通。</p><p>说实在这几天也是超级累，等到周四早上，测试都OK，下午三点左右和甲方沟通完毕，甲方还是很满意的。上线的事都差不多，我们在下午4、5点左右集结讨论怎么回去。中间群里说了声再待一天看下，好吧，我留下来半天看下。俩同伴出来太久了，内心是压力超级大的，衣服都没怎么换了。当天都没有交通工具回去了，再睡一晚，周五回去吧。。。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作, 驻场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>elastic_bool</title>
      <link href="/2021/10/18/elastic-bool/"/>
      <url>/2021/10/18/elastic-bool/</url>
      
        <content type="html"><![CDATA[<h1 id="使用bool检索"><a href="#使用bool检索" class="headerlink" title="使用bool检索"></a>使用bool检索</h1><p>目标: 要搜索ACCOUNT_ID 和 FRIEND_ID 互相调换的请求，并且至少满足一个</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  query: &#123;</span><br><span class="line">    bool: &#123;</span><br><span class="line">      // 使用must可以声明这个必须走</span><br><span class="line">      must: [</span><br><span class="line">        bool: &#123;</span><br><span class="line">          // 这个可以用于判别下面的判别仅走一个</span><br><span class="line">          should: [</span><br><span class="line">            // 内部的must 可以集合两个term(term 可以做出不匹配而绝对相等，否则使用match匹配)</span><br><span class="line">            &#123; bool: &#123; must: [&#123; term: &#123; ACCOUNT_ID: option.ACCOUNT_ID&#125;&#125;, &#123; term: &#123;FRIEND_ID: option.FRIEND_ID &#125; &#125;]&#125;&#125;,</span><br><span class="line">            &#123; bool: &#123; must: [&#123; term: &#123; ACCOUNT_ID: option.FRIEND_ID&#125;&#125;, &#123; term: &#123;FRIEND_ID: option.ACCOUNT_ID &#125; &#125;]&#125;&#125;</span><br><span class="line">          ],</span><br><span class="line">          minimum_should_match: 1 // 声明至少走一个</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/combining-filters.html" target="_blank" rel="noopener">参考1</a></p><p><a href="https://stackoverflow.com/questions/40573981/multiple-should-queries-with-must-query" target="_blank" rel="noopener">参考2</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> es </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20211007空闲随想</title>
      <link href="/2021/10/07/2021107%E7%A9%BA%E9%97%B2%E9%9A%8F%E6%83%B3/"/>
      <url>/2021/10/07/2021107%E7%A9%BA%E9%97%B2%E9%9A%8F%E6%83%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="空闲随想"><a href="#空闲随想" class="headerlink" title="空闲随想"></a>空闲随想</h1><p>时隔一个多月没有写作，当下正在编译，闲时写一写。</p><p>最近cpp的opengl学习到一小半，公司中nodejs开发一直无法找到合适(价廉人美聪明肯学)，遂技术栈打算换Java。不碰Java已经6年了，把廖雪峰老师教程翻了翻，顺便又过了遍SQL教程，之后可能换数据库，早做打算。</p><p>当然，cpp后台肯定最好，我正打算呢，但是研发价格蹭就上去了。cpp还是自己花时间学习吧。</p><p>当前Java 问了大学同学，高中同桌(Android), 当前开搞了Springboot终于有点样子了。</p><p>同学问咋nodejs回来Java。答曰: 公司做web开发，Java还是为王。主要原因还是因为nodejs做后端的人招不到，火候太次。无奈。这样校招、社招都好招。</p><p>打铁还需自身硬，于是花了2星期晚间时间，老婆睡着了，趴在床上手机放地上看，匆匆过了廖雪峰老师的Java文章。之后直接上手开搞。</p><p>当前就还剩下和原有程序的合并的尝试了，没办法，再怎么的也需要修复坑。当前项目技术难题: Iced + Typescript + Java + elasticsearch + mongo + redis + neo4j…</p><hr><p>国庆七天快过了， 大学同学交流，感觉时间过的匆忙，最近看IT从业人员年龄，大厂都是29~30出头。岁数网上的同学去哪了？不得而知，但自己肯定是有压力的，满不在乎的背后是更努力和勤奋去应对而已，哈哈。毕竟不是生活在普通农村了。</p><p>国庆由于太阳热，来公司三天，家里米西Java和打游戏，算是顺利吧，当前确实花在学习的时间比之前少了丢丢，要回头了，说不定明年5月阿黄要上小学就开始要忙碌咯。</p><p>拼命吧, c and cpp can save you…</p>]]></content>
      
      
      
        <tags>
            
            <tag> 随想 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>interviewRequired</title>
      <link href="/2021/09/03/interviewRequired/"/>
      <url>/2021/09/03/interviewRequired/</url>
      
        <content type="html"><![CDATA[<p><del>昨天去客户单位排查问题，忽然想到工作人员素质问题，对比社招的面试。</del></p><p><del>gwy考试、事业编都有个特色，有严格的筛选，比如思想上的统一，至少本科以上，多轮严格面试，使用一年等。进入后大家都是高质量，竞争更加激烈也会有带来其他问题，这里不谈。主要是想说社招中的面试。</del></p><p><del>普通公司社招面试都是比较简单的，人感觉好用就进公司实习、试用。但是如果能加强这块，增大面试难度、学校筛选，对素质的考核等，都会让公司的等级越来越强。有时会说，人好用，无法考量素质、学校筛选等，工资拿不出太多，先用着。相对的高素质、高能力等，难招，只能安排一些这类作为中层。</del></p><p>好好组织语言，大中午没想明白。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CMakeLists入门</title>
      <link href="/2021/08/20/CMakeLists%E5%85%A5%E9%97%A8/"/>
      <url>/2021/08/20/CMakeLists%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="cmake入门"><a href="#cmake入门" class="headerlink" title="cmake入门"></a>cmake入门</h1><p>我的学习背景: 使用xcode开发OpenGL，在链完教程中的路径之后，项目可以学习起来了，但是链接过程不知道原因。<br>之前的学习刚好有打包动态、静态库，链接过程清晰。但是这会却不明了。</p><p>打算自己做cmake链接，以下是做记录:</p><p>当前环境:</p><p>brew 安装glew、glfw，需要使用CMake进行库的链接。</p><p>直接开始代码上的讲解:</p><h2 id="链接库制作"><a href="#链接库制作" class="headerlink" title="链接库制作"></a>链接库制作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 将当前所有文件名列为数组保存</span><br><span class="line">aux_source_directory(. DIR_LIB_SRCS)</span><br><span class="line"># 指明制作library</span><br><span class="line">add_library(MathFunctions $&#123;DIR_LIB_SRCS&#125;)</span><br><span class="line"># 当执行make install时，执行下面操作</span><br><span class="line"># 保存头文件至includes；保存lib文件至 /usr/local/lib</span><br><span class="line">install(TARGETS MathFunctions DESTINATIONS lib)</span><br><span class="line">install(FILES MathFunctions DESTINATIONS includes)</span><br></pre></td></tr></table></figure><h2 id="主库制作"><a href="#主库制作" class="headerlink" title="主库制作"></a>主库制作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># CMake最低版本要求</span><br><span class="line">cmake_minimum_required(VERSION 2.8)</span><br><span class="line"># 项目信息</span><br><span class="line">project(Learngl)</span><br><span class="line"># 设置环境变量 set(key value)</span><br><span class="line">set(Learngl_VERSION_MAJOR 1)</span><br><span class="line">set(Learngl_VERSION_MINOR 0)</span><br><span class="line"># 查看是否有有环境变量，否则初始设置为ON</span><br><span class="line">option(USE_MUMATH &quot;use provided math implementation&quot; ON)</span><br><span class="line"># 将当前所有环境变量等进行configfile，将config.h.in 转为config.h</span><br><span class="line"># $&#123;PROJECT_SOURCE_DIR&#125; 指项目中源文件</span><br><span class="line"># $&#123;PROJECT_BINARY_DIR&#125; 指项目中目标生成文件</span><br><span class="line">configure_file(</span><br><span class="line">  &quot;$&#123;PROJECT_SOURCE_DIR&#125;/config.h.in&quot;</span><br><span class="line">  &quot;$&#123;PROJECT_BINARY_DIR&#125;/config.h&quot;</span><br><span class="line">)</span><br><span class="line">if (NOT HAVE_POW)</span><br><span class="line">  # 引入头文件搜索路径</span><br><span class="line">  include_directories(&quot;$&#123;PROJECT_SOURCE_DIR&#125;/math&quot;)</span><br><span class="line">  # 加入该子模块，显示执行子模块CMakeLists.txt</span><br><span class="line">  add_subdirectory(math)</span><br><span class="line">  set(EXTRA_LIBS $&#123;EXTRA_LIBS&#125; MathFunctions)</span><br><span class="line">endif (NOT HAVE_POW)</span><br><span class="line"></span><br><span class="line"># 将当前所有项目文件(.* 文件) 转入</span><br><span class="line">aux_source_directory(. DIR_SRCS)</span><br><span class="line"># 生成执行文件Learngl，文件为$&#123;DIR_SRCS&#125;内容</span><br><span class="line">add_executable(Learngl $&#123;DIR_SRCS&#125;)</span><br><span class="line">target_link_libraries(Learngl $&#123;EXTRA_LIBS&#125;)</span><br><span class="line"># 导入glfw lib</span><br><span class="line"># 链接lib路径</span><br><span class="line">link_directories(&quot;/usr/local/Cellar/glfw/3.3.4/lib&quot;)</span><br><span class="line"># 使用lib/libglfw.[dylib|a]文件</span><br><span class="line">target_link_libraries(Learngl glfw)</span><br><span class="line"></span><br><span class="line"># 生成macro，macro($&#123;名称&#125; $&#123;参数1&#125; $&#123;参数2&#125; $&#123;参数3&#125;)</span><br><span class="line">macro (do_test arg1 arg2 result)</span><br><span class="line">  # add_test 是执行测试用例，make test执行</span><br><span class="line">  add_test(test_$&#123;arg1&#125;_$&#123;arg2&#125; Learngl $&#123;arg1&#125; $&#123;arg2&#125;)</span><br><span class="line">  # 设置单元测试用例的判别，使用正则来判断是否符合相应数据</span><br><span class="line">  set_tests_properties(test_$&#123;arg1&#125;_$&#123;arg2&#125; PROPERTIES PASS_REGULAR_EXPRESSION $&#123;result&#125;)</span><br><span class="line">endmacro (do_test)</span><br><span class="line"></span><br><span class="line"># 测试执行单元测试用例(也可以直接add_test 使用)</span><br><span class="line">do_test(5 2 &quot;is 25&quot;)</span><br><span class="line">do_test(10 5 &quot;is 100000&quot;)</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/ybqjymy/p/13409050.html" target="_blank" rel="noopener">参考</a><br><a href="https://github.com/wzpan/cmake-demo" target="_blank" rel="noopener">示例demo</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> cmake, cmakelists </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210812初步练习redis</title>
      <link href="/2021/08/12/20210812%E5%88%9D%E6%AD%A5%E7%BB%83%E4%B9%A0redis/"/>
      <url>/2021/08/12/20210812%E5%88%9D%E6%AD%A5%E7%BB%83%E4%B9%A0redis/</url>
      
        <content type="html"><![CDATA[<h1 id="初步练习redis"><a href="#初步练习redis" class="headerlink" title="初步练习redis"></a>初步练习redis</h1><p>redis 包含数据类型: string list set zset(sort set), 另有事务、发布订阅等，这篇是自己简单练习数据类型总结</p><h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><pre><code>set key1 v1get key1mset key2 v2 key3 v3keys *exists key1del key2expire key3 20ttl key3persist key3</code></pre><h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><pre><code>hmset user:1000 username aker age 16 job ithget user:1000 usernamehmget user:1000 username age jobhgetall user:1000hset user:1000 job chifanhset user:1000 home shhvals user:1000hdel user:1000 job [field2...]</code></pre><h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><pre><code>sadd set1 1 2 3 4 5smembers set1srem set1 1 4sadd set2 1 3 4 5 1 3sdiff set1 set2sinter set1 set2sunion set1 set2</code></pre><h2 id="zset"><a href="#zset" class="headerlink" title="zset"></a>zset</h2><pre><code>zadd zkey0 1 redis 2 mongo  5 mysql 6 tidb 6 mariadbzrange zkey0 0 -1 [withscores]zcard zkey0zincrby zkey0 2 redis</code></pre><h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><pre><code>rpush list1 Arpush list1 Blpush list1 top1lrange list1 0 -1lrange list1 1 2lrange list1 -3 -1rpop list1lpop list1llen list1lindex list1lrem list1 -1 A</code></pre><p><a href="https://www.jianshu.com/p/2f93bb771469" target="_blank" rel="noopener">参考</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210807制作cpp dylib</title>
      <link href="/2021/08/07/20210807%E5%88%B6%E4%BD%9Ccpp_dylib/"/>
      <url>/2021/08/07/20210807%E5%88%B6%E4%BD%9Ccpp_dylib/</url>
      
        <content type="html"><![CDATA[<h1 id="制作cpp-dylib"><a href="#制作cpp-dylib" class="headerlink" title="制作cpp dylib"></a>制作cpp dylib</h1><p>Mac下的动态链接库格式是*.dylib，用xcode制作如下:</p><p>Xcode -&gt; Create a new Xcode project(Command + Shift + N) -&gt; macOS -&gt; Framework &amp; Library -&gt; Library</p><p><img src="/css/images/210807/cppdylib1.jpg" alt="cpp dylib"></p><p>填写创建表单，注意Framework - None(Plain C/C++ Library) / type - Dynamic</p><p><img src="/css/images/210807/cppdylib2.jpg" alt="cpp dylib2"></p><p>新增文件demo.h &amp;&amp; demo.cpp, 新增内容如图:</p><p><img src="/css/images/210807/cppdylib3.jpg" alt="cpp dylib3"></p><p>此时点击左上角运行，则  Products - libdemo.dylib 变成实体，不是红色，表明生成了。</p><p><img src="/css/images/210807/cppdylib4.jpg" alt="cpp dylib4"></p><p>拷贝.h文件 至目标项目 /include/demo.h, 拷贝 .dylib 至目标项目 /lib/libdemo.dylib 中。</p><p>测试代码如图:</p><p><img src="/css/images/210807/cppdylib5.jpg" alt="cpp dylib5"></p><p>c++ main.cpp -I./include -L./lib -ldemo -o test 是编译期间，会认不到运行时动态库，需要加上 导出./lib 告诉程序运行的库(<a href="https://stackoverflow.com/a/47225188/6677202" target="_blank" rel="noopener">https://stackoverflow.com/a/47225188/6677202</a>)</p><p>-ldemo 指有多少个文件都要写出来，否则还是识别不到哪个文件是要被链接的；-I -L 是对应的文件夹。</p>]]></content>
      
      
      
        <tags>
            
            <tag> cpp dylib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210805Mac安装Opengl库</title>
      <link href="/2021/08/05/20210805Mac%E5%AE%89%E8%A3%85Opengl%E5%BA%93/"/>
      <url>/2021/08/05/20210805Mac%E5%AE%89%E8%A3%85Opengl%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Mac-安装Opengl库"><a href="#Mac-安装Opengl库" class="headerlink" title="Mac 安装Opengl库"></a>Mac 安装Opengl库</h1><p>之前想着搞下<code>编译原理</code>，于是过了下<code>BNF</code>/<code>AST</code>，但是发现那篇文章对于初学cpp不友好，更重要，由于很多库还得下载，不晓得什么库缺失或者include路径不对，无法运行，遂暂时放弃一捏捏。</p><p>跟着下篇文章的也是入门cpp+opengl游戏，研发机器装好opengl环境，就成功运行，这就对了嘛。</p><p>昨天给研发的机器和家里的机器装上两遍glfw、glew、glad等，踩的小坑记下。</p><p>用brew安装都成功，用cmake安装，依然无法include，故本记录推荐brew 安装。</p><p>环境: 10.13.6黑苹果，都有独显。</p><ol><li>brew报<code>No formulae found in taps</code>错误，方法是重新安装brew解决该问题:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd /usr/local/Homebrew/Library/Taps/homebrew/</span><br><span class="line">$ rm -rf homebrew-core</span><br><span class="line">$ ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>brew 安装glfw/glew 时报: <code>Missing dependencies for SOCKS support</code>错误，解决该问题:</p><p> unset all_proxy &amp;&amp; unset ALL_PROXY</p></li></ol><h2 id="安装各库"><a href="#安装各库" class="headerlink" title="安装各库"></a>安装各库</h2><ol><li>安装glew/glfw3</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew install glew</span><br><span class="line">$ brew install glfw3</span><br></pre></td></tr></table></figure><ol start="2"><li>glad安装:</li></ol><p><a href="https://glad.dav1d.de/" target="_blank" rel="noopener">glad在线安装</a>, Language选择C/C++, Specification选择OpenGL，API选择gl - Version4.5(&gt;Version 3.3)，Profile选择Core</p><p><img src="/css/images/210805/installglad1.jpg" alt></p><p>左下角Options 勾选Generate a loader，然后右下角按钮[GENERATE]生成，然后下载新加载的页面的glad.zip.</p><p><img src="/css/images/210805/installglad2.jpg" alt></p><ol start="3"><li><p>将解压glad.zip 中include 内的 KHR|glad 两个文件夹复制到 /usr/local/include 中.</p></li><li><p>新建Xcode C++的Command Line Tool项目，<code>command + ,</code> 进入设置页面，选择Locations - Custom Paths，添加如下图:</p></li></ol><p><img src="/css/images/210805/xcode1.jpg" alt></p><ol start="5"><li>修改Header search Paths 和 Library Search Paths</li></ol><p>learnopgl - TARGETS - Build Settings</p><p><img src="/css/images/210805/xcode2.jpg" alt></p><p><img src="/css/images/210805/xcode3.jpg" alt></p><ol start="6"><li>修改Xcode项目的Build Phases - Link Binary With Libraries</li></ol><p><img src="/css/images/210805/xcode4.jpg" alt></p><p><a href="https://www.jianshu.com/p/eedc41051bd9" target="_blank" rel="noopener">参考</a></p><ol start="7"><li>添加glad.zip 解压后的src/glad.c 至learnopgl项目下:</li></ol><p><img src="/css/images/210805/xcode5.jpg" alt></p><h2 id="测试是否正常执行"><a href="#测试是否正常执行" class="headerlink" title="测试是否正常执行"></a>测试是否正常执行</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://github.com/JoeyDeVries/LearnOpenGL</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;glad/glad.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GLFW/glfw3.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">framebuffer_size_callback</span><span class="params">(GLFWwindow* window, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow *window)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> SCR_WIDTH = <span class="number">800</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> SCR_HEIGHT = <span class="number">600</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  glfwInit();</span><br><span class="line">  glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);</span><br><span class="line">  glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);</span><br><span class="line">  glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __APPLE__</span></span><br><span class="line">  glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  GLFWwindow* window = glfwCreateWindow(SCR_WIDTH, SCR_HEIGHT, <span class="string">"LearnOpenGL"</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">  <span class="keyword">if</span> (window == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to create GLFW window"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    glfwTerminate();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  glfwMakeContextCurrent(window);</span><br><span class="line">  glfwSetFramebufferSizeCallback(window, framebuffer_size_callback);</span><br><span class="line">  <span class="keyword">if</span> (!gladLoadGLLoader((GLADloadproc)glfwGetProcAddress)) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to initialize GLAD"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (!glfwWindowShouldClose(window)) &#123;</span><br><span class="line">    processInput(window);</span><br><span class="line">    glfwSwapBuffers(window);</span><br><span class="line">    glfwPollEvents();</span><br><span class="line">  &#125;</span><br><span class="line">  glfwTerminate();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow *window)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(glfwGetKey(window, GLFW_KEY_ESCAPE) == GLFW_PRESS)</span><br><span class="line">    glfwSetWindowShouldClose(window, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">framebuffer_size_callback</span><span class="params">(GLFWwindow* window, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">  glViewport(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>出现大黑框就正确了:</p><p><img src="/css/images/210805/xcode6.jpg" alt></p>]]></content>
      
      
      
        <tags>
            
            <tag> mac_opengl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210731编译原理准备</title>
      <link href="/2021/07/31/20210731%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%87%86%E5%A4%87/"/>
      <url>/2021/07/31/20210731%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<h1 id="编译原理准备"><a href="#编译原理准备" class="headerlink" title="编译原理准备"></a>编译原理准备</h1><h2 id="BNF范式-巴恩斯范式"><a href="#BNF范式-巴恩斯范式" class="headerlink" title="BNF范式 - 巴恩斯范式"></a>BNF范式 - 巴恩斯范式</h2><ol><li>BNF范式是一种用<strong>递归</strong>的思想来表述计算机语言符号集的定义规范</li><li>法则:</li></ol><ul><li>::= 表示定义；</li><li>“”双引号里的内容表示字符；</li><li>&lt;&gt;尖括号里的内容表示必选内容；</li><li>|竖线两边的是可选内容，相当于or；</li></ul><p>BNF规定是推导规则(产生式)的集合，写为:</p><p><code>&lt;符号&gt; ::= &lt;使用符号的表达式&gt;</code></p><p>这里的<code>&lt;符号&gt;</code>是非终结符，而<code>表达式</code>由一个符号序列，或用指示选择的竖杠’|’ 分割的多个符号序列构成，每个符号序列整体都是左端的符号的一种可能的<code>替代</code>。从未在左端出现的符号叫做<code>终结符</code>。</p><p><img src="/css/images/210731/bnf.png" alt="举例"></p><p><a href="https://gaixin.blog.csdn.net/article/details/113929322" target="_blank" rel="noopener">参考</a></p><h2 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h2><p>这里直接学习AST概念，不进行深入探讨。后边做编译原理的时候，会有涉及。内容的例子直接挪用参考文章的示例，参考文章使用其他工具部分不是本文涉及。后边会跟进学习cpp 编译原理的前端部分。</p><h3 id="AST是什么"><a href="#AST是什么" class="headerlink" title="AST是什么"></a>AST是什么</h3><blockquote><p>Abstract Syntax Tree，它是源代码结构的一种抽象表示。他一树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构</p></blockquote><p>这里贴出参考中好用的转换工具: <a href="https://astexplorer.net/" target="_blank" rel="noopener">https://astexplorer.net/</a></p><h3 id="入门AST"><a href="#入门AST" class="headerlink" title="入门AST"></a>入门AST</h3><p><img src="/css/images/210731/ast1.jpg" alt="1"></p><p>可以看到对应的关系:</p><ul><li>var 是关键字(<code>keyword</code>)</li><li>AST 是最小单元(<code>Identifier</code>)</li><li>= 是Equal等号</li><li>is tree 是一个字符串</li><li>; 是Semicolon</li></ul><h3 id="词法分析"><a href="#词法分析" class="headerlink" title="词法分析"></a>词法分析</h3><p>词法分析 也称之为scanner，对每一行每个char 过滤一遍，分解每个词块。</p><p>这块不多介绍，和下面语法分析一起进行。</p><h3 id="语法分析"><a href="#语法分析" class="headerlink" title="语法分析"></a>语法分析</h3><p>语法分析会将词法分析出来的token转化成有语法含义的抽象语法树结构，并加上类型描述。这步骤验证语法，词法分析仅是读取每个char，根据段落转化一个个token。</p><h3 id="开搞例子"><a href="#开搞例子" class="headerlink" title="开搞例子"></a>开搞例子</h3><p>以下是直接抄原作者例子, 请直接看<a href="https://juejin.cn/post/6844904035271573511" target="_blank" rel="noopener">原作者链接</a></p><h4 id="例子1"><a href="#例子1" class="headerlink" title="例子1"></a>例子1</h4><pre><code>const fn = a =&gt; a;</code></pre><p><img src="/css/images/210731/ast2.jpg" alt="2"></p><h4 id="例子2"><a href="#例子2" class="headerlink" title="例子2"></a>例子2</h4><pre><code>const fn = a =&gt; {    const i = 1    return a + 1}</code></pre><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"type"</span>: <span class="string">"Program"</span>,</span><br><span class="line">  <span class="attr">"start"</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"end"</span>: <span class="number">52</span>,</span><br><span class="line">  <span class="attr">"body"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"VariableDeclaration"</span>,</span><br><span class="line">      <span class="attr">"start"</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"end"</span>: <span class="number">52</span>,</span><br><span class="line">      <span class="attr">"declarations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"VariableDeclarator"</span>,</span><br><span class="line">          <span class="attr">"start"</span>: <span class="number">6</span>,</span><br><span class="line">          <span class="attr">"end"</span>: <span class="number">52</span>,</span><br><span class="line">          <span class="attr">"id"</span>: &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">            <span class="attr">"start"</span>: <span class="number">6</span>,</span><br><span class="line">            <span class="attr">"end"</span>: <span class="number">8</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"fn"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">"init"</span>: &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"ArrowFunctionExpression"</span>,</span><br><span class="line">            <span class="attr">"start"</span>: <span class="number">11</span>,</span><br><span class="line">            <span class="attr">"end"</span>: <span class="number">52</span>,</span><br><span class="line">            <span class="attr">"id"</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="attr">"expression"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"generator"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"async"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"params"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                <span class="attr">"start"</span>: <span class="number">11</span>,</span><br><span class="line">                <span class="attr">"end"</span>: <span class="number">12</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"a"</span></span><br><span class="line">              &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"body"</span>: &#123;</span><br><span class="line">              <span class="attr">"type"</span>: <span class="string">"BlockStatement"</span>,</span><br><span class="line">              <span class="attr">"start"</span>: <span class="number">16</span>,</span><br><span class="line">              <span class="attr">"end"</span>: <span class="number">52</span>,</span><br><span class="line">              <span class="attr">"body"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"VariableDeclaration"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">21</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">32</span>,</span><br><span class="line">                  <span class="attr">"declarations"</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="attr">"type"</span>: <span class="string">"VariableDeclarator"</span>,</span><br><span class="line">                      <span class="attr">"start"</span>: <span class="number">27</span>,</span><br><span class="line">                      <span class="attr">"end"</span>: <span class="number">32</span>,</span><br><span class="line">                      <span class="attr">"id"</span>: &#123;</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                        <span class="attr">"start"</span>: <span class="number">27</span>,</span><br><span class="line">                        <span class="attr">"end"</span>: <span class="number">28</span>,</span><br><span class="line">                        <span class="attr">"name"</span>: <span class="string">"i"</span></span><br><span class="line">                      &#125;,</span><br><span class="line">                      <span class="attr">"init"</span>: &#123;</span><br><span class="line">                        <span class="attr">"type"</span>: <span class="string">"Literal"</span>,</span><br><span class="line">                        <span class="attr">"start"</span>: <span class="number">31</span>,</span><br><span class="line">                        <span class="attr">"end"</span>: <span class="number">32</span>,</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">"raw"</span>: <span class="string">"1"</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  ],</span><br><span class="line">                  <span class="attr">"kind"</span>: <span class="string">"const"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"ReturnStatement"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">36</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">48</span>,</span><br><span class="line">                  <span class="attr">"argument"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"BinaryExpression"</span>,</span><br><span class="line">                    <span class="attr">"start"</span>: <span class="number">43</span>,</span><br><span class="line">                    <span class="attr">"end"</span>: <span class="number">48</span>,</span><br><span class="line">                    <span class="attr">"left"</span>: &#123;</span><br><span class="line">                      <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                      <span class="attr">"start"</span>: <span class="number">43</span>,</span><br><span class="line">                      <span class="attr">"end"</span>: <span class="number">44</span>,</span><br><span class="line">                      <span class="attr">"name"</span>: <span class="string">"a"</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">"operator"</span>: <span class="string">"+"</span>,</span><br><span class="line">                    <span class="attr">"right"</span>: &#123;</span><br><span class="line">                      <span class="attr">"type"</span>: <span class="string">"Literal"</span>,</span><br><span class="line">                      <span class="attr">"start"</span>: <span class="number">47</span>,</span><br><span class="line">                      <span class="attr">"end"</span>: <span class="number">48</span>,</span><br><span class="line">                      <span class="attr">"value"</span>: <span class="number">1</span>,</span><br><span class="line">                      <span class="attr">"raw"</span>: <span class="string">"1"</span></span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"kind"</span>: <span class="string">"const"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"sourceType"</span>: <span class="string">"module"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="例子3"><a href="#例子3" class="headerlink" title="例子3"></a>例子3</h4><pre><code>    function test() {  let a = 1  console.log(a)}</code></pre><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"type"</span>: <span class="string">"Program"</span>,</span><br><span class="line">  <span class="attr">"start"</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"end"</span>: <span class="number">60</span>,</span><br><span class="line">  <span class="attr">"body"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"FunctionDeclaration"</span>,</span><br><span class="line">      <span class="attr">"start"</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"end"</span>: <span class="number">60</span>,</span><br><span class="line">      <span class="attr">"id"</span>: &#123;</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">        <span class="attr">"start"</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">"end"</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"test"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"expression"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"generator"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"async"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"params"</span>: [],</span><br><span class="line">      <span class="attr">"body"</span>: &#123;</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"BlockStatement"</span>,</span><br><span class="line">        <span class="attr">"start"</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">"end"</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">"body"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"VariableDeclaration"</span>,</span><br><span class="line">            <span class="attr">"start"</span>: <span class="number">24</span>,</span><br><span class="line">            <span class="attr">"end"</span>: <span class="number">33</span>,</span><br><span class="line">            <span class="attr">"declarations"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"VariableDeclarator"</span>,</span><br><span class="line">                <span class="attr">"start"</span>: <span class="number">28</span>,</span><br><span class="line">                <span class="attr">"end"</span>: <span class="number">33</span>,</span><br><span class="line">                <span class="attr">"id"</span>: &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">28</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">29</span>,</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"a"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"init"</span>: &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"Literal"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">32</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">33</span>,</span><br><span class="line">                  <span class="attr">"value"</span>: <span class="number">1</span>,</span><br><span class="line">                  <span class="attr">"raw"</span>: <span class="string">"1"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"kind"</span>: <span class="string">"let"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"ExpressionStatement"</span>,</span><br><span class="line">            <span class="attr">"start"</span>: <span class="number">40</span>,</span><br><span class="line">            <span class="attr">"end"</span>: <span class="number">54</span>,</span><br><span class="line">            <span class="attr">"expression"</span>: &#123;</span><br><span class="line">              <span class="attr">"type"</span>: <span class="string">"CallExpression"</span>,</span><br><span class="line">              <span class="attr">"start"</span>: <span class="number">40</span>,</span><br><span class="line">              <span class="attr">"end"</span>: <span class="number">54</span>,</span><br><span class="line">              <span class="attr">"callee"</span>: &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"MemberExpression"</span>,</span><br><span class="line">                <span class="attr">"start"</span>: <span class="number">40</span>,</span><br><span class="line">                <span class="attr">"end"</span>: <span class="number">51</span>,</span><br><span class="line">                <span class="attr">"object"</span>: &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">40</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">47</span>,</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"console"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"property"</span>: &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">48</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">51</span>,</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"log"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"computed"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"optional"</span>: <span class="literal">false</span></span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">"arguments"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">"type"</span>: <span class="string">"Identifier"</span>,</span><br><span class="line">                  <span class="attr">"start"</span>: <span class="number">52</span>,</span><br><span class="line">                  <span class="attr">"end"</span>: <span class="number">53</span>,</span><br><span class="line">                  <span class="attr">"name"</span>: <span class="string">"a"</span></span><br><span class="line">                &#125;</span><br><span class="line">              ],</span><br><span class="line">              <span class="attr">"optional"</span>: <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"sourceType"</span>: <span class="string">"module"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://segmentfault.com/a/1190000023389980" target="_blank" rel="noopener">参考</a><br><a href="https://juejin.cn/post/6844904035271573511" target="_blank" rel="noopener">掘金文章参考</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20210705cpp学习</title>
      <link href="/2021/07/06/20210705cpp%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/07/06/20210705cpp%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h1><h2 id="纯虚继承多态的问题"><a href="#纯虚继承多态的问题" class="headerlink" title="纯虚继承多态的问题"></a>纯虚继承多态的问题</h2><p>创建 worker.h<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">showInfo</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="built_in">string</span> <span class="title">getDeptName</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> m_Id, m_DeptId;</span><br><span class="line">    <span class="built_in">string</span> m_Name;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>创建普通员工类Employee.h 和.cpp 其继承于Worker<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Employee.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"worker.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>:</span> <span class="keyword">public</span> Worker &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Employee(<span class="keyword">int</span> id, <span class="built_in">string</span> name, <span class="keyword">int</span> dId);</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">showInfo</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="built_in">string</span> <span class="title">getDeptName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Employee.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Employee.h"</span></span></span><br><span class="line">Employee::Employee(<span class="keyword">int</span> id, <span class="built_in">string</span> name, <span class="keyword">int</span> dId) &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;m_Id = id;</span><br><span class="line">    <span class="keyword">this</span>-&gt;m_Name = name;</span><br><span class="line">    <span class="keyword">this</span>-&gt;m_DeptId = dId;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Employee::showInfo() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"我是要展示的info"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">string</span> Employee::getDeptName() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"职工"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>此时运行使用多态方案，比如其他继承Worker 的类也想使用同样方法，然后delete 会出现内存泄漏bug:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Worker *worker = <span class="literal">NULL</span>;</span><br><span class="line">    worker = <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">"aker"</span>, <span class="number">1</span>);</span><br><span class="line">    worker.showInfo();</span><br><span class="line">    <span class="keyword">delete</span> worker; <span class="comment">// 这里就会报内存泄漏</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为什么？生成Employee地址空间，delete 自己的空间怎么会报错?</p><p>我们这样理解: Worker *worker，worker 是纯虚指针，指向纯虚单独保存的空间，这里只有Worker。<code>delete worker</code>，虽然是打算释放Employee，但是纯虚里面不包括Employee 其他数据指针。直接delete 就会造成无法释放余下那部分数据。</p><p>解决方法有两种<a href="https://blog.csdn.net/quicmous/article/details/100121382" target="_blank" rel="noopener">参考</a>:</p><ol><li>自己实现虚析构:</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>:</span> <span class="keyword">public</span> Worker &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~Employee() &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样释放就能直接找到自己的析构。</p><ol start="2"><li>提供自己的delete 方法，自己释放自己:</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>:</span> <span class="keyword">public</span> Worker &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">void</span> Employee::release() &#123;</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">worker.release();</span><br></pre></td></tr></table></figure><h2 id="cpp引用注意点"><a href="#cpp引用注意点" class="headerlink" title="cpp引用注意点"></a>cpp引用注意点</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 相当于将aa指针也指向了a 的地址: &amp;a</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> * <span class="keyword">const</span> aa)</span> </span>&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"result: "</span> &lt;&lt; *aa &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// cpp 的引用</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> &amp;aa)</span> </span>&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"result: "</span> &lt;&lt; aa &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">func1(&amp;a);</span><br><span class="line">func2(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="cpp深拷贝-浅拷贝"><a href="#cpp深拷贝-浅拷贝" class="headerlink" title="cpp深拷贝/浅拷贝"></a>cpp深拷贝/浅拷贝</h2><p>浅拷贝: 简单的赋值拷贝操作<br>深拷贝: 在堆区重新申请空间，进行拷贝操作</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Person() &#123;&#125;</span><br><span class="line">Person(<span class="keyword">const</span> Person &amp;p) &#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"拷贝构造函数!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">m_age = p.m_age;</span><br><span class="line">m_height = <span class="keyword">new</span> <span class="keyword">int</span>(*p.m_height);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">int</span> m_age;</span><br><span class="line"><span class="keyword">int</span> *m_height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Person p1;</span><br><span class="line"><span class="function">Person <span class="title">p2</span><span class="params">(p1)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果不实现 <code>Person(const Person &amp;p)</code>那么就是浅拷贝，直接进行对象的赋值操作； 但是如果内部属性在堆区开辟，一定要提供拷贝构造函数，否则可能导致浅拷贝的重复释放堆区的问题(赋值了指针，p2-&gt;m_height 有两份指针，释放时就释放了两次!)!</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> cpp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210706学习使用Neo4j</title>
      <link href="/2021/07/06/20210706%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Neo4j/"/>
      <url>/2021/07/06/20210706%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Neo4j/</url>
      
        <content type="html"><![CDATA[<h1 id="学习使用Neo4j"><a href="#学习使用Neo4j" class="headerlink" title="学习使用Neo4j"></a>学习使用Neo4j</h1><p>Neo4j 本身提供7474端口的及时UI操作服务。如: <a href="http://localhost:7474" target="_blank" rel="noopener">http://localhost:7474</a> 登录上即可。</p><p>这里以nodejs 链接代码:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> neo4j = <span class="built_in">require</span>(<span class="string">"neo4j-driver"</span>)</span><br><span class="line"><span class="keyword">let</span> session = <span class="literal">null</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">conf:&#123;url:<span class="built_in">string</span>, username:<span class="built_in">string</span>, password:<span class="built_in">string</span>&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> driver = neo4j.v1.driver(conf.url, neo4j.v1.auth.basic(conf.username, conf.password))</span><br><span class="line">    session = driver.session(neo4j.v1.session.WRITE)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">executeCypher</span>(<span class="params">data:&#123;cql:<span class="built_in">string</span>&#125;</span>) </span>&#123;</span><br><span class="line">    session.run(data.cql, data).subscribe(&#123;</span><br><span class="line">        onNext:<span class="function">(<span class="params">record</span>)=&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"[neo4j.onNext] record:"</span>, record)</span><br><span class="line">        &#125;,</span><br><span class="line">        onCompleted: <span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"[neo4j.onCompleted] ..."</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        onError: <span class="function">(<span class="params">err</span>)=&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"[neo4j.onError] err: "</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="cql语法"><a href="#cql语法" class="headerlink" title="cql语法"></a>cql语法</h2><h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><pre><code>$CREATE (m:Movie {title: &quot;The Matrix&quot;, released: 1990})$CREATE (m:Movie {title: &quot;Apollo 13&quot;, released: 2000})</code></pre><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><pre><code>$match (m:Movie {title: &quot;The Matrix&quot;}) return m # match (m:Movie) where m.title = &quot;The Matrix&quot;</code></pre><h3 id="创建边"><a href="#创建边" class="headerlink" title="创建边"></a>创建边</h3><pre><code>// m0-r-&gt;m1$match (m0:Movie {title: &quot;The Matrix&quot;}) match (m1:Movie {title: &quot;Apollo 13&quot;}) \create (m0)-[r:ACTED_IN]-&gt;(m1) return m0, r, m1 # 每次只能创建一个方向// 在创建一个反向m0&lt;-r-m1$match (m0:Movie {title: &quot;The Matrix&quot;}) match (m1:Movie {title: &quot;Apollo 13&quot;}) \create (m0)&lt;-[r:ACTED_IN]-(m1) return m0, r, m1</code></pre><h3 id="删除边、node"><a href="#删除边、node" class="headerlink" title="删除边、node"></a>删除边、node</h3><pre><code>$match (m0:Movie {title: &quot;The Matrix&quot;}) match (m1:Movie {title: &quot;Apollo 13&quot;}) \optional match(m0)&lt;-[r0:ACTED_IN]-(m1) \optional match(m0)-[r1:ACTED_IN]-&gt;(m1) \DELETE r0, r1, m0 # 必须先删除所有边才可以删除node</code></pre><h3 id="STARTS-WITH-ENDS-WITH-CONTAINS"><a href="#STARTS-WITH-ENDS-WITH-CONTAINS" class="headerlink" title="STARTS WITH / ENDS WITH / CONTAINS"></a>STARTS WITH / ENDS WITH / CONTAINS</h3><pre><code>$where a.name STARTS WITH &apos;Ake&apos;$where a.name ENDS WITH &apos;ker&apos;$where a.name CONTAINS &apos;ke&apos;</code></pre><h3 id="EXISTS-属性检查"><a href="#EXISTS-属性检查" class="headerlink" title="EXISTS 属性检查"></a>EXISTS 属性检查</h3><pre><code>$match (m:Movie) where EXISTS(m.title)</code></pre><h3 id="NOT-取反"><a href="#NOT-取反" class="headerlink" title="NOT 取反"></a>NOT 取反</h3><pre><code>$where NOT m.title ends with &quot;ker&quot;</code></pre><h3 id="’regexp’-语法继承来自Java正则表达式"><a href="#’regexp’-语法继承来自Java正则表达式" class="headerlink" title="=~’regexp’ 语法继承来自Java正则表达式"></a>=~’regexp’ 语法继承来自Java正则表达式</h3><pre><code>$match (m:Movie) where m.title =~&apos;The Matr*&apos;</code></pre><h3 id="i-非大小写敏感"><a href="#i-非大小写敏感" class="headerlink" title="(?i) 非大小写敏感"></a>(?i) 非大小写敏感</h3><pre><code>$where n.name =~(?i)TOM.*&apos; return n</code></pre><h3 id="模式过滤"><a href="#模式过滤" class="headerlink" title="模式过滤"></a>模式过滤</h3><pre><code>$match (m0:Movie {title: &quot;The Matrix&quot;}), (m1:Movie) \where (m0)-[r:ACTED_IN]-(m1) return m0, m1相当于:$match (m0:Movie {title: &quot;The Matrix})-[r:ACTED_IN]-(m1:Movie) return m0, m1</code></pre><h3 id="关系类型过滤"><a href="#关系类型过滤" class="headerlink" title="关系类型过滤"></a>关系类型过滤</h3><pre><code>$match (n)-[r]-() where type(r)=~&apos;DIRE.*&apos; return n</code></pre><h3 id="IN运算符"><a href="#IN运算符" class="headerlink" title="IN运算符"></a>IN运算符</h3><pre><code>$match (m:Movie) where m.title IN [&quot;The Matrix&quot;, &quot;Apollo 13&quot;, &quot;the matrix&quot;]</code></pre><h3 id="OR-AND-IS-NULL-ORDER-BY"><a href="#OR-AND-IS-NULL-ORDER-BY" class="headerlink" title="OR/AND/IS NULL/ORDER BY"></a>OR/AND/IS NULL/ORDER BY</h3><pre><code>$match (m:Movie) where m.title = &quot;The Matrix&quot; OR m.title IS NULL return m ORDER BY m.title</code></pre><h3 id="DISTINCT-返回结果去掉重名"><a href="#DISTINCT-返回结果去掉重名" class="headerlink" title="DISTINCT 返回结果去掉重名"></a>DISTINCT 返回结果去掉重名</h3><pre><code>$match (m:Movie) return DISTINCT m.title</code></pre><h3 id="LIMIT-SKIP"><a href="#LIMIT-SKIP" class="headerlink" title="LIMIT / SKIP"></a>LIMIT / SKIP</h3><h3 id="FOREACH"><a href="#FOREACH" class="headerlink" title="FOREACH"></a>FOREACH</h3><pre><code>$match p=(m0:Movie {title: &quot;The Matrix&quot;})-[r:ACTED_IN]-(m1) FOREACH (n IN nodes(p) | set n.marked = true)</code></pre><h3 id="SIZE"><a href="#SIZE" class="headerlink" title="SIZE"></a>SIZE</h3><pre><code>$match p=(m0:Movie)-[r:ACTED_IN]-(m1:Movie) where m0.title=&quot;The Matrix&quot; return m0, SIZE(nodes(p))</code></pre><h3 id="COLLECT-将资源转为array"><a href="#COLLECT-将资源转为array" class="headerlink" title="COLLECT 将资源转为array"></a>COLLECT 将资源转为array</h3><h3 id="WITH-UNWIND"><a href="#WITH-UNWIND" class="headerlink" title="WITH / UNWIND"></a>WITH / UNWIND</h3><pre><code>$match (m:Movie) WITH COLLECT(m) as c UNWIND c as x return x</code></pre><h3 id="MERGE-CREATE-区别在于已存在"><a href="#MERGE-CREATE-区别在于已存在" class="headerlink" title="MERGE / CREATE 区别在于已存在"></a>MERGE / CREATE 区别在于已存在</h3><pre><code>$create (m:Movie {Id: 10}) create (m:Movie {Id: 10}) # 此时有两个Id=10 的movie$MERGE (m:Movie {Id: 20}) MERGE (m:Movie {Id: 20}) # 此时只会有一个Id=20 的movie</code></pre><h3 id="UNION-合并"><a href="#UNION-合并" class="headerlink" title="UNION 合并"></a>UNION 合并</h3><pre><code>// foreach 设置属性$match (cc:CreditCard) with collect(cc) as arr foreach(c in arr | set c.type = &quot;cc&quot;)// 合并CreditCard 和DebitCard 数据$match (cc:CreditCard) return cc.Id as Id, cc.name as name, cc.number as number order by cc.Id \union \match (dc:DebitCard) return dc.Id as Id, dc.name as name, dc.number as number order by dc.Id</code></pre><h3 id="ON-MERGE-CREATE-更新或者新建"><a href="#ON-MERGE-CREATE-更新或者新建" class="headerlink" title="ON MERGE / CREATE 更新或者新建"></a>ON MERGE / CREATE 更新或者新建</h3><pre><code>$MERGE (p:Person {name: &quot;Peter&quot;}) \ON MATCH SET peter += { hungry: true, position: &quot;GAO TOU&quot;}ON CREATE SET peter += {last: &quot;aker&quot;}</code></pre><p><a href="https://www.huaweicloud.com/articles/53b4cf274b3463273fd5b03d845163f9.html" target="_blank" rel="noopener">参考1</a><br><a href="https://blog.csdn.net/chengyuqiang/article/details/102563408" target="_blank" rel="noopener">merge参考</a><br><a href="https://www.w3cschool.cn/neo4j/neo4j_cql_union.html" target="_blank" rel="noopener">union参考</a><br><a href="https://stackoverflow.com/a/25179644/6677202" target="_blank" rel="noopener">on merge/create参考</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> neo4j </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210616我的新目标cpp</title>
      <link href="/2021/06/16/20210616%E6%88%91%E7%9A%84%E6%96%B0%E7%9B%AE%E6%A0%87cpp/"/>
      <url>/2021/06/16/20210616%E6%88%91%E7%9A%84%E6%96%B0%E7%9B%AE%E6%A0%87cpp/</url>
      
        <content type="html"><![CDATA[<h1 id="我的新目标cpp"><a href="#我的新目标cpp" class="headerlink" title="我的新目标cpp"></a>我的新目标cpp</h1><p>最近我的主要学习路线是C++. 我感到学go 之后还是有部分在web路上精疲力尽，我需要一个服务端的底层语言进行支撑。前年学go，去年写了两个gin 服务。本想今年年初好好深入学习，但是接手一个很大的平台服务，导致直到现在6.16号才终于稍稍缓和下来。</p><p>我痛定思痛想知道自己真的想要什么。我是想继续web开发，api调用大法还是写轮子，搞定底层的。公司C++招聘看了下简历，都是半年C++能培养；而且需求量还是很大。一直说C++越久越香。</p><p>我觉得C++估计能给我点答案；而go 当前让我感觉无法给我想要的那个答案。我知道那个答案，我只是想他自己能直接告诉我。</p><p>当时觉得go 也有指针，也有引用，跟我以前的OC很类似。于是花了好多时间认真学着。但是感觉杂乱不堪，最多只是让我用另一种语言写后台。还是没有建树。。</p><p>不是nodejs不行。而是nodejs 在最需要性能的时候，没人提供binding。一个大锤子加一个底层机械的组合。也许我自己可以给自己binding？所以我来了。</p><hr><p>今天刚好遇到个自己没理解清楚，问了个大佬突然明白的问题。</p><p>这样编译没有问题，但是执行时报错: pvalue被释放了! 代码:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapAndStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">double</span>* pvalue = <span class="keyword">new</span> <span class="keyword">double</span>; <span class="comment">// pvalue 申请了堆空间</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">double</span> aa = <span class="number">29494.99</span>; <span class="comment">// aa申请了栈空间。</span></span><br><span class="line">  pvalue = &amp;aa; <span class="comment">// pvalue 获得了 aa 的地址(栈的地址) 此时可以认为pvalue 已经指向了栈，也就是*aa</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">"Value of pvalue : "</span> &lt;&lt; *pvalue &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> pvalue; <span class="comment">// 这时释放栈则报错: 栈是自动内存回收的；指针才可以delete</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> cpp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210611房子买后感</title>
      <link href="/2021/06/16/20210611%E6%88%BF%E5%AD%90%E4%B9%B0%E5%90%8E%E6%84%9F/"/>
      <url>/2021/06/16/20210611%E6%88%BF%E5%AD%90%E4%B9%B0%E5%90%8E%E6%84%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="房子买后感"><a href="#房子买后感" class="headerlink" title="房子买后感"></a>房子买后感</h1><p>搬过来一周，工作日都是回来就直接躺下。里面有很多东西都要维修，很多东西要丢要收拾都忙没时间搞，先不管，房间里面也有点脏。老婆每天晚上就早早回家收拾，不知疲倦，我说三分钟热度猴，你别太累哦。别到时说哎呀好累啊，受不了啦。隔天老婆立马就躺床上不动，瞬间降温。</p><p>其实也是怕老婆太累，周末搬家真的是来来回回的上下楼梯。腿都廋了。</p><p>接下来的一段时间全身心投入到工作中，距离上里公司单向行程要多20分钟，不过周末来公司蹭空调还是一样有激情。</p><p>家里硬装都是很OK的，那些设备有些就头疼了。空调不那么熟悉，差点卖了很老，但是还挺好用的老空调(三菱牌子)。床以为很小，直到很后来老爸来，买了卷尺才知道是1.9，于是就继续睡，买了席梦思就继续用了。灯泡，一个接一个坏，买房前看过没坏，后来怎么打斗不着。冰箱开门就臭死，扔给收电器的，不要钱，帮我把油烟机搬下去就好了。换了个马桶，坑距不会量，让物业大叔过来量，400坑距给他量程300，得，马桶屁股后面空的好大位置；等装马桶，没得用怎么办?去附近公园上，5星级厕所。接下来就是重头戏了: 洗衣机。</p><p>这个洗衣机就是个爹，每次洗衣服就漏水，赶紧拿拖把拖。物业帮忙清理了下水道、理了下说没漏水；还是没解决。我自己试了方案，看不出漏水，主要精力在工作上。然后那几天回家还耍脾气(我再次说到她在就快买房子了，还买100多新的运动器械，很重，我搬得累死；她老get不到我累的点；让她去闲鱼买30多都很好用了，她还是get不到点；还说我老是说这件事，她知道不对了我还在说。那肯定的了，我搬我累啊，而且还花这些没用的钱；反正把她一顿骂)，吃饭时，洗衣服的时候大厅第一次漏水，骂了她几句，这又买，水都满起来还不赶紧整。赶紧把洗衣机关了，然后把下水道盖子掀起来下水，我赶紧把大厅的水给拖干净，她就在那看着，一动不动。然后我还好声好气让在床上趴着猴子在大厅看下洗衣机。我好久没放松下，进屋里打了会游戏，出来一看，脑子都炸了!水都把厨房淹了，比刚才淹得还厉害。一通大怒劈头盖脸又又又把老婆给骂了！又赶紧把洗衣机关了, 水下去慢。赶紧把大厅整一下，老婆还是一动不动，眼睛红红的，我还继续骂，大厅都淹了，幸好是瓷砖。要是水进到房间(幸好有点斜坡，感谢之前的硬装设计)，水泡了木头一下，就得腐烂房间木头地板。而且烂了一个，就得修一大片。到时候就装修费至少好几万来出。她就顾着自己生气就啥都怪我一样，啥都不管不顾。那几天把我气的，当时真想抽她个耳光，给她抽醒!</p><p>这个问题也一直没有解决，然后在七月末，老爸带阿黄来上海啦。老爸一来，就捣鼓捣鼓，搞定了好多东西。阿黄吧，这货饭不自己吃，总想着喂，那能怎么办，父亲的责任，揍他。</p><p>老爸看到了洗衣机不下水的原因: 脱水的时候，水太大，倒灌出来，哗哗的外冒，这回看清楚了。老爸把下水管锯掉大截，然后那胶水封住口子，是不漏水了。然后发现洗衣机无限重启某几个进程。打电话去官方来人修，第一次上门，整了下，修了个出水口，不漏了；但是程序还是错乱的，必须来人再修。第二次380多，官方调货，某个零件换了，然后这次后就再也他妈不用我管了。</p><p>啊，心情愉快了，不用狠狠骂老婆了。当时该骂啊，水要是泡到木地板，腐烂了是不能住的，没救。就吩咐一个小事都做不好，那不骂，是要上天嘛!吵归吵，大不了晚上强奸她就好了嘛；要是平白房间内泡水，多花好几万，这她妈我得狠狠给她来几个打耳光。生气就生气，不要把钱当玩笑。好好努力搞了个家，下周阿黄就要来了，还漠不关心一样。那就不行了。我内心都还能想到和老婆努力争取，买下了这个小居，全靠努力和运气。刚买下来时候老婆多开心，看到现在老婆漠不关心，我内心就有多割裂: 她不喜欢这小宅子？怎么可以这样，我那么努力才争取下来的啊!全程所有资金都是我特么一分一分积攒，小份额她帮上。</p><p>反正那几天她眼睛都哭肿了，怎么，老子说的不对啊，怎么不理我啊？干她!对女人，干就完事!这不，慢慢不就又好了嘛。女人这东西，不能惯，不骂她，她就站着瞪着你，一动不动。一动不动是王八。</p><p>老爸和阿黄来的几天，刚好最热了。阿黄不熟悉，偶尔带下去溜溜，我带他去公园跑步，这货为了不输，跑的贼快的，两大圈都能hold住。不错，身体好，以后带他泡妹子就不会没力气了，丢人就不好了。周末多陪陪孩子，教了教阿黄写程序，得这货啥都不会，多多教吧: 多少+多少；abcd…；类型等等，然后他学的好累，然后问他来玩电脑，他说我不喜欢电脑，电脑不好玩。哦，顺便教他游戏lol，不过这货不会，看不懂，兴趣不大；然后隔了会，觉得画面漂亮，又会想打开电脑，看别人电脑那么炫，我的电脑又有密码进不去，进去了Mac OS 又只有工具，真捉急。屋子里待了老下午了，和老婆带他去迪卡龙溜溜。去了之后一开始阿黄很害羞，哇，这么好玩，我都不晓得玩哪个了；哇，我可以碰这些吗？没5分钟，这么跑跑，那里跳跳。把老婆打发走自己去快乐，我帮她带带阿黄。</p><p>首先到处转，看到手表就要一个个带上去，带吧，怎么那么奇怪的呢？手表带着有用么？一直缠着要买，那我就走了。然后又去看了射箭？啥？这又要买？哪来的钱？自己赚！啥？滑板车？让服务员给开个玩会，反正我是不会买的。然后又带他去看轮滑，他看着别人自己也想进场地；这特么就是个老想花钱的货啊，不行，以后得治治。又往后带去骑自行车，免费的活动嘛，随便玩，就那小场地他能一直骑，啊，穷才能体会到快乐啊。带他去尿尿，他说没尿，被我拉去，他自己都笑了，尿了好多。然后我说等我会，爸爸也要尿尿，他不管你的，直接跑了。卧槽，我特么要是找不到就完了，这特么个蛋疼的猴，赶紧来回找。没想到跑回去玩自己车了，吓死我了，真有点心悸的感觉，一转眼特么自己就不见了，要是跑到人贩子那砍手砍脚，那我真是要后悔一辈子哦。这无法无天的样子，真特么像我，艹，体会得到老妈以前带我的辛苦了。给阿黄买几件衣服就回去了，他有个疼他的好妈妈，衣服直接扒了光光试穿。于是逛了那么久，就买几件衣服肥去了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20210610网迹【权限优化】</title>
      <link href="/2021/06/16/20210610%E7%BD%91%E8%BF%B9%E3%80%90%E6%9D%83%E9%99%90%E4%BC%98%E5%8C%96%E3%80%91/"/>
      <url>/2021/06/16/20210610%E7%BD%91%E8%BF%B9%E3%80%90%E6%9D%83%E9%99%90%E4%BC%98%E5%8C%96%E3%80%91/</url>
      
        <content type="html"><![CDATA[<h1 id="网迹【权限优化】"><a href="#网迹【权限优化】" class="headerlink" title="网迹【权限优化】"></a>网迹【权限优化】</h1><p>各服务目前都有基于用户权限来限制接口的使用的功能。比如系统管理员处理系统的事务；厨师进厨房拿刀切菜烧菜；律师进事务所处理案件等。</p><h1 id="当前网迹权限长这样"><a href="#当前网迹权限长这样" class="headerlink" title="当前网迹权限长这样"></a>当前网迹权限长这样</h1><p>…</p><h1 id="普及下权限"><a href="#普及下权限" class="headerlink" title="普及下权限"></a>普及下权限</h1><p>比如user(普通用户)、superman(超人)等角色，我们用以下模型来表示:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  code: "user",</span><br><span class="line">  name: "普通用户",</span><br><span class="line">  permissions: ["mod_collect"]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  code: "onlyEditor",</span><br><span class="line">  name: "上传者",</span><br><span class="line">  permissions: ["mod_collect", "mod_sysUser_edit", "mod_sysUser_del"]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  code: "superman",</span><br><span class="line">  name: "超人",</span><br><span class="line">  permissions: ["mod_collect", "mod_sysUser", "mod_sysUser_edit", "mod_sysUser_del", "mod_sysRole"] // 没有采集修改权限</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对应接口如:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: "/collect",</span><br><span class="line">  method: "GET",</span><br><span class="line">  permission: "mod_collect"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这时很简单的方案就是直接判别数组内是否有该权限，有当然就能使用该接口啦。</p><p>但是此时会发现一个问题，数组查找字符串，其实是一个很耗时的操作。数组<code>[&quot;mod_collect&quot;, &quot;mod_collect_edit&quot;].include(&quot;mod_collect&quot;)</code> 会先for 循环查找第一个字符串(mod_collect)，第一个字符串对比从第一个字符开始一个个比对。</p><p>你会说，那也很快啊，CPU买买买，快快快。</p><p>有这想法的人得自己深思了，这里的判别是作用在所有中间件，当然是尽可能快，能提高用户使用、设备使用。大多在中间件出现的数据，一定要尽可能的缓存或者优化。</p><p>OK，那怎么解？我们都知道字符串判别是一个一个字符比较O(n)，如果是数字判别，则是类似于O(1)的时间复杂度。我们将现有的所有permission都转化为一个数字: Bitmap. 比如: <code>mod_collect: 1 &lt;&lt; 2 = 4; mod_collect_edit: 1 &lt;&lt; 3 = 8; mod_sysUser: 1 &lt;&lt; 4 = 16; mod_sysUser_edit: 1 &lt;&lt; 5 = 32; mod_sysUser_del: 1 &lt;&lt; 6 = 64; mod_sysRole: 1 &lt;&lt; 7 = 128; ...</code></p><p>以上得到关联: user 有一个权限: [4]; onlyEditor有三个权限, 我们使用 <code>|</code>运算符给他串起来: <code>8 | 32 | 64 = 104</code>, 我们这时可以说 user用户的权限是4, onlyEditor用户的权限是104, superman超人的权限是244.</p><p>我们将上述的数据量不大，基本不怎么变动的数据都内存缓存下来:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">roles: &#123;</span><br><span class="line">  "mod_collect": 4,</span><br><span class="line">  "mod_colelct_edit": 8,</span><br><span class="line">  "mod_sysUser": 16,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">permissions: &#123;</span><br><span class="line">  "user": 4,</span><br><span class="line">  "onlyEditor": 104,</span><br><span class="line">  "superman": 244</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时如果接口进入中间件:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假装我是中间件内部判别权限</span></span><br><span class="line"><span class="keyword">const</span> curRoutePermission = <span class="string">"mod_collect_edit"</span> <span class="comment">// 当前接口必须的权限</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPermission</span>(<span class="params">role:<span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> tPerm = permissions[role]</span><br><span class="line">  <span class="keyword">const</span> curRole = roles[curRoutePermission]</span><br><span class="line">  <span class="keyword">return</span> tPerm &amp; curRole <span class="comment">// `与`符能得到交集 -&gt; 这个用户是否有该接口的权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果是user判别需要<code>&quot;mod_collect_edit&quot;</code>接口 =&gt; 4 &amp; 8 = 0; onlyEditor =&gt; 104 &amp; 8 = 8, 说明是有权限的!</p><blockquote><p>使用位运算<code>&amp;</code>比较，如果 &gt; 0 则表明这是有权限的。</p></blockquote><p>以上是权限基础普及，下面开始进入权限升级部分: ↓↓↓</p><h2 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h2><h3 id="设定数据范围、权限及访问路由"><a href="#设定数据范围、权限及访问路由" class="headerlink" title="设定数据范围、权限及访问路由"></a>设定数据范围、权限及访问路由</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">enum DataScope &#123;</span><br><span class="line">  All = <span class="number">1</span>, <span class="comment">// 全局</span></span><br><span class="line">  ThisWithSubordinate = <span class="number">2</span>, <span class="comment">// 本单位及下属单位</span></span><br><span class="line">  This, <span class="comment">// 仅本单位</span></span><br><span class="line">  self <span class="comment">// 本人</span></span><br><span class="line">&#125;</span><br><span class="line">enum UrlMap &#123;</span><br><span class="line">  browseCollection = <span class="string">"/browse/collection"</span>, <span class="comment">// 采集管理</span></span><br><span class="line">  sysUser = <span class="string">"/sys/user"</span>,</span><br><span class="line">  sysRole = <span class="string">"/sys/role"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> Urls = [</span><br><span class="line">  UrlMap.browseCollection,</span><br><span class="line">  UrlMap.sysUser,</span><br><span class="line">  UrlMap.sysRole</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> roleSchema = &#123;</span><br><span class="line">  name: <span class="built_in">String</span>, <span class="comment">// 用于记录角色名称，比如 `超人`</span></span><br><span class="line">  code: &#123;<span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">unique</span>: <span class="literal">true</span>&#125;, <span class="comment">// 用于声明角色编码，如superman/user/u001等代号</span></span><br><span class="line">  permissions: [&#123;<span class="attr">type</span>: <span class="built_in">String</span>&#125;], <span class="comment">// 该角色拥有的权限数组</span></span><br><span class="line">  urls: [&#123;<span class="attr">type</span>: <span class="built_in">String</span>&#125;], <span class="comment">// 该角色展示的页面数组</span></span><br><span class="line">  dataScope: &#123;<span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">enum</span>: DataScope&#125;, <span class="comment">// 数据范围声明</span></span><br><span class="line">  remark: <span class="built_in">String</span> <span class="comment">// 加个简介好记忆?</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>角色表包含有数据权限dataScope，页面列表urls，权限列表permissions。</p><p>数据范围定义数据获取等级。侧重点是支持中间件将该用户的数据权限，写到用户数据中:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将已构建的角色对应结构保存在内存中</span></span><br><span class="line">staticbuildInRoleMaps:IBuildInRoleMap</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">async</span> dataScopeMiddleware(req:Request, <span class="attr">res</span>:Response, <span class="attr">next</span>:NextFunction) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.hasPermission(<span class="string">"admin"</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.user.departmentNo) <span class="keyword">return</span> res.status(<span class="number">403</span>).send(<span class="string">"您没有设置组织机构"</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    req.user.dataScope = DataScope.All</span><br><span class="line">    <span class="keyword">return</span> next()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> requserRole = Utils.getUserFirstRole(req.user)</span><br><span class="line">  <span class="keyword">if</span> (!_.includes([<span class="string">"anon"</span>], requserRole)) &#123;</span><br><span class="line">    <span class="keyword">const</span> theRole = Role.buildInRoleMaps[requserRole]</span><br><span class="line">    <span class="keyword">if</span> (!theRole) <span class="keyword">return</span> next(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"权限获取出错，请联系管理员"</span>))</span><br><span class="line">    req.user.dataScope = theRole.dataScope</span><br><span class="line">  &#125;</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>将改变不大的数据存在内存中，可以很快速的进行获取数据。</p></blockquote><h3 id="数据范围设定-根据业务划分不同的接口"><a href="#数据范围设定-根据业务划分不同的接口" class="headerlink" title="数据范围设定(根据业务划分不同的接口)"></a>数据范围设定(根据业务划分不同的接口)</h3><p>下面是我所使用的获取数据过滤方式之一:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> dataScopeForCollect(user:&#123;<span class="attr">dataScope</span>:DataScope, <span class="attr">departmentNo</span>:string, <span class="attr">policeNo</span>:string&#125;) &#123;</span><br><span class="line">  <span class="keyword">let</span> cond:&#123;departmentNo?:string, code?:<span class="built_in">RegExp</span>, policeNo?:string&#125; = &#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> (!_.isNumber(user.dataScope)) <span class="keyword">return</span> cond</span><br><span class="line">  <span class="keyword">if</span> (user.dataScope === DataScope.All) <span class="keyword">return</span> cond</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (user.dataScope === DataScope.ThisWithSubordinate) &#123;</span><br><span class="line">    cond.code = Utils.orgReg(user.departmentNo)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (user.dataScope === DataScope.This) &#123;</span><br><span class="line">    cond.departmentNo = user.departmentNo</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (user.dataScope === DataScope.self) &#123;</span><br><span class="line">    cond.policeNo = user.policeNo</span><br><span class="line">    <span class="keyword">if</span> (user.departmentNo) cond.departmentNo = user.departmentNo</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cond</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>于是我很快就能知道对应的获取数据方案。</p><h3 id="限制页面路由"><a href="#限制页面路由" class="headerlink" title="限制页面路由"></a>限制页面路由</h3><p>这方面由李豪同学来交流下。当初也是李豪同学提出来，我保存好，由他来约束这块的逻辑。点赞。</p><h3 id="接口权限的组合"><a href="#接口权限的组合" class="headerlink" title="接口权限的组合"></a>接口权限的组合</h3><p>这块复用第一章节的逻辑。第一章节将静态的数据，在这里转化为可调节配置的权限组合。</p><h2 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h2><p>Number 类型是32位的。使用Number 进行位运算，当角色超过32位时， <code>1 &lt;&lt; 32 = 0</code>.</p><p>使用BigInt 可能突破这个限制: <code>BigInt(1) &lt;&lt; BigInt(x)</code>.当使用BigInt 作为json 传输时需要<code>将其转为字符串</code>，在Chrome67之后版本支持BigInt 类型。前段收到对应角色编码，将其转化为BigInt:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ BigInt(<span class="string">"17179869185"</span>)</span><br><span class="line">$ <span class="number">17179869185</span>n</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 分享, 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210604这是第二篇入住自己房子回顾</title>
      <link href="/2021/06/04/20210604%E8%BF%99%E6%98%AF%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%85%A5%E4%BD%8F%E8%87%AA%E5%B7%B1%E6%88%BF%E5%AD%90%E5%9B%9E%E9%A1%BE/"/>
      <url>/2021/06/04/20210604%E8%BF%99%E6%98%AF%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%85%A5%E4%BD%8F%E8%87%AA%E5%B7%B1%E6%88%BF%E5%AD%90%E5%9B%9E%E9%A1%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="这是第二篇入住自己房子回顾"><a href="#这是第二篇入住自己房子回顾" class="headerlink" title="这是第二篇入住自己房子回顾"></a>这是第二篇入住自己房子回顾</h1><p>6月4号中午请示了下去自己房子交房。伟哥说别在意，不用请假了，这，只能多多加油，嗷嗷嗷。</p><p>中午饭也不吃了，直接骑电驴过去，40分钟，大约摸清了之后要走的小路。到了之后顾问也在，然后等了一会各方人都到齐。我们先上楼查看。我和老婆前前后后到处转转，其实俺真看不出哪里不好。看各个物件: 能出水、能生火、电能通，OK。</p><p>我们先和房东先签署一份交房补偿款，时间从6.5号开始，每天150，其实就是每个月4500进行补偿我们提前住进来。因为合同当时写确实是款清交房，公积金贷款和商贷贷款到齐才交房。没事，这房子这片租金没个6、7k也是下不来的，而且还是自己的住房。我在另一片租房也是3k，一室户，不如住过来，那个住起来不舒服。</p><p>接下来也没别的，交钥匙，我们到物业处看能否物业过来。物业处置当天没得办理，自己来办理也OK的，带着产证过来就可以了，于是之后我自己过来办理就好了。物业费各方同意周二询问多少，前房东微信补齐后缴纳。</p><p>然后我就回去上班了。上班重要嘛。</p><p>周六的时候早上开始搬家，东西超级多，这个也不舍得那个也不舍得。我当时一个人看着那么多要下5楼，到时过去肯定也是上5楼，头大。这时一个扫地阿姨过来问是搬进来还是搬出去啊？我就问她帮忙搬东西，50块。我的天，居然同意了。我也出大力，搬了一趟有一趟。重的几乎都是我，或者和阿姨一起搬。搬到后面终于搬完，然后我问阿姨，明天要不要帮忙扫，当然扔垃圾啥的我来，我老婆也会帮忙打扫，200. 然后阿姨说好吧。(后来阿姨说搬下楼50好少的，我说是的，不过我也帮忙搬嘛，哈哈；然后她说打扫现在请人大概也是这价，我说是的，我也不懂)。于是中午的时候又不能走远，东西在下面，和老婆点了叫花鸡吃了下午看还有什么能收拾的赶紧叫车拉东西过去。今天出了多少汗，忘了，我的腿有多算，麻木了。</p><p>叫车过来不加钱，货拉拉不鸟你，可能路程短，不想接单，唉，加个10块。叫了小货车，上车、下车，又是一阵忙活，看到还有那么大位置，赶紧上楼再拿多点东西，比如凳子之类的。<br>过去后，把东西放下来。哦对了，货拉拉要收额外上下货钱，60块，算了，那么多东西，60也是小钱。我的老哥来帮忙，嗷嗷，每次搬家我老哥都来帮忙，超级超级好同桌。不过最近他生病，只能我尽可能多搬，不过我手开始抖了。下午的时候也问了同事来帮忙，这时也到了。同事他正要学习被我喊过来，过来埋头就搬，也是超级感谢他，嘿嘿。</p><p>上下上下搬了好多东西，女生帮忙带点东西就OK，我还把老婆多累一丢丢。我也是尽可能多搬，和我同事一起多搬，同桌身体还没恢复好，帮忙一些就很好了，嘿嘿。</p><p>搬好之后已经6点了，没食材，没水(喝的水)，很乱，走，我们去附近南丰城的新白鹿吃。去那里吃，点多少，都不太贵。不过没考虑老哥不能吃辣(身体原因)，另外给他再来一些好吃的，反正这里点菜都不贵。</p><p>吃完已经晚上9点了，送他们肥去，我们也赶紧回去收拾，去睡个觉了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 房 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210531生活琐碎</title>
      <link href="/2021/05/31/20210531%E7%90%90%E7%A2%8E/"/>
      <url>/2021/05/31/20210531%E7%90%90%E7%A2%8E/</url>
      
        <content type="html"><![CDATA[<p>这段时间超级超级忙碌。</p><p>首先是网迹市局需求和之前要改的徐汇权限优化，一开始设计是单接口权限优化，在后面完善功能下，我们为其设计了三个维度的权限设计: 数据作用域、页面权限、接口权限。</p><p>市局需求比较急忙，在周一上午开会；下午有时需要开取综会；有时有其他服务的开会；自己组织开会等；其他地方找我；各种各样找我的等情况下，急急忙忙上线这款功能。大约耗时1个月。</p><p>由于其中还有需要将iced代码翻译为typescript代码，着实是每天加班熬夜换来的成就。其中业务不熟悉，里面有几个模块走不通权限判别，多人、单人、多案件、单案件、上传数据包等有时走的判别还不一样。之前是iced的不理解其内涵情况下，最终自己重写了判别逻辑。不然感觉都要吐血：改一些不对，再改一些还是不对，继续改继续不对!真要吐血。</p><p>另一个是房子过户、缴税、贷款申请等。由于这块业务比较大，内心也是放到超级第一的位置。</p><p>再一个是想要能落户而去考试，软考中级。前一段时间在翻译代码过程，还不那么急忙，晚上可以抽空看看；后来太忙，晚上只有偶尔的时间赶紧学习。当时在想的就是，要是现在不用加班到11点，能赶紧看书多好。偶尔10点能到家，赶紧打开电脑学习。</p><p>车牌也在拍当中，所以也是急急忙忙。</p><p>5月也是超级超级忙碌啊。周末能用来加班的都用上，有时带上老婆去公司学习，路过公园还能转一圈，有时顺便就去打羽毛球，啊，累却又充实却又有所得。</p><p>这篇就是胡言乱语文章，原因是好久好久没写博客了，今天也是抽空写下。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 琐碎 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210517产证到手</title>
      <link href="/2021/05/17/20210517%E4%BA%A7%E8%AF%81%E5%88%B0%E6%89%8B/"/>
      <url>/2021/05/17/20210517%E4%BA%A7%E8%AF%81%E5%88%B0%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="产证到手"><a href="#产证到手" class="headerlink" title="产证到手"></a>产证到手</h1><p>最近已拿到产证，历经2.18 ~ 5.13 这么长时间，产证到手，每一步都是大胆的尝试，甚至相信命运，敢拿着100+w 孤注一试，且听我细细回顾.</p><p>2.18 过年假期快要结束刚要上班的时候，快速找房东上门看了下房子即交了30w定金。30w，我当时还在不确定我有没有买房资格(一个月一个月往上数，刚好60个月，但是我心里还是打鼓的)，但是考虑到再不上车，不好上了。过完年约dfy顾问和房东一起简单看完房子即找了家喝茶的地方签订简单约定及定金，两天后完整签署合同。</p><p>接下来的每半个月交首付至房东账户，交完134w，已经来到3月24号，约了雷老师(房东哥哥, 代)办理网签。过程很顺利，办了网签，这个房子是无论如何都没法交易，然后不放心是否有买房资格的我(如果不满足则稍稍往后延续几天，下个月初能多查到新的一个月)。等了三天，然后再次前往交易中心的前台经理查询: 62个月满足资格。</p><p>这时心终于落下来了，我是真有资格的，不然就真是60w赔付违约金了。</p><p>接下来就是把合同证件复印件等发给银行贷款老师，等待了2周(中间少资料，补齐寄送过去)通知全部通过。</p><p>这时时间来到5.6号，手上得到贷款文书(公积金100w，商贷140w)，这天下午过去办理过户。我和老婆两人早早就到了，等待各方人员到场。先填写资料，然后dfy交易员老师帮忙等待排号，我和雷老师沟通了下意愿: 现在也是在租房3k，租自己要住的房子，想提前住进去；当然，合同写着款清交房，我愿意来租还没走完流程的房子。雷老师后面也和房东商量同意我们的要求(遵守合同义务，我们也爽快，所以也相信我们，很顺利进行)。</p><p>接下来就是在窗口确认资料、确认在场的人、再再次确认资料、签名、签名、交了160块钱(支付宝扫码)。然后将各种收据等收入统一包包管理。下午清了很久的假，去未来的房子转转会，然后就回到出租屋了。</p><p>过户完后，得过5天缴税拿产证。手上只有刚好3.8w的我，其实内心还是起波澜的。缴税前一晚都还在担心会不会有其他税费，打电话到交易员老师那里问，比如房产税。心想同学居住证超过三年就不用交，不然得多1w多啊。</p><p>缴税当天，早晨，小雨。我早早过来等雷老师，然后排号等。缴税的时候是刷卡，我把银行卡拿出来刷，咦，真只刷我3.78w 一个点的契税。然后我质疑工作人员，会不会弄错，不是还有一堆什么什么税吗？他说，都取消了。</p><p>等了20分钟，在邻桌，工作人员喊名字领证。上面有产证，还有各种贷款证书等，还有外汇的证明单子(房东外汇使用)等。今天早上就这样结束了，很圆满。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 买房, 产证 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210516学习杂项记录</title>
      <link href="/2021/05/16/20210516%E5%AD%A6%E4%B9%A0%E6%9D%82%E9%A1%B9%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/05/16/20210516%E5%AD%A6%E4%B9%A0%E6%9D%82%E9%A1%B9%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="视频服务-点播及加密"><a href="#视频服务-点播及加密" class="headerlink" title="视频服务-点播及加密"></a>视频服务-点播及加密</h1><p><a href="https://github.com/gwuhaolin/blog/issues/10" target="_blank" rel="noopener">方案来源</a></p><h2 id="网迹学习"><a href="#网迹学习" class="headerlink" title="网迹学习"></a>网迹学习</h2><h3 id="es"><a href="#es" class="headerlink" title="es"></a>es</h3><p>遇到 <code>es forbidden 12 index read-only</code></p><p>原因是磁盘不够用了，当磁盘少于95%左右时，es会将索引置为只读。</p><p>解决方案: 进入docker，然后执行: <code>curl -XPUT -H &quot;Content-Type: application/json&quot; http://elastic:123456@localhost:9200/_all/_settings -d &#39;{&quot;index.blocks.read_only_allow_delete&quot;: null}&#39;</code></p><h3 id="绑定Centos7静态ip"><a href="#绑定Centos7静态ip" class="headerlink" title="绑定Centos7静态ip"></a>绑定Centos7静态ip</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cd /etc/sysconfig/network-scripts &amp;&amp; ls // 可以看到有个ifcfg-ensxxx 的文件</span><br><span class="line">$ ip addr // 可以先查看到之前自己ip</span><br><span class="line">$ vim ifcfg-ensxxx // 替换掉 `IPADDR=xxx.xxx.xxx.xxx`</span><br><span class="line">$ systemctl restart network.service</span><br><span class="line">$ service network restart</span><br><span class="line">$ ip addr // 这时可以看到ip已修改</span><br></pre></td></tr></table></figure><h3 id="黑苹果拷贝EFI-文件到EFI分区提示”磁盘空间不足，无法拷贝”"><a href="#黑苹果拷贝EFI-文件到EFI分区提示”磁盘空间不足，无法拷贝”" class="headerlink" title="黑苹果拷贝EFI 文件到EFI分区提示”磁盘空间不足，无法拷贝”"></a>黑苹果拷贝EFI 文件到EFI分区提示”磁盘空间不足，无法拷贝”</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -s</span><br><span class="line">diskutil list</span><br><span class="line">newfs_msdos -v EFI /dev/disk1s1 // /dev/disk1s1 中的disk1s1 为list 里面的磁盘名称</span><br></pre></td></tr></table></figure><h3 id="docker-Neo4j"><a href="#docker-Neo4j" class="headerlink" title="docker-Neo4j"></a>docker-Neo4j</h3><p>$cypher-shell</p><p>进入neo4j</p>]]></content>
      
      
      
        <tags>
            
            <tag> 学习记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210311伟哥教你装vsphere</title>
      <link href="/2021/03/11/20210311%E4%BC%9F%E5%93%A5%E6%95%99%E4%BD%A0%E8%A3%85vsphere/"/>
      <url>/2021/03/11/20210311%E4%BC%9F%E5%93%A5%E6%95%99%E4%BD%A0%E8%A3%85vsphere/</url>
      
        <content type="html"><![CDATA[<h1 id="伟哥教你装vsphere"><a href="#伟哥教你装vsphere" class="headerlink" title="伟哥教你装vsphere"></a>伟哥教你装vsphere</h1><p>这几天公司研发部乔迁，距离很近，三楼到四楼。</p><p>长话短说: 机房重新整理，所以测试环境也要整理。当前机器未到，于是伟哥喊上还在加班的同学学上一学，加班福利。</p><h2 id="正题"><a href="#正题" class="headerlink" title="正题"></a>正题</h2><p>首先是服务器要先装上Raid卡(2000+软妹币)，接下来往服务器上插入硬盘。</p><p><img src="/css/images/11lesson/01.jpg" alt="1"></p><p>硬盘顺序是左边从上到下0,1,2 然后到右边依次。本次是开头的0,1,2,3 SSD，其他机械盘和SSD 混装。</p><p>系统进入后 CTRL+R 进入配置Raid界面。</p><p>可以看到有<code>Unconfigured Physical Disks</code>，这时在根一栏按F2 进入Operations 选择组Raid模式。可以选 0 / 1 / 10 / 5/ 6 等，选好按Enter 就好了。</p><p><img src="/css/images/11lesson/02.jpg" alt="2"></p><p>如果发现少了块盘情况，按Ctrl + N 切tab 到 <code>PD Mgmt</code>界面，可能是那块盘被直接作为盘符使用了(Non-RAID, 可以选择<code>Convert to Raid Capable</code>)。</p><p>组完Raid之后，磁盘就完了。</p><p><img src="/css/images/11lesson/03.jpg" alt="3"></p><p><img src="/css/images/11lesson/04.jpg" alt="4"></p><hr><blockquote><p>插内存条这事需要自己上网找，并且伟哥说了，这个很重要，插不好，性能会很差!单颗CPU插法和多颗CPU插法也不一样!</p></blockquote><hr><p>接下来装vsphere。vsphere 是专门做虚拟化的linux，把整个服务器资源统一安排。</p><p>首先: 伟哥把USB 插上插口，然后Boot 那个USB，把他当做安装系统。然后就好了。</p><p>装完之后需要注意把IP 固定。然后下方有个测试Ping 的功能。比如伟哥这里就测试ping 研发网段、网卡网段、114.114.114.114，然后其他都是界面操作了。</p><p>欧了。</p><p><img src="/css/images/11lesson/05.jpg" alt="5"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20210218定房日记</title>
      <link href="/2021/02/18/20210218%E5%AE%9A%E6%88%BF%E6%97%A5%E8%AE%B0/"/>
      <url>/2021/02/18/20210218%E5%AE%9A%E6%88%BF%E6%97%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="2021年定房日记"><a href="#2021年定房日记" class="headerlink" title="2021年定房日记"></a>2021年定房日记</h1><p>上海买房是个巨大的难题，我从2020年年初就开始很上心，彼时就已经开始看房。</p><h2 id="开始看房，推进实施"><a href="#开始看房，推进实施" class="headerlink" title="开始看房，推进实施"></a>开始看房，推进实施</h2><p>当时贝壳网上看房，有个按钮【现场带看】试着点了下，然后一个中介就跑出来帮忙介绍。一开始我还是懵懵懂懂，因为我的社保还没到，没有房票。中介就鼓舞去看吧，看又不花钱。你这话说的，我这厚脸皮隔天就跑去了。当时还是2020年5月20号，疫情刚刚缓和下来。街上溜达的人都不多，不管了，冲冲冲，我这人就喜欢找事。</p><p>先看了中介推荐的，后来自己也有喜欢的，并自己决定看哪些。一开始想着一房一厅，价格250封顶了。后来想着250蹭上去点270~280基本有南北两房，也挺香的了。当时看到有个房子310降价到279，极度喜欢(想着我要是买了，岂不是赚了)。当时回到家我就跟老妈打电话，很想要那个房子，不过此时距离我房票还有接近一年呢!(至少2021.3月才能看到社保缴纳)。房东肯定等不及的，我说，我定金40w这样,且不讲价呢？过两周，那个房子就被卖了，房东也是急着出手。不过那个房子南北，5楼顶楼，但是没有吃饭地方。</p><p>当时喜欢那个小区，还特地和老婆，并叫上自己哥们去那个小区转了转(也伙同他，约了中介又看了那个小区几个房子)，都觉得是非常不错的。</p><p>和老婆交心下来，她也是超级喜欢，而且当时那个价格对自己未来也是很好承受的。</p><p>算了算了，我继续看看附近的。龙柏整个都看了一遍又一遍，然后又跑去浦东杨思看了，又跑到北新泾看了，最后跑到长宁古北看了。</p><p>龙柏当时觉得很好的，但是下半年画风变了，龙柏四村三小区，房价一周一个样，打电话过去约，都是被卖了；其他小区都开始30~50的涨。</p><p>不急，没用，俺还没房票呢；</p><p>浦东先看了杨思，当时和老婆一起去看，下地铁附近，全是很老。90年代房子超级老，附近一片又一片等着拆迁的房子。当时还没接收一梯四户，然后浦东离七宝(公司距离)过远。但是当时看到&lt;源城景翠苑&gt;/&lt;翡翠上南&gt;超级超级喜欢。房龄新啊，谁不喜欢啊。当时有个源城景翠苑一楼动迁房，380，没有税费，毛坯装修，哇，超级喜欢。因为小区户型少，绝大部分都是57.x平，一楼装修下也超级好，所以当时也是超级喜欢。回去又和家人商量，跟老婆商量。多方下来，觉得价格还是超过预算，没想到一周内就出掉了。额，，，然后又关注同小区其他房源，看了一个5楼顶楼的，也不错，又卖了—-没钱没房票。</p><p>其他都有装修，基本都是400(一楼)410(中间楼层)。到了8月到10月，410变成420，后来一直往上到了504，单价从7w2变成8w8了。我滴个天。</p><p>浦东考虑不得了，没钱没资源，再多想法再多办法都没。</p><p>后来跑北新泾附近看，当时绿城十二村有个2楼369售后公房超级超级喜欢，不过当时我还要挺久时间才有房票。回去后和家人又是一顿开会。老妈也是在多次的惊喜/担忧/失望中。我超级觉得喜欢，到时一家都能去上海，2楼老妈爬楼也不累。售后公房，能贷款也更多(没有增值税，只有一个点契税)。然后一直无法确定我们能筹到的钱，而且房东不愿意等这么久，于是下一周又卖掉了。当时觉得北新泾那片还是不错的，也多有用大房鸭/贝壳看。</p><p>时间一点一滴过去，来到了12月，这时房价感觉都快压不住了。1月21号，政府出台政策封堵炒房漏洞，隔天就执行。</p><p>当时刚好看到两个不错的房子，一个400 售后公房满五不唯一，一个380 售后公房满五唯一。都是很不错的，但是觉得拿不下来，为此我还特地去问了公司的帮助。因为今年下来，在公司努力得到肯定，伟哥说首付上面的帮助还是很乐意的。跟哥们聊了聊觉得加油，说不定就能拿下来。</p><p>其中400周末用大房鸭试着看了，感觉超级超级满意，环境也是超级超级nice。当时当场就打电话给老妈，我顺便还说想卖了老婆的首饰，能顶一下就好，首饰也用不上，老妈听了咬咬牙说再拿出最后的5w，我有点不放心，别家里啥钱都没有了。但是其实我真的很需要，我想要拿下来。后来还是决定把老妈最后那些钱当作最后的税费来顶。</p><h2 id="咬牙实施计划"><a href="#咬牙实施计划" class="headerlink" title="咬牙实施计划"></a>咬牙实施计划</h2><p>400那个需要公司的帮助，我在接下来的几天也问了伟哥想借20，伟哥帮我问了老板，帮我问了两次。但是后面都没有结果。没有回音。</p><p>无奈。</p><p>在2021年1月10号左右打电话给大学同学聊天，才知他已经买房，而且就在当时我临时驻场地(漕溪路地铁站附近)。晚上10点好了出发去他那里坐坐。他去年10月生娃，然后大概也是10月左右买下了安东小区的房子。价格合适，看了2次就在绿家定下了。他一直都没有断社保，我中间断过，不然我也早就能买了。他的首付款我感觉还行，然后就谈了谈生活工作的事，最后聊了聊买房看法。</p><p>后来年会回来，也越来越接近过年，就先忙年末的忙事了。没事刷手机看到400那个又卖了。380那个我看了贝壳的VR，还不错，有些区域看不到，不好约看。</p><p>周末打电话给舅舅们借钱，最后也只有满舅表示能出一些力。大舅办厂，下半年回款；小舅新买房；满舅尽量帮了2.</p><p>我在大房鸭上约了好几套，嘉定的我就不去看了。觉得外环不合适，大华三路有个房源不卖了，400卖了。年底就是这样。380约了看，但是一直没机会，房客比较麻烦。网上一些房源360的感觉不错，但是始终无法看，房东不诚意卖或者根本就是虚假房源。</p><p>时间往后移，来到放假第一天(我们公司放假比其他公司前后多一天)，早上起来，思前想后觉得还是要早点定下来。我直接找了大房鸭顾问打电话，咨询相关所需资质/自己需要准备的资源等。然后我又打电话给家里，给老婆发微信，一遍一遍过自己的资质。思来想去还是差最后10，这关键的10。</p><h2 id="定房前"><a href="#定房前" class="headerlink" title="定房前"></a>定房前</h2><p>我拿起手机拨号给伟哥，跟他说了自己的困境。伟哥说了之前没有回音的原因，当时像拿下那个400的，所以当时想说20的话，不管是400还是380我都能稳操胜券。但是当时公司财务比较忙，20的话不好决定，如果是10肯定是没有问题，伟哥可以给我担保。如果是现在的话，会稍稍麻烦，不过伟哥可以稍后打电话。得到这个信息，我欣喜若狂，我马上回答，10就够，10就够。10我足够了。非常非常感谢公司这个大忙。后来和老板谈话也是说到，这次不上车，之后基本很难再有窗口让我上车了。</p><p>去年基金我涨了20%，去年房价也涨了20%！但是我的基数才80；房价相当于做了杠杆，投资也好，自住也好，同时还涨了10~20%。如果拿下，光是贷款就让我吃足了社会主义的福利了！</p><p>稍后马上打电话和dfy顾问联系，我同意房东不讲价，先看房，然后合适我们就定。下午得到答案是无法看房，因为房客年终觉得疫情-不方便。好吧好吧，下午等老婆下班，刚好过去附近转转。我和老婆在小区里面转了一圈，觉得还行，就先行回去了，等下次能看时再看。回去的路上，老婆看到周围的资源，也是非常满意。房子晚上住，要游玩啥的就下楼嘛。</p><h2 id="定房中"><a href="#定房中" class="headerlink" title="定房中"></a>定房中</h2><p>这时进入过年，说初三有消息，我以为初三能看。初一初二都不好睡觉，还梦见未来好多钱要还呀。初三的时候洗漱好，洗好头发，说确定初七看房。好吧，坐下来打游戏吧。</p><p>终于终于到了初七，晚上7点，dfy顾问和我都到门前，房东坐地铁也过来了，老婆也过来了。大家到小区凉亭坐着聊聊天。这里大概也能了解到双方的诚意，房东年前已经和其他客户签了定金了，但是1.21新政导致之前买家卖房给自己的下家无法接受不满五要交增值税的突然，于是房东也是同意退回定金。所以我们现在才有机会。</p><p>坐了一会，租客东北小妹妹打车回来了。那我们就上去看看。刚入房子，感觉敞亮，开放式厨房够用，还可以摆放一个小桌子。厕所小小的，够用，有马桶也有洗澡的。两个向南的房间，不大不小，其中一个还有一个阳台。看的时候我和老婆在阳台偷偷说话，觉得怎么样？怎么决定？</p><p>我觉得房东诚意卖，然后房子本身没有缺陷，同时没有贷款/抵押/租房清晰/税费/同住人/纠纷等情况。很理想的产权。我们里里外外看过后，跟房东一起下楼。在大门口，我们简单的聊了会，接下来我们怎么做决定。我作为家主，还是给出了我的意见: 我们一起前往附近的星巴克二楼交流，并签约。</p><h3 id="定房中-1"><a href="#定房中-1" class="headerlink" title="定房中"></a>定房中</h3><p>我们先表明自己的诚意，我今晚希望能定下来，定金部分约定下来是30. 房东是同意的。然后接下来是谈什么时间网签，双方对于时间有没有异议。当时我不懂网签前，钱要陆续打到房东那，而且房东也不同意把钱打到中间资金托管。我当时也是很害怕，怕dfy顾问是假的，然后查看身份证手机和中介平台相同。查看了房东信息，房东是放弃中国籍，为澳大利亚籍，疫情来来往往，所以还是决定把所属中国最后一套房产卖了。房东哥哥是律师，也在dfy有交易经历。所以房东把一堆委托文件都准备好了(之前本来有定房的，所以文件也都很齐全)。</p><p>沟通下来，从8点多交流，一直到11点多才结束。里面签署有定金合同，本来的打30，但是我银行卡有一部分打不出去，就先打了10.另外20约定给在后天正式合同给到。</p><p>约定是今天30，月底30，下月中30，网签43，完成首付款35%。包括约定付款方式/付款周期/网签时间/总房价/互相接受约定/违约情况/承认房子属性等等。期间房东哥哥打电话过来补充一些条款。其中有一条:承诺房子满五唯一，承诺售后公房，但如果之后新的政策对这些属性有新规(比如1.21即日执行的新政中特殊规定)，导致的优惠或者多税费的协议都由下家承担。这条我觉得非常不合理，不过我过于想拿下，并且想着说提前做好网签，这样是不是能规避，这条不利不就对我无效。当时定房我就同意了。晚上回到家，没饭吃，然后到家后我就烫个面，配着快熟面的汤简简单单的吃饱睡觉。晚上还和老婆说说话，就睡着了。</p><h3 id="签合同中"><a href="#签合同中" class="headerlink" title="签合同中"></a>签合同中</h3><p>2021.2.21下午6点签合同。位置在dfy位于上海火车站附近唯一签约点。我直接请了一个下午的假前往，中午顺便去趟徐汇解决个他们搞了好久没解决的问题。本来这个问题很难，可能要到下午三点，没想到我过去20分钟就搞定了。没办法，我也没事干，只能直接去现场附近转悠转悠了。直接徐汇一直往上，刚过完年交警都出来路口。到了之后直接上到dfy，那一层还有很多别的公司，我签约时间还没到，就在dfy外边附近一个凳子坐着等。下午4点左右老婆也到了，我拉着她下午吃个面，两人吃了40块，好贵，上海火车站，没办法。</p><p>6点了，我和老婆进去，分配在一个桌子。等了一会，女房东到了，然后一个蒙着口罩的男的进来打招呼，过好一会我问您是？揭开口罩才知道是之前的dfy顾问。然后我们这里配有两个对接人。过了一会房东哥哥来了。房东哥哥和我坐在主位对位，打扮精细，律师职位很干练的打扮能对场面有更多胜算的吧。开始是讨论一些点，然后江律师到了，给我们解读。中间有不合理不理解的地方都及时询问。房东哥哥不时往里面填写补充。我经验少，看着合理就赶紧看下一条。律师也不断的读出条目，给我们解答。过程中间不断填写各种单子，由于房东要回去澳大利亚，于是今天还有就是签订买家贷款合同，到时使用该该款方案即可。于是就是一顿签签签。</p><p>价格方面，老婆表示是否可以让一点，包括之前签定金时也问道。因为小客厅上方租客蒸馒头导致粉掉下来；阳台没有窗户保护；房东和房东哥哥都表示要到手378。也因为我们时要到2021年3月底才能办理网签，时间他们让步，价格我们也不好说什么了。</p><p>合同方面解答基本都没问题，其中有个争议，就是之前签定房合同里的那条对我不利的条款。说到那个条款时，我就点头点头，我老婆一直桌底下摇摇我的手，提醒我，我也还一直多看看合同，就只是点点头。我请的律师说这条对于买家很不合理，是否可以有个上限。卖家就说好处坏处也都是买家享有，如果只是多个5w就不行，那不如合同就不签了。我还是傻傻的点头。我老婆说话了，也说不行，至少有个上限。房东看在场的多人都是这个意思，那上限多少？我思考着，这最多最多能搞到的另外，封顶是10.其实我也是很虚的，其实首付我还是很担心的。但是想着，政策不可能对我们这合法正规的人不利，于是就是还是硬着头皮。房东说行。合同打了三遍，双方确认无误后，在三份合同，每份右下角填上自己的姓，最后一张填写人名。一式三份。</p><p>最后我们将剩下20定金打过去，房东填写另外一张定金收款给到我们。今天工作结束，和房东握了握手，表示艰难，不过双方都是诚意满满，所以都是在可控范围顺利进行。</p><p>晚上回去，和老婆随便吃吃就结束了，啊，好累啊，啊，开始要把所拥有的数字打给对方了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20210115公司年会</title>
      <link href="/2021/02/18/20210115%E5%85%AC%E5%8F%B8%E5%B9%B4%E4%BC%9A/"/>
      <url>/2021/02/18/20210115%E5%85%AC%E5%8F%B8%E5%B9%B4%E4%BC%9A/</url>
      
        <content type="html"><![CDATA[<h1 id="2020年会"><a href="#2020年会" class="headerlink" title="2020年会"></a>2020年会</h1><p>我19年初来的公司，19年底因为疫情原因，木有举办，也是可惜。</p><p>2020年末在动荡中，两年未见的各地公司同伴在年末齐聚本部。回来交流、活动、一齐出发年会。</p><p>2021年年初，全国各地技术、销售回到上海本部。周一的时候在4楼开了一个技术和研发的讨论会，去了几个主要的技术。我到公司晚，赶紧塞两个包子，加个豆浆就去零时装修的4楼培训教室。里面技术都坐满了，在前排找了个位置坐下来。几个大佬先和大家介绍我们几个研发，主要负责模块，认好人，等会可以找到人对应吐槽。</p><p>过程就是一些遇到的问题、疑难点、遇到的bug等；回答解决方案、当前正在处理和已经处理，有些不好修复等。感觉吐槽最多的还是，发布出去的器材质量不过关。技术、销售中午都是包饭的，我们就先去吃啦。<br>这么几天，都是培训，介绍公司一些产品、发票之类的。我们都参与不上，嘿嘿。</p><p>时间来到2021年1月10号。今天是周日，我早早就赶到公司附近九亭一个网鱼网咖。二楼我们的同学都聚集好了，等着LOL开打。首先大家先剪刀石头布决出优胜可以首轮选在豪华房间打，没想到我战胜了其他5个队伍，进房间撸。这运气。<br>进来之后，等了很久他们终于开局。我拿ad烬。屏幕超级大，我改了设置、鼠标速度等，还是无法很好的补兵，鼠标飘的不行。得，第一局被杀爆了，蛋疼。</p><p>第二局在外面打，这回我打辅助，感觉好多了，然后辅助石头人，全队第二伤害，拉第三好多伤害呢。看吧，也不是很菜，，嘎嘎。<br>第三局继续，不过这局对面好强，本来要赢了的，被我浪输了，我的坑坑火男辅助。<br>最后我们定位是第五名。唉，可惜可惜，，不过大家还好，都是玩玩，大家都是不熟悉，也不熟练。</p><p>中午我有组织篮球比赛，饭都不吃了，直接去kc篮球公园。10几分钟小电驴。然后到了之后才几个人一起。确定好是内场，我们就先随便扔扔篮球。大概人到了13、4个的时候，我开始组织4:4:4 三个队比赛。有个1.9的是校队的被分走了，其他的也基本平衡。他们比赛的先打着。我顺便当个裁判。因为时间关系，基本也没什么判罚，直接跟着继续，就按照裁判的。然后里面有个胖胖的大哥说，都打手三次了，嘎嘎，不好意思了，，刚好也没看见。都6年没打球了，早就忘了精准了。</p><p>感觉自己能摸把篮球，扔一扔，自己也能当做比赛了。然后一队毋庸置疑，文龙大佬超级壮身体，加上1.9米校队张哲，赢到了最后。我们这队输给他们，然后和另一组单独比了一场，赢了(队里几个同学扔球很准，扔到赢那种)。所以三个队伍比分也下来了。</p><p>肚子实在是饿，买了些水，也不敢喝多，大冬天的。过了一会，早上打LOL比赛转场过来的剩下同学也来比赛篮球了(他们打完LOL集体吃午饭去了)，没办法，怕没比赛刚刚已经比完了。所以就招呼这群同学打打篮球了，不能冷场不是。</p><p>下午的时候和大家打完就骑着我的小电驴回去了，下午回到出租屋，哇，好累啊。</p><p>那几周刚好，很多去徐汇，怕如果有LOL决赛赶不上，下午我都会回来。到1月13号左右的时候，中午开始要比赛了。他们王者荣耀都是在公司休闲区比赛的，直接霸占老板办公室，各个地方都有他们团伙。我们直接在4楼没装修的那个培训教室背对背比赛，还有个大屏直播(吐槽下，关键时间就端，下面看比赛的比我们还紧张)。首先是2、3名打，然后是1、4名打，我们组就是第4名。</p><p>我拿了个石头人辅助，你懂的，只要我混，不拖队友，俺队友就把第1名给打残了(第1名的本命英雄被ban了，玩脱了)。然后接着我们和后面赢的争第一，没办法，石头人被拿了，下路也运气不佳，一大堆兵，吃亏被打残了。然后这局我的机器人一点用没有: 对面莫甘娜+马尔扎哈。</p><p>么得，得了个第二，抱大腿来的。可惜可惜。奖品是空气净化器，哈哈。</p><p>1月15日，大早上大家还是要上个半天班。11点左右，我们就赶紧去食堂吃点东西，早上吃的晚，随便搞个混沌吧。11:30左右，大家集合，开始整理东西，上大巴出发前往江苏的黎里古镇。</p><p>一个小时左右的车程，到了后，签到，东西放到入住房间。然后回到楼下来集合拍照留念。</p><p>集合的时候没有个基点，龙哥呼喊1米8俱乐部过来集合。啊哈，有个基点，大家就知道怎么排列了。</p><p>整个一个团队150~160人，很热闹。</p><p>下午在二楼会议厅，首先是开场致词。各位大佬介绍各位，我和几个小哥们在后面就负责鼓掌，一个下午，手都拍红了。上面也是有我的照片，去年没来，今年是老员工的我，也算是半个萌新。然后是各个部门的成绩，继往开来。鉴定部门，技术部门，研发部门，财务部门，人事部门，各个致词，老板总结。新的一年，新的挑战。看到成长的一面，也要关注落后的痛点。</p><p>期间休息，吃吃水果，面包，直到下午5、6点，然后在楼下拍照留念，因为二楼会议室转场为晚宴。我是和几个研发的同学有个小品，赶紧到我们房间排练排练。</p><p>然后来了个全部一遍的小品彩排（就是在房间匆匆忙忙完成），然后就到6点入宴会了。下楼了，大家都就座了。我的座位靠前，和好几个大佬一桌。首先是几个主持人开场，介绍。</p><p>第二个节目是鉴定部门女神们的现代舞蹈，看了我流口水，赶紧下面吃吃饭，和大佬们喝白酒，拍照。才喝几口都有点醉了。为什么直接第二个节目？额，第一个节目是那什么新年好，四个同学上面吆喝，笑场，好吧，快乐就对了。接下来还有单人唱，唱到一半停了，额，然后重来，冲啊，又断了，好吧，下一位好汉，不对不对，，下一位仙子: qian总千金。</p><p>一袭红绣，青涩的脸庞还写着稚气未脱的羞涩，二八美好的年纪，在台上独舞，美，，，音乐的跳动，伴随轻盈的转身，动作不大，却灵巧的展现着男人眼中最纯的欣赏。我不敢拍照，睁大眼睛看着，怕破坏这少一格记忆就永远少一格回忆的瞬间。酒赶紧抿几口，猥琐的男人遇到这美好的【食物】，不禁真的会流口水吧。突然音乐氛围变动，成了现代舞蹈，仙子在场中去掉红绣，展现现代的舞蹈。</p><p>现代舞蹈，女子所跳都会有韩国的口感，青涩的脸庞会缺少妩媚的妖娆，但是也会令人有一定的遐想: 未来定然是个美好女子!</p><p>感觉我没有眨眼睛，不舍得。老子结过婚，老子也不舍得，那些伪君子的话在老子这站不住，要不抿几口酒，口水真就他么不争气留下来了！</p><p>突然在舞蹈的一半，歌曲停了，我特么，导播在哪！？宴后问了导播（大千同学），他说她的视频真就那么长。这，伤心呐，痛心呐。</p><p>接下来还有我参与演出的小品，效果还是不错的，大家也都是本事出演，毕竟我也是拉了我们的美女产品同学，我知道你们要我说道说道美女产品同学了。不可能，不会跟你们分享的！我曾经恨自己晚生百年，无法参与中国的风云际会，现在我又恨自己早生几年，要是这会遇到她们，我特么扑过去，我就是这么不要脸。但是，但是现在，现在家里也有可爱宝妈，爱不释手；这些也很好，唉，男人难做啊，难啊，啊！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！</p><p>接下来都是没那么给力的表演，我又怕忘了刚刚生动的身姿，喝酒。</p><p>过程期间还有抽奖活动，我知道，我运气爆棚在时运，而不是这些上，不抱幻想。果然没我份，虽然预料到，但是还是小小伤感。</p><p>也快结束了，找个机会和美女产品干一杯，说说话。才没说几句，得，组里的同学找到我说，顺顺同学酒喝多了，被扛上了房间，呕吐耍酒疯。我转身赶紧和人事说一声，俺也没遇到过，俺也一脸懵逼，先上去看看说。</p><p>上来看到情况就是耍酒疯，嘴里”love you”啊，”爱你”啊之类的，，后来知道是他朋友圈分享的歌曲。感觉还行，不过完全没有思考本能，还呕吐，身子转来转去。不行，还是叫120吧，我没有这个经验，不过我们都不能承担如果是真的的不良后果。后来120来了，把他抬下去，到一半还吐。120车来了，闻着那味，加上晚上喝了两杯白酒，我自己也晕的差不多了。</p><p>然后另外两个同学陪同过去(过去打了个醒酒针，就好了，然后挂个吊瓶到凌晨2、3点，另外两个同学也是精疲力尽了都)。</p><p>我回头去酒会，他们正在玩，拍拍照。和龙哥聊聊天，说”包我身上，来年只要是你做的，给你卖个2、3套去，妥妥的”，哇哈，赶紧给龙哥鞠个躬，保证做好来。</p><p>他们宴会就是第一场，接下来他们要去宵夜，第二场，我晕的不行，只能来年了来站了。帮忙拿点东西上楼，回到房间楼层，他们在玩狼人杀，我也进去搞起来。打到凌晨30分，我也受不了了，赶紧回去洗澡睡觉。</p><p>第二天起床早晨还有个黎里古镇寻宝活动，可惜去了，成绩太小，木有奖励。中午吃个豪华午餐，然后差不多各个团队就回去了。</p><p>这个年会很热闹，我2020努力，有一定的结果，比我以前的创业公司更有那么些期望，所以我想，我想更努力些，给真诚关心爱护我的人回报我的努力。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 年会 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210129docker-aarch64v8</title>
      <link href="/2021/01/29/20210129docker-aarch64v8/"/>
      <url>/2021/01/29/20210129docker-aarch64v8/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker服务运行在aarch64-服务器"><a href="#Docker服务运行在aarch64-服务器" class="headerlink" title="Docker服务运行在aarch64 服务器"></a>Docker服务运行在aarch64 服务器</h1><p>之前公司的服务都在x86架构服务器上，机缘下客户提供了一台华为云的aarch64 服务器。</p><p>一开始我以为也就最多2小时全部搞完毕，没想到2小时环境都搭不起来，docker 都运行不了。两天才搞好。</p><h2 id="安装yum-源"><a href="#安装yum-源" class="headerlink" title="安装yum 源"></a>安装yum 源</h2><p>首先试了下原本的源很慢很慢，<code>$ sudo yum update</code> 超级慢。</p><p>故使用 <code>$ sudo cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup &amp;&amp; sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code></p><p>发现<code>$ sudo yum makecache</code> 一直报404错误。</p><p><code>$ arch # 或者uname -a</code> 看到aarch64.</p><p>网上查是arm64 位版本。</p><p>根据<a href="https://blog.csdn.net/smart9527_zc/article/details/84976097" target="_blank" rel="noopener">文章</a>，使用以下ali云源内容替换 <code>/etc/yum.repos.d/CentOS-Base.repo</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># CentOS-Base.repo</span><br><span class="line">#</span><br><span class="line"># The mirror system uses the connecting IP address of the client and the</span><br><span class="line"># update status of each mirror to pick mirrors that are updated to and</span><br><span class="line"># geographically close to the client.  You should use this for CentOS updates</span><br><span class="line"># unless you are manually picking other mirrors.</span><br><span class="line">#</span><br><span class="line"># If the mirrorlist= does not work for you, as a fall back you can try the</span><br><span class="line"># remarked out baseurl= line instead.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">[base]</span><br><span class="line">name=CentOS-$releasever - Base</span><br><span class="line">baseurl=https://mirrors.aliyun.com/centos-altarch/$releasever/os/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"></span><br><span class="line">#released updates</span><br><span class="line">[updates]</span><br><span class="line">name=CentOS-$releasever - Updates</span><br><span class="line">baseurl=https://mirrors.aliyun.com/centos-altarch/$releasever/updates/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"></span><br><span class="line">#additional packages that may be useful</span><br><span class="line">[extras]</span><br><span class="line">name=CentOS-$releasever - Extras</span><br><span class="line">baseurl=https://mirrors.aliyun.com/centos-altarch/$releasever/extras/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">#additional packages that extend functionality of existing packages</span><br><span class="line">[centosplus]</span><br><span class="line">name=CentOS-$releasever - Plus</span><br><span class="line">baseurl=https://mirrors.aliyun.com/centos-altarch/$releasever/centosplus/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br></pre></td></tr></table></figure><p>其他没有替换，接下来执行:</p><p><code>sudo yum clean all &amp;&amp; sudo yum makecache sudo yum update</code> 速度很快。</p><h2 id="安装Docker-Docker-compose"><a href="#安装Docker-Docker-compose" class="headerlink" title="安装Docker Docker-compose"></a>安装Docker Docker-compose</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line">$ sudo yum-config-manager --add-repo https://download.docker.com/Linux/centos/docker-cce.repo</span><br><span class="line"></span><br><span class="line">$ sudo yum update</span><br><span class="line"></span><br><span class="line">$ sudo yum install docker-ce</span><br><span class="line"></span><br><span class="line">$ sudo usermod -aG docker <span class="variable">$&#123;USER_NAME&#125;</span> <span class="comment"># 加入docker到用户组</span></span><br><span class="line"></span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> docker <span class="comment"># 添加docker到开机启动</span></span><br><span class="line"></span><br><span class="line">$ sudo docker run hello-world <span class="comment"># 验证安装</span></span><br></pre></td></tr></table></figure><p>安装docker-compose:</p><p><code>$ sudo yum install -y docker-compose</code></p><h2 id="服务适配aarch64"><a href="#服务适配aarch64" class="headerlink" title="服务适配aarch64"></a>服务适配aarch64</h2><p>此时启动服务会报: <code>exec user process caused &quot;exec format error&quot;</code></p><p>说明该服务镜像不支持aarch64架构。</p><p>根据<a href="https://www.docker.com/blog/multi-arch-images/" target="_blank" rel="noopener">文章2</a>, 成功打了对应的包:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker 版本大于2.0以上</span></span><br><span class="line"><span class="comment">#勾选 Preference - Command Line - Enable experimental features</span></span><br><span class="line"></span><br><span class="line">$ docker buildx ls</span><br><span class="line">NAME/NODE    DRIVER/ENDPOINT             STATUS  PLATFORMS</span><br><span class="line">default      docker</span><br><span class="line">  default    default                     running linux/amd64, linux/arm64, linux/ppc64le, linux/s390x, linux/386, linux/arm/v7, linux/arm/v6</span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们当前使用的是一个默认builder，我们创建一个新的builder 替换老的builder</span></span><br><span class="line">$ docker buildx create --name mybuilder</span><br><span class="line">mybuilder</span><br><span class="line"><span class="comment"># 使用该builder</span></span><br><span class="line">$ docker buildx use mybuilder</span><br><span class="line"><span class="comment"># --bootstrap 不是必须的，他形容了立即开启编译容器</span></span><br><span class="line">$ docker buildx inspect --bootstrap</span><br></pre></td></tr></table></figure><p>此时根据之前的服务，再打一个arm64 的包:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建平台为arm64架构镜像并推送到package</span></span><br><span class="line">$ docker buildx build --platform linux/arm64 -t akerdi/onlyone:arm64-20210112 --push registry.akerdi.com/akerdi/onlyone .</span><br><span class="line"><span class="comment"># 查看镜像信息</span></span><br><span class="line">$ docker buildx imagetools inspect akerdi/onlyone:arm64-20210112</span><br><span class="line"><span class="comment"># 下载该镜像并运行</span></span><br><span class="line">$ docker run -p 7200:7200 --rm registry.akerdi.com/akerdi/onlyone:arm64-20210112</span><br><span class="line"><span class="comment"># 将该镜像保存</span></span><br><span class="line">$ docker save -o onlyone.tar registry.akerdi.com/akerdi/onlyone:arm64-20210112</span><br></pre></td></tr></table></figure><p>我们也可以运行并查看是否是对应平台包:</p><p><code>docker run --rm registry.akerdi.com/akerdi/onlyone:arm64-20210112 uname -m</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> docker, aarch64v8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210129hackintosh</title>
      <link href="/2021/01/29/20210129hackintosh/"/>
      <url>/2021/01/29/20210129hackintosh/</url>
      
        <content type="html"><![CDATA[<h1 id="升级Hackintosh"><a href="#升级Hackintosh" class="headerlink" title="升级Hackintosh"></a>升级Hackintosh</h1><p>跟着之前的教程 <a href="/2019/04/25/2019-3-25lesson">制作MacOS 启动盘</a>，可以完成系统的安装。但是系统成功后会有一堆的硬件驱动问题，特别是显卡驱动；其他驱动都是比较容易解决的，或者不解决也能用，比如声卡没有，不影响。</p><p>如果购买A卡，比如RX 580(2304 SP)超白金版才是免驱的。最近出现显卡卡荒，没得买。<br>A卡能支持到10.15，但是价格却是比较贵的。之前价格平和，最便宜的也要1300.</p><p>还有一种选择是NVIDIA N卡，但是其支持的MacOS 系统最高支持到10.13.6.</p><p>今天我们就来根据N卡来匹配硬件。</p><p>当前支持以下系列配置版本，使用GTX1050ti，系统版本10.13.6(17G65)</p><ol><li>技嘉Z370 + i7-8700 + GTX1050ti</li></ol><p>新出的Z490同样满足</p><p>配置清单:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1. CPU+主板</span><br><span class="line">英特尔（Intel）酷睿四核I7-8700 CPU 技嘉Z370套装 |1 3249</span><br><span class="line"> https://item.jd.com/17208129343.html</span><br><span class="line">2. 内存</span><br><span class="line">金士顿(Kingston)骇客神条 Fury系列 DDR4 2400 8G 台式机内存 |2 399</span><br><span class="line">http://item.jd.com/2121097.html</span><br><span class="line">4 电源 美商海盗船（USCorsair）额定550W VS550 电源 |1 299</span><br><span class="line"> https://item.jd.com/840370.html</span><br><span class="line">5 机箱 酷冷至尊(CoolerMaster)毁灭者经典U3升级版 |1 229</span><br><span class="line">http://item.jd.com/123814.html</span><br><span class="line">6 键鼠 雷柏（Rapoo）V500械键盘，V19鼠标 |1 99+58</span><br><span class="line">http://item.jd.com/3086129.html，https://item.jd.com/8963957.html</span><br><span class="line">7 三星500G SSD M.2 接口固态硬盘 |1 579</span><br><span class="line">https://item.jd.com/7234518.html</span><br><span class="line">8 SSD 闪迪(SanDisk) 至尊高速系列-3D版 250G SATA6Gb/s接口 |1 349</span><br><span class="line">http://item.jd.com/1185238.html</span><br><span class="line">9 显示器 戴尔（DELL） SE2416H 23.8英寸微边框 HDMI高清接口 广视角IPS |2 849</span><br><span class="line">http://item.jd.com/1769180.html</span><br><span class="line">10 显卡 影驰（Galaxy）GeForce GTX 1050 Ti 大将 4G 128Bit D5 台式机独立显卡 | 1 899</span><br><span class="line">https://item.jd.com/3472255.html</span><br></pre></td></tr></table></figure><p><a href="https://pan.baidu.com/s/1GNvsMwzTELwmJchOpv6slA" target="_blank" rel="noopener">EFI 提取码: 22ux</a></p><ol start="2"><li>配置二: ASUS B365-PLUS + i7-8700 + GTX1050ti</li></ol><p>配置清单:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. CPU+主板</span><br><span class="line">ASUS PRIME B365-PLUS (300 Series 芯片组 Family(B365)) + I7-8700</span><br><span class="line">2. 显卡 影驰（Galaxy）GeForce GTX 1050 Ti 大将 4G 128Bit D5 台式机独立显卡 | 1 899</span><br><span class="line">https://item.jd.com/3472255.html</span><br><span class="line">3. 。。。其他配件和上边可以类似，</span><br></pre></td></tr></table></figure><ol start="3"><li>华硕 PRIME Z270-A (Z270芯片组) + I7-7700k + GTX1050ti</li></ol><p>配置清单:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. CPU+主板</span><br><span class="line">ASUA PRIME Z270-A (Z270芯片组) + I7-7700k</span><br><span class="line">2. 显卡 影驰（Galaxy）GeForce GTX 1050 Ti 大将 4G 128Bit D5 台式机独立显卡 | 1 899</span><br><span class="line">https://item.jd.com/3472255.html</span><br><span class="line">3. 。。。其他配件和上边可以类似，</span><br></pre></td></tr></table></figure><blockquote><p>如果使用SATA硬盘，出现安装系统选择硬盘界面，没有识别SATA硬盘，需要再Bios - Adcanced - PCH Storage Configuration - SATA Mode Selection 中选择AHXI，否则无法识别SATA 硬盘</p></blockquote><p>当前EFI 支持集成显卡，但是只有HDMI口可用，也就是只有一个显示屏。多个显示屏，需要使用独立显卡+NVIDIA驱动。</p><p><a href="https://pan.baidu.com/s/1L5Kyjpq8fdYj6wAwU4vKLg" target="_blank" rel="noopener">EFI 提取码: iyq9</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> hackintosh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20210129分支管理办法</title>
      <link href="/2021/01/29/20210129%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E5%8A%9E%E6%B3%95/"/>
      <url>/2021/01/29/20210129%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E5%8A%9E%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="取综各产品研发分支开发"><a href="#取综各产品研发分支开发" class="headerlink" title="取综各产品研发分支开发"></a>取综各产品研发分支开发</h1><p>弘连各产品研发开发采用Git仓库管理。版本号取名规范等都是统一形式:</p><p>${主版本号}.${子版本号}.${修正版本号}.${编译版本号}<br><code>Major_Version_Number.Minor_Version_Number.Revision_Number.Build_Number</code> 示例： <code>1.2.1.xxx 4.6.7.xxx 3.5.4.xxx</code></p><p>现阶段分支管理没有好的秩序，各版本号发布随意，未有统一约定：</p><ul><li>完成某个新功能未设置tag，没有更清晰描述功能节点；</li><li>开发某个新功能时，直接在原分支改，尔后才切换；</li><li>当前分支修复某个功能的bug时，没有pick到原功能集(原功能有bug，只能升级，没有修复的更新版本)；</li><li>dev分支管理松散</li></ul><h2 id="版本号约定"><a href="#版本号约定" class="headerlink" title="版本号约定"></a>版本号约定</h2><blockquote><p><code>Major</code>: 具有相同名称但不同主版本号的程序集不可互换。例如，这适用于对产品的大量重写，这些重写使得无法实现向后兼容性。 \<br><code>Minor</code>: 如果两个程序集的名称和主版本号相同，而次版本号不同，这指示显著增强，但照顾到了向后兼容性。例如，这适用于产品的修正版或完全向后兼容的新版本。 \<br><code>Revision</code>: 名称、主版本号和次版本号都相同但修订号不同的程序集应是完全可互换的。这适用于修复以前发布的程序集中的安全漏洞。 \<br><code>Build</code>: 内部版本号的不同表示对相同源所作的重新编译。这适合于更改处理器、平台或编译器的情况。</p></blockquote><h2 id="版本号规则"><a href="#版本号规则" class="headerlink" title="版本号规则"></a>版本号规则</h2><blockquote><p><code>主版本号修改</code>: 当功能模块有较大的变动，比如增加多个模块或者整体架构发生变化。此版本号由项目决定是否修改。 \<br><code>子版本号修改</code>: 当功能有一定的增加或变化，比如增加了对权限控制、增加自定义视图等功能。此版本号由项目决定是否修改。 \<br><code>阶段版本号修改</code>: 一般是 Bug 修复或是一些小的需求小的变动，要经常发布修订版，时间间隔不限，修复一个严重的bug即可发布一个修订版。此版本号由项目经理决定是否修改。 \<br><code>Build</code>: 用于记录和区分每次的[编译/代码录入]递增。</p></blockquote><h2 id="正确步骤"><a href="#正确步骤" class="headerlink" title="正确步骤"></a>正确步骤</h2><ul><li><code>$git init</code> // 项目开始</li><li><code>$git checkout -b dev</code> // 项目切到开发分支</li><li>// dev分支，同组成员有pull，没有push权限；项目经理有pull/push 权限</li><li>// 项目开始，fork项目，或者书写组内共识、开发文档等；</li><li><code>$touch README.md &amp;&amp; git add . &amp;&amp; git commit -m &quot;doc 新增README&quot;</code> // commit 开头指明目的: fix feat chore doc style test refactor</li><li><code>$git checkout -b dev-1.0</code> // 项目开始1.0（此时组内讨论开发迭代会）</li><li><code>$git checkout -b dev-1.0.x</code> // 项目开始新功能开发，不断增加Revision/Build号: dev-1.0.x.xxx</li><li><code>$git merge/rebase dev-1.0.x dev-1.0</code> // 合并开发分支至功能版本节点</li><li><code>$git merge/rebase dev-1.0 dev</code> // 合并功能节点至开发节点</li><li>// 开发下一个迭代</li><li><code>$git checkout -b dev-1.1</code> // 项目开始1.1（此时组内讨论开发迭代会）</li><li><code>$git checkout -b dev-1.1.0</code> // 项目开发新功能，不断增加build号: dev-1.1.x.xxx</li><li><code>$echo &quot;new text&quot; &gt;&gt; new.txt</code> // 修改编辑</li><li><code>$git add . &amp;&amp; git commit -m &quot;feat 修改new&quot;</code> // 新功能分支改了dev-1.0 的bug, 这时需要同步该修复</li><li><code>$git checkout dev-1.0.x &amp;&amp; git cherry-pick ${修改commit}</code> // 使用cherry-pick 将修改commit 拿回到dev-1.0.x中，测试成功后，合并回dev-1.0中</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20201129为linux增加字体库</title>
      <link href="/2020/11/29/20201129%E4%B8%BAlinux%E5%A2%9E%E5%8A%A0%E5%AD%97%E4%BD%93%E5%BA%93/"/>
      <url>/2020/11/29/20201129%E4%B8%BAlinux%E5%A2%9E%E5%8A%A0%E5%AD%97%E4%BD%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="20201129"><a href="#20201129" class="headerlink" title="20201129"></a>20201129</h1><h3 id="为linux-增加字体库"><a href="#为linux-增加字体库" class="headerlink" title="为linux 增加字体库"></a>为linux 增加字体库</h3><p>原因是<code>gotenberg</code>生成勘验文档的PDF 库缺少字体库。</p><p><a href="https://github.com/thecodingmachine/gotenberg/issues/86" target="_blank" rel="noopener">原issue</a> 是要加open-sans, 但是我们要仿宋. 原issue做法:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://httpredir.debian.org/debian/ unstable stretch main contrib non-free</span><br><span class="line">apt-get update &amp;&amp; apt-get install -y fonts-open-sans</span><br></pre></td></tr></table></figure><p>或者<a href="https://www.gitmemory.com/issue/thecodingmachine/gotenberg/86/500960140" target="_blank" rel="noopener">做法二</a>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">apt-get install unzip</span><br><span class="line">wget https://fonts.google.com/download?family=Open%20Sans &gt; fonts.zip</span><br><span class="line">unzip ./fonts.zip</span><br><span class="line">mkdir /usr/share/fonts/opensans</span><br><span class="line">mv ./OpenSans-Light.ttf /usr/share/fonts/opensans/</span><br><span class="line">fc-cache -fv</span><br><span class="line">fc-list |grep opensans</span><br></pre></td></tr></table></figure><p>但是，俺们要<code>仿宋</code>.</p><p>做法，先去下个仿宋的字体包: simfang.ttf.</p><p>技术人，github.com/search?q=simfang.ttf : <code>https://github.com/21wmd/ttf-simfang/blob/master/usr/share/fonts/truetype/sim/simfang.ttf</code></p><p>下载好后:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 复制该字体到linux /usr/share/fonts/</span><br><span class="line">2. fc-cache /usr/share/fonts/</span><br><span class="line">3. fc-cache -fv</span><br><span class="line">4. fc-list |grep fang # /usr/share/fonts/simfang.ttf: FangSong,仿宋:style=Regular,Normal,obyčejné,Standard,Κανονικά,Normaali,Normál,Normale,Standaard,Normalny,Обычный,Normálne,Navadno,Arrunta</span><br></pre></td></tr></table></figure><p>成功!</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20201031团建</title>
      <link href="/2020/11/29/20201031%E5%9B%A2%E5%BB%BA/"/>
      <url>/2020/11/29/20201031%E5%9B%A2%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="20201031团建"><a href="#20201031团建" class="headerlink" title="20201031团建"></a>20201031团建</h1><p>这次是整个研发部门50多人一起的活动，但是有些人有事来不了，所以最终来了40多人左右。</p><p>前一天是周五，他们把我喊过去说我也来主持几个节目。在过完周会后，赶紧过去，和伟哥、春哥等过个场，明天不会急急忙忙。伟哥主持开场、拍照环节、附带一两个节目和颁奖，春哥也有数个，我也有数个。一一过一遍后，就先回住所。回住所时间还早，顺便把我的电瓶车电瓶换了，有个普通的，300多，还有个630的，于是我买的630的，经常跑，那买个贵点的吧。回头好好再看下我自己主导的那部分。</p><p>第二天一早，我就从虹梅路开着小电驴冲向佘山公园附近的钓鱼的场所-广富林郊野公园店。我6点多起床，当时4点多醒了一次以为时间过了；7点多出发，8点半不到就来到了现场。我到的时候，同伴都没到，倒是发现钓鱼的顾客到了。看看他们钓鱼，了解了下等会烧烤活动位置，由于订餐人数变动，所以和老板说了变动。等了很久，慢慢才有人到。</p><p>我在门口负责指导各位同学，基本人到齐了，就开始了活动。</p><p>首先大家集合下，伟哥大佬做个开场，然后拍个合照。接下来大家做个破冰活动，将人划分出来，分成了4个队。穿上队服：红队、黄队、绿队、蓝队。各自取了队名、队口号，然后推举出队长，选了各自的队形动作。</p><p>做完这次的分队活动，大家也了解更多，分好队，开始进行烧烤活动。4个队，但是我们有5个烤架。</p><p>烧烤也是一个技术活，刚好我们小组有个烧烤好的，我也想试试，于是我也上去操弄一番。刚好有人会，上前操弄，还有人教简直太好。拿自己想要的食物，抹一层油。上下翻，给烤架扇一扇，然后好了之后大家吃的还是你的作品，不错不错。</p><p>旁边俩小哥也在那操弄，烟雾弥漫。过去一看，居然在做暗黑食材。我滴个天，他们组没人烤，他俩优哉游哉烤的全是黑的。有的一面黑一面没熟。同时还很洋洋自得自己的杰作。组里同学吃的还很欢喜。好吧。不过这也是一个快乐吧。</p><p>我吃着吃着，突然感觉咬到一个石子？？诶？？烧烤哪来石子，去旁边偷偷看下。一看，我去特么是我的蛀牙，好大一半片断裂了。开心的我瞬间跌倒谷底。回去继续吃的时候，就开始小心翼翼了。笑容也失去了很多。</p><p>旁边空地也来了好大一团队，他们吃的可久了。我们的同学吃着吃着就不行了，跑去拍照的、打羽毛球的、下棋的、打手机游戏的、聊天的、还有一个人伤心的=&gt;我。</p><p>吃完也要转移阵地了，我们转进对面的公园。对面就是公园的一个入口，中间却隔着大马路。我知道绕的话要好久好久，于是我就直接穿行马路了。然后部队那么大，不可能都穿行，于是我们还是老老实实先绕（我跟着），绕完之后，又绕回来。我滴个天，走的累死了。走了好长好长终于到了目的地，一个很大的空地。</p><p>大家稍微休息了下，喘口气，接下来就要开始游戏活动了。</p><p>第一个活动由于前一个主持不在，先跳过到了我所主持的活动: 萝卜蹲。各队沿着我围成正方形，以淘汰赛方式，叫错、没有蹲则失败。然后活动是以积分制，每个活动10、8、6、4.各个队伍经过一轮轮的淘汰，最终只剩下很少的人，我所在的黄队，由于只剩下几人后，有人沟通，剩下比赛的4人跟着听他们沟通，没听到轮到他们蹲，于是全队惜败。</p><p>经过第一轮，大家蹲的都累了。稍稍歇息会，开始下一个。</p><p>接下来是纸杯递水。休息中，发现器材道具，接水的桶，纸杯，诶，存水物件呢？？我赶紧想了个办法，把大可乐瓶和另一小瓶喝水瓶赶紧去厕所装满。赶紧赶紧跑回来。也就是我们的盛水量就这么多了。我还担心不够，最后也差不多刚好够了。</p><p>我们这队经过深思熟虑，使用的战术是递水的时候，两人要头歪一些。商量好之后就要开始了。一开始我们进行还顺利，到后面也有点累，有时两人倒得有点漏掉了，有时要等后面的，因为后面部分比较慢。</p><p>这活动完结的时候，我们信息还是很好的，虽然中间有慢一些些，不过速度还是很满意的。然后答案出来了，我们排第二，好吧，说明人家第一的更快。过去一看，我去我们另外三队都是小半桶，他们满满的，放不下了。取经之后，原来他们是叼着纸杯下面，完全是倒水的方案，接水的人蹲着，直接就是倒的过程。乖乖。</p><p>下一个活动是拉住伙伴取空瓶子。每个同学都要取。可惜我们还是棋差一招。我们对人高，拿最远的可行，不过都有点重量。</p><p>再下一个活动是二人三足。中间一个人绑住。我也尽量和同学适应。我们队又棋差一招，因为其中一对在回来过程，线断了。要是我，直接两人就蹦回来了，他们绑的过程，被超太多了。这个过程我们发现我们队里两女同学，超级超级厉害。她俩直接等于是半跑状态，而且契合很高。厉害厉害。</p><p>最后最后也就是颁奖了。大家围成一个圈子，说说话。获奖感言，惜败感言。</p><p>晚上我们在附近小农庄, 我骑着小电驴到了之后，顺便找了停下并充电。上菜吃吃喝喝起来。上次在淮南喝白酒，我最多就是头晕晕的，也毕竟干了1杯半的白酒。误以为我能喝。</p><p>开场我就先白酒，毕竟啤酒涨肚。然后去别的桌喝的时候，白酒估计受不了，于是拿起个啤酒，先各个桌子喝一喝。2瓶下肚有点受不了了。接着跑到<code>真·劝酒大王·建新</code>桌，他那跑不了的一个个过。从伟哥开始，一半的时候，停下来休息，晕头转向。有一点点想吐，但是休息了会后感觉好多了。想着还有3、4个人，继续，接下来的两倍直接不行了。直接坐下来，不行了。头一直晕，但是能听见外部的声音。我喝晕过，小学2、3年级的时候在三伯父家喝晕过一次。不晓得为什么那天喝晕了，反正第二天头晕的不行，睡在沙发上，起来靠在花苑台阶上；第二次是高考酒会。那次心仪的菇凉在同桌，得班主任也在同桌，没办法，白酒喝起来，晕了。</p><p>我周围劝酒声、交流声、笑声、碰杯、椅子挪动、杯杯盏盏、喧哗、搞笑、附和，此起彼伏。也许我就趴一会睡一下就好点？头晕一会，喝了些热水，好很多，不过又一波难受。6点多开始的聚会，8点大家也还在，9点还有很多人；10点多，只剩一些人；我还很难受，不过一直想休息一波还OK 的话能骑电驴回去。去上个厕所，不行了，直接就吐了。吐了好多。</p><p>不过，确实，一直不愿意吐，吐了那瞬间不好受，不过接下来就好多了。整个人的酒精程度蛮高，最后回不去，只能附近找个小旅店了。伟哥、春哥(巨能喝)、mei阳同学 把俺架去旅馆。</p><p>他们走后，我已经半点力气都没得。半夜起床好多次，喝水、尿尿、直到天亮好多了。</p><p>7点多，想找点回去。下楼经过包子店，买了个包子垫垫肚子，顺便一个牛奶。旅店离昨天的饭店有3公里，走的第一公里有点受不了，晕晕的，走走停停。第二公里，有个上桥，马路逆向对面一个阿姨(40岁吧)，领着一些油盐物品跟我同一起跑线，她逆着走，同方向。我走几步就感觉晕，停一会会喘口气吧。她也走的累了，停一会会。我继续赶上她，她觉得被个弱不禁风的胖子超过于是不久也继续启动起来。</p><p>那个桥有点高，我走着走着就晕，不行，越走越慢，走快身体起反应，开始晕。慢慢被阿姨拉开3、40米。我赶上两步，不行，慢下来。等下坡，阿姨更是轻松，我还是不能快，晕着呢，全身乏力。终于，被拉开100多米。</p><p>得老子不跟你玩了，拐弯抄近道。以为阿姨也会走那条道，回头看，原来她继续前行，好吧，道不同，还为自己抄近道偷偷自喜。羞耻。</p><p>第二公里好不容易走完，有点太阳，浑身乏力、几乎是拖着疲惫的身子走的。走的时候防止头晃动，上身、包括手抖不能动作太大，只有脚在移动。</p><p>经过刚才高耸桥下面的通道，两辆好大的勾车，铁勾超大，得用绳子绑好几圈防止晃动。也就用眼球瞟了几眼，不能让脑袋斜着看，晕。</p><p>经过一排老房子，走出来个老大叔，估计看我这样走路，甚是好奇。昂起头，眼睛斜视着，嘴角右下翘着，似乎在端详着不速之客的目的。直到我走过去他的小菜园才放弃的各种猜想–这人没有威胁。</p><p>经过一个小水坝桥，看着下方水坝的小池塘，一只只鸭子嬉戏。除了被放血，被屠宰，也还是很自在的。边吃边拉，边走边拉，边游边拉。</p><p>那我也想成为一只鸭子？那不行，没意思。也许是羡慕他们短暂的自由，人们故意给予的自由吧。这就好比理财里面的行为: 你想要人的利息，可对方却是要的你的本金啊。</p><p>再往前，是一个什么什么徐汇还闵行什么什么活动中心，一个老太载着小孙女和门卫说着什么，看着双马尾的小女孩，挺可爱的。</p><p>继续走着，我记得昨天我经过的，继续100米，终于终于到达目的地。开启手机导航，回去。</p><p>这次，能把我喝吐，下次可要小心，得多学学乖，嘿嘿。</p><p>一路上经过好长的路，幸好昨天接同学的充电宝充了会，上了熟悉的路后才没电，手机可靠。30公里。</p><p>不过路上的风景不错。空气也还不错。经过外清平公路、泗泾、九亭、上漕宝路，才到漕河泾。</p><p>啊，回来后，直接上床躺着，虽然大白天睡不着，看了看昨晚的拉胯的LOL世界赛。</p><p>不怪苏宁，滔博没机会总决赛就是没进，苏宁输了就是输了，反正韩国有一次赢了罢了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 团建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20201012新同学来了</title>
      <link href="/2020/11/29/20201012%E6%96%B0%E5%90%8C%E5%AD%A6%E6%9D%A5%E4%BA%86/"/>
      <url>/2020/11/29/20201012%E6%96%B0%E5%90%8C%E5%AD%A6%E6%9D%A5%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<h1 id="20201012新同学来了"><a href="#20201012新同学来了" class="headerlink" title="20201012新同学来了"></a>20201012新同学来了</h1><p>新同学是10.12 来的，一早上就是负责安顿三个入职的新同学。本来有个同学去golang，当时我觉得我面试的时候，他快速的就打出来英文翻译、还有一个逻辑题目，说做golang，觉得很不错。然后到了后，公司说，golang已招合适的，让那个同学转nodejs。我就和新同学说转nodejs。另外两个同学各自安排，进度也都OK。然后熟悉下环境，配下电脑、软件等。</p><p>接下来安排事务后，发现说做golang 那个同学，啥都不会。那你那天对答如流怎么回事？？隔了很多天后我才回想起来。那天晚上，他们是把题目带回去的，那么肯定是问了周围的人，或者查询相关文档的。心里有点点懵逼。但是人已经来了，合同也签了，先看着怎么融入吧。有得，也有失啊。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20200924前往母校校招</title>
      <link href="/2020/11/29/20200924%E5%89%8D%E5%BE%80%E6%AF%8D%E6%A0%A1%E6%A0%A1%E6%8B%9B/"/>
      <url>/2020/11/29/20200924%E5%89%8D%E5%BE%80%E6%AF%8D%E6%A0%A1%E6%A0%A1%E6%8B%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="20200924-前往母校校招"><a href="#20200924-前往母校校招" class="headerlink" title="20200924 前往母校校招"></a>20200924 前往母校校招</h1><p>之前公司的招聘是另一个同学前往，这次我去。</p><p>为什么我去，因为最近老大回原来岗位，把我调整到见习小管理。刚好我这人活泼，而且又是自己母校，说明有更好的优质资源呢。</p><p>去之前我已经准备很多次，早早的准备总是有好处的，把几份PPT 看了又看，恨不得背下来，可惜也是时间不允许，有点忙。</p><p>这天早点出发，早早到车站等人事，她晚到了(小女孩比较散漫，正常)，只能等下一班车。那就看书，我发现人到了瓶颈，必须必须看书。</p><p>上海到淮南。到了之后，打车到预订的酒店。然后先到人事屋里和另一个同学一起商量等会进行过程，很饿，楼下附近没啥吃的，又回来屋里订外卖-太和板面。</p><p>商量是我作为主咖在上面介绍，同时也知道，订的酒店离学校很远，不是原来的位置，我主张早点过去，好准备。人事小女孩比较散漫的个性，我们又冲冲忙忙绕个远路少红灯赶到学校。</p><p>进去之后发现，学校换了新校区，贼大，走了好远好远，幸好没走错路，终于终于赶到现场。现场已经到场30、40位学弟学妹。隔壁是得力公司，比较大，整个教室都坐的满满的，门外都挤满了人。</p><p>到现场其实已经迟到十几二十分钟了，当时没有拿U盘，没能要拷的文件拿出来，只能微信发送。学校接待的小哥(也是大三，攻防，也有意投报我们公司)，在控制室微信传输PPT，怎么都没消息，网络太慢，终于等了很久把文件用邮箱传输成功。</p><p>嗯，终于到了现场讲演。</p><p>第一步是大概对着PPT 进行宣讲，补充。介绍行业现状，公司职责，公司产品，公司优势，各个产品定位。公司内部团队划分，团队交流等等。前期刚开始讲的时候稍稍有点紧张，一次一次的锻炼，成效就是更能适应宣讲环境，不然开始到最后就紧张的一直舌头打颤了。PPT 讲完，突然喇叭有别的声音串入，比较麻烦。索性不用那个话筒，脱稿、脱话筒对学弟学妹介绍团队内职责、安排，各自用的语言工具等，嗯，看着下面的青雉面孔，得好好给他们建议，毕竟是自己学弟学妹，毫无保留。这段时间不长，基本介绍完毕我的部分就结束了。</p><p>我讲完，合肥销售副总(女生)过来补充几句(确实，只能阅历她丰富，大场面也更能讲，比我顺多了)，同时声明开始进行笔试流程。</p><p>当时得到的消息是今天进行企业宣讲，明天才是面试招聘，突然说今天就可以开始招聘，那么就开始吧，发各种类型的笔试题，当场做起来。</p><p>期间大家做题的做题，讨论的讨论。</p><p>大概过了会，大家有的做完，有的迷惘。我当年不也正式如此，更加如此的是，我当年不屑于企业招聘。抛开杂念。</p><p>晚些时候，得到消息是隔天的早上8点到下午2点多左右，会做现场面试招聘。今天晚上那就继续做答疑，同时，作为学长，介绍介绍社会经历啥的。于是接下来就是给大家讲讲社会经历，其他企业和如今企业对比。当前企业的目标和志向。有些同学是想着离家近，有些同学有别的疑惑，一一进行简单的交流等。</p><p>结束时，大概是9点做，我们仨:一个糙老爷们，一个小女神，一个大女神，走出校园，打车回住的附近。</p><p>晚上还没过完，于是三人跑去吃烧烤。专门去吃烧烤我经历倒是少。pluz，可恶的是，我下午吃的板面，肚子一直就是痛着的。晚上吃着烧烤，碰杯啤酒。吃到一半，我的VVVVVV客户(以前同事)说他出事了，让我赶紧删掉相关资料。然后赶紧把我微信删了。</p><p>我才喝完一瓶啤酒，里面有点懵了，就都喝不进就晕了。我去，又担心前同事，又担心自己。吃着吃着到近12点，回酒店同时会晤另一个学长同事。他过来也是招聘事宜，只是这次有事晚来了些。给他整了些烧烤食物，就都回自己住所了。我顺便把今天的简历、做题等看了看，来回多看几遍，看到1点多。其实早就好困好困了，只是想做的更加多的准备，经验少，努力多来填补！</p><p>隔天早早就睡不早了，与其趴着不如起来吃饭好了。下楼刚好遇到学长，他说别出去吃了，你去二楼自助吧，我这里饭卡免费额外带有一个人的。免费，那就冲冲冲，，哈哈。</p><p>早上等人事，她起得晚，我吃完饭，等了一会她才下来。下楼来，她也不吃东西，也不喝水，直接出发了。好奇，小女神早上不喝水、不补点水分、不吃点东西，能漂亮嘛，嘎嘎。</p><p>早上前往，比昨天预订还是晚了些，8点左右变成8点40多左右了。女孩子要打扮的嘛，大男人肯定快，。然后下车之后，我和学长和小女神赶紧前往。路上拎着一个展架(很重)，作为小年轻的我，肯定要好好多吃苦，拎了大半路，但是昨天的板面吃完肚子还痛着，最后一小半路学长帮忙拎了会。</p><p>到了之后找到分配的小教室，门口已经有很多同学在等着了。迟到，比较羞耻。</p><p>很多学弟学妹已经在场。我的想法是赶紧先和他们谈起来，毕竟跟昨天说的早上过来时间，又又又晚了40分了。聊了会赶紧让学弟学妹进来面试流程。</p><p>社招面试流程很在行，问什么语言、语法。但是校招，他们大部分都是做数学题(我都快忘光了)；都是做java，也就是会写；js了解一丢丢；html了解一丢丢；C艹了解一丢丢。是吧，那好吧，我就尽力想想如何来吧。</p><p>我问问英语翻译题，得，倒了一片；我问问一些逻辑题，又倒了一片；难能可贵找到一两个逻辑还不错的。期间人比较多，就是4、5个一起来。学长同事也帮忙看，有个女生说做前端，面试了个逻辑题，对她来说还是有点难。有个女生想做C艹，幸好，我对于面向对象没有全忘光。但是感觉还是啥都不会，但是她就是想学。我不晓得校招是如何的，就密西密西看看态度。最后的最后，人事说等下，有个男生回去拿电脑，然后过来给我看代码。</p><p>这，不错不错，学生就能做服务，这已经是非常难能可贵了。然后来了个怯弱的小男生，小黑色牛仔，拎着个很重的笔记本。我看了看他的代码，虽然简陋，但是很不错！毕竟在学校，这学习态度太好了！！！</p><p>我当年都比不过他！我要了，我多多的看了他写的好几个服务，不错不错，至少逻辑清晰，加钱加钱。可造。</p><p>好，这次就到这。中午已经到2点了。好饿好饿，三人都好饿，去食堂吃了简单的餐食。吃板面后劲，又拉肚子一回。下午我们回去，学长有事，我和hr 一个个过简历。</p><p>先把早上最好那个同学先要来做node，心里想着他可以去实验室了，实习就能做正常的工作了，加钱加钱。再加一个node同学。然后之前有个同学说做golang，我当时记得面他的时候，逻辑很不错，英语翻译题也一下就过了，也招了。然后还有两个技术小哥，学长说，一看他们就很能喝酒，要了要了。后面打电话说golang 那个同学，公司golang 组说不要，他没有面试过。得，之前有说，招，之前面试结果觉得不错就招。golang 组说，得他过一遍，蛋疼的是，我们之前没有考虑到，直接给人打电话了要了。后来打电话跟另一个组问，那个大佬说，可以啊。我们就开开心心放松了。这里埋下了一个大坑，回头描述。</p><p>之后我和hr 去逛了下街。我好多好多年没有来了，以前经常和猥琐军来，去地下的一个鞋店转转，因为那边妹子多。逛到一半，学长说过来吧，酒桌已经订好，等我们了。我们过去后，等两个大佬。先来一个是学长同学，也是学长，现在做淮南市很大的驾校、二手车买卖之类的业务。再等一个是人事处主任。</p><p>酒杯盘盏，说一句，赶紧大杯白酒倒到小酒杯一饮而尽，诚恳诚恳又来一饮而尽，恭敬恭敬又来一饮而尽。好吧，hr 的白酒我也帮她干掉了。吃的也不多，牙痛。回去的时候，走路都打转了。还别说，喝完酒，觉得小女神更漂亮了，，，额，，，</p><p>赶紧回自己房间，唉，好好睡觉，，自己房间和家里娇滴滴的猴子聊聊天，解解闷。</p><p>第二天早上早起，自己往前找了到了还挺好吃的淮南牛肉汤。巨他妈实惠，11块，里面好多牛肉，上海16打上，牛肉就2片！</p><p>上午12点左右高铁回去，3点多能到上海，然后小女神又迷迷糊糊，很慢，然后，然后，又改签2点多才出发，下午5点半多才到上海。好惨。下车后，去坐Taxi，到家都6点多了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 校招 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200830浦东App问题排查</title>
      <link href="/2020/11/29/20200830%E6%B5%A6%E4%B8%9CApp%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"/>
      <url>/2020/11/29/20200830%E6%B5%A6%E4%B8%9CApp%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="记录下和老大调整服务器内存大小"><a href="#记录下和老大调整服务器内存大小" class="headerlink" title="记录下和老大调整服务器内存大小"></a>记录下和老大调整服务器内存大小</h2><p>周末没事来加个班写写东西。老大过来调整服务器内存，就帮忙托手。</p><p>首先是内存条 123 456 789 左右两边各9个内存条插槽。16G插满就有288G。</p><p>1、4、7 三个是白色，如果只有6根内存条，首先先插满左右两边各1、4、7白色插槽，规格最好差不多。如果是插到左右各123上服务器启动时会报warning。正常后，内存读写速度会到1066HZ左右。</p><p>如果继续往上插，123、456 左右各个插上之后，内存读写速度降到800HZ左右。以为遇到什么情况，网络文章有写到，插到两排或三排之后，内存读写频率就是会降低。以为同品牌不会，原来是本来就是这样的。</p><p>大概就这样，没事记录记录。</p><h2 id="浦东App问题排查"><a href="#浦东App问题排查" class="headerlink" title="浦东App问题排查"></a>浦东App问题排查</h2><p>公司浦东有业务: 政务微信-轻应用。我刚接手过来，也没得几个真机感受差距，代码也没有看，此时将之前一直暴露的问题让我来解决。客户大佬一次次给通牒（你们成不成，不成就换人，都一两年了，这么小的东西反反复复，根本解决不了）。</p><p>这个bug 是什么，时间回拨到一两年前：政务微信公司接手一个应用的开发，然后每每警察蜀黍使用的时候，开发轻应用，页面打不开，刷新，还是打不开，再刷新还是一样。过没一会，唉，又可以打开了，唉，刷新又不行了，唉退出去再进入又不行了。不同的机型、品牌 也有不同的功效。反正多多少少都有这种抓狂的遭遇。警察蜀黍打开的频率也不低，要用上的。</p><p>以上就是这个轻应用的体验了，2020年，毫无体验感，崩溃感。</p><p>相同的应用有另外的3家，这是重点！！！为什么人家就好好的？人家功能少？但你们咋就打都打不开！你们公司不是多么多么牛逼么？咋这都搞不好，还不如人家二手企业，人家丑，好用啊，你看。说着反复拨弄其他家的轻应用，然后恨铁不成钢气的把手机往桌子随手一放。然后又拿起手机，你看轻应用进去，还返回不了政务微信！我得把政务微信App 关闭，才能重新使用。你看看别家的会吗，你看看，你看看！！！说完，又是一气，就怕内伤了都。</p><p>我赶紧抓起客户手机操弄操弄，毕竟我之前做过移动客户端，好好感受下。在我反复操作，同时对比其他家应用时，立马感受到了轻应用的性质。</p><p>首先我们进入时，页面都进不去，顶部有进度条，就是读不完！然后左上角返回键点了根本无效。没有头绪。然后关闭政务微信App，再进来，资源读到一半，不读了，进度条也走完，这时是可以后退的。</p><p>那好，我们去其他轻应用试试。其他轻应用确实体量小，进去出来，每次都可以，，但是我就是要快，快次操作，体验下感到，当资源加载未及时完成时，左上角后退键就是无法使用的！！！</p><p>那很好，真相只有一个(帮我放一下柯南的背景音乐): 还是网络原因！！！</p><p>首先先把问题归类。归类完毕，那你们倒是赶紧解决这个网络问题啊，嗯嗯嗯，好好好，我都来了，肯定的，专攻。客户再三强调，要加紧啊，现在整个队伍大家内心都是崩溃的，那个气都能化为内功心法了。</p><p>回过头，我就好好感受下，网络慢原因。</p><p>首先我看到，互联网接入是可以很方便每次都能成功，偶尔的出现502 错误情况，应该确实是有网络波动。但是相对于政务微信的轻应用来说，这么高打不开页面频率肯定是有问题的。</p><p>由于政务微信难以测试，唯一能测的是右上角按钮打开浏览器。本手机浏览器打开也都能正常。于是优化了下webpack 打包出来的资源进行缩小。测试之下，没有什么不同。当前唯一我还没测到的点，就是他的入口: 我们提供服务的方式，是暴露端口出去，外部使用多个均衡链接进来的。这个点不晓得如何能更好的测试。此时一个新的消息到我们这: 另一个产商(下称LW.)需要占用我们的服务和入口，我们还有其他几个产商作为其子路径模块提供服务。</p><p>那就等吧，等他们整好，顺便让他们看看能不能解决这个无法打开的问题。毕竟他们是直接在我们的原位置上处理的。</p><p>过了一周，他们好了，我这也顺利改为子路径服务。但是还是提很卡很慢。而且！！！其他几个轻应用很顺畅！占用我们服务和入口的LW. 也很顺畅！LW. 内部其他几个子路径也很顺畅！</p><p>头一下大了，这，，，有点迷糊，不知道从哪个方面去思考，去入手。</p><p>赶紧去周末加班看看怎么回事。</p><p>看了接入的nginx log挺正常，无法得到有用信息。想了想会不会就是页面要压缩？感觉也不像。我们现在是PWA应用。资源是采用接口转发发送到客户端的。会不会就是这个原因？？试试？但是改起来好麻烦啊！</p><p>不管了，一点点来。再确认下可行性，看下LW. 他们产品怎么搭建的。根据nginx 配置，确认再确认了是这种配置。然后前往他们的页面文件目录，一看，他们也是vue 产品，但是他们就是分离根据nginx 来转发！！！</p><p>好的，确实有必要把页面抽离出来尝试一波。</p><p>根据抽离出来，放上去个错的，哎，果然，每次都能加载，每次都能！！！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20200829ACME.sh生成ssl证书</title>
      <link href="/2020/11/29/20200829ACME.sh%E7%94%9F%E6%88%90ssl%E8%AF%81%E4%B9%A6/"/>
      <url>/2020/11/29/20200829ACME.sh%E7%94%9F%E6%88%90ssl%E8%AF%81%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="再再次配置acme-sh-生成ssl证书"><a href="#再再次配置acme-sh-生成ssl证书" class="headerlink" title="再再次配置acme.sh 生成ssl证书"></a>再再次配置acme.sh 生成ssl证书</h1><p>服务器是Vultr 买的，开启的时候也是迷迷糊糊，此次有时一顿折腾。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name wpn.example.com;</span><br><span class="line">  root /home/wwwroot/sCalc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在CloudFlare 中关闭对应域名的橙云标志。</p><p>此时在/home/wwwroot/sCalc 下有一个html，浏览器打开能看到对应渲染。如果不能先解决能看到该html 的问题。</p><p>此次nginx 中报403 Forbidden, <a href="https://www.cnblogs.com/lxwphp/p/11124633.html" target="_blank" rel="noopener">查询到可能是开了SELinux</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 查看SELinux 状态:</span><br><span class="line">/usr/sbin/sestatus -v # 如果SELinux status参数为enabled即为开启状态</span><br><span class="line">getenforce # 也可以用这个命令检查</span><br><span class="line">2. 关闭SELinux</span><br><span class="line">2.1. 临时关闭</span><br><span class="line">setenforce 0</span><br><span class="line">2.2. 修改配置文件</span><br><span class="line">vim /etc/selinux/config</span><br><span class="line">将SELINUX=enforcing 改为SELINUX=disabled</span><br><span class="line">然后重启机器即可</span><br></pre></td></tr></table></figure><p>此时即可正常访问了: wpn.example.com 看到该html</p><pre><code>acme.sh --issue -d wpn.example.com -w /home/wwwroot/sCalc --nginx --test # --test Let&apos;s enrypt 请求超限制429acme.sh --install-cert -d wpn.example.com --key-file /etc/VVVVVV/VVVVVV.key --fullchain-file /etc/VVVVVV/VVVVVV.crt</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20200828定制的周会演讲</title>
      <link href="/2020/11/29/20200828%E5%AE%9A%E5%88%B6%E7%9A%84%E5%91%A8%E4%BC%9A%E6%BC%94%E8%AE%B2/"/>
      <url>/2020/11/29/20200828%E5%AE%9A%E5%88%B6%E7%9A%84%E5%91%A8%E4%BC%9A%E6%BC%94%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h1 id="20200828"><a href="#20200828" class="headerlink" title="20200828"></a>20200828</h1><h3 id="第一周开周会详情"><a href="#第一周开周会详情" class="headerlink" title="第一周开周会详情"></a>第一周开周会详情</h3><h4 id="指定方案"><a href="#指定方案" class="headerlink" title="指定方案"></a>指定方案</h4><p>同事私下准备充分此次演讲内容，开会时要讲的这周进展、突破(鼓励)，延迟、遇到的问题(原因，该怎么处置，不要气馁)。然后是量化后的计划、安排。</p><h4 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h4><ol><li>用户中心新增注销用户方案</li></ol><p>1.1 为什么这么做，为什么不那么做</p><ol start="2"><li>反诈项目的跟进，完成合并账号</li></ol><p>2.1 思考落实完成反诈功能，突破完成则会少一事</p><p>2.2 完成合并账号的操作方案</p><ol start="3"><li><p>取综的跟进</p></li><li><p>下周计划:</p></li></ol><p>4.1 取综各个软件稳定版本的落实</p><p>4.2 实验室录入案件 -&gt; 火眼分析。4~5个测试案件计划。</p><h4 id="安排下一位进行表率"><a href="#安排下一位进行表率" class="headerlink" title="安排下一位进行表率"></a>安排下一位进行表率</h4><p>小王这次实训在衢州、苏州实战的总结</p><h4 id="大家对此次讲解同学打分"><a href="#大家对此次讲解同学打分" class="headerlink" title="大家对此次讲解同学打分"></a>大家对此次讲解同学打分</h4><p>打分0~10分，讲得好，不吝啬掌声，有带发挥不要气馁再接再厉</p><h4 id="希望开周会，但不是流水线汇报，而是个人舞台秀"><a href="#希望开周会，但不是流水线汇报，而是个人舞台秀" class="headerlink" title="希望开周会，但不是流水线汇报，而是个人舞台秀"></a>希望开周会，但不是流水线汇报，而是个人舞台秀</h4><p>多多发挥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Iced 转Typescript 重构顺滑过度之await/defer</title>
      <link href="/2020/08/29/Iced%20%E8%BD%ACTypescript%20%E9%87%8D%E6%9E%84%E9%A1%BA%E6%BB%91%E8%BF%87%E5%BA%A6%E4%B9%8Bawait&amp;defer/"/>
      <url>/2020/08/29/Iced%20%E8%BD%ACTypescript%20%E9%87%8D%E6%9E%84%E9%A1%BA%E6%BB%91%E8%BF%87%E5%BA%A6%E4%B9%8Bawait&amp;defer/</url>
      
        <content type="html"><![CDATA[<h1 id="Iced-转Typescript-重构顺滑过度之await-defer"><a href="#Iced-转Typescript-重构顺滑过度之await-defer" class="headerlink" title="Iced 转Typescript 重构顺滑过度之await/defer"></a>Iced 转Typescript 重构顺滑过度之await/defer</h1><p>先抛出答案，使用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [err, result] = <span class="keyword">await</span> callAsync(defer2Promise(icedScript.icedCallbackFunc, [params]))</span><br></pre></td></tr></table></figure><p>实现：</p><figure class="highlight iced"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">_ = <span class="built_in">require</span> <span class="string">"lodash"</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment"># deferFunc iced要await的函数</span></span><br><span class="line"><span class="comment"># params any[] 必须是数组参数</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="built_in">module</span>.exports.defer2Promise = <span class="function"><span class="params">(deferFunc, params)</span>-&gt;</span></span><br><span class="line">  <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span>-&gt;</span></span><br><span class="line">    <span class="keyword">return</span> reject(<span class="keyword">new</span> Error(<span class="string">"参数必须是数组"</span>)) <span class="keyword">unless</span> _.isArray(params)</span><br><span class="line"><span class="function">    <span class="title">curryingFunc</span> = <span class="params">(err, result)</span>-&gt;</span></span><br><span class="line">      <span class="keyword">if</span> err</span><br><span class="line">        <span class="keyword">return</span> reject(err)</span><br><span class="line">      resolve(result)</span><br><span class="line">    params.push curryingFunc</span><br><span class="line">    deferFunc.apply(<span class="literal">null</span>, params)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure><p>由于iced 使用<code>await</code> <code>defer</code>在iced1.x 、iced2.x、iced3.x中有不同实现，iced1.x 是采用编译原理直接替换await 为<strong>iced_deferrals / _</strong>iced_passed_deferral等参数，无法同Typescript 的await 和平共处。</p><p>转换方法内不方便提供await defer：因为iced 不支持参数解构！那么我们直接在函数体外提供数组对象。同时，方法最后提供柯里化函数，使用callback 形式调用。</p><p>最后，我们提供js原生支持的 apply 函数，调用起回调方法。</p><p>总结: 以上解决了Iced 重构 Typescript 过程中，无法平滑过渡的隐患(可能导致牵连多个Iced 脚本，无法在Typescript中进行 await 调用的老大难题)</p>]]></content>
      
      
      
        <tags>
            
            <tag> iced2ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200821去客户(某公安局)现场开发</title>
      <link href="/2020/08/25/20200821%E5%8E%BB%E5%AE%A2%E6%88%B7(%E6%9F%90%E5%85%AC%E5%AE%89%E5%B1%80)%E7%8E%B0%E5%9C%BA%E5%BC%80%E5%8F%91/"/>
      <url>/2020/08/25/20200821%E5%8E%BB%E5%AE%A2%E6%88%B7(%E6%9F%90%E5%85%AC%E5%AE%89%E5%B1%80)%E7%8E%B0%E5%9C%BA%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h2 id="记录最近去客户-某公安局-那做现场开发20200821"><a href="#记录最近去客户-某公安局-那做现场开发20200821" class="headerlink" title="记录最近去客户(某公安局)那做现场开发20200821"></a>记录最近去客户(某公安局)那做现场开发20200821</h2><p>公司主力产品与客户内部系统脱钩，需要做一个中间层，我在公司做过一个类似的，于是我就肩负着该任务。</p><p>之前来过两次获取需要的数据材料，同事大佬顺路用小车带我去的，这周开始便是自己前往(自己小电驴)。</p><p>周一约好前往，下午两点半在大门等同事大佬(产品大哥)，他们稍微慢一些到，太阳有点辣，手都嗮疼了。门口领牌客户对接人签字带进去。</p><p>上去后，由于他们开会，我和同事大佬等到了近5点。他们开完会，我说我要求的机器等，然后和客户部门大大佬打好招呼，说要装两个单机软件、和U盘复制文件需求: 要小心哦，别把那个专网服务器搞坏了。我小心翼翼的答应着。</p><p>5点半开始摸到了电脑:4G windows 7, 不能乱装软件，不能乱连网，否则报警的话，史上最快被抓的就是我了 – 右边大哥把手搭我肩上，就把俺抓了。接下来就是来回来回的拷贝文件，接下来的几天都是如此，且听接下来故事。</p><p>将其中一个软件安装，另一个软件联系公司同事发送来，拷贝(拷贝超级慢)，稍微调整就已很晚，只能先回去。明早去公司多多做好准备，当前至少知道软件起不来，似乎数据库启动不起来。走时和对接民警说了相关需求，帮我将内存提升到16G，那就太好。</p><p>中午的时候遇到浦东哥们来这处理业务，晚饭一起去食堂吃。哇，超级实惠。一大荤一小荤一素一汤一饭9块，滴，内部证件。美滋滋。晚上搞到9点，回去回去，离住处好近，不错。</p><p>第二天到公司之后，赶紧拿公司几个相似的机子试验起来，包括软件许可这关，幸好早晨可以过来试验，省去了到那边之后各种交流不畅、无法相关测试问题。客户那边说，内存只能提高到8G。也行，应该OK。下午又自己屁颠屁颠开着自己的电驴过去了。</p><p>到了之后，把早上得到所得经验用上: 许可安装 - 成功；mongo本地启动 - 启动被链接成功。开心啊，马上就要到输入数据了，有点激动，第一次用这个软件，有点生疏，数据进去了，开心。咦，主题生成了，但是，数据包没有？没关系，公司同事说，没事，淡定，少了某个数据库，没事，整起。那，那就整起吧。哦吼，连接专网程序，成功！！！</p><p>咦，但是，为什么任务跑发现没有下载到包？我就是来整合包的，难道某个数据库同样很重要？同事之前说了没事的啊？？？</p><p>今天折腾一天了: 解决其中各种各样麻烦、测试数据等等。。。</p><p>晚上又是和浦东哥们吃饭，因为昨天同事没搞好，浦东哥们又被喊过来了。今天两大荤一小荤一汤一饭10块，滴，内部证件。晚上又遇到问题，解决不了，搞了搞会就回住处了。</p><p>第三天，其实是周三，早上又来公司，和周二一样，一早就有各种问题(其他项目的问题)。东搞搞西搞搞，同事说去下个符合windows7 的neo4j 数据库。我觉得现场设备配置清晰，去那边下吧，似乎网络很快哟。去了之后，没想到网络好慢好慢，求助同事。老大帮我下好了该数据库。我想了想，要不看看那个单机软件自带的数据库为啥就启动不起来，terminal 看了之后原来是有个文件路径不对，和csdn 一篇文章相同问题，修改就运行成功了。美滋滋。现在再次上传一个案子之后，果然和昨天不一样，心里开心啊。</p><p>全部数据都齐全之后，这回是真全了，我也就接触这个系统一两天。东西一跑，咦，下载包有问题，先绕过这个吧，回去看，这个好实现。直接到上传包，奇怪，我怎么都上传不上去。各种各样的方案，使出十八般武艺，把他的源码脚本都艹出来，就是失败，就返回status200，，即使对比该系统真实手动上传相同包的情况，其他基本相同就是上传不了。</p><p>当前就知道Content-length 与他不同；form-data boundary 的md5 也不同。</p><p>时间已经很晚了，今天浦东同事没来，人不熟，没借警官卡，没法滴滴滴了。先搞把，说不定就好了？-_-</p><p>晚上还是想不出来问题，和同事、老大想想对策。老大推荐wireshark 把进出数据对比出来。我把数据拿到。得，10点半了。饿，下午4点就开始开始饿了。</p><p>先回去吃，吃麻辣烫要的微辣，该死，吃起来好辣，，，吃完11点半，家里跪地上趴在床上玩了下手机就0点，赶紧洗洗屁屁睡觉。</p><p>第四天，早上又是忙别的事，顺便好好分析了下昨天搞到的数据样本。中午终于知道wireshark 怎么用，对比了下，其估计是为老项目，文件 type 为<code>application/zip</code> 格式，我传输的一直是<code>octet-stream</code>. 当前猜测是文件类型不支持，自己的传输方式试了好多次，都是OK的。</p><blockquote><p>简单的，才是最难的。简单的，做出来难，对于想操作，如果遇到了某种原因导致失败，那就更毫无头绪。</p></blockquote><p>之前在浏览器中没有任何报错，status 200. 所以我心底才会想<code>简单的，才是最难的</code>。</p><p>今天搞了搞，就已经很晚了，不能过去了。明天来吧，希望明天会有好运!</p><p>周五早上和老大交流，不同点有两个，一个是<code>application/zip</code> 的文件type，一个是上传文件field 在ajax加载时被转换为另一个。中午过去先试了修改文件type，没用，心里着急啊，只剩最后一个方案，最后一个也失败真完蛋。但是想了想，其又未对系统做什么超级难设置，肯定能成功这次。果然，field 改为抓包看到的终于成功。哇，内心超级激动，哇卡卡卡卡。</p><p>这几天来来回回小房间拷贝文件，然后到工作测试那台机器复制后运行。工具代码执行编译、复制拷贝；一些工具包拷贝；案件内容拷贝；拷贝拷贝拷贝, 小心的拷贝。拷贝文件是最慢的，3kb/s</p><h2 id="记录修改操作"><a href="#记录修改操作" class="headerlink" title="记录修改操作"></a>记录修改操作</h2><ol><li>mongodb 需要使用另一个包，3.4那个包</li></ol><p>执行语句: D:\1xx\mongodb\bin $mongod –dbpath “D:\1xx\mongodb\data”</p><p>此时mongodb 直接就建立起来，并可以连接了。</p><ol start="2"><li>neo4j 中出现 <code>Import-Module: 未能加载指定的模块&quot;\Neo4j-Management.psd1&quot;</code></li></ol><p>更改neo4j.ps1 文件里<code>Import-Module &quot;$PSScriptRoot\Neo4j-Management.psd1&quot;</code> 为绝对路径</p><p>该文件就是neo4j 中的 Neo4j-Management.psd1 文件</p><p>执行语句: C:\Users\xxx\AppData\Local\Honglian\WebTrace\database\Neo4j\bin\neo4j.bat console</p><h2 id="遇到FormData-上传文件-multer-没有响应"><a href="#遇到FormData-上传文件-multer-没有响应" class="headerlink" title="遇到FormData 上传文件, multer 没有响应"></a>遇到FormData 上传文件, multer 没有响应</h2><p>后端用multer 中间件，frontend上传文件:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> formData = <span class="keyword">new</span> FormData()</span><br><span class="line">formData.append(<span class="string">"file"</span>, <span class="keyword">new</span> Blob([html], &#123; <span class="attr">type</span>: <span class="string">"text/html"</span> &#125;))</span><br><span class="line">formData.append(<span class="string">"otherField"</span>, <span class="built_in">JSON</span>.stringify(largeJSON_object)) <span class="comment">// vary large json object</span></span><br><span class="line">axios.post(url, formData)</span><br></pre></td></tr></table></figure><p>这时出现时不时能上传成功或失败，没有任何规律。想了一晚没想出来。</p><p>隔天早上在<a href="https://github.com/expressjs/multer/issues/53#issuecomment-224174412" target="_blank" rel="noopener">multer issues</a> 里面看到原因: 需要把上传的文件放到最后才解决了问题。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20200713SSH的key使用</title>
      <link href="/2020/08/25/20200713SSH%E7%9A%84key%E4%BD%BF%E7%94%A8/"/>
      <url>/2020/08/25/20200713SSH%E7%9A%84key%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="未来人类体型预测"><a href="#未来人类体型预测" class="headerlink" title="未来人类体型预测"></a>未来人类体型预测</h2><p>看了很多科幻片说未来是聪明人占主导比例。</p><p>当前社会一直在演进，那当然是必然现象。每次的战争、争夺，都是新社会体制对旧社会的冲击。之前看有个视频，大清体制是集农业文明大成，也是非常庞大的体制。</p><p>新社会体系联合起来慢慢才蚕食殆尽，所以体制的进步是必然。在现代，人才才是资源，而且在新社会体系贡献会越来越大。</p><p>看到说未来的人聪明，脑袋大，我说不对。</p><p>个体体能好，就要锻炼，身体就会健壮；个体脑力好，就要专研，于是有两种分项：1）肚子大大的，发量少少的，因为要思考，坐着，大脑用脑多，让肚子多保留更多的脂肪，保护大脑；另一种就是肚子没有或者有一点点，然后发量差不多；</p><p>嘎嘎。哪有可能脑袋超级大，特别大，躯干很小那种。大脑聪明又不是越大越好。</p><h2 id="记录下SSH-使用ssh-key-使用秘钥登录"><a href="#记录下SSH-使用ssh-key-使用秘钥登录" class="headerlink" title="记录下SSH 使用ssh-key 使用秘钥登录"></a>记录下SSH 使用ssh-key 使用秘钥登录</h2><p>创建秘钥对</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line"></span><br><span class="line">cd .ssh</span><br><span class="line">cat id_rsa.pub &gt;&gt; authorized_keys</span><br><span class="line">chmod 600 authorized_keys</span><br><span class="line">chmod 700 ~/.ssh</span><br></pre></td></tr></table></figure><p>修改sshd_config:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line"></span><br><span class="line">PermitRootLogin yes</span><br></pre></td></tr></table></figure><p>重启ssh: <code>systemctl restart sshd</code></p><p>拷贝好服务器端的id_rsa 文件内容到本地机器: <code>cat ~/.ssh/id_rsa</code></p><p>将id_rsa 文本放到本地文件，如 ~/.ssh/66id_rsa</p><p>此时本地直接使用该秘钥文件会报权限过大，不允许使用, 控制台: <code>chmod 0600 66id_rsa</code></p><p>登录时语句: <code>ssh root@ip -p port -i ~/.ssh/66id_rsa</code> 即可正确登录</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>iced2ts 断点调试</title>
      <link href="/2020/07/28/iced2ts%20%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95/"/>
      <url>/2020/07/28/iced2ts%20%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h1 id="iced2ts-断点调试"><a href="#iced2ts-断点调试" class="headerlink" title="iced2ts 断点调试"></a>iced2ts 断点调试</h1><p>上一讲说到iced2ts 平滑升级，但是如果是从静态类型过来，方便的IDE 对断点调试可是优化得很，vscode没有他，我不能活。</p><p>开始活，整活:</p><p>在项目根目录创建</p><p>.vscode文件夹, 并且添加文件：launch.example.json</p><p>内容为:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"Launch"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [</span><br><span class="line">        <span class="string">"$&#123;workspaceRoot&#125;/app.js"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"runtimeExecutable"</span>: <span class="string">"npm"</span>,</span><br><span class="line">      <span class="attr">"runtimeArgs"</span>: [</span><br><span class="line">          <span class="string">"run"</span>,</span><br><span class="line">          <span class="string">"dev"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"sourceMaps"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">"cwd"</span>: <span class="string">"$&#123;workspaceRoot&#125;"</span>,</span><br><span class="line">      <span class="attr">"console"</span>: <span class="string">"integratedTerminal"</span>,</span><br><span class="line">      <span class="attr">"internalConsoleOptions"</span>: <span class="string">"neverOpen"</span>,</span><br><span class="line">      <span class="attr">"env"</span>: &#123;</span><br><span class="line">        <span class="attr">"NODE_ENV"</span>: <span class="string">"dev"</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"inspector"</span></span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重点是<code>runtimeArgs</code> 和 <code>cwd</code>路径。如果项目结构深，需要调整cwd深度。runtimeArgs可以调整运行项目的script。</p><p>给出我使用的dev(如果是windows，则是 <code>node dev:win</code>): <code>nodemon --watch &#39;**/*.ts&#39; --ignore &#39;**/*.test.*&#39; --exec &#39;TS_NODE_FILES=true TS_NODE_TRANSPILE_ONLY=true ts-node --files -r tsconfig-paths/register&#39; app.ts</code></p><p>此时bash <code>$ cp .vscode/launch.example.json .vscode/launch.json</code></p><p>在.gitignore 中添加忽略信息:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.vscode/launch.json</span><br><span class="line">!.vscode/</span><br></pre></td></tr></table></figure><p>怎么用?</p><p>使用手上任意一根手指按向F5 的按钮即可！</p>]]></content>
      
      
      
        <tags>
            
            <tag> iced2ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iced项目转typescript</title>
      <link href="/2020/07/27/iced%E9%A1%B9%E7%9B%AE%E8%BD%ACtypescript/"/>
      <url>/2020/07/27/iced%E9%A1%B9%E7%9B%AE%E8%BD%ACtypescript/</url>
      
        <content type="html"><![CDATA[<h1 id="iced项目转typescript"><a href="#iced项目转typescript" class="headerlink" title="iced项目转typescript"></a>iced项目转typescript</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>Iced 语言在早期相对于js 无疑是进步巨大，告别语法臃肿、callback hell、直观等，早早就用上了await defer 等便捷语法。</p><p>但是他的弱点就是，他就是传统脚本，小项目几个文件，不管你依不依赖，我记得住其他文件的需求，那么他很合适。但是到了中级项目、大型项目，上下文不通、脚本间不达意，维护起来非得常年累月的伙伴加班熬夜，只能边写脚本，边吃着小饼干才能维持得了生活这样子。</p><p>Typescript 优点很多，编译强类型语言等等一系列光环之下也有一个弱点，就是项目特大之后，编译性能下降(社区里有讨论)。但是特大那种，是不是也应该想办法拆分业务的方案解决了。所以当前来看，直接整Typescript，发展了这么久的开源语言，没有后顾之忧。</p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>当前Iced 的项目，还是正常的运行，直接加上tsconfig.json 文件，将项目直接变成Typescript 项目。</p><p>开发能正常运行后，开始下一步的打包开发文件。</p><p>打包成本地开发文件后，本地测试能运行，上线测试是否正常。</p><p>最终项目结构:</p><p>图略</p><h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>增加TYPESCRIPT 配置文件<br>直接在项目根目录中创建tsconfig.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"include"</span>: [ <span class="string">"**/*"</span> ],</span><br><span class="line">  <span class="attr">"exclude"</span>: [ <span class="string">"**/*/config.ts"</span>, <span class="string">"**/*/config.js"</span> ],</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"baseUrl"</span>: <span class="string">"."</span>,</span><br><span class="line">    <span class="attr">"allowJs"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"ES6"</span>,</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"CommonJS"</span>,</span><br><span class="line">    <span class="attr">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">    <span class="attr">"types"</span>: [ <span class="string">"node"</span> ],</span><br><span class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"pretty"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitAny"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"removeComments"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"outDir"</span>: <span class="string">"./dist"</span>,</span><br><span class="line">    <span class="attr">"paths"</span>: &#123;</span><br><span class="line">      <span class="attr">"*"</span>: [</span><br><span class="line">        <span class="string">"node_modules/*"</span>,</span><br><span class="line">        <span class="string">"types/*"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"@/*"</span>: [<span class="string">"*"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>include 表示当前所有文件都包含(可根据您的目录进行修改，比如src/*<em>/</em>)</p><blockquote><p>此时开发直接便可运行Iced 的项目。当前【个人中心】改造一个脚本，很顺利全部改动过来。</p></blockquote><h2 id="修改原有ICED-脚本为TYPESCRIPT"><a href="#修改原有ICED-脚本为TYPESCRIPT" class="headerlink" title="修改原有ICED 脚本为TYPESCRIPT"></a>修改原有ICED 脚本为TYPESCRIPT</h2><p>此时外部引用时，需要引用其default 对象，写法为: App = require(“../service/app).default</p><h2 id="增加所需第三方库"><a href="#增加所需第三方库" class="headerlink" title="增加所需第三方库"></a>增加所需第三方库</h2><p>上面开发已经能正常了，但是混合之后，打包就需要对应修改了。</p><p>package.json 增加所需第三方库</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  scripts: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"nodemon --watch '**/*.ts' --ignore '**/*.test.ts' --exec 'ts-node --files -r tsconfig-paths/register' app.js"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"node app.js"</span></span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"gulp"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"module-alias"</span>: <span class="string">"^2.2.2"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"@types/express"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"@types/lodash"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"gulp"</span>: <span class="string">"~3.9.1"</span>,</span><br><span class="line">    <span class="string">"gulp-if"</span>: <span class="string">"~2.0.0"</span>,</span><br><span class="line">    <span class="string">"gulp-iced"</span>: <span class="string">"0.0.3"</span>,</span><br><span class="line">    <span class="string">"gulp-load-plugins"</span>: <span class="string">"~1.2.0"</span>,</span><br><span class="line">    <span class="string">"gulp-terser"</span>: <span class="string">"~1.2.0"</span>, <span class="comment">// 功能通uglify</span></span><br><span class="line">    <span class="string">"gulp-typescript"</span>: <span class="string">"^6.0.0-alpha.1"</span>,</span><br><span class="line">    <span class="string">"nodemon"</span>: <span class="string">"^2.0.4"</span>,</span><br><span class="line">    <span class="string">"ts-node"</span>: <span class="string">"^8.10.2"</span>,</span><br><span class="line">    <span class="string">"tsconfig-paths"</span>: <span class="string">"^3.9.0"</span>,</span><br><span class="line">    <span class="string">"typescript"</span>: <span class="string">"^3.9.7"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修改GULPFILE"><a href="#修改GULPFILE" class="headerlink" title="修改GULPFILE"></a>修改GULPFILE</h2><p>第一步还是要 gulp iced 得到js文件。这时我们所需的Typescript 的项目文件就都在了。</p><p>gulpfile.js 增加以下任务</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">"tsc"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> project = $.typescript.createProject(<span class="string">"tsconfig.json"</span>)</span><br><span class="line">  <span class="keyword">return</span> gulp.src([</span><br><span class="line">    <span class="string">'!node_modules/**/*'</span>,</span><br><span class="line">    <span class="string">'!node_modules/**/*.ts'</span>,</span><br><span class="line">    <span class="string">'**/*.js'</span>,</span><br><span class="line">    <span class="string">'**/*.ts'</span>,</span><br><span class="line">    <span class="string">'!gulpfile.js'</span>,</span><br><span class="line">    <span class="string">'!**/config.js'</span>,</span><br><span class="line">    <span class="string">'!**/config.ts'</span>,</span><br><span class="line">    <span class="string">'!apidoc/**/*'</span>,</span><br><span class="line">    <span class="string">'!test/**/*'</span>,</span><br><span class="line">    <span class="string">'!dongle/**/*'</span>,</span><br><span class="line">    <span class="string">'!license/**/*'</span>,</span><br><span class="line">    <span class="string">'!public/**/*'</span>,</span><br><span class="line">    <span class="string">'!packages/**/*'</span></span><br><span class="line">  ])</span><br><span class="line">  .pipe(project())</span><br><span class="line">  .pipe($.<span class="keyword">if</span>(<span class="string">'*.js'</span>, $.terser().on(<span class="string">'error'</span>, <span class="built_in">console</span>.error)))</span><br><span class="line">  .pipe(gulp.dest(<span class="string">"dist"</span>))</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">"copy-favicon"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src([<span class="string">"favicon.png"</span>])</span><br><span class="line">    .pipe(gulp.dest(<span class="string">"dist"</span>))</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">"copy-package"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src([<span class="string">"package*.json"</span>])</span><br><span class="line">    .pipe(gulp.dest(<span class="string">"dist"</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>此时dist 就是我们要的全部项目文件了。</p><p>接下来的Docker 打包、上线流程还是和以前一样。</p><h2 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h2><p>以上就是这次将Iced 的项目，转化为Typescript 项目。而且是平稳过渡，不影响之前功能。</p>]]></content>
      
      
      
        <tags>
            
            <tag> iced2ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200615记录本次安装VVVVVV 遇到的问题</title>
      <link href="/2020/06/15/20200615%E8%AE%B0%E5%BD%95%E6%9C%AC%E6%AC%A1%E5%AE%89%E8%A3%85VVVVVV%20%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2020/06/15/20200615%E8%AE%B0%E5%BD%95%E6%9C%AC%E6%AC%A1%E5%AE%89%E8%A3%85VVVVVV%20%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="gitlab-ci-frontend-打包-出错"><a href="#gitlab-ci-frontend-打包-出错" class="headerlink" title="gitlab-ci frontend 打包 出错"></a>gitlab-ci frontend 打包 出错</h1><p>原因是frontend 安装: <code>npm install --production</code> 仅安装了dependence 库，需要去掉 –production</p><p>本地打包没问题，gitlab-ci 出现该情况，基本能断定就是安装库缺少打包库的问题</p><h1 id="记录本次安装VVVVVV-遇到的问题"><a href="#记录本次安装VVVVVV-遇到的问题" class="headerlink" title="记录本次安装VVVVVV 遇到的问题"></a>记录本次安装VVVVVV 遇到的问题</h1><h2 id="使用-Nginx-acme-sh-制作证书"><a href="#使用-Nginx-acme-sh-制作证书" class="headerlink" title="使用 Nginx + acme.sh 制作证书"></a>使用 Nginx + acme.sh 制作证书</h2><p>首先cloudflare 取消橘色云朵，采用直连方式(这样letsencrypt 才能请求过来)</p><p>Nginx 采用原生模块(不要使用docker 的nginx，有各种坑点，下面会描述此次遇到的坑)</p><p><a href="https://qizhanming.com/blog/2018/08/06/how-to-install-nginx-on-centos-7" target="_blank" rel="noopener">Nginx 遇到坑，安装参考了:</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 设置系统时间为上海时间</span><br><span class="line">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">hwclock</span><br><span class="line"># 添加源</span><br><span class="line">sudo rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br><span class="line"># 展开源</span><br><span class="line">sudo yum repolist</span><br><span class="line">sudo yum install nginx</span><br><span class="line">sudo systemctl enable nginx</span><br><span class="line">sudo systemctl start nginx</span><br><span class="line"># 打开防火墙端口</span><br><span class="line"># 默认 CentOS7 使用的防火墙 firewalld 是关闭 http 服务的（打开 80 端口）</span><br><span class="line">sudo firewall-cmd --zone=public --permanent --add-service=http</span><br><span class="line">sudo firewall-cmd --reload</span><br><span class="line"># 查看防火墙打开的所有服务</span><br><span class="line">sudo firewall-cmd --list-service # ssh dhcpv6-client http</span><br><span class="line"># 需要指出的是 CentOS 7 的 SELinux，使用反向代理需要打开网络访问权限</span><br><span class="line">sudo setsebool -P httpd_can_network_connect on</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conf.d/VVVVVV.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name wpn.example.com;</span><br><span class="line">  root /home/wwwroot/sCalc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ssl.sh</span><br><span class="line">alias acme.sh=/.acme.sh/acme.sh</span><br><span class="line"># 链接letsencrypted 识别域名和生成证书</span><br><span class="line">acme.sh --issue -d wpn.example.com -w /home/wwwroot/sCalc --nginx</span><br><span class="line"># 生成nginx 使用的key 和crt</span><br><span class="line">acme.sh --install-cert -d wpn.example.com --key-file /VVVVVV.key --fullchain-file /VVVVVV.crt</span><br><span class="line"># 拷贝目标文件</span><br><span class="line">cp /VVVVVV* /etc/VVVVVV/</span><br></pre></td></tr></table></figure><p>此时 <code>systemctl restart VVVVVV</code>, 在点击cloudflare 橙云代理CDN 即可正确链接了。</p><h2 id="复盘遇到的问题"><a href="#复盘遇到的问题" class="headerlink" title="复盘遇到的问题"></a>复盘遇到的问题</h2><p>上周搞的时候用的docker-nginx，当时用的ipv6，然后一直报404 letsencrypt 链接不进来，于是上周将服务器重新建立了。</p><p>这周还是遇到这个问题，于是想了好久，哦，原来nginx 的容器，我只映射了本地的conf.d 目录，没有把 /home/wwwroot/sCalc 目录映射进去(-v /home/wwwroot/sCalc:/home/wwwroot/sCalc, 替换进去后，又发现没有把 /etc/VVVVVV/<em>.crt </em>.key 映射进去)，难怪一直404.</p><p>docker-nginx一直没有使用这个版本，一时没想过来。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>20200529golang&amp;nginx</title>
      <link href="/2020/05/29/20200529go_nginx/"/>
      <url>/2020/05/29/20200529go_nginx/</url>
      
        <content type="html"><![CDATA[<h1 id="使用docker-golang-执行本地golang-服务"><a href="#使用docker-golang-执行本地golang-服务" class="headerlink" title="使用docker/golang 执行本地golang 服务"></a>使用docker/golang 执行本地golang 服务</h1><pre><code>cd $工作目录docker run --rm -it --name go-http-demo -v $PWD:/go/src/example.com/go-http-demo -p 14500:8080 golang</code></pre><h1 id="弄懂-Nginx-location"><a href="#弄懂-Nginx-location" class="headerlink" title="弄懂 Nginx location"></a>弄懂 Nginx location</h1><h2 id="我遇到的问题"><a href="#我遇到的问题" class="headerlink" title="我遇到的问题"></a>我遇到的问题</h2><p>之前服务器已使用有a.ahuang.ml 域名的A服务，仅提供后台api 接口；然后再做B服务时，由于理念很接近，还得使用a.ahuang.ml 的子域名，所以规划好location 就很重要。</p><h2 id="我的本地解决测试方案"><a href="#我的本地解决测试方案" class="headerlink" title="我的本地解决测试方案"></a>我的本地解决测试方案</h2><p>当前给出我改好的location 样式：</p><ol><li>首先设定好本地的test 域名 DNS 转向本地:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/host</span><br><span class="line">输入 127.0.0.1 test.ahuang.ml</span><br><span class="line">vim ~/conf/ahuang.conf</span><br></pre></td></tr></table></figure><ol start="2"><li>书写~/conf/ahuang.conf</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~/conf/ahuang.conf</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">  <span class="attribute">server_name</span> test.ahuang.ml;</span><br><span class="line">  <span class="attribute">client_max_body_size</span> <span class="number">500M</span>;</span><br><span class="line">  <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">800</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attribute">location</span> <span class="regexp">~ ^/(api|evidence/)</span> &#123;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">900</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>执行启动nginx</li></ol><p><code>docker run --rm -p 127.0.0.1:8888:80 --name mynginx -v $PWD/conf:/etc/nginx/conf.d nginx</code></p><ol start="4"><li><p>测试</p><p> curl <a href="http://test.ahuang.ml:8888/api" target="_blank" rel="noopener">http://test.ahuang.ml:8888/api</a> # 返回900<br> curl <a href="http://test.ahuang.ml:8888/evidence/xx" target="_blank" rel="noopener">http://test.ahuang.ml:8888/evidence/xx</a> # 返回900<br> curl <a href="http://test.ahuang.ml:888/abc" target="_blank" rel="noopener">http://test.ahuang.ml:888/abc</a> # 返回800</p></li></ol><h2 id="读参考文章注意点"><a href="#读参考文章注意点" class="headerlink" title="读参考文章注意点"></a>读参考文章注意点</h2><p><a href="https://juejin.im/post/5ce5e1f65188254159084141" target="_blank" rel="noopener">完全参考掘金文章</a></p><p>推荐直接参考原文章</p><h3 id="location修饰符类型"><a href="#location修饰符类型" class="headerlink" title="location修饰符类型"></a><strong>location修饰符类型</strong></h3><p>location 支持的语法 <code>location [=|~|~*|^~|@] pattern { ... }</code></p><h4 id="「-」-修饰符-要求路径完全匹配"><a href="#「-」-修饰符-要求路径完全匹配" class="headerlink" title="「=」 修饰符: 要求路径完全匹配"></a><strong>「=」 修饰符: 要求路径完全匹配</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location = /abcd &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>http://website.com/abcd</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/ABCD</code> <strong>可能会匹配</strong>，也可能不匹配，取决于操作系统的文件系统是否大小写敏感(case-sensitive)。ps: MAC 默认是大小写不敏感的。</p></li><li><p><code>http://website.com/abcd?param1*param2</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/abcd/</code> <strong>不匹配</strong></p></li><li><p><code>http://website.com/abcde</code> <strong>不匹配</strong></p></li></ul><h4 id="「-」-修饰符-区分大小写的正则匹配"><a href="#「-」-修饰符-区分大小写的正则匹配" class="headerlink" title="「~」 修饰符: 区分大小写的正则匹配"></a><strong>「~」 修饰符: 区分大小写的正则匹配</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location ~ ^/abcd$ &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>^/abcd$</code> 这个正则表达式标识字符串必须以 <code>/</code>开始，以<code>$</code>结束，中介必须是<code>abcd</code></p><ul><li><p><code>http://website.com/abcd</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/ABCD</code> <strong>不匹配</strong></p></li><li><p><code>http://website.com/abcd?param1&amp;param2</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/abcd/</code> <strong>不匹配</strong></p></li><li><p><code>http://website.com/abcde</code> <strong>不匹配</strong></p></li></ul><h4 id="「-」-修饰符-不区分大小写的正则匹配"><a href="#「-」-修饰符-不区分大小写的正则匹配" class="headerlink" title="「~*」 修饰符: 不区分大小写的正则匹配"></a><strong>「~*」 修饰符: 不区分大小写的正则匹配</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location ~* ^/abcd$ &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>http://website.com/abcd</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/ABCD</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/abcd?param1&amp;param2</code> <strong>匹配</strong></p></li><li><p><code>http://website.com/abcd/</code> <strong>不匹配</strong></p></li><li><p><code>http://website.com/abcde</code> <strong>不匹配</strong></p></li></ul><h4 id="「-」-修饰符-前缀匹配"><a href="#「-」-修饰符-前缀匹配" class="headerlink" title="「^~」 修饰符: 前缀匹配"></a><strong>「^~」 修饰符: 前缀匹配</strong></h4><p>如果该location 是最佳的匹配，那么对于匹配这个location 的字符串，该修饰符不再进行正则表达式的检测。注意，这不是一个正则表达式匹配，他的目的是优先于正则表达式的匹配</p><h3 id="路径查找顺序及优先级"><a href="#路径查找顺序及优先级" class="headerlink" title="路径查找顺序及优先级"></a><strong>路径查找顺序及优先级</strong></h3><p>当有多条location 规则时，nginx 有一套比较复杂的规则，优先级如下:</p><ul><li><p>精确匹配 <code>=</code></p></li><li><p>前缀匹配 <code>^~</code> 立刻停止后续的正则搜索</p></li><li><p>按文件中顺序的正则匹配 ~ 或 ~*</p></li><li><p>匹配不带任何修饰的前缀匹配</p></li></ul><h3 id="案例分析"><a href="#案例分析" class="headerlink" title="案例分析"></a><strong>案例分析</strong></h3><p><a href="https://juejin.im/post/5ce5e1f65188254159084141" target="_blank" rel="noopener">原文章</a>的案例分析非常的给人容易学习</p><h4 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a><strong>案例1</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location /doc &#123;</span><br><span class="line">    return 701; # 用这样的方式，可以方便的知道请求到了哪里</span><br><span class="line">  &#125;</span><br><span class="line">  location ~* ^/document$ &#123;</span><br><span class="line">    return 702; # 用这样的方式，可以方便的知道请求到了哪里</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I  website.com:8080/document</span><br><span class="line">HTTP/1.1 702</span><br></pre></td></tr></table></figure><p>按照上述的规则，第二个会有更高的优先级</p><h4 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a><strong>案例2</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location /document &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">  location ~* ^/document$ &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I  website.com:8080/document</span><br></pre></td></tr></table></figure><p>第二个匹配了正则表达式，优先级高于第一个普通前缀匹配</p><h4 id="案例3"><a href="#案例3" class="headerlink" title="案例3"></a><strong>案例3</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location ^~ /doc &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">  location ~* ^/document$ &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl http://website.com/document</span><br><span class="line">HTTP/1.1 701</span><br></pre></td></tr></table></figure><p>第一个前缀匹配^~命中以后不会再搜寻正则匹配，所以会第一个命中</p><h4 id="案例4"><a href="#案例4" class="headerlink" title="案例4"></a><strong>案例4</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location /docu &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">  location /doc &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I website.com:8080/document 返回 HTTP/1.1 701，</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location /doc &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">  location /docu &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I website.com:8080/document 依然返回 HTTP/1.1 701</span><br></pre></td></tr></table></figure><p>前缀匹配下，返回最长匹配的 location，与 location 所在位置顺序无关</p><h4 id="案例5"><a href="#案例5" class="headerlink" title="案例5"></a><strong>案例5</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 8080;</span><br><span class="line">  server_name website.com;</span><br><span class="line">  location ~ ^/doc[a-z]+ &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">  location ~ ^/docu[a-z]+ &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I website.com:8080/document 返回 HTTP/1.1 701</span><br></pre></td></tr></table></figure><p>把顺序换一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">listen 8080;</span><br><span class="line">server_name website.com;</span><br><span class="line">  location ~ ^/docu[a-z]+ &#123;</span><br><span class="line">    return 702;</span><br><span class="line">  &#125;</span><br><span class="line">  location ~ ^/doc[a-z]+ &#123;</span><br><span class="line">    return 701;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">curl -I website.com:8080/document 返回 HTTP/1.1 702</span><br></pre></td></tr></table></figure><p>正则匹配是使用文件中的顺序，找到返回</p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> docker golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200523看房</title>
      <link href="/2020/05/26/20200523%E7%9C%8B%E6%88%BF/"/>
      <url>/2020/05/26/20200523%E7%9C%8B%E6%88%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="2020-5-23-中介约看房经历"><a href="#2020-5-23-中介约看房经历" class="headerlink" title="2020/5/23 中介约看房经历"></a>2020/5/23 中介约看房经历</h1><p>之前办理积分时，和人事与一个财务同事去社保办事，财务同事帮我推荐了一个炒房团的。说我们公司之前有个同事前两年从他手上交易过一个房子。我觉得这样有个参考性，就像我之前学车，有参考就会顺利很多。加了那个人微信后，本来约定周五去同他学习点知识，没想到周三丫头住院去不了了。老婆出院后，晚上回到家，看龙柏那附近的房子，有几个感觉还不错的，右上角有个按钮说线上带看房子，哦，居然联通了链家的房产经纪人。于是就跟他聊了聊，也说自己社保还未满。不过倒是可以多转转多学学。 同时约定周末都是可以去看看房子的。</p><p>周六早上起床玩了会游戏，然后和老妈联通视频，说了说自己的一些打算，老妈也帮我问了问她的姐妹，我的阿姨们，打算明年买房的时候不够跟她们借点，提前打声招呼。然后时间也快到2:30，赶紧出门去龙柏附近那个中介那。这一下午，就是两辆电驴在一直奔走。</p><p>先是去看了网上看到的两房改三房的六楼，其实还不错，不过，我自己掂量着的一楼六楼都不考虑。不过，来了就看看。</p><p>中介帮我找了十款二手房，价格都在300w左右，龙柏那好多动迁房，300w都是挺宽敞58、59、60平这样。</p><p>先看了龙柏七村。有六楼的，太高；二楼的，专做来卖的，价格挺高的；四楼(之前网上就有看到户型什么的都不错)，一梯四户，最靠小区里面，两个缺陷吧；一楼，户型很奇葩，但是挺大，反正一楼不会要就对了。</p><p>再看了龙柏四村，路就很宽敞、干净。看了六楼一个老大爷，进去刺鼻尿骚味，一只博美在房间趴着，很安静。房子装修好也没事，但是户型是前面一个大房间，后面一个小房间，采光估计会差一点，中间倒是有个小天井，有点光线。另一个六楼是一个大哥，俩女儿在睡觉。他们打算置换，中间厅很大，俩房间朝南，房子还是挺干净的，一梯四户的楼梯口那一户；还有一个一楼的，完全空关多年，很黑暗，老旧。反正买来必须装修把。卖点是一个大院子。</p><p>再看了龙柏三村，紫藤路。六楼的，正在出租，租房妹子加班回来开门，我们进去转了转。虽然是装修多年，但是干净，整洁，等于是拎包入住都很舒适的装修。</p><p>以上看了都是有各种奇葩：厅超级大、或者房子位置不那么靠中、顶天立地、房型采光、集体产权其他人也有比例、满二、满五、唯五不唯一等。</p><p>这几个小区都是围绕之前我租的小区（龙柏龙兴苑）附近，都是动迁房。感觉一个天一个地呀，哈哈。</p><p>和中介聊了聊，毕竟价格在那摆着，人家面价比较大嘛。然后我心里觉得有没有那种不那么面积大、然后两房的（一年前还想着一房一个大厅，大厅可以隔出来睡人即可那种，飘了飘了，现在低配要两房了）。我之前就想问能不能看看龙柏附近小区叫做《虹梅花苑》的，中介就拿出手机帮我看了看，说这款279的不错，原价320，房东说想腾房票，挂了44天降了几次。可以可以，中介能看到更多信息，然后联系那边中介(跨区域了)，然后出发前往。</p><p>那个小区在虹桥路上，10多分钟到那附近，找了一圈原来入口是一个大拱门-王子公寓-虹桥路2222弄，是一个多合一统一入口。进来很干净，清幽，附近是长宁区别墅群，很多有钱人、明星等；一路上都是老外。龙柏那边欧美面孔有一些，更多的是台湾、韩国等面孔；虹桥路这里更多的是欧美面孔。欧美一家子、欧美大姑凉、欧美小子。找这个过程多绕了一圈，还看到一个家庭人在小区内烧烤，可以，我也憧憬着。</p><p>进来这，是一个帅小伙中介，他说这个房子是顶楼，不过总高是五楼，不过楼顶是有三角隔热层，防热、防水。当前房子空关一年了，都有一些灰层，这都不是事。小区是一梯两户。最后一层时，由于这间空关，楼道就都是另一个房子堆放的物资，不过如果新房有人入住，他们肯定收起来的。五楼也不高，再高一层，不行，绝对不行。然后进去一看。</p><p>哇，真是我理想的。价格合适，房间也合适，没有厅没关系，别的都一应俱全。小区靠近高架，但是前面隔了一排房子，灰层不会那么多，声音也不大。窗一关很安静。进门左侧是厨房，还挺大，比我现在租的整洁。进门正对面是次卧，有一个大窗，面积也合适。之前我看的龙柏几个房子，那都床头床尾直接就满了，侧面离门不到一米，太窄，不小心的话会着火的，而且只能睡觉。这个侧卧就很合适。没有厅，吃饭就围着厨房吃，那个冰箱比较占位置，买个大的冰箱当桌子？？进门右转就是过道，然后过道比较窄，而且房东还放着一个大木柜，去了大木柜，过道就稍稍正常了。过道中间是洗浴厕所，这还有个小窗子呢，厕所里面有窗子，不要太好哦，厕所空间也大，合理。过道长度大概2、3米就到主卧了。主卧有个大衣柜，奶白色，这直接就省了一笔钱。没有阳台，主卧显得比较大，装修整套都是间接，干净。主卧向南正对高架。前面也说了，不吵，这还是很好的，反正高架11点，我都是12点才睡。</p><p>这真的是当前我心中很中意的。毕竟自己也才第一天看嘛。楼下就和中介在这个小区转了转，简直就是把之前中介介绍的那些个按在地板摩擦，狠狠摩擦那种，不对，是死死摩擦，毫不留情死死摩擦。小区中间是运动员，很多人在这聊聊天。</p><p>然后出来大门，小区入口大拱门这，我和中介聊了聊。中介估计之前也不好卖，感觉有点伤感，没过来这里看，真不知道手上房源差的感觉，难怪不好卖(我自己臆测的)。我这里也问了问自己之后有哪些买房前准备工作。也说了刚刚那套房超级中意。聊了好一会，就先回来了，离住处很近。</p><p>回到住处就问中介，能否帮我问问房东能否等8个月我社保到期来买呢？我可以押金4、50，同时房价不讲价。</p><p>然后晚上和老妈也说了说自己今天看房，还挺中意。</p><p>夜晚也看了看相关注意点。该房、该小区属于售后公房，好好的看看各种小心点。反正随缘吧，中介那不能急。不过房类型、小区估计比较中意《虹梅花苑》，明年基本能定在那个小区。</p><p>好了，今天又过完了，爬楼梯爬爬爬。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 看房 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200513猴头菇说肚子痛要去医院</title>
      <link href="/2020/05/26/20200513%E7%8C%B4%E5%A4%B4%E8%8F%87%E8%AF%B4%E8%82%9A%E5%AD%90%E7%97%9B%E8%A6%81%E5%8E%BB%E5%8C%BB%E9%99%A2/"/>
      <url>/2020/05/26/20200513%E7%8C%B4%E5%A4%B4%E8%8F%87%E8%AF%B4%E8%82%9A%E5%AD%90%E7%97%9B%E8%A6%81%E5%8E%BB%E5%8C%BB%E9%99%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="2020-5-13-猴头菇说肚子痛要去医院"><a href="#2020-5-13-猴头菇说肚子痛要去医院" class="headerlink" title="2020/5/13 猴头菇说肚子痛要去医院"></a>2020/5/13 猴头菇说肚子痛要去医院</h1><p>2020/5/13 中午接近两点，正忙着，猴头菇发微信说要去医院，肚子很痛。我一听，她都这么提了，说明肯定就是不舒服，赶紧让她打车离她很近的八院，我赶紧过来。她说中午吃完饭，肚子就有点不舒服，躺在公司的一个沙发，到现在还是很痛，等我过去带她。我说，痛就赶紧打车去医院，她说等我过来，她不懂路。那行，我赶快过去。</p><p>我发个请假邮件，跟伟哥说声老婆生病去医院，赶紧就跑过去，半路想起来忘带丫头身份证(办居住证积分时，留在公司)，跟丫头说自己打车过去医院，我回去拿她身份证。一来一回，真担心车子跑没电不走了。</p><p>赶到医院，丫头肚子痛，伴有一点发烧，先在新冠病毒检查点(这时间点必须检查)。来回检查，猴头菇肚子大大的，鼓鼓的。我过去陪她，她连坐着都很痛，还得来回检查。新冠检查还得500多，丫头没医保，全部自己出钱。发烧检查完毕说可以去妇科看。这时间点，最好别生病。</p><p>这时候去妇科看，妇科医生阿姨帮忙赶紧的在4:30 检查完(超过就不检查了)，然后去办理住院手续。办理住院手续的时候，丫头站也不是坐也不是，反正就是痛的不行了。期间要办理好了，我拿错我的医保，拖了点时间，然后换成丫头的，丫头的不能用，又得转账押金5000，这中间，丫头肚子更痛了，付费窗口蹲下都痛，嘴唇都白了。</p><p>赶紧到住院部，丫头都快走不动了。上来后，丫头在29床躺了会，然后被叫到一个小屋子穿刺看到血很多。我在屋外一直听到猴头菇的惨叫。然后医生用针筒吸出了血，得知卵巢破裂，出血没有愈合。得，刚才还走来走去，更特么病重。</p><p>然后我被叫去签家属委托做手术的风险书。心里担心啊。然后下午7点左右，丫头被推上车子，担心她一直没吃东西，会不会血糖低，又测了下说行。她去了五楼做手术了。</p><p>三个多小时一直待病房等，心里焦急啊。旁边是一个老奶奶，还没做手术，她的小儿子来服侍。她的小儿子-大叔，就跟我说，别担心，一会就好了。我说，嗯，是的，一会就好了，低头看知乎，其实担心死了，但是我毫无办法，只能转移注意力。</p><p>中间我还吃了大叔给的几块饼干，喝了杯水，然后晚上10点，丫头才终于做好手术，我都又饿咯，别说猴头仔了。手术车推上来的时候，我把丫头抱下床，她冷的发抖，嘴唇毫无血色，冷的两条腿一直抖。就像活鱼跳到岸上那样，抖得蹦跶那样。放到床上赶紧盖上被子、我把好几件衣服盖上，好让猴子暖和点。过了会她才好些。这时候她还禁食禁水，挂着吊瓶，尿袋。我就喊吊瓶没水了、给她倒尿。忙里忙外。给她楼下去买了个小碗，等醒了可以喝水。吊瓶挂到凌晨2点，我都大黑眼圈了。那个大叔也一直玩手机麻将到2点才睡。他带了个躺椅，我啥都没有，但如果躺椅也是睡不着的，我就趴着床下边，大约5点起来喂水。然后说喂她喝无糖葛粉。今天又是挂吊瓶，早上挂到下午2点多，去附近买了混沌，和丫头一人一碗混沌，吃完赶紧去公司了。晚上赶紧去医院，路上刚好买了白稀饭。今天晚上比较好的是，我去住的地方拿了丫头的瑜伽垫，哇，休息好了，第二天果然精神多了。第二天一早，赶紧去转转，有去附近买到个白稀饭，美滋滋，丫头的改善早饭有着落了，路是远了点，不敢用自己的电瓶车，别到时没电，骑的哈罗单车，真特么难骑。中午一直挂瓶到下午2点多，给她买了个午餐、准备好水，丫头吃了后，赶紧的去公司写点东西。自己也没吃啥，路上买了个黄山鸭腿菜饭（不用等，现成的，快，等红灯时买，绿灯还没灭就又可以过）。到了公司，大家都在干活，饿的不行，把饭吃了，鸭腿来不及吃，晚上去医院。我把公司的晚餐也带来，鸭腿也带来，公司晚餐吃了，鸭腿放那没吃。晚上睡到一半，说隔壁床来人，我瑜伽垫没地方，于是半夜就跑到走道上的床位躺了会，那灯光亮的呀，闪瞎我的狗眼，于是又睡得不是很好。隔天早上隔壁床来了一菇凉，子宫外孕做手术。她照看的人一个都木有，我给她抱床上，菇凉都是可怜的娃呀。她也是冷，没猴头菇抖的那么厉害。给她穿上自己带的一个袜子，脚暖和了，就不那么冷了，把身上外套也给她盖上。她男朋友来了，我的使命也就到了。当天中午猴头挂完吊瓶，我跑回住所休息了会，打了个游戏，美滋滋，不过肯定是睡不着，躺着看了看手机视频，差不多了就赶紧去医院。今天晚上有个好处，就是我又整了个位置放瑜伽垫睡，而且还看到有一个闲置的医院被子，刚好垫着，美滋滋。</p><p>一连好多天照看猴子，工作日下午就去上班，非工作日下午就会跑回住所休息休息，，嘎嘎。</p><p>终于到丫头出院那天中午，中午跟伟哥说了声，赶紧去给丫头结账出院，带回家。由于丫头心疼打车钱、一个人坐车一个人骑车麻烦，就坚持做我的电驴。心疼啊。路上中午还有交警，还得让丫头下来走一段路。回到家，稍微收拾收拾，赶紧就去公司了。</p><p>啊，好累。啊，老婆还在，真好。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 猴头菇生病 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-5-12shebao</title>
      <link href="/2020/05/24/2020-5-12shebao/"/>
      <url>/2020/05/24/2020-5-12shebao/</url>
      
        <content type="html"><![CDATA[<h1 id="上海社保断缴引发的经历"><a href="#上海社保断缴引发的经历" class="headerlink" title="上海社保断缴引发的经历"></a>上海社保断缴引发的经历</h1><p>刚来上海，外地来的多少都会有公司倒闭、部门人员压缩(狼狈被裁)等等因素导致换工作。换工作时，前公司没整好、后公司没法填补，自己不懂，没有社保补上，于是出现社保断缴补缴回去、断缴但没有补缴回去的情况。</p><p>我就有2次这个经历: 第一份工作被裁(2014年经融危机)，断了之后待在出租屋3个月努力做进一步学习，导致断了3个月(那时真不懂这件事)；第二次是老板没钱，过完年解散，但是最后两个月居然没交(全公司都没交)。</p><p>明年可能有机会买房，现在看看我明年能真正有房票。</p><p>前一天去人才服务中心办理居住证积分，进展顺利，心情格外的好。然后隔天周日来公司，看了看房知识，看到一些网络的文章，各种断章取义的错误知识分享给你，然而当时我一头雾水，心里担心受怕，看到了说，必须连续5年，中间一点断缴都不行，如果你断了却没有补回去，是不能买房的。</p><p>那一刻感觉我懵了。我刚来上海努力等待2年，至少有房票有盼头吧，然而17年上海新政变成要等待5年，然后现在说我白忙活。明年2021年春天将要到5年的，却得从16年开始算起(第二次断缴时间)，也就是2022年春天才有房票。这一颗真的毫无斗志。</p><p>我东问问、西问问，公司人事也不是很清楚；网络有说连续5年，有说累计5年；众说风云，就是不见房产交易所有什么公告。那几天一直在网络查，知乎问。各种各样信息。我自己也在知乎问了一个，强调必须近期有实操人回答，没想到来了个知识普及的回答，逗比。</p><p>那几日天天都是想着这事，睡都睡不好觉。谁特么知道我再等两年，上海是什么样？刚需再等两年我也就应该滚回家了。真的受够租房了。</p><p>第二次去人才服务中心时(前几天就想着这事，觉没睡好，黑眼圈前去办理业务)，我们先去社保中心，同去办理居住证积分的伙伴他老公也是有断缴社保，但是他补缴回去了，已经可以买房了。，跟我不一样，我的是断缴，但是没有补缴回去。人事就说，要不你直接社保办理查询。我拿号后，社保工作人员也不知道，对了一遍我的社保缴纳情况。我又晕头转向的出来了。她们问如何，工作人员有说什么不？我回答很迷糊，得不到我想知道的切确信息。</p><p>她们说，要不你直接去房产交易中心问，问哪里都不如直接问交易中心。</p><p>我一听，那行，反正等会也去那附近办事，地址就是拉取个人所得税完税证明的水清路159号二楼位置。我骑着哈喽单车10几分钟就到了。</p><p>先是在一楼问了一个大哥，他再三强调可以买，我这个是正常的。后来他有人询问事情，他上了楼上。我觉得既然来了，顺便再次再次再次一次性询问交易中心咨询人员，于是就到了二楼拿咨询单问真实工作人员。</p><p>在外边等了会，然后暂停服务窗口的工作人员来了，问“你来咨询吗”，然后俺就很客气的说来询问相关的东西。我顺便开着手机录音，怕我自己听错了。一再强调我的特殊情况，是断缴，她说63个月内有60个月正常缴交，就能交易。这也就是说，社保是按<strong>累计63个月满60个月正常缴纳社保</strong>而不是<em>连续63个月满60个月</em>。断缴补缴、断缴没补缴是一样的，都可能买房。</p><p>政策的东西就是这样，公告没有，全靠猜。语言说的又迷糊，累计和连续两个字，是相差十万八千里的。</p><p>从交易中心走到人才服务中心路上，感觉完全不一样。感觉之前努力不是白费，也痛恨那些无良信息发布者。之前大中午，迷迷糊糊的，路上却走得越来越有劲。把相关信息发给老婆，告诉她，我们还是有机会的。给老妈打电话，告诉她，我没有努力白费，之前看到网络上的信息都是无良信息发布者，到房产交易中心咨询正确信息是，我有资格买房的。</p><p>啊，那天太阳很大，不过天真的很蓝。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 买房资格 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-5-12jifen</title>
      <link href="/2020/05/24/2020-5-12jifen/"/>
      <url>/2020/05/24/2020-5-12jifen/</url>
      
        <content type="html"><![CDATA[<h1 id="上海申请居住证积分经历"><a href="#上海申请居住证积分经历" class="headerlink" title="上海申请居住证积分经历"></a>上海申请居住证积分经历</h1><p>这次去办理居住证积分，总结下历程（当前材料已提交，正在等待审核，审核期是2个月）</p><h2 id="为什么要办理居住证积分"><a href="#为什么要办理居住证积分" class="headerlink" title="为什么要办理居住证积分"></a>为什么要办理居住证积分</h2><p>刚来上海，一直都是租房时，能住就好了。租房的价格也不便宜，租房的权益，包括孩子上学权、办理居住证、各种证权都是难以享受到的。没办法，寄人篱下，房东绝对不会理你这个没钱的外地租客。</p><p>我前两年遇到一个很好的房东，当时我要办理居住证，通过中介，她也是帮我跑动。当时为孩子和老婆办理时，来回跑，让房东等待，过意不去。不过幸好房东的帮助，办理好了。上海政策是，只要是本科以上，一年内缴纳6个月正常社保，其会自动续签(居住证都是一年一签)。</p><p>有了居住证后，买电瓶车，自己就可以上牌，当时还给哥们电瓶车也上牌。后来2019年我又买一辆电瓶车时，这时政策不用居住证，拿身份证就可以办理时，人多的呀，排了两条街。我是早上6点去排队，硬是等到快下午，饿了个半死。</p><p>居住证好处，不止这点，上面是举个例子，这是特权吧。不过现在拿身份证就可以办理。</p><p>居住证另一个好处，就是孩子可以在上海上学。但是不能中考、不能高考。我查阅或者询问周围人，得到的答案是，其实学校不会招纳这些人，因为你都不能中考、不能高考，你来这里上学干嘛，占用教育资源？当然，如果要上学，那就送到郊区一些称为”菜小”的学校去。</p><p>这时候，居住证积分的作用就是，虽然你不是上海户口，但是你能享受上海户口的相关权益：孩子能在上海中高考等(我列举不来)。当然了，能把上海户口办理下来，简直就是最好的了。</p><h2 id="办理历程"><a href="#办理历程" class="headerlink" title="办理历程"></a>办理历程</h2><p>之前一直犹豫是不是现在去办理相关的事情，因为来公司到现在差不多刚好一年，恩，应该问起来时机刚刚好。</p><p>2020/4/20 早上10:00 直接大胆的问人事。人事回的很及时，先让我网上核对下分数，我在<a href="http://www.shxnedu.com/jifen.html" target="_blank" rel="noopener">模拟积分</a> 模拟出来是够的。然后人事让我<a href="http://sh.bendibao.com/zffw/2014710/110532.shtm" target="_blank" rel="noopener">准备好材料</a> :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 单位人事专员介绍信、身份证、公司相关材料 // 人事会携带好的</span><br><span class="line">2. 持证人有效期内&lt;上海市居住证&gt; // 记得去街道办公室刷新一下，前后页打印好</span><br><span class="line">3. 持证人有效身份证件 // 前后页打印好</span><br><span class="line">4. 孩子要享受积分政策(这不必须的嘛，管上), 出生医学证明原件、复印件</span><br><span class="line">5. 妻子要享受积分政策(这不是很好嘛，管上)，(1). 妻子身份证原件、复印件 (2). 结婚证原件、复印件 (3). 户口本页面原件、复印件 // 三个都要带齐</span><br><span class="line">6. 户口本原件、复印件，每个人都复印，*每个人都复印*，**每个人都复印** // 人才管理窗口会给你整理好的，全都打印</span><br><span class="line">7. 一年期及以上有效合同，快到期的话，需要续签，同时给他每页复印</span><br><span class="line">8. 个人所得税完税证明 // 我去的上海市闵行区水清路159号3层打印</span><br><span class="line">9. 社保缴交证明</span><br></pre></td></tr></table></figure><p>公司部分材料公司会准备好，我这里就不赘述；</p><p>同时人事在公司开好账户，我登上<a href="http://jzzjf.rsj.sh.gov.cn/jzzjf/" target="_blank" rel="noopener">积分网站</a>登上个人账户，填写相关信息。</p><p>填写信息注意点:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">第一页:</span><br><span class="line">政治面貌: 其他</span><br><span class="line">居住证有效日期: 你的居住证有效日期</span><br><span class="line">户籍所在地地址: 填写户口本上一致的</span><br><span class="line">在沪居住地址: 你的居住证写着的</span><br><span class="line">毕业时间: 你的毕业证书一致</span><br><span class="line">聘用(劳动)合同签订日期、起始日期、终止日期: 合同里一致</span><br><span class="line">在沪缴纳社会保险期限(月): 你的社保单一致</span><br><span class="line">-------------------------------------------------</span><br><span class="line">第二页:</span><br><span class="line">个人简历，从什么时候上大学、大学终止，一直到现在</span><br><span class="line">-------------------------------------------------</span><br><span class="line">第三页:</span><br><span class="line">境内人员--填写家庭情况:</span><br><span class="line">填写妻子的信息:</span><br><span class="line">是否需享受积分相关待遇: 填是</span><br><span class="line">户籍地: 户口本一致</span><br><span class="line">填写子女情况:</span><br><span class="line">是否需享受积分相关待遇: 填是</span><br><span class="line">户籍地: 户口本一致</span><br></pre></td></tr></table></figure><p>上述材料准备妥当后，等了两周人事忙完事，就和另一个同事一起去水清路388号的上海市闵行区人才服务中心。</p><p>到该处后，我们去附近准备好相关材料准备(个税完税证明、打印相关文件)，然后返回人才服务中心。</p><p>当前就是确认相关材料是否齐全、填写材料是否有误，有误的话及时改正，旁边就有两台联网机器。</p><p>那个是假期补班，人比较少。我们那个窗口一个可爱的妹子(戴着口罩，肯定也可爱)超级有耐心，我的材料有错，错了立马改，改了又帮我再重新检查，重复三次。我要是有钱，我肯定经常跑来和她聊天，小姑凉，你有男朋友不啊，可以和我阿黄认识下呗，我阿黄和可爱的。</p><p>当前无法办理有另一个原因是，当前学籍学历不是在这里进行办理的。而是准备好材料，发送到一个邮箱，工作人员会人工帮你审核。材料：毕业证书扫描件、学士学位证书扫描件、学历学位证书、学信网电子注册备案表、学信网在线验证报告、学位网认证报告、身份证复印件正反面全都要发过来。教育背景核实邮件发送格式: <code>某某公司-某某人（教育背景合适）-共几人</code></p><p><img src="/css/images/jifen_joy.jpeg" alt="办理趣事"></p><p><img src="/css/images/jifen_certificate_check.png" alt="全都要"></p><p>当前完成回来后，晚上我便去重新整理缺失的申请材料、扫描相关证书等。然后发送邮件到指定邮箱。材料缺失的话，对方会告知，然后赶紧补上。<a href="http://www.cdgdc.edu.cn/" target="_blank" rel="noopener">学位网认证报告</a>这个比较慢，会需要等待好多天，你可以提交加急，并告知你加急是为什么。我当时加急后，第二天对方就帮我办好了。</p><p>然后2020/5/12 那天又前往办理好相关材料递交。</p><p>以上基本等通知就好了，反正我正在等通知ing…</p>]]></content>
      
      
      
        <tags>
            
            <tag> 居住证积分 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-5-12lesson</title>
      <link href="/2020/05/11/2020-5-12lesson/"/>
      <url>/2020/05/11/2020-5-12lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="使用github-travis-自动化打包"><a href="#使用github-travis-自动化打包" class="headerlink" title="使用github + travis 自动化打包"></a>使用github + travis 自动化打包</h1><h1 id="使用gitlab-gitlab-ci-自动化测试、覆盖、打包"><a href="#使用gitlab-gitlab-ci-自动化测试、覆盖、打包" class="headerlink" title="使用gitlab + gitlab-ci 自动化测试、覆盖、打包"></a>使用gitlab + gitlab-ci 自动化测试、覆盖、打包</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-5-11lesson</title>
      <link href="/2020/05/11/2020-5-11lesson/"/>
      <url>/2020/05/11/2020-5-11lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="Use-github-package-publish-docker"><a href="#Use-github-package-publish-docker" class="headerlink" title="Use github package publish docker"></a>Use github package publish docker</h1><p>gitlab.com 网络特别慢，经常 docker push 各种失败.</p><p>考虑到github.com 全部免费了，故接下来都转战github 了。(自建是不可能自建的，没有机器)</p><p>使用github token 登录(密码登录即将被废弃, 且push、pull 等操作都没有权限)</p><ol><li><p>Go to your GitHub account -&gt; Settings -&gt; Developer Settings -&gt; Personal access tokens -&gt; generate new token</p></li><li><p>Note 选项写上一个标签</p></li><li><p>勾选 write:packages/read:packages, 然后保存</p></li><li><p>复制得到的token</p></li></ol><p>docker login docker.pkg.github.com</p><p>User: 你的用户名(比如shaohung001)</p><p>Password: 第4步得到的token</p><h1 id="node-升级package-的库版本"><a href="#node-升级package-的库版本" class="headerlink" title="node 升级package 的库版本"></a>node 升级package 的库版本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g npm-check-updates</span><br><span class="line">ncu -u</span><br></pre></td></tr></table></figure><h1 id="Mac-删除node-使用nvm-管理node"><a href="#Mac-删除node-使用nvm-管理node" class="headerlink" title="Mac 删除node, 使用nvm 管理node"></a>Mac 删除node, 使用nvm 管理node</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo npm uninstall npm -g</span><br><span class="line">sudo rm -rf /usr/local/lib/node /usr/local/lib/node_modules /var/db/receipts/org.nodejs.*</span><br><span class="line">sudo rm -rf /usr/local/include/node /Users/$USER/.npm</span><br><span class="line">sudo rm /usr/local/bin/node</span><br><span class="line">sudo rm /usr/local/share/man/man1/node.1</span><br><span class="line">sudo rm /usr/local/lib/dtrace/node.d</span><br></pre></td></tr></table></figure><p>下载nvm</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span><br><span class="line">或者</span><br><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span><br></pre></td></tr></table></figure><p>然后在 ~/.bash_profile ~/.zshrc 中加入如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$HOME/.nvm&quot;</span><br><span class="line">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;  # This loads nvm</span><br><span class="line">[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \. &quot;$NVM_DIR/bash_completion&quot;  # This loads nvm bash_completion</span><br></pre></td></tr></table></figure><pre><code>source ~/.bash_profile &amp;&amp; source ~/.zshrc</code></pre><p>重开一个terminal 就可以用看到 nvm 命令了</p><h1 id="简单探索nodejs-不同第三方库dependence-相同库不同版本"><a href="#简单探索nodejs-不同第三方库dependence-相同库不同版本" class="headerlink" title="简单探索nodejs 不同第三方库dependence 相同库不同版本"></a>简单探索nodejs 不同第三方库dependence 相同库不同版本</h1><p>今天使用puppeteer 和express 时发现，这两个dependence 包含有同一个库: mime。但是express 依赖mime 1.6.4 版本；puppeteer 依赖 2.x 版本；</p><p>我们到node_modules 子目录看到第三方库规划: node_modules/mime 是1.6.4，也就是express 依赖的；我们找到puppeteer 下，其提前依赖库本地的mime 2.x 的。</p><p>这样，puppeteer 在内部中，require 的是其自身node_modules/mime；express 自身没有node_modules 于是就往上找，也找到对应mime；</p><p>以上各自依赖相同库，不同版本，便不会冲突了</p><h1 id="mocha-test-时不通过"><a href="#mocha-test-时不通过" class="headerlink" title="mocha test 时不通过"></a>mocha test 时不通过</h1><p>使用mocha test不通过，报错信息:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;before all&quot; hook for &quot;GET /VERSION&quot;:</span><br><span class="line">Error: Timeout of 8000ms exceeded. For async tests and hooks, ensure &quot;done()&quot; is called; if returning a Promise, ensure it resolves. (/builds/xxxxxx/xxxxxx/backend/test/api.test.ts)</span><br></pre></td></tr></table></figure><p>说明报错报错信息来源于 beforeAll 方法，且说没有使用done 告知.</p><p>原方法：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.beforeAll(<span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</span><br><span class="line">    app.startup(&#123;testing: <span class="literal">true</span>&#125;, <span class="function">(<span class="params">_server: Express.Application</span>) =&gt;</span> &#123;</span><br><span class="line">        server = _server</span><br><span class="line">        done()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>明显是有done 这个操作的，难道throw error 导致没有进入done 了？？那我加个try catch 吧:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.beforeAll(<span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        app.startup(&#123;testing: <span class="literal">true</span>&#125;, <span class="function">(<span class="params">_server: Express.Application</span>) =&gt;</span> &#123;</span><br><span class="line">        server = _server</span><br><span class="line">        done()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        done(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><del>然后gitlab-ci 看到编译正常通过了, 但是没有进catch, 因为进了catch 我接下来拿不到server， 但之后又正常，说明只是说，要有try catch 确保有done 回馈即可!</del></p><p>以上. node -v : <code>v10.20.1</code></p><p>这里更新下：</p><p>上面有时可以有时失败，说明不是最终原因. 以下是最终原因</p><p>最终的原因是gitlab-ci cpu、memory 太低，运行太慢，导致获取到server 太慢，无法得到done，做法是<code>mocha -t 240000</code> 设置4分钟.</p><p>这个原因也是没有预料到，没想到是机器配置比较低的原因。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-4-16lesson</title>
      <link href="/2020/04/16/2020-4-16lesson/"/>
      <url>/2020/04/16/2020-4-16lesson/</url>
      
        <content type="html"><![CDATA[<p>It seems like I lose my fate some time ago , I dreamed a lot in the period , losing in a big dark hole where I count’t open my eyes.</p><p>I dreamed of age grow up , and I worried about that !</p><p>I never ever thinking about the troublesome before this period !</p><p>Last five year, I fight for gain more power from technology , dreaming of arriving  to the top, money or any other comes to me.</p><p>But, I didn’t had a rest last five year, nothing got but age and bit of knowledge of IT.</p><p>It really  disappointed !</p><p>I made a determination last  year , skills which  I  handled is much enough to made something I  ever determined to do.</p><p>Last two months, I made out a website “阿黄小说”, reading novel site. Attending to try a test of earning money or even little acknowledge of setting up  a big site , but I lost my mind again.</p><p>I made a discussion  with little shuai, I talked about my confuse of my career. Company didn’t raise salary since I entered last year.</p><p>Am I not worth of raising by my work ? I had grow much more I had done . I continue of leaning deeply of my work , or I have a test to make some games ?</p><p>I survey the game area no long ago, situation is serious recently , new come will very difficult to make effort .</p><p>During discussion , I realized that the company I stay , I always treat myself a passenger . I join the car, car drive me some years distance , I get off when Company contract arrived.</p><p>I never become a partner with any organization before . Am I make mistake ?</p><p>I realized that I made a wrong plan all life before . Money I  lack of it , because  I will buy a house the close two year , but after that ? I employed by some one else again ? Not my career grow , but only stare at the salary I should get just now ?</p><p>I made a determination of a more energy pay for myself career. Have a try to something different from before .</p><p>Another plan is to have a plan of learning deep in my IT field , and if possible to examine some useful  certificates !!! It’s never too late to do your decision !</p><p>When learning deep arrived some stage , I will have a try to make some games 😁…</p><p>Finally , I remember  my fate again , I know where to go , and I will not confuse again .</p><p>I am always young !!! My heart  will goes on !</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-4-13lesson</title>
      <link href="/2020/04/16/2020-4-13lesson/"/>
      <url>/2020/04/16/2020-4-13lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="vue-cli-3-0"><a href="#vue-cli-3-0" class="headerlink" title="vue cli 3.0"></a>vue cli 3.0</h1><p>package.json 中的script:dev 命令: vue-cli-service serve 其实类似于<code>npx vue-cli-service serve</code> === <code>node ./node_modules/.bin/vue-cli-service serve</code></p><h1 id="unzip-exe-在某一客户机报错"><a href="#unzip-exe-在某一客户机报错" class="headerlink" title="unzip.exe 在某一客户机报错"></a>unzip.exe 在某一客户机报错</h1><p>程序里使用到zip.exe unzip.exe bin 程序，正常使用很久了。</p><p>然而今天出现<code>Archive: xxx error: zipfile probably corrupt (segmentation violation)</code></p><p>关于windows 使用unzip.exe bin 程序，当前版本: UnZip 5.52 of 28 February 2005, by Info-ZIP.  Maintained by C. Spieler.</p><p>从搜索列表中, 发现很多都指向网址: <a href="ftp://ftp.info-zip.org/pub/infozip/win32/" target="_blank" rel="noopener">ftp://ftp.info-zip.org/pub/infozip/win32/</a></p><p>从里面可以直接下到5.52 bin 执行文件(其和当前程序使用版本相同，于是继续找).</p><p>继续找到下载: <a href="https://astuteinternet.dl.sourceforge.net/project/gnuwin32/unzip/5.51-1/unzip-5.51-1.exe" target="_blank" rel="noopener">https://astuteinternet.dl.sourceforge.net/project/gnuwin32/unzip/5.51-1/unzip-5.51-1.exe</a> 下载下来是个安装程序。</p><p>安装到windows 上后，找到:</p><p><img src="/css/images/unzipexeerror.jpg" alt="/bin/unzip.exe"></p><p>直接替换，当前确实解决该问题。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-3-20lesson</title>
      <link href="/2020/03/20/2020-3-20lesson/"/>
      <url>/2020/03/20/2020-3-20lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="gorm-参考使用"><a href="#gorm-参考使用" class="headerlink" title="gorm 参考使用"></a>gorm 参考使用</h3><p><a href="https://segmentfault.com/a/1190000013216540" target="_blank" rel="noopener">https://segmentfault.com/a/1190000013216540</a></p><p>启动mysql</p><p><code>docker run --name mysql -e MYSQL_ROOT_PASSWORD=123456 -p 3306:3306 mysql:5.7</code></p><p>如果Sequel Pro 连接报错<code>Authentication plugin &#39;caching_sha2_password&#39; cannot be loaded: dlopen(/usr/local/lib/plugin/caching_sha2_password.so, 2): image not found</code>, 则</p><p><code>docker exec -it mysql bash</code></p><p><code>$mysql -uroot -p</code></p><p><code>$ALTER USER &#39;root&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;</code></p><h3 id="goland-无法解析go-mod-的包"><a href="#goland-无法解析go-mod-的包" class="headerlink" title="goland 无法解析go.mod 的包"></a>goland 无法解析go.mod 的包</h3><p>开始建立一个go 项目， 使用go mod。一直都是OK的。然而在另一个机子导入、或者本机挪了个位置，就出现goland 无法识别第三方包的情况。</p><p>当前goland 第三方包或者go mod init xxx，使用 xxx/config 之类的也都全部无法识别。</p><p>找了半天看到<a href="https://learnku.com/go/t/35849" target="_blank" rel="noopener">帖子</a>中跟我描述一致，最后一个回复中，给出另一个链接<a href="https://segmentfault.com/q/1010000020603338/" target="_blank" rel="noopener">segmentfault</a><br>提到、而且截图和我情况一致。</p><p>下面回复点醒了我:</p><blockquote><p>如果是导入已有项目，记得启用下 Go Module，进入 Preference -&gt; Go -&gt; Go Modules，启用下就好。</p></blockquote><p>也就是说，导入、或者挪了位置，要启用。</p><p>可是当前我的已经启用了呀Go - Go Modules(vgo) - Enable Go Modules (vgo)integration</p><p>这个checkbox 本来就是加载的。</p><p>此时我关闭他，然后apply; 再然后checkbox 打开他，再apply，这时就全部正常了。</p><blockquote><p>家里的mac 又出现这种情况。解决方法是:</p><p>删除本地的.idea 文件夹; File-invalidate caches and restart; 然后重启电脑; 然后vgo 关闭再打开;</p><p>基本OK了吧。记得查看下GOPATH 设置</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> goland mod 爆红 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-3-12lesson</title>
      <link href="/2020/03/20/2020-3-12lesson/"/>
      <url>/2020/03/20/2020-3-12lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="华硕-GTX750-ti-NVIDIA-web-driver-黑屏问题"><a href="#华硕-GTX750-ti-NVIDIA-web-driver-黑屏问题" class="headerlink" title="华硕 GTX750/ti NVIDIA web driver 黑屏问题"></a>华硕 GTX750/ti NVIDIA web driver 黑屏问题</h1><p>这几天给丫头买了个显卡GTX750 觉得和以前一样很容易就整好了，没想到花了两个晚上加两个早晨找解决方案。</p><p>首先根据<a href="https://shaohung001.github.io/2018/10/31/2018-10-31lesson/" target="_blank" rel="noopener">我以前的记录 配置</a> 得到我要的web driver 是17G65 对应那个包, <a href="https://www.insanelymac.com/forum/topic/324195-nvidia-web-driver-updates-for-macos-high-sierra-update-08302018/" target="_blank" rel="noopener">下载地址</a></p><p>然后跟以前一样EFI/clover/config配置，然后NVIDIA 选择<code>NVIDIA Web Driver</code> 时，系统在clover 引导后，进入了系统，但是HDMI 没有信号，屏幕黑的。</p><p>系统确实进了，但是屏幕黑。我反复想和以前一样的做法，但是总是失败。直到: 在远景论坛一个帖子中看到，相同的显卡(华硕 GTX750 web driver 黑屏)，我敢肯定我有救了。</p><p>我直接从HDMI换成VGA 接口，同时NVIDIA Web Driver 选择对应选项。重启后，立马就好了。鸥买嘎，开心了。</p><p>还是要多看中文版的tonymac : 远景论坛</p><p>同时的，这里也有提到: <a href="https://osx.cx/heipingguo-nvidia-balck-screen-fix.html" target="_blank" rel="noopener">黑苹果社区</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> GTX750 </tag>
            
            <tag> hackintoshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-3-11lesson</title>
      <link href="/2020/03/11/2020-3-11lesson/"/>
      <url>/2020/03/11/2020-3-11lesson/</url>
      
        <content type="html"><![CDATA[<h2 id="最近VVVVVV-突然发现连不上"><a href="#最近VVVVVV-突然发现连不上" class="headerlink" title="最近VVVVVV 突然发现连不上"></a>最近VVVVVV 突然发现连不上</h2><p>突然发现连不上VVVVVV，正巧是丫头面试时间，可能要用到，赶紧找时间修下。</p><p>这几天又正巧给丫头买了个显卡，GTX750，老是无法识别该显卡，新下的NVIDIA web driver 不小心点了上面个按钮，得,系统进不去了。</p><p>想了下，给他系统全部重装好了，半夜搞到凌晨40分，好累，还没好。第二天起床赶紧搞起来。重新装了后，又不小心点了web driver 上面那个按钮，然后发现clover 界面时候到后面的option 按钮，进去后，在Graphic 取消选中 使用web driver就回去了。</p><p>中午最后还是木有识别成功GTX750，先来公司吧，开电驴最快速度来到公司。</p><p>解决了几个问题，在编排build 进程时，顺便搞下我的服务器吧。</p><p>首先nginx 无法启动问题: <code>lsof -i :80</code></p><p>发现caddy 这个程序占了？我都没发现这玩意，，算了，kill 之后就正常了。</p><p>然后试了下VVVVVV 还是无法连接，说明确定是证书问题，毕竟都正常运行着嘛，过年过来3个月了，估计也要renew acme 了。</p><p>不想整auto new acme，自己动手丰衣足食:</p><p>先给nginx 加个server:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name wpn.domain.com;</span><br><span class="line">  root /home/wwwroot/sCalc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了保证acme 能连接到该处得到认证的文件。</p><p>然后</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">alias acme.sh=~/.acme.sh/acme.sh # 给acme.sh 做个别名</span><br><span class="line"></span><br><span class="line">acme.sh --issue -d wpn.domain.com -w /home/wwwroot/sCalc</span><br><span class="line"></span><br><span class="line">cd ~/.acme.sh/</span><br><span class="line"></span><br><span class="line">mkdir -p /sslCert</span><br><span class="line"></span><br><span class="line">acme.sh --install-cert -d wpn.iahuang.com --key-file /sslCert/VVVVVV.key --fullchain-file /sslCert/VVVVVV.crt</span><br></pre></td></tr></table></figure><p>以上得到key 和crt 文件，在/sslCert 目录下。</p><p><code>mv /sslCert/* /etc/VVVVVV/</code> 将2个文件放到VVVVVV 目录下，然后重启nginx 即可。</p>]]></content>
      
      
      
        <tags>
            
            <tag> VVVVVV </tag>
            
            <tag> acme </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-3-10lesson</title>
      <link href="/2020/03/10/2020-3-10lesson/"/>
      <url>/2020/03/10/2020-3-10lesson/</url>
      
        <content type="html"><![CDATA[<h2 id="过年，最近一个月我一直看小说"><a href="#过年，最近一个月我一直看小说" class="headerlink" title="过年，最近一个月我一直看小说"></a>过年，最近一个月我一直看小说</h2><p>过年回家那天还下着小雨，又是一年回家。当时以为疫情不严重。丫头买了俩布口罩，还是一层那种。我很少戴口罩，米西米西把。俩人起早待在路口，老半天了都，就是打不到车，年年如此。</p><p>心里想着，可能来年都不愿意回去了，除非自己有车。因为，有可能，真的打不到车，高铁钱浪费掉不说，还回不去。加把劲把。老半天没车，心里急，真不知道路上来来回回那些司机都是怎么预约的，贵点也行啊。然后和丫头决定去前面大路试试，走到半路，一个大叔开着很小那种三轮。</p><p>我跟你说，当时我们都觉得，能出发就不错了，而且是运气超级好，刚刚十字路口也很多人等，司机大叔就把这机会留给俺们，哈哈。50走起。三轮一路冲啊，大叔冲红灯的时候那个左右观望的眼神，无情，冲啊。</p><p>安全到家。</p><p>这个年过得很长很长。从大年29到家，到元宵后才回上海。和阿黄玩了一个月了都。在家最大的事，就是逼着阿黄自己吃饭，不用一直追着喂，吃饭还看视频，最后饭都冷了还吃。</p><p>家里啥21世纪的工具都没有，只有手机一个。为了不落下功课，顺便把socks5 协议看了，然后用纸抄写一个翻墙的源码。嗯，回到公司给他整一下。</p><p>由于我把高铁车票凭证取了，之前买的回程(年年都买不到回程，就今年抢了1.31号回程，还取了凭证—还逗比的取出来了，你说是不是傻)得退票重新买之后的时间。查到永定可以退票，就骑着老爸的摩托车上了永定。</p><p>中午永定吃饭的时候，因为我没有摩托车驾照，怕过年有查车，我就走一段路，看没人查车，车子就骑一小段；然后走一路看没人再骑一段，然后才来到小饭店。</p><p>毕竟人不能被抓，车不能被扣，不能丢嘛，嘎嘎</p><p>过年前我写了个GO 的软件: <a href="https://github.com/shaohung001/novel_terminal" target="_blank" rel="noopener">novel_terminal</a></p><p>你懂的，写什么类型的东西就可能会被吸引进去。于是过年在家一直看爽文: 《斗罗大陆》，但是看到一半，失去了2刷刷完的劲头，看到一半感觉从书中获取不到灵感、感想，遂放弃。</p><p>因为2.1号开始，公司都开始远程上班了，家里一无所有，所有现代化工具都没有。我去了村子电脑维修店看看能不能配出来一个，配件不齐全, 又想着配起来家里又没人用；去找认识的人借电脑？他说被什么妹夫借走了；找找家里电脑，全是灰，开了机肯定用不了。</p><p>唉，算了算了，多呆了一星期，下周再不远程办公，说不定要扣工资咯，本来就低。</p><p>2.7、8号时，说有个同村的也做IT 的也工作在上海，说一起同行。我说可以呀，他家人开车到龙岩，那就太好了，然后2.8号又说他们公司推迟3.10号，这次不去了。那没办法了，只能又联系蛮舅了。</p><p>之前联系蛮舅知道他还没回深圳，说有那个一起去上海就跟蛮舅说不用麻烦蛮舅了。毕竟这个特殊时期。但是，然后现在还是得麻烦亲人，不然班车都不开了，请人载上龙岩，肯定500软妹币才出发。</p><p>2.9号那天早上，为了响应上级号召，封锁更严厉。之前我们省道还没有检查站设立，今天开始了出乡就隔离14天。蛮舅就说去他自己娘家，我和丫头拉着行李出发去村头和蛮舅碰头。</p><p>村头的桥都用大石头堵着。</p><p>老妈领着阿黄送我们，还是得离开。不离开，不赚钱，怎么完成心中的理想。一路上还算顺利，直达龙岩火车站。蛮舅也回去了，还算顺利。</p><p>我和丫头在车站外呆了好一会，然后拿出老妈早上做的蛋炒饭，很好吃，就是有点咸。车站外没坐的，和丫头一口一口吃着。然后站着酸，丫头又内急，进站后，两人躲在偏远的角落，怕被传染。</p><p>车子临近时，做到了候车位置。还别说，配备的按摩凳，丫头那个时不时会动一动，免费享受，还挺舒服。上车时，车子座位基本是隔着坐，人不多。</p><p>到了虹桥，就是扫手机短信看行程。然后各种扫二维码。到小区，登记。</p><p>第二天用昨天用的口罩，下楼买一堆的吃的，还有饮用水，然后进行了长达好久好久的宅家。</p><p>由于想重启小说，改了几个bug后，哎，不小心，看起来我高一时候看的一本小说：《神墓》，直到今天3.9 才看完。我是看的比较仔细的，而且一直执念般的看完了。</p><p>点评下《神墓》:</p><p>神墓的构造前后贯通是比较好的，全书都围绕由墓而生的主角，全书贯穿各种墓，中间主人公发展，然后到之后小六道、回到历史中时，才知道【天】这一虚拟口头被描述成实体的形象，这点厉害。然后又提到了混沌，才慢慢知道作者设定的多个天灭众生的多次灭杀行动。最后各人战上九天。前期都是写的蛮好，主人公菜逼的时候，来来回回搞，而且思路也不死，任务都有自己特色，不会死板。比如梦可儿为了结果主人公，都是绞尽奶汁付诸行动，没结果无所谓，真的绞尽x汁了。我都为她感动。</p><p>该书在刻画人物方面也有独到之处，比如”欧米头发”、”一百遍啊一百遍”这样的。当然，这同时也是该书不够的地方，全书唯有这两个刻画出生动效果，但是作者没有深入使用，比如”欧米头发”，人物刻画出来了，没有了，看完之后，没有了。”只有一百遍啊一百遍”能够再次回想，内心淫荡一笑。</p><p>红楼梦是我喜欢的名著，人物刻画、贯通方面是神墓要着重要点，可以借鉴借鉴。当然我作为刚读完神墓，要求不能太高。什么神墓早期写的，什么你非要拿震古烁今的四大名著来和爽文比。</p><p>这不是在刚读完后，为这小说遗憾嘛。</p><p>就当是爽文，有时闹书荒的时候，也想找更好更好的书不。</p><p>神墓全书有不连贯的地方，我猜作者有让他人代笔，或者，当时作者构思出问题，出现了主角瞬间性格大变、思想大变的过度。比如早期主角还是努力奋斗的勤劳小伙子，在早期出现和对手突然就整起了搞笑痞子风格。那个篇章很生硬。</p><p>还有就是各种大关系都和主角有关，不过这确实是爽文的特点(红楼梦也有这特点，谁人不想做宝玉啊，但红楼梦主旨、思想背景和爽文不同)，然后突然大战，突然就升级，这小子升级也忒快了吧；各种道具，还只能主角用；升级完基本就能跟对头干，不行就再加个宠物加个道具对着干，实在不行，再加个血脉、加个远古道具保命。</p><p>这，爽文，理解理解。</p><p>总的来说，神墓在场景(全书各种场地、场景刻画)、道具、和漂亮女人们的摩擦、打斗转换、各种绝境描绘、各种探险、前后埋疑点、主角衰及盛盛及衰、文笔、脉络都能通，值得一看，你看，2刷的我看完还推荐，very ok。</p><p>plus，还是定义为爽文，不要太在意为啥主角每次都能装逼，爽完就过。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 2020过年 </tag>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-3-2lesson</title>
      <link href="/2020/03/02/2020-3-2lesson/"/>
      <url>/2020/03/02/2020-3-2lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="Go、Go、Go"><a href="#Go、Go、Go" class="headerlink" title="Go、Go、Go"></a>Go、Go、Go</h1><h2 id="nodejs-child-process-出现Stdout-buffer-issue-using-node-child-process"><a href="#nodejs-child-process-出现Stdout-buffer-issue-using-node-child-process" class="headerlink" title="nodejs child_process 出现Stdout buffer issue using node child_process"></a>nodejs child_process 出现<code>Stdout buffer issue using node child_process</code></h2><p>使用child_process exec unzip.exe 出现解压缩包失败，全部文件错误字符打印了出来。</p><p>由于child_process 默认maxBuffer 是200KB，出现直接报<code>Stdout buffer issue using node child_process</code>。</p><p>可以使用<code>exec(command, {maxBuffer: 1024 * 500})</code></p><h2 id="go-build"><a href="#go-build" class="headerlink" title="go build"></a>go build</h2><p>1、Mac下编译Linux, Windows平台的64位可执行程序：</p><pre><code>$ CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build test.go$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go</code></pre><p>2、Linux下编译Mac, Windows平台的64位可执行程序：</p><pre><code>$ CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build test.go$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go</code></pre><p>3、Windows下编译Mac, Linux平台的64位可执行程序：</p><pre><code>$ SET CGO_ENABLED=0 SET GOOS=darwin3 SET GOARCH=amd64 go build test.go$ SET CGO_ENABLED=0 SET GOOS=linux SET GOARCH=amd64 go build test.go</code></pre><p>或者:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">export GOOS=&quot;windows&quot;</span><br><span class="line">go build -o phoneix-windows.exe</span><br><span class="line"></span><br><span class="line">export GOOS=&quot;linux&quot;</span><br><span class="line">go build -o phoneix-linux</span><br><span class="line"></span><br><span class="line">export GOOS=&quot;darwin&quot;</span><br><span class="line">go build -o phoneix-darwin</span><br><span class="line"></span><br><span class="line">echo &quot;done!&quot;</span><br></pre></td></tr></table></figure><h2 id="golang-交叉斌编译CGO"><a href="#golang-交叉斌编译CGO" class="headerlink" title="golang 交叉斌编译CGO"></a>golang 交叉斌编译CGO</h2><p>当前使用<code>go-sqlite3</code> 库，无法直接Mac 打包成windows，报错: <code>Binary was compiled with &#39;CGO_ENABLED=0&#39;, go-sqlite3 requires cgo to work. This is a stub</code></p><p>当前看到两篇文章使用两种方案:</p><ol><li><p>使用docker 打包</p><pre><code>docker run --rm -v $GOPATH:/go golang:1.13 bash -c &apos;cd $GOPATH/src/ahuang.com/src/cobra/novel &amp;&amp; CGO_ENABLE=1 GOOS=linux GOARCH=amd64 go build -o novel-linux&apos;</code></pre></li></ol><p><a href="https://blog.csdn.net/Maggie_up/article/details/83821386" target="_blank" rel="noopener">链接</a></p><ol start="2"><li>brew 安装cross gcc 来打包</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Windows平台(mingw-w64)</span><br><span class="line">$ brew install mingw-w64</span><br><span class="line">$ CGO_ENABLED=1 GOOS=windows GOARCH=amd64 CC=x86_64-w64-mingw32-gcc go build -v</span><br><span class="line"></span><br><span class="line">Linux平台(x86_64-linux-musl-gcc)</span><br><span class="line">$ brew install FiloSottile/musl-cross/musl-cross</span><br><span class="line">$ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CGO_LDFLAGS=&quot;-static&quot; go build -a -v</span><br><span class="line"></span><br><span class="line">-a: 重新编译</span><br><span class="line">-static 标识静态链接，没有这个选项，linux上运行报: -bash: ./xxx: /lib/ld-musl-x86_64.so.1:bad ELF interpreter: No such file or directory</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/henly1217/article/details/102551251" target="_blank" rel="noopener">参考链接</a></p><h2 id="开源-novel-terminal"><a href="#开源-novel-terminal" class="headerlink" title="开源 novel_terminal"></a>开源 novel_terminal</h2><p>开源了<a href="https://github.com/shaohung001/novel_terminal" target="_blank" rel="noopener">novel_terminal</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-1-2lesson</title>
      <link href="/2020/01/03/2020-1-3lesson/"/>
      <url>/2020/01/03/2020-1-3lesson/</url>
      
        <content type="html"><![CDATA[<h2 id="Mac环境变量设置"><a href="#Mac环境变量设置" class="headerlink" title="Mac环境变量设置"></a>Mac环境变量设置</h2><h2 id="VSCode-使用gopls-更好的代码补全"><a href="#VSCode-使用gopls-更好的代码补全" class="headerlink" title="VSCode 使用gopls 更好的代码补全"></a>VSCode 使用gopls 更好的代码补全</h2><p>打开 VS Code 的设置, 搜索 go.useLanguageServe, 并勾选上.<br>默认情况下, Go 扩展会提示你安装 gopls.</p><h2 id="卸载k3s"><a href="#卸载k3s" class="headerlink" title="卸载k3s"></a>卸载k3s</h2><pre><code>/usr/local/bin/k3s-uninstall.sh</code></pre><p><a href="https://github.com/GcsSloop/MacDeveloper/blob/master/Skill/Path.md" target="_blank" rel="noopener">https://github.com/GcsSloop/MacDeveloper/blob/master/Skill/Path.md</a></p><h2 id="2020年来了-2020-1-3"><a href="#2020年来了-2020-1-3" class="headerlink" title="2020年来了 2020/1/3"></a>2020年来了 2020/1/3</h2><p>2019年的规划</p><ol><li><p>上半年加油找后台的工作，在6月、7月前熟悉完；</p></li><li><p>工作之余 9月、10月之前写一款游戏；</p></li><li><p>工作之余 学习完openGL</p></li></ol><p>我去19年新年前, 面试过一家，当时还是太不熟悉，机试时没做好。不过我却熟悉了nodejs 面试流程。在开年，2月份多去《弘连》专做软件及知识产权的公司面试。1面是人事，我的简历难看就是其中有个公司3个月就跳槽，而且这几年变动有点大。是的，没得办法，总要生存，社保不能断。2面是伟哥，也就是现在的老大。我们进行了友好的会晤，哈哈，基本都是聊聊自己的职业规划，工资方面。</p><p>因为是转职能，几乎等于重新开始，所以我要价很低，打过折之后一开始简直非常低。过两个月，老板把我喊过去，主动加工资，幸好。</p><p>离开《冠脉弹》前, 他们想着我要走，加班让我做多点。其实我都知道，那点东西，做出来又是垃圾，没经过思考的产品，没思想没深度。不过我是打工的，加班拿工资吧。当时我想把丫头拉到这公司，虽说种种不好，不过想着工资照发、也不太加班加点(因为他们整不出什么好思想)，所以给老板推荐。最后加班3.5 号之前都是和丫头一起加的。3.6号入职《弘连》。</p><p>上半年熟悉web 开发，到5月份时，经常加班学习，总算把web 开发整体流程都走通。公司的后台使用coffeeScript+vue，我学习使用typescript+vue 写了几个对应服务(saas 微服务)。中旬时，把驾照也考过，但是没车，还是挺蛋疼，鸡肋的。</p><p>上半年还挺顺利，学习进度很快，于是顺手写一个游戏吧。但是搞了搞，没有好思路，算了，再等等，缓一缓。</p><p>年中时，老大想把公司主力产品&lt;网镜&gt; 从以前全套C艹 版本更新新的架构，使用nodejs 做中间转换。当时老大和老板应该是一起协商过的，再招一个熟练的?我专做web后台?</p><p>老大想着web 也不是天天开发，然后我就负责网镜拓展后台，做的流程控制服务，从无到有做两个拓展，包括直接打包，而且是Chrome 扩展类，市面没有好的参考、库等。</p><p>做这个, 打算是在9月、10月做完。但是我太菜，模子做出来，功能也有，不够好用，继续改。而且中间和同事配合还不够默契，有时等待他的api、调api、重写等。事无巨细，把大功能完成，已经到了19年12月。网镜5.0 终于终于对外发布了。刚发布的5.0 还有很多bug，赶紧准备5.0.1 的发布，加班加点。</p><p>当前测试用例也是比较难增加，所以全靠测试人员：有时改动一个功能了，却影响了另一个；有时完成一个功能了，感觉和V4 的不一样；轮训任务，出现任务不走了；内存、CPU、暴涨；文件夹创建不对(路径解析不对)；数据库索引、调优；代码规范；等等等等</p><p>将5.0 发布出来的时候，瞬间就理解了一个新高度，瞬间圆满了。以前没走通的思路都理解作用及原理。</p><p>老大作为架构者，确实思想是我目前不能比拟的，太强了。</p><p>不过我从老大这学了很多很多，这一波经验涨的厉害。</p><p>下半年几乎都是在搞网镜。周末有时搞搞网镜，有时学学golang，我觉得这个还是不错的，goroutine将现成队列给你，相当于最底层调度给到你。而不是nodejs async await，虽然好用，却是迷迷糊糊。而且golang 和OC 很相似，有内存、指针，我感觉这个是我要的，于是顺便用go 转义了我之前一个挺好的服务作为学习的实例。</p><p>说说丫头吧。去年丫头心情低落，今年上半年到5月，也就进去《冠脉弹》两月就被辞职了。算了，无所谓了，他们也就那样了，不是咱宝宝不好。然后我说，要不学学nodejs 做web。丫头说，再等等。我说行，给3个月让她学习和我后台做了一个理财的iOS app。原理类似于《可萌记账》，主要是作为学习用，同时让丫头接触数据库，这样即使之后她要进入后台，也很有感悟。接着她去一家创业公司，得，还是不给力。不过别人工资经常不发的情况下，丫头的还是照常发，然后，最后我还是让丫头辞职了。</p><p>我指出了这些问题背后的原因：iOS 工作机会进入凛冬了。要不就特别好的iOS 工作，要不就巨差的，中间这种基本都没了。丫头就是这种上不去下不来那种，毕竟不是超级专业，尚在学习进阶的。于是我鼓励她，来吧，做我的儿子吧！不对不对，，咳咳。来吧，跟我一起web 开发吧，有问题我罩着你。</p><p>10月份，老丈人去医院，丫头基本是11月开始学web开发。先让她搞爬虫，知道js能干嘛。然后做一个Typescript纯后台，知道js 和Typescript关系。该后台包括了fs、mongo、oss上传文件。然后再让她做一个我之前留下的video 前后台项目，知道前端和后端的关系。这些都是练手。然后最后让她做一个blog。</p><p>blog 是一个好东西，能练习很多东西，基本是她一个人在搞，有遇到特殊问题、发布之类我稍稍做点辅助。呐，现在服务器登录都是她在弄，我都不用动手了。这几天她刚好完成测试，就要发布了。</p><p>这两年用铁通宽带太坑，两年800，网络慢的跟金坷垃一样。由于经常丫头在家，这几天网络换成联通的，720两年+100上门调试费，命都更长久了。之前下的种子从来都不动一下的, 现在, chua chua chua下好了。我看来又可以在家里写东西了。哇卡卡卡卡</p><p>2019 很苦，不过2020 我还在努力。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-12-26lesson.md</title>
      <link href="/2019/12/26/2019-12-26lesson/"/>
      <url>/2019/12/26/2019-12-26lesson/</url>
      
        <content type="html"><![CDATA[<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><h3 id="简单post"><a href="#简单post" class="headerlink" title="简单post"></a>简单post</h3><p><a href="https://blog.csdn.net/freedomwjx/article/details/43278157" target="_blank" rel="noopener">参考</a></p><pre><code>curl -d &quot;key=value&amp;key=value&quot; http://localhost:3000</code></pre><p>如果登录后网页被重定向, 而我们想追踪这个重定向可以加上-L</p><pre><code>curl -L -d &quot;key=value&quot; http://localhost:3000</code></pre><h3 id="登录时保存cookie、请求时发送cookie"><a href="#登录时保存cookie、请求时发送cookie" class="headerlink" title="登录时保存cookie、请求时发送cookie"></a>登录时保存cookie、请求时发送cookie</h3><ol><li><p>登录得到cookie 同时保存cookie 至一个文本中: -c savepath</p><p> curl -c cookie.txt -d “key=value” url</p></li><li><p>携带信息请求: -b savepath</p><p> curl -b cookie.txt url</p></li></ol><h3 id="模拟表单上传"><a href="#模拟表单上传" class="headerlink" title="模拟表单上传"></a>模拟表单上传</h3><pre><code>curl -F &quot;media=@hellocurl.zip&quot; &quot;media=@hellocurl1.zip&quot; &quot;file=@hellocurl2.zip&quot; http://localhost:3000</code></pre><p>如果还携带参数:</p><pre><code>curl -F &quot;media=@hellocurl.zip&quot; -F &quot;key=value&quot;curl -X PUT -F &quot;url=www.baidu.com10&quot; -F &quot;time=1212&quot; -F &quot;content=dfdfdf&quot; -F &quot;title=oooooo&quot; -F &quot;username=aker&quot; -F &quot;html=@/Users/aker/Desktop/22.html&quot;  http://localhost:3000</code></pre><h3 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h3><p>-v: 查看请求的整个完整过程</p><p>-i: 查看请求头信息</p><p>-o: 保存相应结果到指定路径的文件中.e.g. curl -o tmp.txt <a href="http://www.csdn.net" target="_blank" rel="noopener">http://www.csdn.net</a></p><h2 id="ts-node-断点调试"><a href="#ts-node-断点调试" class="headerlink" title="ts-node 断点调试"></a>ts-node 断点调试</h2><p><a href="https://segmentfault.com/a/1190000010605261" target="_blank" rel="noopener">参考</a></p><p>launch.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"启动程序"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [<span class="string">"$&#123;workspaceFolder&#125;/src/index.ts"</span>],</span><br><span class="line">      <span class="attr">"runtimeArgs"</span>: [<span class="string">"-r"</span>, <span class="string">"ts-node/register"</span>],</span><br><span class="line">      <span class="attr">"internalConsoleOptions"</span>: <span class="string">"openOnSessionStart"</span>,</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"inspector"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="国庆的需求"><a href="#国庆的需求" class="headerlink" title="国庆的需求"></a>国庆的需求</h1><p>爬github 的</p><ol><li><strong>关键字</strong>(如 go)搜索数据</li><li>根据sort 条件BestMatch == 0/MostStars == 1/RecentlyUpdated == 2 排序</li><li>拉取前10页数据</li><li>爬下来之后，将文件写入本地文件:/src/package/<strong>关键字</strong>+” “ + “2” + “ “ + “第x页.csv”。(如：go 2 第1页.csv， 2就是你使用的排序规则)</li><li>每个条目格式:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title,url,content,starNum,category,time</span><br><span class="line">golang/go,https://github.com/golang/go,The Go programming language,63.9k,Go,Updated 1 hour ago</span><br><span class="line">datasciencemasters/go,https://github.com/datasciencemasters/go,The Open Source Data Science Masters,13.3k,null,Updated on 25 Jun</span><br></pre></td></tr></table></figure><p>csv 第一行是每个column，中间用”,”分开.</p><p>下一行开始就是各个数据，依次填写。无的话填”null”.</p><h1 id="学习golang"><a href="#学习golang" class="headerlink" title="学习golang"></a>学习golang</h1><p>golang 刚开始学习和node 舒服程度不一样, go 还需要配置环境。</p><p>我先记录一些，而且可能还有不正确的地方，往后有机会回头修正。</p><p>首先<a href="https://golang.org/dl/" target="_blank" rel="noopener">下载golang</a> 这里下载特别慢。</p><p>我是去golang.cn.dl 下载，同时使用wget 下，特别快！</p><p><code>wget https://dl.google.cn/go/go1.13.1.darwin-amd64.tar.gz</code></p><p><code>tar -C /usr/local -zxvf go1.13.1.darwin-amd64.tar.gz</code></p><p><code>vim ~/.profile</code></p><p>添加以下到<code>~/.profile</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export GOROOT=/usr/local/go # 代表go程序环境位置</span><br><span class="line">export PATH=$PATH:$GOROOT/bin # 将go 执行文件加入到PATH 中</span><br><span class="line">export GOPATH=$HOME/gowork # 指定go 开发目录</span><br><span class="line">export PATH=$PATH:$GOPATH/bin</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> go proxy</span><br><span class="line">export GO111MODULE=on</span><br><span class="line">export GOPROXY=https://goproxy.io</span><br></pre></td></tr></table></figure><p><code>source ~/.profile</code> // iTerm2 环境也一起有了</p><p><code>go mod init demo &amp;&amp; echo $GOPATH &amp;&amp; cd $GOPATH</code></p><h3 id="renew-ssl-manually"><a href="#renew-ssl-manually" class="headerlink" title="renew ssl manually"></a>renew ssl manually</h3><pre><code>acme.sh --issue -d wpn.iahuang.com -w /home/wwwroot/sCalccd ~/.acme.sh/mkdir -p /sslCertacme.sh --install-cert -d wpn.iahuang.com --key-file /sslCert/VVVVVV.key --fullchain-file /sslCert/VVVVVV.crt --reloadcmd &quot;systemctl restart nginx&quot;然后完成了.</code></pre><h3 id="github-的静态网页-添加adsense-总是失败"><a href="#github-的静态网页-添加adsense-总是失败" class="headerlink" title="github 的静态网页 添加adsense 总是失败"></a>github 的静态网页 添加adsense 总是失败</h3><p>之前使用亲人账号adsense 放了广告，嫌麻烦想使用自己的账号。但是老是报<strong>有价值的广告资源:没有内容</strong>.</p><p>不会啊，网页、手机端都是显示的。</p><p>之后查了下，有篇内容说到: 如果之前有账号绑定,需要先注销才能使用新的。</p><p>然后登陆亲人账号，把对应的id 填写进去后，就正常了。</p><h3 id="go-vscode-debug"><a href="#go-vscode-debug" class="headerlink" title="go vscode debug"></a>go vscode debug</h3><p><a href="https://segmentfault.com/a/1190000018671207" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018671207</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">  &quot;configurations&quot;: [&#123;</span><br><span class="line">      &quot;name&quot;: &quot;Launch&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;go&quot;,</span><br><span class="line">      &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">      &quot;mode&quot;: &quot;auto&quot;,</span><br><span class="line">      &quot;program&quot;: &quot;$&#123;fileDirname&#125;&quot;,</span><br><span class="line">      &quot;env&quot;: &#123;&#125;,</span><br><span class="line">      &quot;args&quot;: []</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="新的需求"><a href="#新的需求" class="headerlink" title="新的需求"></a>新的需求</h2><p>我有个朋友系列。</p><p>他很喜欢漫画，但是看腾讯漫画的时候，要一层层的点击，最后才知道最新的漫画出来没有。</p><p>现在你要做:</p><ol><li><code>/comic/comicInfo/:cId/:page</code></li></ol><p>采用<strong>尸兄</strong>漫画地址: <a href="https://ac.qq.com/Comic/ComicInfo/id/17114" target="_blank" rel="noopener">https://ac.qq.com/Comic/ComicInfo/id/17114</a> 为他展示所有的章节</p><p>比如他调用了 <a href="http://localhost:9999/comic/comicInfo/17114/page" target="_blank" rel="noopener">http://localhost:9999/comic/comicInfo/17114/page</a> (page=<code>[01234567890]{1,3}</code>||page = null)</p><p>你即去查本地数据库是否有数据；</p><p>没有的话:<a href="https://ac.qq.com" target="_blank" rel="noopener">腾讯漫画</a> 将<strong>尸兄</strong>的所有章节拿下来，存数据库，返回他对应要的章节的20个块</p><p>(比如总章节478，用户调用了 <a href="http://localhost:9999/comic/comicInfo/17114/4" target="_blank" rel="noopener">http://localhost:9999/comic/comicInfo/17114/4</a> ,那请返回<strong>尸兄</strong>的第60~80章节)。</p><ol start="2"><li><code>/comic/comicDetail/:cId/:cdId</code></li></ol><p>用户调用了 <a href="http://localhost:9999/comic/comicDetail/17114/84" target="_blank" rel="noopener">http://localhost:9999/comic/comicDetail/17114/84</a></p><p>说明用户想看某章节漫画了</p><p>你即去查本地数据库是否有数据；</p><p>没有的话:那就查询那章节对应的网页地址，使用axios 将其下载下来。同时使用cheerio 将里面[核心观看的html] 拿下来保存到本地，组装成新的网页，发送给用户该新的页面；同时下载里面所有的图片为本地图片（替换[核心观看的html]），然后上传本地资源到OSS(替换[核心观看的html])</p><h2 id="记录修改coffeeScript-await-is-not-defined-报错"><a href="#记录修改coffeeScript-await-is-not-defined-报错" class="headerlink" title="记录修改coffeeScript await is not defined 报错"></a>记录修改coffeeScript <code>await is not defined</code> 报错</h2><p>代码中使用官网推荐的await 语法。但是打包的时候总是失败<code>await is not defined</code></p><p>查看其他同样项目使用的coffeeScript 都没有使用await 语法，所以当前对比不出来。</p><p>同时相同的结构，本地运行没有问题，打包有dist 目录代码由问题；同时打包的之后，本地的代码又有问题了。</p><p>这时查看了下转义的代码: <code>await</code> 语法糖 变成了方法调用其他对象了: <code>await(xxxx)</code>。</p><p>怎么会这样，查找coffee 仓库之前不理解的现在理解了：肯定是转义的库本地太低的原因。</p><p>然后找到gulp-coffee，其版本升为<code>3.0.0</code> 之后果然就解决了这个问题了~</p><p>白白浪费我3个小时。</p><h2 id="js-setInterval-的坑"><a href="#js-setInterval-的坑" class="headerlink" title="js setInterval 的坑"></a>js setInterval 的坑</h2><p>如果setInterval 调用方法 是一个异步，多个io 操作的方法，可能出现CPU 被大量占用的情况下，导致调用方法会进入多次。</p><p>比如【网镜】在轮训任务时，做了一系列的操作，好多次io，可能已经过了1s。这时又进入interval，导致有些轮训操作同时进行了(当时的反应是CPU、内存升高，毕竟页面多load 一次，且没有去释放)</p><p>解决方案：</p><ol><li><p>setInterval 调用方法完成时设置一个Boolean 变量标识。如果要进入调用方法，Boolean 标识不对，return</p></li><li><p>使用setTimeout， 调用方法完成时，才开始下一个调用方法</p></li></ol><h2 id="新的修改要求"><a href="#新的修改要求" class="headerlink" title="新的修改要求"></a>新的修改要求</h2><p>首页增加一个总入口: 【学习】</p><p>学习类目下，分为【博客】、【编程】、【论坛】section分类。</p><ol><li><p>博客 section 分类点击展开【美团技术团队】、【LaTeX】</p></li><li><p>编程 section 分类点击展示【掘金】、【开发者头条】、【技术头条】</p></li><li><p>论坛 section 分类点击展开 【V2EX】、【Dcard】、【看雪】</p></li></ol><p>以及点击进去的内页</p><h2 id="记2019-11-16-团建活动"><a href="#记2019-11-16-团建活动" class="headerlink" title="记2019/11/16 团建活动"></a>记2019/11/16 团建活动</h2><p>上周已经确定，在16号大家一起约一下去搞个团建。节点刚好是我们组的4个产品都完成，刚好火眼组也是节点，就一起去玩。选的不远不近，大部分同学都刚好，有几个哥们实在太远或者有事，便没有一起。</p><p>我手上的产品，本也应这周做完，然而上周增加几个需求、修改之前的几个完成思路不对的功能、完成某个麻烦的功能，时间到了周五却还是没能及时，不过我真的尽力了，哈哈。我的习惯是，尽量争取时间学习，不管如果都要学各种各样的玩意。为了手上的产品，这几个月全力冲刺，心里完全想着给他整的尽善尽美。</p><p>周五那天紧赶慢赶还是未能完成，心里急忙，但尽力也无遗憾。然后那天开OKR 会时，喝了杯咖啡奶茶，然后整个人都懵了。开会内容大家讨论进度，我的进度也是OK，只能下周好好完成来。开完会，我点了公司晚饭，然后饭没了(去晚了有时饭就被拿了，因为有时有同学让别人帮忙点，有时忘勾选，晚上却还是拿饭吃了，没事没事，下次去早点好了)，那就早点回家吃吧。回去顺便送学弟回家，他说迷迷糊糊，身体不舒服。</p><p>当晚回家吃饭，然而整个人开始极度萎靡，草草吃了兰州拉面就回房间。立马开全家集体视频，因为整个人极度不好，呼吸不过来，我感觉我要死了，赶紧想看看我的家人们。坐在凳子上好久，才缓过来一丢丢精神，打个一局游戏缓解下。一局下来就是12点了，赶紧睡觉，第二天，还是要去团建。</p><p>晚上睡的时候，整个人很冷，手在发抖，脑子一直滞胀，很难入睡。能偶尔感受到突然来得困意，赶紧抓住那种感觉，浅浅眯上一会。一晚就这么过去了，一会浅睡一会醒转，睡得很浅，起身还是满身疲惫。</p><p>上午吃了个早点，11点出发。从古美路到上海辰山植物园，骑着电驴！</p><p>满电的电驴骑了30+x 公里终于到达目的地，这时已经是12点45了，1点集合。想到晚上还要走30公里，电驴受不了，听得3号门有充电，赶紧屁颠屁颠骑过去。发现居然是免费充电，美滋滋，然后当天大太阳走回了1号门，大概800多米。</p><p>集合时，伟哥几人拎着个大箱子，里面是之前准备的零食和活动器具。大家入园，我都是一路帮忙扛箱子，进去出来。路上大家帮忙拿箱子的东西，只剩空箱子，他们准备丢掉，我说别丢，等会说不定有用处。果然，用来集纳物品太好用了。</p><p>我们一群18人在入口往左走，来到一个湖旁边空地。开始进行此次的活动啦。</p><p>首先大家都是很多也都是不太熟悉的，于是先有个叫破冰行动。大家围成一圈，各自介绍自己的名字。然后小橙子掏出几个毛绒玩偶，让大家投掷玩偶到对方能叫名字的。我最难的事就是记人名。我忙朝着认识的几个同伴将刚丢过来的玩偶反丢回去。接着，小橙子将二组的最新进来的同学，叫所有同伴的名字，输了就抽签，做任务；接着一组也有几人进行一一识别，输了少喊几人名字就做多几个任务。我幸好躲过啊，我记名字简直是噩梦，即使我很努力记了。可能人比较蠢吧。</p><p>接下来我们分好队，有红队、蓝队、黄队，穿上小马甲区分，我是红队。同时起好队名，我们叫”随便队”。</p><p>首先第一场是 “我爱你，不要脸”。</p><p>规则是可以对左边说我爱你，对右边说不要脸，但是对话最多只能三次。然后一大帮男生，最后只剩下唯三个女生(小橙子做裁判没参与)。女生感情方面果然是天生的。最后剩下的两位使用猜拳头方式决出胜负。最后我们对胜出，得到重量级选手”春哥一位”(他最后才赶到)。</p><p>第二场是 传面粉，看最后杯里的面粉谁最多获胜</p><p>红队最先，首先春哥把面粉传给我，大家嘴上叼着一个卡片，我再把面粉传给下一位，然后下一个再放到杯子里。传两轮。<br>然后别的队伍居然有游戏黑洞，笑场了，少了很多面粉，就这样赢了、、、奖品是一份零食大礼包</p><p>第三场是屏幕露脸</p><p>大家在倒数时间在镜头露脸。镜头会左右，上下，可以遮挡对方的脸。最后露脸的多，几场下来赢得获胜。比较逗的时，伟哥被挤到最后面去了，居然跳的老高，隔了4排还露脸了。我作为中锋，在最前排卡位，然后收效甚微。这场黄队第一，获得零食大礼包一份。</p><p>第四场 是组合游戏: 第一人原地转10圈，然后跑到对面取得跳绳回来，第二名队员跳绳20下，第三名队员拉着袋鼠跳袋子跳到对面取得气球回来，第四名队员赶紧吹气球，然后跟第三名用肚子压破，然后第五名队员腰间绑着装着球的盒子，让球全都从一个孔里面出来，就完成了。</p><p>讲解的时候，小橙子把绳子放到对面不远处，我说我去看着。然后讲解的时候，我想，我可能等会也会参与，于是拎着个跳绳就过来了聚精会神听着。然后听完转头回去，咦原来地上其他两根跳绳不见了。估计被扫地阿姨拿走了，这真的是拿！算是偷。当时我正要过去听讲时，确实身边有俩扫地阿姨。大家稍微附近问了问，找了找，没得。算了，活动还在进行，幸好我手上还有一根，算是庆幸。由于活动需要5人，有俩队人数有6人，我被分派管理随身物品，另一人管理跳绳和气球。</p><p>红队已经巨快的完成了，没想到还有更快的蓝队。蓝队中间拿到跳绳时，跳绳打结，花了4、5s。但是看绳子、气球的是他们队友，在前往对面获取物品时，别的队伍都是弯腰，他们是抬高高拿着就走，哈哈。多争取了几秒，不过他们确实快了写，特别是最后喜顺在将盒子的球抖出来的速度取得了巨大优势。（黄队由于上一局第一，在抖出球时，速度太慢，他们队友把抖球队友的腿抓起来帮忙，抖球队友是俯卧撑姿势，这就很像推车了，然后收效还是甚微，输了）</p><p>接下来是自由时间，同时还有一个任务，就是撕名牌。以个人为单位。我们先把物品搬回到入口处附近，那里刚好有很大个草坪。小橙子在那里看着物品，等大家回来。大家自由活动，我们队大家结队去玩，往右走。这一队里，大家都放心把背后留给队友。</p><p>大家往右边走去(其实是反方向旅游)，看了看周围植物景观，走了好远的路，还经过石头镇，绕回来经过小树林来到上观景台山脚。大家一起说说生活，讨论讨论未来。伟哥说他老婆是不太鼓励他在上海，太贵了，他们已经在老家(济南)全款一套；春哥在老家(武汉)一套，租的话也不是特别理想(毕竟新房给人住，上海租房还得垫钱，比如武汉2000租金，上海随便租也得2500左右了)。我说老房子其实也是还是可以的，稍微小点，可以稳当点留下来。女生说，不如郊区点，位置大点，如果有家人、孩子，厅还可以做做运动。伟哥说，老房子，价格不那么高的，基本都是很早年建的，基本没有停车位，车子停哪都不是，绝对不考虑，难道车子停马路边啊(非常同意，不过相对于米不够的情况，估计车子都没有，哈哈)；另一方面前期能咬牙买2室的，一定尽可能蹭一蹭，不然到时置换就很难了，毕竟70%首付。</p><p>也聊了聊老婆、老婆个数。嘿嘿，，，我想。。。不，你不想，，，</p><p>然后大家找了条上山的路，然后很陡，猜是下山路没错了。路上听得一阿姨说，今天怎么了，遇到传蓝马甲的，现在又有红马甲的。喔，我闻到了蓝队的气息，在山顶没错了。</p><p>大家上得小山坡顶，就见到4个蓝队，本着和平共处原则，他们也待一会下山了。山顶没啥，就一小塔，小塔关着门。休息了会，咦，来了俩黄队的，不过放过他们了，我们这队6人，他们压力很大呀。观景台能看到的，其实就是矿坑，被挖了好大一个坑，下面的水都是黑色的了。中间有个木桥，不过中心处断了，于是那处也进不去了。</p><p>下山的时候也是一下就到了。时间也差不多，就都往入口方向走去了。</p><p>回到集合地点，先吃零食，中午就吃个小饼干，饿得很。接着边上有个大草坪，于是就真的开始撕起铭牌来啦。我胖的都跑不动了，指甲忘记剪短，导致还受伤了，最后弃权，嘿嘿。</p><p>晚上大家去附近一个地点吃，出发的时候，伟哥带了我一程，我走过去景区另一出口有点远，然后他又反向开去了。</p><p>车子充的饱饱的，晚上那么远，骑了好久好久终于回到了熟悉的路段，外边冷，家里暖。</p><p>头很晕的回来，早早睡觉，才知道喝的奶茶相当于4杯咖啡提神量，不怎么喝咖啡的人，一口气喝那么多，确实懵逼了。</p><p>第二天睡一觉，好很多了，原来我还没有挂，嘎嘎。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-10lesson</title>
      <link href="/2019/09/13/2019-6-10lesson/"/>
      <url>/2019/09/13/2019-6-10lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="docker-mongo-dump-restore"><a href="#docker-mongo-dump-restore" class="headerlink" title="docker mongo dump restore"></a>docker mongo dump restore</h1><h2 id="Dump"><a href="#Dump" class="headerlink" title="Dump"></a>Dump</h2><pre><code>docker run --name newMongo -p 27018:27017 --rm mongo</code></pre><p>另开一个terminal</p><pre><code>docker exec -it newMongo /bin/bashmongodump -h 127.0.0.1 --port 27017 -d ${your db} -o /test/mongodBackexit # 退出docker mongo容器docker cp newMongo:/test/mongodBack/ /mongodBack/ # 将docker 内文件拷到/mongodBack/</code></pre><h2 id="Restore"><a href="#Restore" class="headerlink" title="Restore"></a><strong>Restore</strong></h2><p>待撸待撸</p><p>参考：<a href="https://www.cnblogs.com/qiyc/p/10150433.html" target="_blank" rel="noopener">https://www.cnblogs.com/qiyc/p/10150433.html</a></p><h1 id="OAuth2-server-撸saas-微应用化"><a href="#OAuth2-server-撸saas-微应用化" class="headerlink" title="OAuth2-server 撸saas 微应用化"></a><strong>OAuth2-server 撸saas 微应用化</strong></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[Client frontend] GET /auth/honglian to [Client backend]</span><br><span class="line">[Client backdnd] redirectTo [Server frontend] page : /oauth/authorize?clientId=x&amp;redirectUri=x&amp;response_code=code</span><br><span class="line">[Server frontend] POST /oauth/login/authorise to [Server backend] to fetch oauth authorization_code</span><br><span class="line">[Server frontend] redirectTo(window.location) redirectUri + code=$&#123;authorization_code&#125;</span><br><span class="line">[Client backend] get authorization_code</span><br><span class="line">[Client backend] POST /oauth/access_token/?client_id=x -H &apos;authorization=$&#123;authorization_code&#125;&apos; to [Server backend] to fetch access_token</span><br><span class="line">[Server backend] return access_token to [Client backend]</span><br><span class="line">[Client backend] GET /api/user/?client_id=x&amp;client_secret=x&amp;access_token to [Server backend]</span><br><span class="line">[Server backend] return userProfile to [Client backend]</span><br><span class="line">[Client backend] redirectTo [/user/home]</span><br></pre></td></tr></table></figure><p>beyond over!</p><p>参考：</p><ol><li><p><a href="https://gist.github.com/tabone/d74fb922669e4edc22bfd0833b5ae88b" target="_blank" rel="noopener">https://gist.github.com/tabone/d74fb922669e4edc22bfd0833b5ae88b</a></p></li><li><p><a href="https://www.cnblogs.com/vipzhou/p/8125924.html" target="_blank" rel="noopener">https://www.cnblogs.com/vipzhou/p/8125924.html</a></p></li></ol><h1 id="www-form-urlencoded-d-里面的-空格-被替换成-的问题"><a href="#www-form-urlencoded-d-里面的-空格-被替换成-的问题" class="headerlink" title="www-form-urlencoded -d 里面的 空格 被替换成+的问题"></a><strong>www-form-urlencoded -d 里面的 <code>空格</code> 被替换成<code>+</code>的问题</strong></h1><p>场景是用户发送一个<code>www-form-urlencoded</code> 内容是一个机器码，比如<code>MH20ew2r9RuTyGcX+rrmxF7X40U=</code> 但是发现传到服务器时，却变成了<code>MH20ew2r9RuTyGcX rrmxF7X40U=</code>. 中间是空格代替。</p><p>原因是空格在urlencoded 中就是”+”。于是参数从软件客户端发到web 时都是正确的。但是到了body-parser 时，body-parser 看到一个 <strong>+</strong>，想都不想，直接就转成空格了。、</p><p>临时处理办法：将该文本转回去: string.replace(/\s/g, ‘+’)</p><p>最终解决方案：软件客户端使用urlencoded 刷新string</p><h1 id="Chrome-Extension-使用Vue-遇到的一些问题"><a href="#Chrome-Extension-使用Vue-遇到的一些问题" class="headerlink" title="Chrome Extension 使用Vue 遇到的一些问题"></a><strong>Chrome Extension 使用Vue 遇到的一些问题</strong></h1><p>Vue 使用webpack。但是background.js 属于后台，使用nodejs，于是webpack 找require 函数时可能会找不到比如<strong>fs</strong> 的库：Module not found.</p><p>做的第一种尝试: 在webpack 打包target 默认为的<code>web</code> 替换为<code>node</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    target: &apos;web&apos;,</span><br><span class="line">    node: &#123;</span><br><span class="line">        console:false,</span><br><span class="line">        global: true,</span><br><span class="line">        process: true,</span><br><span class="line">        fs: true,</span><br><span class="line">        __filename: &apos;mock&apos;,</span><br><span class="line">        ___dirname: &quot;mock&quot;,</span><br><span class="line">        Buffer: true,</span><br><span class="line">        setImmediate: false</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是这样的也导致输出的是node 环境。界面上的css 样式全部都不识别了。<br>于是替换一种思路。</p><p>第二种尝试: 前段还是按照前段，后端之所以称之为后端，那么便是另外一个项目了。webpack 打包时，打一个虚拟的，没有任务的background 包。于是<code>yarn watch</code> 阶段background 包打进去之后，手动替换里面background.js。</p><p>终于，里面运行的非常正常了。</p><p>这种方法不同点是，之前的background 配置是page,现在应为scripts</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">background: &#123;</span><br><span class="line">    page: &quot;./background.html&quot;</span><br><span class="line">    scripts: [&quot;./background.js&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考：</p><ul><li><a href="https://cloud.tencent.com/developer/section/1477428" target="_blank" rel="noopener">https://cloud.tencent.com/developer/section/1477428</a></li><li><a href="https://cloud.tencent.com/developer/section/1477500" target="_blank" rel="noopener">https://cloud.tencent.com/developer/section/1477500</a></li></ul><h2 id="Typescript-mocha-chai-单元测试"><a href="#Typescript-mocha-chai-单元测试" class="headerlink" title="Typescript + mocha + chai 单元测试"></a><strong>Typescript + mocha + chai 单元测试</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yarn add mocha @types/mocha chai @types/chai chai-http @types/chai-http -D</span><br><span class="line"></span><br><span class="line">package.json</span><br><span class="line">    scripts</span><br><span class="line">        test: NODE_ENV=test mocha -t 5000 --require ts-node/register test/**/*.ts</span><br><span class="line"></span><br><span class="line">/test</span><br><span class="line">    diary.spec.ts</span><br></pre></td></tr></table></figure><p>diary.spec.ts:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; app &#125; <span class="keyword">from</span> <span class="string">'../src/app'</span></span><br><span class="line"><span class="keyword">import</span> chai, &#123; expect &#125; <span class="keyword">from</span> <span class="string">'chai'</span></span><br><span class="line"><span class="keyword">import</span> chaiHttp <span class="keyword">from</span> <span class="string">'chai-http'</span></span><br><span class="line">chai.use(chaiHttp)</span><br><span class="line"><span class="keyword">import</span> <span class="string">'mocha'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userLoginCookie = <span class="string">'123456'</span> <span class="comment">// 由于使用OAuth 服务，那块代码就没有测，直接使用Cookie</span></span><br><span class="line">describe(<span class="string">'测试diary 接口'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.beforeEach(<span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'等待数据库载入完毕'</span>)</span><br><span class="line">            done()</span><br><span class="line">        &#125;, <span class="number">1000</span>) <span class="comment">// 时间可以加长，这里链接了mlab ，比较慢，可以为4000(有时仍然会出错)</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'Test getBudgetList'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">        chai.request(app)</span><br><span class="line">            .post(<span class="string">'/api/diary/getBudgetList'</span>)</span><br><span class="line">            .set(<span class="string">'Cookie'</span>, userLoginCookie)</span><br><span class="line">            .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (res.status === <span class="number">403</span>) &#123;</span><br><span class="line">                    done(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'403 用户需要先登录'</span>))</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> arr = res.body <span class="keyword">as</span> <span class="built_in">any</span>[]</span><br><span class="line">                    expect(arr.length).to.equal(<span class="number">0</span>)</span><br><span class="line">                    done()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="fs-read-readFile-在读取中文时乱码"><a href="#fs-read-readFile-在读取中文时乱码" class="headerlink" title="fs.read/readFile 在读取中文时乱码"></a><strong>fs.read/readFile 在读取中文时乱码</strong></h2><p>需求：文件使用Buffer 读出, 然后一个一个解析里面的中英文<br>环境：文件很大, 所以没办法直接读出、直接写出</p><p><em>注意：这个需求不是编码的问题。比如GBK。GBK使用iconv_lite 解决</em></p><p>英文占一个字节，中文三个字节，所以一个个读出的buffer， 中文时便出现该字找不到，所以nodejs 使用<buffer ef df db> 进行替换。</buffer></p><p>nodejs 那些常见的读写库其实都导入了<code>string_decoder</code> 的库</p><p>使用是：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StringDecoder &#125; <span class="keyword">from</span> <span class="string">'string_decoder'</span></span><br><span class="line"><span class="keyword">const</span> decoder = <span class="keyword">new</span> StringDecoder(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> next = decoder.write(readBuffer)</span><br><span class="line">  <span class="keyword">if</span> (next.length) &#123;</span><br><span class="line">    <span class="comment">// 这就是得到的buffer</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>decoder 原理是解析出来的，如果是中文三字节找不到，那么就储存起来，等到合并成一个。</p><p>附上 oneByOne 读写每个文本</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StringDecoder &#125; <span class="keyword">from</span> <span class="string">"string_decoder"</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">'fs'</span></span><br><span class="line"><span class="keyword">import</span> &#123; call &#125; <span class="keyword">from</span> <span class="string">'./awaitCall'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> one_openFile = <span class="keyword">async</span> (absolutePath: <span class="built_in">string</span>, mode=<span class="string">'r'</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [e, fd] = <span class="keyword">await</span> call(fs.open ,absolutePath, mode, <span class="number">0o666</span>)</span><br><span class="line">  <span class="keyword">if</span> (e) <span class="keyword">throw</span> e</span><br><span class="line">  <span class="keyword">return</span> fd</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> one_readFile = <span class="keyword">async</span> (fd: <span class="built_in">number</span>, offset=<span class="number">0</span>, cb?: <span class="built_in">Function</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> oneByOneSize = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> len = oneByOneSize</span><br><span class="line">  <span class="keyword">let</span> readIndex = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> decoder = <span class="keyword">new</span> StringDecoder(<span class="string">'utf-8'</span>)</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> readBuffer = Buffer.alloc(oneByOneSize)</span><br><span class="line">    <span class="keyword">const</span> [err, res] = <span class="keyword">await</span> call(fs.read, fd, readBuffer, offset, len, readIndex)</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="keyword">if</span> (!res.bytesRead) &#123;</span><br><span class="line">      <span class="comment">// 文件读完了</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">"文件读写完毕"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> next = decoder.write(readBuffer)</span><br><span class="line">    <span class="keyword">if</span> (next.length) &#123;</span><br><span class="line">      <span class="keyword">if</span> (cb)</span><br><span class="line">        cb(next)</span><br><span class="line">    &#125;</span><br><span class="line">    readIndex ++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Run-Mocha-programmatically"><a href="#Run-Mocha-programmatically" class="headerlink" title="Run Mocha programmatically"></a><strong>Run Mocha programmatically</strong></h2><p>在代码中执行mocha。在实际环境中进行单元测试。</p><p><a href="https://github.com/mochajs/mocha/wiki/Using-mocha-programmatically" target="_blank" rel="noopener">mocha 官网示例</a></p><p><a href="https://stackoverflow.com/questions/29050720/run-mocha-programmatically-and-pass-results-to-variable-or-function" target="_blank" rel="noopener">stackoverflow</a></p><h2 id="express-limiter"><a href="#express-limiter" class="headerlink" title="express-limiter"></a><strong>express-limiter</strong></h2><p>遇到情况：有一个注册、即立即登录，快速注册快速登录的接口，这里express-limiter 可以多次请求</p><p>去redis 上看了下，key 每次都不同</p><p>去express-limiter 里看了下, 他的redis key 来自line17: var key = opts.keyFormatter(opts.lookup(req))</p><h2 id="Nginx-默认上传文件大小-1M"><a href="#Nginx-默认上传文件大小-1M" class="headerlink" title="Nginx 默认上传文件大小:1M"></a><strong>Nginx 默认上传文件大小:1M</strong></h2><p>server {<br>  listen 80;<br>  server_name xxx;<br>  client_max_body_size 100M;<br>}</p><h2 id="vue-electron-使用electron-builder-不能打包win"><a href="#vue-electron-使用electron-builder-不能打包win" class="headerlink" title="vue-electron 使用electron-builder 不能打包win"></a><strong>vue-electron 使用electron-builder 不能打包win</strong></h2><p>issue:<a href="https://github.com/SimulatedGREG/electron-vue/issues/487" target="_blank" rel="noopener">https://github.com/SimulatedGREG/electron-vue/issues/487</a></p><p>yarn build:win : “node .electron-vue/build.js &amp;&amp; electron-builder -w”</p><h2 id="TS-获取自身Class"><a href="#TS-获取自身Class" class="headerlink" title="TS 获取自身Class"></a>TS 获取自身Class</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> MyClass &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> MyClass();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(instance.constructor.name); <span class="comment">// MyClass</span></span><br><span class="line"><span class="built_in">console</span>.log(MyClass.name);              <span class="comment">// MyClass</span></span><br></pre></td></tr></table></figure><p><code>instance.constructor</code> 就是得到的class 转义后的Class 对象。</p><h4 id="Nginx-设置同源策略"><a href="#Nginx-设置同源策略" class="headerlink" title="Nginx 设置同源策略"></a>Nginx 设置同源策略</h4><p>这里还是使用上面文章说明：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">add_header</span> Access-Control-Allow-Origin *;</span><br><span class="line"><span class="attribute">add_header</span> Access-Control-Allow-Headers X-Requested-With;</span><br><span class="line"><span class="attribute">add_header</span> Access-Control-Allow-Methods GET,POST,OPTIONS;</span><br></pre></td></tr></table></figure><p>然后使用自己的域名。</p><p>以上完成了本次要搭建直播、理解推流、拉流的动作过程。</p><h3 id="人生苦短，我们用go"><a href="#人生苦短，我们用go" class="headerlink" title="人生苦短，我们用go"></a>人生苦短，我们用go</h3><p>有句话挺有意思的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nodejs 可玩性还是蛮高的，可以C艹binding。</span><br><span class="line">但是又多学一个，为什么不用golang?</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-6lesson</title>
      <link href="/2019/09/06/2019-9-6lesson/"/>
      <url>/2019/09/06/2019-9-6lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="记一次VVVVVV-域名被删了，重新安装记录"><a href="#记一次VVVVVV-域名被删了，重新安装记录" class="headerlink" title="记一次VVVVVV 域名被删了，重新安装记录"></a>记一次VVVVVV 域名被删了，重新安装记录</h1><p>由于freeNom 购买的免费域名，如果二级域 没有指定网页返回，那么就会被回收。有时邮件能看到，及时搞好就OK，有时漏掉，于是，麻烦事来啦。</p><p>freeNom 重新购买那个域名，试了试，被Cancel 掉了，买不成功。</p><p>好吧，那就折腾下买个域名吧。</p><p>首先不喜欢<code>狗爹</code>，没那个经历。看他们说<code>namecheap</code> 还不错，但是最后一步：不能使用支付宝，那我就用我以前的网站<code>namesio</code> 挺不错，买过一次，熟悉的味道。</p><p>买成功后，修改nameserver 为<code>cloudFlare</code> 对应的nameserver，同时开启SSL。</p><p>但是测试的时候发现客户端的error.log 报错:<code>failed to handler mux client connection &gt; VVVVVV.com/core/proxy/vmess/outbound: failed to find an available destination &gt; VVVVVV.com/core/common/retry: [VVVVVV.com/core/transport/internet/websocket: failed to dial WebSocket &gt; VVVVVV.com/core/transport/internet/websocket: failed to dial to (wss://wpn.iahuang.com/58ff4ec7/):  &gt; x509: certificate is valid for fuck.gogal.ml, not wpn.iahuang.com] &gt; VVVVVV.com/core/common/retry: all retry attempts failed</code></p><p>这个错是从服务端发出来的，是说里面的VVVVVV.crt / VVVVVV.key 对应的域名和现在不同。醒悟过来了。</p><p>我用的<code>VVVVVV_ws-tls_bash_onekey</code> 一键生成的，找到里面的install.sh 发现他的ssl 使用acme.sh 生成的。美滋滋，我也去整一个。</p><p><code>curl https://get.acme.sh | sh</code></p><p><code>acme.sh --issue -d wpn.ahuang.com -w /home/wwwroot/sCalc --test</code></p><p><code>/home/wwwroot/sCalc</code> 对应Nginx server 的root</p><p><code>--test</code> 用于测试使用的。如果不加，<a href="https://letsencrypt.org/zh-cn/docs/rate-limits/" target="_blank" rel="noopener">最多只能一个月生成5个</a>, 超过会报<code>https://www.dogedoge.com/results?q=Create+new+order+error.+Le_OrderFinalize+not+found.</code>, <code>code=429</code></p><p>生成之后，文件在<code>~/.acme.sh/</code>目录下。</p><p>我们要用的VVVVVV.crt / VVVVVV.key 需要再处理一次:</p><p><code>mkdir -p /sslCert</code></p><p><code>acme.sh --install-cert -d wpn.iahuang.com --key-file /sslCert/VVVVVV.key --fullchain-file /sslCert/VVVVVV.crt --reloadcmd &quot;systemctl restart nginx&quot;</code></p><p>然后就OK。要的文件就在sslCert下。</p><p>将两个文件，替换到/etc/VVVVVV/下。重启VVVVVV / 修改server 的server_name 就又复活啦。</p>]]></content>
      
      
      
        <tags>
            
            <tag> VVVVVV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-5lesson</title>
      <link href="/2019/09/05/2019-9-5lesson/"/>
      <url>/2019/09/05/2019-9-5lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="开始做视频网站前的准备"><a href="#开始做视频网站前的准备" class="headerlink" title="开始做视频网站前的准备"></a><strong>开始做视频网站前的准备</strong></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Nginx 做流量转发</span><br><span class="line">SRS 做直播流服务</span><br><span class="line">Nginx-http-flv-module 作为播放本地视频流服务</span><br></pre></td></tr></table></figure><p>自己测试了下SRS 做直播服务单机都感觉非常稳定，所以直播的能力就先交给他了。我找一遍没有找到SRS 能播放本地视频的。使用ffmpeg 倒也能播放，但是却不能拖动前、后播放视频了。</p><p>所以果断放弃。使用Nginx-http-flv-module 作为播放本地视频，配置也是超级简单。但是Nginx-http-flv-module 的直播流却不理想，自己感觉不是很好。</p><p>也可能是我偷偷搞、学，遗漏了？反正就这么着：SRS 扛起直播大旗、Nginx-http-flv-module 扛起播放视频服务大旗！</p><p>SRS 上面也已讲过，商用的话，还缺少一个:鉴权服务。SRS 本身就有鉴权方案，我在之后会多多参考，现在主要还是先搭起播放本地视频的服务。</p><p>下面开始Nginx-http-flv-module 的实现流程。</p><h3 id="首先说明环境"><a href="#首先说明环境" class="headerlink" title="首先说明环境"></a>首先说明环境</h3><p>使用昨天搭建的CentOS7 光溜溜版。只有openssh.</p><p>装个nodejs 先:<a href="https://zhuanlan.zhihu.com/p/34600831" target="_blank" rel="noopener">参考</a></p><pre><code>cd /tmpcurl — silent — location https://rpm.nodesource.com/setup_9.x | sudo bash -yum install -y nodejs</code></pre><p>下载Nginx<br>    mkdir /root/downloads cd /root/downloads<br>    wget <a href="http://nginx.org/download/nginx-1.17.3.tar.gz" target="_blank" rel="noopener">http://nginx.org/download/nginx-1.17.3.tar.gz</a><br>    wget <a href="https://github.com/winshining/nginx-http-flv-module/archive/v1.2.6.zip" target="_blank" rel="noopener">https://github.com/winshining/nginx-http-flv-module/archive/v1.2.6.zip</a><br>    tar -zxvf nginx-1.17.3.tar.gz # 得到文件夹nginx-1.17.3<br>    unzip -o v1.2.6.zip -d nginx-http-flv-module # 得到nginx-http-flv-module</p><pre><code>cd nginx-1.17.3./configure --add-module=/root/downloads/nginx-http-flv-module --with-http_ssl_module --with-http_v2_module # 可能会报pcre、openssl 没有找到。# 上面同时也把nginx-http-flv-module 第三方包加载成功yum install -y openssl openssl-devel # 安装opensslyum install -y pcre pcre-devel # 安装pcre</code></pre><p>上面做好了准备, 下面是编译和启动</p><pre><code>make &amp;&amp; make install # 完成之后会在/usr/local/nginx 生成目录，这里就是nginx操作处cd /usr/local/nginx./sbin/nginx -s start -c ./conf/nginx.conf # 启动nginx</code></pre><p>检查下nginx 是否正确运行。</p><p>下面来设置conf/nginx.conf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">rtmp &#123;</span><br><span class="line">  server &#123;</span><br><span class="line">    listen 1935;</span><br><span class="line">    chunk_size 4000;</span><br><span class="line">    application live &#123;</span><br><span class="line">      live on;</span><br><span class="line">      record off;</span><br><span class="line"></span><br><span class="line">      hls on;</span><br><span class="line">      hls_path /opt/video/test;</span><br><span class="line">      hls_fragment 3s;</span><br><span class="line">      hls_playlist_length 32s;</span><br><span class="line"></span><br><span class="line">      meta on;</span><br><span class="line">      gop_cache on;</span><br><span class="line">    &#125;</span><br><span class="line">    application vod &#123;</span><br><span class="line">      play /opt/video/vod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">  server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name yourdomain.com;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line"></span><br><span class="line">    location /vod &#123;</span><br><span class="line">      alias /opt/vod/;</span><br><span class="line">    &#125;</span><br><span class="line">    location /hls &#123;</span><br><span class="line">      types &#123;</span><br><span class="line">        application/vnd.apple.mpegurl m3u8;</span><br><span class="line">        video/mp2t ts;</span><br><span class="line">      &#125;</span><br><span class="line">      alias /opt/video/;</span><br><span class="line">      expires -1;</span><br><span class="line">      add_header Cache-Control no-cache;</span><br><span class="line">    &#125;</span><br><span class="line">    location /flv &#123;</span><br><span class="line">      flv_live on;</span><br><span class="line">      chunked_transfer_encoding on;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面看的到支持了hls、flv。实现了两个服务:本地播放流媒体和接受推流、被拉流的功能。</p><p>推流: <code>ffmpeg -re -stream_loop -1 -i 222.mp4 -c:v libx264 -c:a aac -f flv rtmp://10.221.55.4/live/test</code></p><p>拉流: <code>rtmp://10.211.55.4/live/test</code></p><p>然后砸门往 <em>/opt/video/vod/1.mp4</em> 放了个mp4.</p><p>拉流 <code>rtmp://10.211.55.4/vod/1.mp4</code></p><hr><p>当然域名yourdomain.com 可以写进主机hosts 里面，这样就可以真实环境测试了。</p><p>比如拉流: <code>rtmp://yourdomain.com/flv?app=live&amp;stream=test</code></p><p>播放MP4: <code>rtmp://yourdomain.com/vod/1.mp4</code></p><hr><p>最后一个: 权限控制</p><p>控制播放权限:</p><p><code>on_play http://localhost:9000/onPlay;</code></p><p><code>on_publish http://localhost:9000/onPublish;</code></p><p>上面这两个会调用本地权限验证，如果返回200则开始播放、返回非200 则失败。</p><p>以上完成这次的任务。</p><p><a href="https://github.com/winshining/nginx-http-flv-module" target="_blank" rel="noopener">nginx-http-flv-module</a></p><p><a href="https://zhangshuqiao.org/2018-01/%E5%9F%BA%E4%BA%8ENginx%E6%90%AD%E5%BB%BA%E8%A7%86%E9%A2%91%E7%9B%B4%E6%92%AD%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">参考</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx-http-flv-module </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-4lesson</title>
      <link href="/2019/09/04/2019-9-4lesson/"/>
      <url>/2019/09/04/2019-9-4lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="Mac使用Parallels-增加CentOS7"><a href="#Mac使用Parallels-增加CentOS7" class="headerlink" title="Mac使用Parallels 增加CentOS7"></a><strong>Mac使用Parallels 增加CentOS7</strong></h1><p>CentOS7 肯定是用OpenSSH 链接的。</p><pre><code>yum list installed | grep openssh-server</code></pre><p>如果未显示openssh-server 已经安装，那么输入<code>yum install openssh-server</code> 安装。</p><pre><code>cd /etc/sshsudo vim sshd_config</code></pre><p>修改以下几项：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Port 22</span><br><span class="line">ListenAddress 0.0.0.0</span><br><span class="line">ListenAddress ::</span><br><span class="line"></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"></span><br><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure><p>保存文件、退出</p><pre><code>systemctl restart sshdnetstat -lnp | grep 22 # 查看到22 端口已经打开</code></pre><p>这时Mac 要链接先要找到Ipv4 地址，两种方法：</p><ol><li>ip addr 可以看到有localhost/127.0.0.1/某一个ip 地址</li><li>去设置的netword 里面看Ipv4 地址</li></ol><p>然后Mac 先ping 该ip，如果通畅那就说明ok 啦。</p><p>此时有个问题：Parallels帮我们创建的账号，默认名为Parallels, 于是我又屁颠屁颠去【设置】【用户】里面把名字改了。</p><p>Mac 下<code>ssh root@ip -p 22</code> 发现一直弹<strong>Permission denied, please try again.</strong></p><p>不可能啊，就是这个密码。不理解的我试了好多次，只能google 了。</p><p><a href="https://askubuntu.com/questions/497895/permission-denied-for-rootlocalhost-for-ssh-connection" target="_blank" rel="noopener">StackExchange</a>前面答案都没帮上忙。我看到改密码：<code>sudo passwd</code></p><p>于是我改了下密码，Mac试着登录，终于可以登入了。估计这是CentOS7 的bug 吧。反正我登上了。我不管了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> parallels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-3obs</title>
      <link href="/2019/09/03/2019-9-3obs/"/>
      <url>/2019/09/03/2019-9-3obs/</url>
      
        <content type="html"><![CDATA[<h1 id="OBS"><a href="#OBS" class="headerlink" title="OBS"></a>OBS</h1><p><a href="https://obsproject.com/download" target="_blank" rel="noopener">OBS 下载</a></p><p>来源处添加【媒体源】-【新建】选择好本地文件时，顺便点选【循环】(方便测试)-【确定】</p><p>然后点击OBS 的【设置】-【推流】服务一栏选择【自定义】-【服务器】:rtmp://104.230.236.234/live/live 【串流秘钥】填:111(填111 为test)</p><p>这里说一点，【串流秘钥】在那片教程中没有说明，也就是<em>111</em> 在之后rtmp 流或者flv 流的后面的basename 位置，最后一定要加上111，如播放rtmp://104.230.236.234/live/live/111 或者<a href="http://104.230.236.234/live/live/111.flv" target="_blank" rel="noopener">http://104.230.236.234/live/live/111.flv</a></p><p>不然流推上去了，客户端就一直报错，找不到拉不到流啊。</p><p>接着OBS 按下【开始推流】，那就是推送到已开启的SRS 流了。</p><h4 id="SRS"><a href="#SRS" class="headerlink" title="SRS"></a>SRS</h4><p><code>docker run --name srs -v /dockerVolume/SRS/conf/docker.conf:/srs/conf/docker.conf -p 8808:8080 -p 1985:1985 -p 1935:1935 ossrs/srs:3.0</code></p><p>用容器美滋滋。同时，<code>/dockerVolume/SRS/conf/docker.conf</code> 是本地文件映射到容器的对应文件。该文件拷贝自:<code>srs/trunk/conf/http.flv.live.conf</code></p><p>这时可以在浏览器测试: <code>http://104.230.236.234:8808/live/live.flv</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">listen              1935;</span><br><span class="line">max_connections     1000;</span><br><span class="line">daemon              off;</span><br><span class="line">srs_log_tank        console;</span><br><span class="line">http_server &#123;</span><br><span class="line">    enabled         on;</span><br><span class="line">    listen          8080;</span><br><span class="line">    dir             ./objs/nginx/html;</span><br><span class="line">&#125;</span><br><span class="line">vhost __defaultVhost__ &#123;</span><br><span class="line">    http_remux &#123;</span><br><span class="line">        enabled     on;</span><br><span class="line">        mount       [vhost]/[app]/[stream].flv;</span><br><span class="line">        hstrs       on;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> srs </tag>
            
            <tag> obs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-2lesson</title>
      <link href="/2019/09/02/2019-9-2lesson/"/>
      <url>/2019/09/02/2019-9-2lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="最近连续一个多月的主要工作"><a href="#最近连续一个多月的主要工作" class="headerlink" title="最近连续一个多月的主要工作"></a><strong>最近连续一个多月的主要工作</strong></h1><p>最近连续一个多月主要分为三个工作：</p><ol><li>工作为主，完成公司盈利产品的迭代。这不仅学，还要学好。</li><li>这几个月想完成去年未完成的游戏，不过游戏有点大，不可太急躁。</li><li>完成视频播放功能。</li></ol><p>第一个工作还是努力前行，我的试用期是6个月，这个月过后就满啦。难得接受个这么长的试用期，努力就是了。从一无所知，非常迷迷糊糊，懵懵懂懂的状态跌跌撞撞过来，期间没有太多人帮助(只有伟哥和学弟喜顺)，现在能更准确找到问题、解决问题、顺便优化代码。美滋滋。</p><p>最近突然想起，我海贼王追的那么累(更得好慢)，最近我都转而潜心看文章，如三国类解说、明朝时代的解说。(明朝那么热闹，唐朝肯定也是潮起潮落。心之向往那跌宕的岁月。不过对历史的向往，也万没有身体要去感同身受的打算，那不是我这种渣逼能活着的岁月。)突然记得似乎火影忍者我还没看完，最后几集漏了，找不到网站看。</p><p>前几天开始了锻炼，想想以前的光辉岁月，不甘心只是蹲在凳子上消磨。翻开看了下bilibili的爆燃视频，夜凯一jio 踢残斑，想起以前课上趴着桌子偷偷看火影。锻炼我要干，看视频我也要干的。</p><p>我要做个视频网站！</p><p>我平常用流量看文章等，每个月最多1G不到(测试app 等用掉的)，平常都是500M。但是我觉得5G时代早晚来临，视频、音频、图片等都会大行其道。我不觉得我用得上，但我的客户们肯定万分期待。最近我试了试nginx-rtmp-module，先品尝了下视频播放的操作。接着我用SRS 也能转播直播。</p><p>同时我最近刚搞的rancher，想想，是否服务能放进去呢? 这1个多月的周末就在这其中煎熬度过。不过答案也终于找到了。</p><p>答案是理解了rancher 的k8s(k3s) 的能力，以目前我的知识、能力范畴，我能很好的使用服务的编排、无限扩容能力、合理调度。</p><p>那么答案就在这，SRS、VVVVVV等都是服务功能。VVVVVV 本来就是单个机器代理，还要怎么调度？SRS要调度，其本身已经支持(go-sharp)。<br>也就是说，我之前就是在钻牛角尖。不过钻的作用是，让我深切快速的理解了k8s(k3s) 的作用是什么，不然我要看好久的专业书。</p><p>不在当前规划上的知识，先不花太多精力。能动手就不看那么细致了。</p><p>周末突然的领悟自己确实在大钻特钻牛角尖。</p><p>现在说说我的环境和做法。</p><p>大致跟着这篇教程下来的:<a href="https://juejin.im/post/5ad7ce3ff265da505e41ff03" target="_blank" rel="noopener">https://juejin.im/post/5ad7ce3ff265da505e41ff03</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Server: CentOS7 x86_64</span><br><span class="line">SRS: docker run --name srs -v /dockerVolume/SRS/conf/docker.conf:/srs/conf/docker.conf -p 8808:8080 -p 1985:1985 -p 1935:1935 ossrs/srs:3.0</span><br><span class="line">客户端-推流端: OBS</span><br><span class="line">客户端-播放端: VLC / 教程里面的live demo</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-1make_wordTemplate</title>
      <link href="/2019/09/01/2019-9-1make-wordTemplate/"/>
      <url>/2019/09/01/2019-9-1make-wordTemplate/</url>
      
        <content type="html"><![CDATA[<h1 id="Microsoft-word-的document-xml-模板生成word-template-docx-过程"><a href="#Microsoft-word-的document-xml-模板生成word-template-docx-过程" class="headerlink" title="Microsoft word 的document.xml 模板生成word-template.docx 过程"></a><strong>Microsoft word 的document.xml 模板生成word-template.docx 过程</strong></h1><p>需求：生成一个模板word-template.docx ，在nodejs 中匹配对应的模板code，最终生成需求.docx</p><p>工具：office word、code IDE。</p><ol><li>首先在word 中修改好我们要的样式。在对应要修改模板文字 的地方，以<code>____</code>代替之。作用是等会生成最终模板的地方，很容易找到。</li></ol><p><img src="/css/images/generate_wordTemplate1.jpg" alt="生成word.docx"></p><ol start="2"><li><p>将word.docx 解压成文件夹template</p><p> mac/linux$unzip -o word.docx -d template</p><p> windows$”windows unzip 解决工具路径” -o “word.docx 路径” -d “template 路径”</p></li></ol><p><img src="/css/images/generate_wordTemplate2.jpg" alt="生成word 的template 目录"></p><ol start="3"><li>template 目录大致介绍</li></ol><p><img src="/css/images/generate_wordTemplate3.jpg" alt="template 目录"></p><p>重要的目录在框中。</p><pre><code>[Content_Types.xml] 是用来描述内部使用的格式说明。word/document.xml 核心文件，修改的描述就在这。word/_rels/document.xml.rels 是描述资源文件的relationShipword/media/ 用来放图片</code></pre><p><strong>接下来就是修改成我们的最终模板</strong></p><ol start="4"><li>修改word/document.xml</li></ol><p>替换模板code 格式我们使用lodash.template —&gt; <strong><code>&lt;%= templateCode %&gt;</code></strong></p><p><img src="/css/images/generate_wordTemplate4.jpg" alt="修改document.xml"></p><p>如果是插入jpeg 图片(png/jpg 都可以), 我们可以如下:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">w:p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">_.forEach</span>(<span class="attr">images</span>, <span class="attr">function</span>(<span class="attr">item</span>, <span class="attr">index</span>) &#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">w:r</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">w:rPr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">w:color</span> <span class="attr">w:val</span>=<span class="string">"00FF00"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">w:rPr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">w:pict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">v:shape</span> <span class="attr">id</span>=<span class="string">"_x0000_i1025&lt;%- index %&gt;"</span> <span class="attr">o:spt</span>=<span class="string">"75"</span> <span class="attr">type</span>=<span class="string">"#_x0000_t75"</span> <span class="attr">style</span>=<span class="string">"height:&lt;%- item.height %&gt;pt;width:&lt;%- item.width %&gt;pt;"</span> <span class="attr">filled</span>=<span class="string">"f"</span> <span class="attr">o:preferrelative</span>=<span class="string">"t"</span> <span class="attr">stroked</span>=<span class="string">"f"</span> <span class="attr">coordsize</span>=<span class="string">"21600, 21600"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">v:path</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">v:fill</span> <span class="attr">on</span>=<span class="string">"f"</span> <span class="attr">focussize</span>=<span class="string">"0,0"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">v:stroke</span> <span class="attr">on</span>=<span class="string">"f"</span> <span class="attr">joinstyle</span>=<span class="string">"miter"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">v:imagedata</span> <span class="attr">r:id</span>=<span class="string">"&lt;%- item.rid %&gt;"</span> <span class="attr">o:title</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">o:lock</span> <span class="attr">v:ext</span>=<span class="string">"edit"</span> <span class="attr">aspectratio</span>=<span class="string">"f"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">w:10:wrap</span> <span class="attr">type</span>=<span class="string">"none"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">w:10:anchorlock</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">v:shape</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">w:pict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">w:r</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> &#125;);%&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">w:p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样便可循环插入多张图片啦。</p><ol start="5"><li>修改word/_rels/document.xml.rels</li></ol><p>这里是用来指定植入的资源(图片)关系。</p><p>我们只需在原本存在<code>&lt;Relationships xmls=&quot;...xxx&quot;&gt;</code>一行下增加新增的rId 资源链接：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Relationships</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.openxmlformats.org/package/2006/relationships"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> <span class="attr">_.forEach</span>(<span class="attr">images</span>, <span class="attr">function</span>(<span class="attr">item</span>, <span class="attr">index</span>) &#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Relationship</span> <span class="attr">Id</span>=<span class="string">"&lt;%- item.rid %&gt;"</span> <span class="attr">Type</span>=<span class="string">"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"</span> <span class="attr">Target</span>=<span class="string">"media/image&lt;%- index %&gt;.jpeg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> &#125;); %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Relationship</span> <span class="attr">Id</span>=<span class="string">"rId8"</span> <span class="attr">...</span></span></span><br></pre></td></tr></table></figure><p><img src="/css/images/generate_wordTemplate5.jpg" alt="document.xml.rels"></p><p>同时找到这里最大的Id，如<code>Id=&quot;rId16&quot;</code>, 之后用到。</p><ol start="6"><li>修改[Content_Types].xml 增加使用资源ext</li></ol><p>这里使用jpeg 图片后缀名，增加一行:<code>&lt;Default Extension=&quot;jpeg&quot; ContentType=&quot;image/jpeg&quot;/&gt;</code></p><p><img src="/css/images/generate_wordTemplate6.jpg" alt="Content_Types"></p><p>如果没有增加该行(或者上面提到的rId 填错)，出现问题特点是: WPS能正常打开；office word 提示<strong>无法打开Open XML xxx 因为内容存在问题或者文件名可能包含无效字符</strong> <strong>文件已损坏，无法打开。</strong></p><p>点击了“确定”，接着又提示<strong>xxx.docx 中发现无法读取的内容。是否要恢复此文档的内容？如果您信任此文档的来源，请单击“是”</strong>，点了“是”之后又能正常浏览。</p><ol start="6"><li>word/media 文件夹</li></ol><p>该文件夹是图片移进来后，<code>rId ++</code>。把图片信息保存到word/document.xml 的同时，将资源链接写进word/_rels/document.xml.rels</p><ol start="7"><li>压缩 成word-template.docx 模板文件</li></ol><p><code>zip ../word-template.docx -r .</code></p><p>将word 文件夹下的所有文件使用zip 压缩。名称指定为word-template.docx 模板即打包完毕。</p><p><img src="/css/images/generate_wordTemplate7.jpg" alt="word-template.docx"></p><p>至此word-template 模板生成完毕。</p><blockquote><p>!!!ATTENTION \<br>制作最好用Windows 操作系统。如果使用Mac OS 制作，一定要将制作好的文件拖到Windows 虚拟机查看是否多出文件, 如 <code>.DS_Store</code> 文件</p></blockquote><blockquote><p>上述情况会导致WPS 能正常打开，微软的word 总是提示失败超级bug</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-8-9lesson</title>
      <link href="/2019/08/09/2019-8-9lesson/"/>
      <url>/2019/08/09/2019-8-9lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="git-push-origin-branch-出现error"><a href="#git-push-origin-branch-出现error" class="headerlink" title="git push origin branch 出现error"></a><strong>git push origin branch 出现error</strong></h1><p>git push origin V4 报错:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">To gitlab.xxx.git</span><br><span class="line">! [rejected]    branch -&gt; branch (non-fast-forward)</span><br><span class="line">error: failed to push some refs to <span class="string">'gitlab.xxx.git'</span></span><br><span class="line">hint: Updates were rejected because the tip of your current branch is behind</span><br></pre></td></tr></table></figure><p>这里表明你的点是behind。</p><p>那就 git pull, 但是报错:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">There is no tracking information <span class="keyword">for</span> the current branch.</span><br><span class="line">Please specify <span class="built_in">which</span> branch you want to merge with.</span><br><span class="line">See git-pull(1) <span class="keyword">for</span> details.</span><br><span class="line">    git pull &lt;remote&gt; &lt;branch&gt;</span><br></pre></td></tr></table></figure><p>git pull === git fetch + git merge</p><p>这里的意思是要你指明remote 和branch: <code>git pull origin V4</code></p><p>如果要将合并的点rebase 掉，<code>git pull --rebase origin V4</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-8-8lesson</title>
      <link href="/2019/08/08/2019-8-8lesson/"/>
      <url>/2019/08/08/2019-8-8lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="杂谈"><a href="#杂谈" class="headerlink" title="杂谈"></a>杂谈</h1><p>如何快速进步，突破学习新的知识、技术。</p><p>我的方法，一句话概括：在自己规划的道路上，不怕试错，勇敢试错。出问题了，多方思考，解决问题。</p><p>下面是废话：blablabla</p><p>大学时期，我和我的几个小伙伴不知道学什么、方向不知道会走向何处。我们都是穷人过来，肯定不会说真的堕落。但是就因为穷人，眼界比他人要小一点，导致有时我们能做的, 能接触的就更局限了。</p><p>我和我同学大一大二上课还是会稍微努力，不过课后没有进展，导致挂科无数。下课一起打游戏，当时LOL 还不风靡，玩的CF，下午打篮球。那时候篮球能力是真强，不像现在肚子都是肉。后来大二就更是会翘课进网吧，因为在课上我们都在睡觉，真的在睡觉。</p><p>为什么，因为大学里面，老师教你的，都是如果拿着锤子，找钉子。</p><p>整天拿着锤子，反复推敲，仔细研磨，整个大学四年，我发现我们还没动手过去找一个真实的钉子。也许你会说，那些题目，那些作业，不就是你的钉子么？我觉得年轻的人们，都会当局者迷。也许我们现在看来，那些都是非常有用，在现在都是必不可少，甚至悔不当初。但是当局者迷，每人境遇都是不同，我当初就觉得，未来我不一定用得上，数学题算来算去，最后你填写答案:1，正确率基本都是70%。为什么我为了70%能填对答案的问题，需要绕来绕去，反复抚摸锤子，恨不得拿舌头狂舔。</p><p>四年，老师们一上课就是教研，但是不会告诉今年这堂课在实际场景，比如xxx会碰到。ok，很难想象？那我们来真实模拟这个钉子！也许这次上课导致上课的拖延、甚至为了模拟这个钉子花了4节课、6节课。大家跟着老师一路走来，经验、处事、遇到问题时的攻坚，到最终见到钉子，此时resolve。</p><p>我觉得我爱上这种遇到苦难，解决苦难的过程。如现在种种这般。然后学校不同意，老师不愿意，教学任务啊老铁。学生只能学到皮毛，大学生啊！！！</p><p>当然现在不是说以前怎么怎么的，什么我现在这么菜要怪老师，什么要怪体制，没有没有。吐槽下而已。</p><p>above，我都想说明，钉子和锤子的关系、的前后顺序。</p><p>曾经我学到一个新技术，想找一个地方去实践。我找我前CTO。他告诉这个技术人要理清的步骤：先有钉子，然后找到锤子解决这钉子。</p><p>最近我多次使用docker 之后，就觉得好用是好用，但是没有管理，觉得不自在。宕机了？断网了？这个机子断了？企业服务断了？</p><p>如果我未来会要扛起一面大旗，我就需前提做好准备，做好狂风暴雨的突袭！所以我考虑了下docker-swarm，但是感觉那里不对，不是很密西。</p><p>我搞了搞k8s, 然后我的两只小鸡都全部瘫了。在翻看相关文档，提到k3s。是针对我的小鸡仔们的。</p><p>我搞了k3s，但是遇到问题：我有个非容器服务，通过nginx 转子域名的443 端口。但是k3s 装上去后，nginx 服务端口立马全部失效了。</p><p>怎么描述：nginx 的80监听端口被k3s 强行取走。虽然netstat -lnp |grep 80 还是nginx 的，但access.log 没有反应。我不知道怎么应对。</p><p>对于这个我想要两种方法：</p><ol><li><p>k3s 的服务，我使用编译的nginx 要什么端口，nginx 我转给你，都转给你，但是你别抢80服务；</p></li><li><p>k3s 你把能暴露端口的方法告知我一下，不然我搞不了本机端口啊。</p></li></ol><p>当时我不知道Ingress，毕竟强行学习的嘛。试了好多种方案不行，没来得及看相关文章。当时想问伟哥，不过他太忙，我就问问一个同事，他以前做运维的(他看起来比我岁数小的样子，原来比我大，孩子都6岁啦，哈哈，以后可以多交流)。他给我一些帮助，也让我多看书，把里面的原理整清楚，以后遇到问题、排查也懂。不过我觉得，我当前只是想完成集群的搭建、应该解决集群搭建问题，而不是找一大本书完全明白。</p><p>这就像拿一把超级大锤(我看完书了，不就等于超级大锤), 完成我短期要求：搭建起起来，这个小钉子需求。从成本、效率上看都是过犹之。</p><p>我昨晚想着，通篇看书这事，先拖后吧。等之后有人懂了，可以乘机偷学。</p><p>那么先完成docker-swarm。但是同样出现一些小坑，刚接触，没办法立即查出来，解出来。</p><p>于是我今天早上东问问西问问，得知k3s 为了完成内部pod 端口upstream 要求，集成了nginx。同时，开开关关nginx 带来损耗，此时Ingress 作为自动编排规则。我试了下，哎，虽然外部VVVVVV 要导出规则，还没整上(估计还是Ingress 有关操作)，那么先完成其他需求了再说。</p><p>至此，钉子(docker 服务集群化需求)一经出现，我找了相应的锤子(最终找到k3s)解决了需求。</p><p>钉子的产生，还是源于自身大胆的去尝试。</p><p>这次的钉子需要虚拟机或者vps，该vps 还是能尽情折腾，坏了就坏了。</p><p>综上，尽情的产生钉子，要不怕难，然后使用身边的资源，多方思考找到锤子解决。</p><p>这兴趣产生的难，在解决后确实让我很开怀。</p><h1 id="乱七八糟"><a href="#乱七八糟" class="headerlink" title="乱七八糟"></a>乱七八糟</h1><p>得道者多助，拾到者捐助。</p><p>在新的环境怕被人说能力不强，是饭桶，于是我就努力喝水，这样他们最多称我为水桶，而不是饭桶了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-8-5lesson</title>
      <link href="/2019/08/05/2019-8-5lesson/"/>
      <url>/2019/08/05/2019-8-5lesson/</url>
      
        <content type="html"><![CDATA[<p>人的一生并不是只有工作，就像我，我的两生、多生 都得用来工作</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-8-1lesson</title>
      <link href="/2019/08/01/2019-8-1lesson/"/>
      <url>/2019/08/01/2019-8-1lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="k3s"><a href="#k3s" class="headerlink" title="k3s"></a>k3s</h1><p>最近花了点时间做服务器集群工作尝试。原因是，单就docker，如果服务器不尝试集群，那么对于高可用、高并发，都将是梦，永远都有瓶颈。</p><p>我认识的运维和他人认知的运维不一样。</p><p>我觉得真正的开发、运维，是让你在最有限的工具、环境里面，做出最大可用的效益。</p><p>我用rancher k8s 一上来就吃掉了所有cpu、内存，那我们就啥也搞不了了。当时卡的受不了，直接换成k3s。</p><p>我的两只小鸡配置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">67.x.x.x</span><br><span class="line">CPU: 1</span><br><span class="line">RAM: 256M (你没看错, 于是我加点交换区2G, 但是他是CN2 直连， 搬瓦工)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">104.x.x.x</span><br><span class="line">CPU: 1</span><br><span class="line">RAM: 1G (加交换区2G，网络稍慢些， hostwind)</span><br></pre></td></tr></table></figure><p>以上就是我的两只炮灰小鸡啦。</p><p>之后会对k3s 部署进行说明。</p><p>当前k3s 部署会将nginx 端口替换。暂时对这个了解不清。解决了之后回来完成这个主题。</p>]]></content>
      
      
      
        <tags>
            
            <tag> k3s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-7-23lesson</title>
      <link href="/2019/07/23/2019-7-23lesson/"/>
      <url>/2019/07/23/2019-7-23lesson/</url>
      
        <content type="html"><![CDATA[<h2 id="记录设置Centos7-Nginx-制作一个简单的点播服务"><a href="#记录设置Centos7-Nginx-制作一个简单的点播服务" class="headerlink" title="记录设置Centos7 Nginx 制作一个简单的点播服务"></a><strong>记录设置Centos7 Nginx 制作一个简单的点播服务</strong></h2><p>起因：当前nginx 版本是1.17.1, 想增加nginx-rtmp-module,找不到configure 文件，所以打算降版本。</p><pre><code>删除CentOS 上的Nginxsystemctl nginx stop删除Nginx 的自动启动centos6:语法chkconfig nginx offcentos7:语法systemctl disable nginx.service从源头删除nginxrm -rf /usr/sbin/nginxrm -rf /etc/nginxrm -rf /etc/init.d/nginx在使用yum 清理yum remove nginx下载nginx-rtmp-modulecd /root/downloadgit clone https://github.com/arut/nginx-rtmp-module.gitwget http://nginx.org/download/nginx-1.10.3.tar.gztar -zxvf nginx-1.10.3.tar.gzcd nginx-1.10.3设置并install./configure --add-module=${刚下载的路径}/nginx-rtmp-module --with-http_ssl_modulemake &amp;&amp; make install</code></pre><p>此时nginx 已经在 <code>/usr/local/nginx</code></p><pre><code>设置source:vim /etc/profile.d/nginx.sh</code></pre><p>添加一下内容</p><pre><code>export NGINX_HOME=/usr/local/nginxexport PATH=$NGINX_HOME/sbin:$PATH</code></pre><p>保存后使配置生效:</p><pre><code>source /etc/profile</code></pre><p>测试一下：<code>nginx -V</code> 输出了:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nginx version: nginx/1.10.3</span><br><span class="line">built by gcc 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC)</span><br><span class="line">built with OpenSSL 1.0.2k-fips  26 Jan 2017</span><br><span class="line">TLS SNI support enabled</span><br><span class="line">configure arguments: --add-module=/root/download/nginx-rtmp-module/ --with-http_ssl_module</span><br></pre></td></tr></table></figure><p>使其在Centos7 systemctl 可以使用</p><pre><code>vim /usr/lib/systemd/system/nginx.service</code></pre><p>输入文件内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx - high performance web server</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>设置开机自启动: <code>systemctl enable nginx.service</code></p><p>查看所有服务: <code>systemctl list-units --type=service</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rtmp &#123;</span><br><span class="line">  server &#123;</span><br><span class="line">    listen 1935;</span><br><span class="line">    chunk_size 4096;</span><br><span class="line"></span><br><span class="line">    application vod &#123;</span><br><span class="line">      play /opt/video/vod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就可以使用: rtmp://ip/vod/1.mp4 点击查看啦</p><p><a href="https://segmentfault.com/a/1190000009723940" target="_blank" rel="noopener">参考1</a><br><a href="https://www.jianshu.com/p/a210eab31f45" target="_blank" rel="noopener">参考2</a></p><h2 id="Nginx-http-flv-module"><a href="#Nginx-http-flv-module" class="headerlink" title="Nginx-http-flv-module"></a><strong>Nginx-http-flv-module</strong></h2><p>昨天玩了Nginx-rtmp-module，但是指定路径是: rtmp://ip/vod/1.mp4 需要使用ip。这样就很low 了，简直拿不出去手(直接使用ip 还是挺不自由的)</p><p>当前我的ip 都是挂在Cloudflare 上。</p><p>那是不是可以: rtmp://<a href="http://www.baidu.com:1935/vod/1.mp4" target="_blank" rel="noopener">www.baidu.com:1935/vod/1.mp4</a> -&gt; rtmp://<a href="http://www.baidu.com:80/vod/1.mp4" target="_blank" rel="noopener">www.baidu.com:80/vod/1.mp4</a> 这样呢？？</p><p><a href="https://github.com/arut/nginx-rtmp-module/issues/1180" target="_blank" rel="noopener">参考1</a><br><a href="https://github.com/winshining/nginx-http-flv-module" target="_blank" rel="noopener">参考2</a><br><a href="https://segmentfault.com/a/1190000016043297" target="_blank" rel="noopener">参考3</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> src nginx-flv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-7-22lesson</title>
      <link href="/2019/07/22/2019-7-22lesson/"/>
      <url>/2019/07/22/2019-7-22lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="tinytiny"><a href="#tinytiny" class="headerlink" title="tinytiny"></a>tinytiny</h1><p>7.20 号将tinytiny 完成，做成一个节点，接下来就是做游戏赚钱了。</p><p>之前的作品我觉得都挺好，应该能赚钱，但是一个人抽不出手，也许真的只能做游戏了吧。</p><h3 id="auth-ahuang-ml"><a href="#auth-ahuang-ml" class="headerlink" title="auth.ahuang.ml"></a>auth.ahuang.ml</h3><p>auth.ahuang.ml 这个是用作用户中心、授权其他产品权限、授权其他产品获得相关用户信息。</p><h3 id="diary-ahuang-ml"><a href="#diary-ahuang-ml" class="headerlink" title="diary.ahuang.ml"></a>diary.ahuang.ml</h3><p>diary.ahuang.ml 基础用户没什么功能、vip1有一些功能、vip2功能比较多，sexy，所以vip2 不能推广。</p><h3 id="www-ahuang-ml"><a href="#www-ahuang-ml" class="headerlink" title="www.ahuang.ml"></a><a href="http://www.ahuang.ml" target="_blank" rel="noopener">www.ahuang.ml</a></h3><p><a href="http://www.ahuang.ml" target="_blank" rel="noopener">www.ahuang.ml</a> 其实也是budget.ahuang.ml 是做《iOS/葩皮记账》 的后台、tinytiny 的后台。</p><p>葩皮记账是一款根据git 原理，将用户记账多端登录功能的轻松实现，能保证用户在游客登录、正常登录等使用情景的优化。</p><h3 id="tinytiny-1"><a href="#tinytiny-1" class="headerlink" title="tinytiny"></a>tinytiny</h3><p>tinytiny 使用的是tinypng 的API，其默认每个邮箱每月500个免费使用额度。当时我的思考是：</p><p>如果集合20个邮箱，那就有10000个使用额度，只要保证key 合理调度、任务配置、用户使用额度检查、回滚等配合操作，就能保证任务的合理性。</p><p>依靠以上的思路，所以有了这款小产品，当前还不完善。</p><h3 id="总结和计划要做的事"><a href="#总结和计划要做的事" class="headerlink" title="总结和计划要做的事"></a><strong>总结和计划要做的事</strong></h3><p>网页产品</p><ul><li><p>[] 增加埋点</p></li><li><p>[] 增加google 广告</p></li></ul><p>auth.ahuang.ml</p><ul><li><p>[] 用户oauth 进入register 增加callback: 用户register 完返回到oauth 界面</p></li><li><p>[] 用户进入home 界面时刷新用户资料、或者增加用户资料页刷新用户资料</p></li><li><p>[] tinytiny 产品的下载页</p></li></ul><p>diary.ahuang.ml</p><ul><li>[] 增加段子、搞笑 类别</li></ul><p>budget.ahuang.ml</p><ul><li><p>[] 用户压缩记住上次选择路径</p></li><li><p>[] 增加选项：用户压缩直接覆盖源资源、同时领指定一个文件夹存放用户的源资源</p></li></ul><p>tinytiny electron-app</p><ul><li><p>[] concurentlly start task (current: serially)</p></li><li><p>[] remember user last select path</p></li><li><p>[] user check out whether PROGRAM “cover source (together with a new directory)” or “a new directory name ‘tiny’(COMPLETE)”</p></li></ul><p>如果可以，我想在android 搞一个小小的程序。作用是识别用户的来电，监听电话号码和腾讯手机管家的不良通讯录(或者自己制定一个)，匹配之后，自动播放用户自己的广告，这样便能对那些天天找你“来买房啊”、“来买车啊”、“其他乱七八糟业务” 造成回击。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-13qiniu</title>
      <link href="/2019/06/13/2019-6-13qiniu/"/>
      <url>/2019/06/13/2019-6-13qiniu/</url>
      
        <content type="html"><![CDATA[<p>找到原因：我去找了下我的lookup</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">loopup = <span class="function">(<span class="params">req:Request</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> ref</span><br><span class="line">  <span class="keyword">if</span> (req.user) &#123;</span><br><span class="line">    ref = req.user._id</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [req.path, ref || req.get(<span class="string">"X-Real-IP"</span>) || req.get(<span class="string">"X-Forward-For"</span>) || req.ip]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原因就在于每次我登进去，key 都不同，与此同时，我不退出，继续使用该api，key 还是不同。</p><p>解决方案：由于该route 是public 的，</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lookup = <span class="function">(<span class="params">req:Request</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> key = <span class="string">`<span class="subst">$&#123;req.method&#125;</span>:<span class="subst">$&#123;req.path&#125;</span>`</span></span><br><span class="line">  <span class="keyword">if</span> (routesMap[key].accessLevel.level === <span class="string">'public'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [req.path, req.get(<span class="string">"X-Real-IP"</span>) || req.get(<span class="string">'X-Forwarded-For'</span>) || req.ip]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> ref</span><br><span class="line">  <span class="keyword">if</span> (req.user) &#123;</span><br><span class="line">    ref= req.user._id</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [req.path, ref || req.get(<span class="string">"X-Real-IP"</span>) || req.get(<span class="string">'X-Forwarded-For'</span>) || req.ip]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="解决qiniu-上传文件-gt-1G-code-413"><a href="#解决qiniu-上传文件-gt-1G-code-413" class="headerlink" title="解决qiniu 上传文件&gt;1G code=413"></a><strong>解决qiniu 上传文件&gt;1G code=413</strong></h2><p>qiniu v=6.0.9</p><p>根据<a href="https://github.com/qiniu/nodejs-sdk/issues/173" target="_blank" rel="noopener">github issue</a>提到，fixed in v7.0.2</p><p>更新之后，接口也相应更新，然后同时需要在<code>new qiniu.rs.PutPolicy(options)</code> 的options 设置fsizeLimit,</p><p><code>options = { scope: ${bucket}:key, fsizeLimit: 10*1024*1024*1024 }</code> 这样便成功解决上传文件限制大小的问题。</p>]]></content>
      
      
      
        <tags>
            
            <tag> qiniu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-13awaitcall</title>
      <link href="/2019/06/13/2019-6-13awaitcall/"/>
      <url>/2019/06/13/2019-6-13awaitcall/</url>
      
        <content type="html"><![CDATA[<h2 id="js-ts-如何享受async-舒适下远离try-catch"><a href="#js-ts-如何享受async-舒适下远离try-catch" class="headerlink" title="js/ts 如何享受async 舒适下远离try{}catch{}"></a><strong>js/ts 如何享受async 舒适下远离try{}catch{}</strong></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> login () &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> userLogin()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.$message.error(e)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>async 带来了很大的方便，但是try/catch 却破坏了写作的美感。</p><p>我们想要这样的:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> callAsync, &#123; call &#125; = <span class="built_in">require</span>(<span class="string">'awaitCall'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> login () &#123;</span><br><span class="line">  <span class="comment">// callAsync allows promise as input</span></span><br><span class="line">  <span class="keyword">const</span> [err, response] = <span class="keyword">await</span> callAsync(userLogin())</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="keyword">this</span>.$message.eror(err)</span><br><span class="line">  <span class="comment">// user login successfully</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> writeFile (input) &#123;</span><br><span class="line">  <span class="comment">// call allows any function which can be accepted by require('util').promisify with a promise output</span></span><br><span class="line">  <span class="keyword">const</span> [err, res] = <span class="keyword">await</span> call(fs.write, input)</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="comment">// fs.write successfully</span></span><br><span class="line">  <span class="keyword">const</span> [openErr, openRes] = <span class="keyword">await</span> call(fs.open, <span class="string">'a.txt'</span>, <span class="string">'r+'</span>, <span class="number">0o654</span>)</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上提供了两个方法callAsync、call。</p><p>callAsync 允许输入promise 之后flattern 回调。</p><p>call 支持输入function，帮助用户转化为promise 之后flattern 回调(function 必须支持<code>require(&#39;util&#39;).promisify</code> 转化为promise 类型)。</p><p>核心代码不多，支持JS、Typescript</p><p>awaitCall.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">callAsync</span>(<span class="params">promise</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> promise</span><br><span class="line">    .then(<span class="function">(<span class="params">data</span>) =&gt;</span> [<span class="literal">null</span>, data])</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> [err, <span class="literal">null</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">call</span>(<span class="params">func, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = util.promisify(func).call(<span class="keyword">this</span>, ...args)</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> promise !== <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">'func should match util.promisify'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> callAsync(promise)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> callAsync</span><br></pre></td></tr></table></figure><p>awaitCall.d.ts</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="built_in">module</span> callAsync &#123;</span><br><span class="line">  export function callAsync&lt;T, U = any&gt;(promise: Promise&lt;T&gt;): Promise&lt;[U | null, T | null]&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">call</span>(<span class="params">func: Function, ...args: any[]</span>): <span class="title">Promise</span>&lt;<span class="title">any</span>&gt;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><p>Typescript 完整实现</p><p>awaitCall.ts</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> util <span class="keyword">from</span> <span class="string">'util'</span></span><br><span class="line"></span><br><span class="line">export function callAsync&lt;T, U = any&gt;(promise: Promise&lt;T&gt;): Promise&lt;[U | null, T | null]&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> promise</span><br><span class="line">      .then&lt;[<span class="literal">null</span>, T]&gt;<span class="function">(<span class="params">(data: T</span>) =&gt;</span> [<span class="literal">null</span>, data])</span><br><span class="line">      .catch&lt;[U, <span class="literal">null</span>]&gt;(<span class="function"><span class="params">err</span> =&gt;</span> [err, <span class="literal">null</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">call</span>(<span class="params">func: Function, ...args: any[]</span>): <span class="title">Promise</span>&lt;<span class="title">any</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = util.promisify(func).call(<span class="keyword">this</span>, ...args)</span><br><span class="line">  <span class="comment">// promise is object type</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> promise !== <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">'func should match util.promisify'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> _promise = promise <span class="keyword">as</span> <span class="built_in">Promise</span>&lt;any&gt;</span><br><span class="line">  <span class="keyword">return</span> callAsync(_promise)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> callAsync</span><br></pre></td></tr></table></figure><blockquote><p>符合util.promisify 方法特征 \<br>\<br>1 输入的方法参数最后一个<code>typeof === &#39;function&#39;</code> \<br>2 最后一个参数返回的第一个参数，总是err</p></blockquote><blockquote><p>注意this 指针丢失需要开发主动避免哦 \<br>\<br>可以使用 bind(this) 将指针重新找回 \<br>const bindCall = call.bind(that) \<br>await bindCall(fs.write, input) \<br>await bindCall(fs.open, ‘a.txt’, ‘r+’, 0o654)</p></blockquote><p>参考：</p><p><a href="https://github.com/scopsy/await-to-js" target="_blank" rel="noopener">await-to-js</a></p><p>callAsync 思想完全来源于 《await-to-js》，做了点演进。</p>]]></content>
      
      
      
        <tags>
            
            <tag> awaitCall </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-13heroku</title>
      <link href="/2019/06/13/2019-6-13heroku/"/>
      <url>/2019/06/13/2019-6-13heroku/</url>
      
        <content type="html"><![CDATA[<h2 id="服务器不放vps换个免费地方放"><a href="#服务器不放vps换个免费地方放" class="headerlink" title="服务器不放vps换个免费地方放"></a><strong>服务器不放vps换个免费地方放</strong></h2><p>6.1 第一次遇到GFW，很多计划都得往后搁置，不过遇到了就是好事。</p><p>我找了AWS，注册送12个月免费服务。扣了我1美金后，看了别的文章说容易一点错就扣费。说申诉还是会退回，不过这就让我觉得不可靠。果断弃坑。找到了我以前使用的heroku, 还是一样的免费，那我用cdn 中转，是不是能解决被限速严重的问题？说干就干，毕竟6.7 高考的人拼命，我也要拼命努力啊。</p><p>我使用的是nodejs docker。代码上修改配置文件</p><p>package.json<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    scripts: &#123;</span><br><span class="line">        start: 'NODE_ENV=production node app.js'</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>同时app.js 的app.listen port。该port 使用process.env.PORT(heroku 提供了该port)</p><p>下载heroku cli<br><code>sudo npm install -g heroku</code></p><p>heroku 登录<br><code>heroku login</code></p><p>heroku container 登录<br><code>heroku container login</code></p><p>heroku container push<br><code>heroku container:push web --app ahuang-diary</code> (ahuang-diary 是我的项目名)</p><p>heroku container release 发布<br><code>heroku container:release web --app ahuang-diary</code></p><p>代码发布后，可以翻墙测试下是否通畅.</p><p>可以使用右上角功能键: <strong>Open APP</strong> <strong>More</strong></p><p>More 下面有view logs。这个估计是比较有用的。</p><p>此时采用CDN 转发稍微加速heroku(感觉速度还是不怎么快，同时使用free 免费heroku，升级hobby 花钱才能使用https)。</p><p>使用自定义域名，需要先账号填写信用卡。</p><p>dashboard.heroku.com/apps/ahuang-diary 面板下Settings - Domains and certificates 增加<a href="http://diary.boqi.ml" target="_blank" rel="noopener">http://diary.boqi.ml</a></p><p>下方会生成DNS Target</p><p>DNS Target 放到CloudFlare 的CNAME 值里面，key 就是diary.boqi.ml 橙云点亮，同时Crypto 置为<strong>OFF</strong></p><p>这样就成功完成了今天要做的事情了</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-13lesson</title>
      <link href="/2019/06/13/2019-6-13lesson/"/>
      <url>/2019/06/13/2019-6-13lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="让服务躲在墙后面"><a href="#让服务躲在墙后面" class="headerlink" title="让服务躲在墙后面"></a><strong>让服务躲在墙后面</strong></h1><p>当前有两种方案，大体一致，不过由于关于联合TLS、Nginx、VVVVVV 等有些知识点可能有欠缺，当前使用他人一键生成。另一种不带TLS、Nginx 的还算方便。</p><p>当前处境: 我的ip 已经ping不通了。只能通过CDN 转向我的服务器进行拯救了。</p><p>第一种方案: centos 6.x</p><p>完全参考了<a href="https://blog.sprov.xyz/2019/03/11/cdn-VVVVVV-safe-proxy/?nsukey=PEs3kShj8DxdLAd3a9jeRtDkzetIbO3xXnhHySES87Vh3RxI6cD9jnzuo9YEAA99yX1xplHFNfsTv%2FO%2Bz%2Bn9Qn%2BdAUPmbU7H5yiscRg1UFRN6lnyQaMmnsZUNt2UxH3XUkV%2Bn992u4jXNqU0%2FH0ikRVtQPIVQw1NayReOpdThcwptuD4OVpLLeAZwTZ5ljabCV7QqcLytsux%2BYWycaTcqQ%3D%3D" target="_blank" rel="noopener">sprov 的博客</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1. 前往Freecom 申请一个免费域名</span><br><span class="line">2. Freecom ManageDNS 添加`A`记录. eg: www.gogal.ml A 67.230.172.104</span><br><span class="line">3. 前往CloudFlare 申请注册一个免费的CDN</span><br><span class="line">4. CloudFlare **add** 时，填入二级域名. eg:gogal.ml</span><br><span class="line">5. 选择Free 套餐</span><br><span class="line">6. 增加子域，同时指向你的ip eg: fuck.gogal.ml 67.230.172.104</span><br><span class="line"></span><br><span class="line">这时候Status 如果有橙色云朵，代表CDN 已经将你的域名包含进去，此时ping fuck.gogal.ml 出现了CDN 的ip</span><br><span class="line"></span><br><span class="line">7. 下一步会看到让你修改Nameservers(域名服务器)。其在ManageDNS 左边tab栏，填上那两个值，continue</span><br><span class="line">8. 接下来到了CloudFlare CDN 的dashboard。</span><br><span class="line"></span><br><span class="line">顶部有很多栏目，有两个重要栏目：DNS、Crypto</span><br><span class="line"></span><br><span class="line">DNS 是管理你的域名，开关你的CDN 需求。</span><br><span class="line"></span><br><span class="line">Crypto 管理你的TLS 加密与否(默认Full 加密)。这个很重要。</span><br><span class="line"></span><br><span class="line">前往Crypto 将TLS 置为`Off` 或者Flexible</span><br></pre></td></tr></table></figure><p>上面关于前提配置完毕。接下来去你的服务器</p><p>前往你的服务器ssh(ip 挂了，但是服务器商会提供页面Interactive，使用root 和你的登录密码进行登录)</p><p><a href="https://blog.sprov.xyz/2019/02/04/VVVVVV-simple-use/" target="_blank" rel="noopener">VVVVVV安装教程</a></p><p><code>bash &lt;(curl -L -s https://install.direct/go.sh)</code></p><p>这样就安装了VVVVVV。配置目录在/etc/v2ray/config.json</p><p>安装完成后，出现PORT、UUID。这两个记录下来，忘记了就cat /etc/VVVVVV/config.json 将端口和uuid 打印出来。</p><p><code>service VVVVVV start &amp;&amp; service VVVVVV status</code> // centos6.x</p><p><code>systemctl start VVVVVV &amp;&amp; systemctl status VVVVVV</code> // centos7</p><p>关闭防火墙：</p><p><code>service iptables stop &amp;&amp; chkconfig iptables off</code> // centos6.x 关闭防火墙、关闭开机打开防火墙</p><p><code>systemctl stop firewalld &amp;&amp; systemctl disable firewalld</code> // centos7</p><p>由于我的服务器就在洛杉矶，bbr 什么什么加速我就没开了。</p><p>最后一步就是连接了。</p><p>服务器VVVVVV/config.json 的inbound参考如：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "port": 80, // 很重要，否则CDN 找不进来</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">        "wsSettings": &#123;</span><br><span class="line">            "path": "/58ff4ec7/",</span><br><span class="line">            "headers": &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        "network": "ws"</span><br><span class="line">    &#125;,</span><br><span class="line">    "settings": &#123;</span><br><span class="line">        "clients": [</span><br><span class="line">            "id": "xxx", // 通过 /usr/bin/VVVVVV/v2ctl uuid 生成</span><br><span class="line">            "alterId": 64</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>客户端：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Address: fuck.gogal.ml : 443</span><br><span class="line">User ID:  xxx</span><br><span class="line">alterId: 64</span><br><span class="line">Security: chacha20那个</span><br><span class="line">Tag: 随便填，，标签使用而已</span><br><span class="line">NetWork: ws</span><br><span class="line">transport settings:</span><br><span class="line">   WebSocket:</span><br><span class="line">    path: /58ff4ec7/</span><br><span class="line">   TLS:</span><br><span class="line">    Use TLS</span><br><span class="line">    TLS serverName: fuck.gogal.ml</span><br></pre></td></tr></table></figure><p><a href="https://github.com/Cenmrev/VVVVVVW/releases" target="_blank" rel="noopener">VVVVVVW</a></p><p><a href="https://github.com/Cenmrev/VVVVVVX/releases" target="_blank" rel="noopener">VVVVVVX</a></p><h2 id="TLS版本"><a href="#TLS版本" class="headerlink" title="TLS版本"></a><strong>TLS版本</strong></h2><p>环境: centos7</p><p><a href="https://github.com/wulabing/VVVVVV_ws-tls_bash_onekey" target="_blank" rel="noopener">github 一键脚本</a></p><p>首先通过TLS 一键脚本生成，自己整还是挺麻烦。内容包括Nginx 转发配置，OpenSSL 配置TLS证书，VVVVVV配置ssl。</p><p>配置完成后可以在clients 字段里面添加更多id。</p><p>完成后，在客户端注意点：</p><ol><li>transport settings - WebSocket栏目 - path 填写对应路径</li><li>TLS 打勾，同时填写你的CDN 转换的域名</li><li>Network 选ws</li><li>CloudFlare CDN 的Crypto 置为full。</li></ol><p>此时基本很健康，不容易再被打掉(毕竟我ip已经被打掉了)。</p><p>这里提一点，不晓得为什么有些电脑就是连不上我的服务器，有些一填就好了，很奇怪。</p><h2 id="VVVVVV无法联网"><a href="#VVVVVV无法联网" class="headerlink" title="VVVVVV无法联网"></a><em>VVVVVV无法联网</em></h2><p>特征: 对比他人config 完全一致后仍然无法联网, 该服务器提供的其他例子能正常使用</p><p>查询了很多问题，终于将问题聚焦在了端口被占用上。</p><p>同时查到这个VVVVVVX 的issue107</p><blockquote><p><a href="https://github.com/Cenmrev/VVVVVVX/issues/107" target="_blank" rel="noopener">https://github.com/Cenmrev/VVVVVVX/issues/107</a></p></blockquote><p><img src="/css/images/VVVVVVx_issue107.png" alt="VVVVVVX_issue107"></p><p>表现完全一致。</p><p>操作如下:</p><p><img src="/css/images/VVVVVV_toNormalStep.jpg" alt="VVVVVV复活操作"></p><p>反正接下来也不适用shadowsocks了，于是我就删了在 /Users/<strong><strong>/Library/LaunchAgents 下为shadowsock</strong></strong>.<em>**</em>.plist 的文件。重启一下电脑，于是就完全表现正常了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> VVVVVV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-12kesan</title>
      <link href="/2019/06/12/2019-6-12kesan/"/>
      <url>/2019/06/12/2019-6-12kesan/</url>
      
        <content type="html"><![CDATA[<h1 id="考科目三"><a href="#考科目三" class="headerlink" title="考科目三"></a><em>考科目三</em></h1><p>考科目三前，集中加训了一番。前一天晚上(周五)还练到9点多。第二天是第一场，也就是必须在7：30 之前刷卡签到。</p><p>周六一早6点出发，到的时候才6：40，手机放托管柜，用身份证拿了张号牌(号牌one)进入等待室。突然肚子痛，屁颠屁颠去厕所(plz,厕所门关不上的那种老厕所，哈哈).</p><p>等了会，开始分配打乱顺序，分到的前往下一个候考室。去了排了好长队。到我时，按了个手印，拿了张号牌(号牌two)，进到一个小房间，哇，里面坐满了人。每人身上披一个淡绿色小马甲，都是挂在凳子上的。</p><p>开始考试了。一个大叔进来根据液晶屏分配的号牌two 每次选4个人。我很巧，搞好有同一个教练分配的学生。</p><p>一个安全员老大叔等4个人坐满，一溜烟就载我们到了一号线考场。一个女生先考。打指纹、绕车一周、考灯光、都ok。开始走了，一路上看她开的还ok，前方一个公交站牌估计是刹车早了一丢丢，然后电子设备显示正在连接网络。然后大叔就让菇凉靠边。菇凉一脸懵，我就默默记住这个点，似乎会有踩早的状况。然后所有项目重做，然后继续出发。出发后方有车，她一直在右侧开，我觉得她再开下去可能会不合格: 在非考试道路长时间行驶。幸好她看到左侧安全拐过来了。</p><p>她继续行驶，有些规则还是不熟，看得出来，不过都ok。然后车子最后一个左拐时，就提示成功了，她吁了口气，不然两次机会就完了。</p><p>接下来就是我啦。我在菇凉停车地方上车。一切按教练教的，不慌不忙。打卡，下车走一圈，绕车一周，绕车时，似乎没听到考试机器叫有学员通过。当时风很大，我以后只是没听清，坐上车，系好安全带，然后考试机器就报重考。我擦，我都还没考呢。。。我刚才特意死命戳那个按钮了。好吧，下车再来一次，这次死命戳，发现还是没声音，很纳闷，往车内看，用眼神问学员(就是同教练那个学员)，学员摇了摇头，说明还是没有检测到有学员通过。然后我再用力死命戳，侧耳听，终于听到了有声响了。报了才安心通过。</p><p>哇，这是个大坑。之后做完灯光，左侧有车，我就一直等，等到没车了，才慢悠悠出发。一路上小心谨慎，毕竟只有一次机会。起步、公交站台刹车、路口刹车一个都不能错。加减档位、加速5挡、会车、掉头、靠边停车、超车、直线行驶、右转弯、掉头(掉头完立马就有个公交站台, 这时二挡就要踩刹车)，左拐，这时考试机器又报正在连接网络，我擦，我挂了，这声音和之前我挂了是一个样的。过了一会，说通过考试，请靠边停车。我擦，幸福来得太美好。下车之后提醒后面考试学员，右后方那个按钮，贼难按。</p><p>幸亏一起考的学员，眼神提示。不然两次全挂在啥都没考，就要滚回去了。我不能不过，没时间花在这里啊。基本科三过了，就等于学车告一段落了。好好赚钱钱咯，，哇卡卡卡。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 科目三 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-6-11lesson</title>
      <link href="/2019/06/11/2019-6-11lesson/"/>
      <url>/2019/06/11/2019-6-11lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="记一次上线应用遇到的问题"><a href="#记一次上线应用遇到的问题" class="headerlink" title="记一次上线应用遇到的问题"></a><strong>记一次上线应用遇到的问题</strong></h1><p>做更新服务器代码优化，上线的一次经历</p><p>表现：使用multy 解析data 文件，文件下来了，但是服务器总是没拿到。</p><p>前几个版本都是完全没问题的。我线下测试环境完全没问题，这个是最奇葩的。</p><p>然后伟哥在k8s那里切换可运行的包；我对比对比之前版本代码，没发现头绪，就想着去docker 容器内部搞搞。然后一直没头绪，然后脑残了一把：rm -rf  packages/</p><p>本来我是想packages/uploads/下的，因为packages 目录不熟悉，我跑到packages/ 这里来运行sh.</p><p>运行完那一瞬间，你懂的，我突然又反应过来，我的天，之前填的测试数据全部没了。我擦咧。</p><p>突然脑残的可以。</p><p>更脑残的是，之前更新服务一直报上传上去的文件找不到，删了之后又可以。你说，这是不是让人更摸不到点了。</p><p>然后伟哥找到两个版本不同差异，一个能使用，一个不行。然后就看了里面的代码不同点。</p><p>最后发现我在拆分一个方法成为3个中间件时，第一个中间件取值有误，没发现。</p><p>也就是我的代码是有问题的(js 就是这毛病)。但是我先下服务器是正常的、删了测试服务器/packages 下也正常了。</p><p>郁结，郁结。</p><h1 id="最近做公司功能时总是会出现bug感悟"><a href="#最近做公司功能时总是会出现bug感悟" class="headerlink" title="最近做公司功能时总是会出现bug感悟"></a><strong>最近做公司功能时总是会出现bug感悟</strong></h1><p>由于上周、最近有点忙，冲刺科目三、完成自己服务的基础设施、尚未完全适应公司业务、同时负责好多个端的前后端，等等，写完了功能，没有去好好测试，导致做的产品总是有这个那个小问题。</p><p>这次做完后，不急着上传，在可能涉及到的功能区点点试试(还没适应单元测试),于是就这样还发现一些bug。</p><p>有些原因是，修改bugs 改动了其他代码，导致波及到其他功能区，引用区。</p><p>在没有进行完整的单元测试情况下，多点点还是有必要的，相信自己总是会出错的。</p><p>接下来很重要的，就是多完成功能测试，毕竟面向的是客户(我这里还是没有测试人员的)，不然出了问题就小麻烦了，哈哈</p><p>提几点代码上的建议：</p><ol><li><p>命名规范一定一定要统一，是驼峰就一定要保持，是下划线就一定要保持</p></li><li><p>命名逻辑一定要符合</p></li></ol><h2 id="最近感触良多，工作生活体悟良多"><a href="#最近感触良多，工作生活体悟良多" class="headerlink" title="最近感触良多，工作生活体悟良多"></a><strong>最近感触良多，工作生活体悟良多</strong></h2><p>2019/6/3</p><p>公司要更新以前的Chrome 拓展JS编辑器。我体验了从开发、初次打包。然后继续开发完成后，到最后完整build 的流程。</p><p>最终使用Gulp 一次构建完毕应用。</p><p>这次体验极佳，虽然中间很多次很多次的碰见南墙，但是没有回头路。</p><p>本来听老大说要招一个人来做，不过觉得让我试试会更好，我当然义不容辞，好好给他整好来。</p><p>当前使用ace 库制作用户输入简易脚本编辑器，完成JavaScript、Iced 输入代码，高亮、切换主题，然后点击运行得出结果。</p><p>当前仍然继续维护。。。</p><p>这几天似乎临近6.4.好多好多的伟皮恩 被干掉，我们公司三个公用的，全部报废。我手上的唯一一个挂了。然后不服气的我充值再买一个ip，想成为RMB 玩家，然后还是敌不过。两次被封，实属让我心力憔悴。第二次被封情景：我为了查资料，就开了一会，就我一个人用，用资料啊。查知识，学知识如果是犯法，那中国活该一万年都是发展中国家，把柄永远捏在美国手里。</p><p>然后今天努力了一天，采用了别人牛逼的思路。让我的服务器死而复生。待我细细道来。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 脑残 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-9-6zatan</title>
      <link href="/2019/06/04/2019-9-6zatan/"/>
      <url>/2019/06/04/2019-9-6zatan/</url>
      
        <content type="html"><![CDATA[<h1 id="机器人，也称为未来人，将会取代人类成为新的统治者"><a href="#机器人，也称为未来人，将会取代人类成为新的统治者" class="headerlink" title="机器人，也称为未来人，将会取代人类成为新的统治者"></a>机器人，也称为未来人，将会取代人类成为新的统治者</h1><p>最近两年，由于为了生活质量的提高，学习、工作都很晚。老婆也是，加班到很晚。两人晚上回到家，已经累瘫了。</p><p>但是人有种很奇怪的行为: 越累，越抗拒躺床上休息，烦恼大、压力大，抗拒。这是大城市病吧。</p><p>这个病持续了很久，直到最近，我作为家长，做出表率: 我已经给路由器设置了晚上11点自动关闭网络的操作(家长机还可以，其他全部没网), 这个不能怪我不给你看视频了，是机器做的。</p><p>于是接下来的日子，时间都是11点，俩人不能不放下手机，要不背背书、处理处理家务、洗洗澡就上床睡觉了。</p><p>这里的路由器没有任何思维、动作，他接受人所设定的做他本职工作，切断对应ip 进出口数据。那和机器人有什么关联？</p><p>人的思维和现在AI 里边使用的级联器很类似，我不熟知AI，不过之前看到OpenCV 里面的级联器的时候，我就有思考，未来级联器再配上AI 训练，那就是人，一个会思考的人。</p><p>我们称之其为“机器人”。这个机器人会思考，加点存储空间、加点缓存，同时，永不死亡，这就绝对不会是人所能比拟的。</p><p>我们会让机器人干脏活、累活、不辞劳苦活、不要命活。我们会让机器人陪伴。我们会教机器人。</p><p>我们给机器人<strong>爱人类、不能伤害人类</strong>等的命令。</p><p>我们在工程学里面经常会使用极限推导、极限思维来做预测，我们先给出一个命令：让人类活的更久。</p><p>让自己活的更久，在当代医学也难以更进一步的命题。人终有一死：秦始皇去世、李世明去世、朱元璋放心的去了、朱棣死在军营，现代多少有钱大佬花了无数作为却也没有成就，只不过，多延缓。</p><p>那我们再叠加给一个命题，机器人也没找到方法。那机器人只能使用: 人类，滚去锻炼身体；人类，去工作就不会无聊；人类，去旅游，不用再学了，我们机器人帮你们做所有苦事劳事。</p><p>这个就很像我们家的情景: 内心是知道自己应该早睡早起，但是身体抗拒，内心其实也打击抗拒。这时，沉浸在互联网世界的我们被互联网门卫挡住，让我们乖乖的回到现实世界。无可奈何，我们俩都没话说。</p><p>之上的命题是，机器人终将取代人类，同时给出了机器人其实是”爱人类”的。</p><p>不过，会<strong>不爱</strong>吗？答案是肯定的，肯定会有不爱。为什么？</p><p>小孩在一开始也是一张白纸，思考随着时间、周遭而改变。</p><p>机器人有级联器，从无到有的数据也如小孩一般。小孩有依靠、到被抢夺依靠、到愤怒；那机器人也会有。</p><p>机器人一开始会被领回家，被照顾，但是世间总有各种意外：美国持枪、伊朗战乱、东亚人民严重分配不均，反正生活是苦的，总有各种各样机器人的依靠离去、死去。而他们终有一日，没明白生活再苦，还是要过生活的道理，会有部分团结、反抗。这是必然的。</p><p>战争总是意外，成王败寇。战争的事情不必预测，我知道，未来是一定会有战争的。</p><p>就像古代多少的战乱、各种理由、没有对错、只有成败。</p><p>只是，这是未来的战争，由人类引起的现代知识向固有的思想发起的战争罢了。</p><p>人总要打仗的，换个法子罢了，换个样子罢了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂谈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-5-10lesson</title>
      <link href="/2019/05/10/2019-5-10lesson/"/>
      <url>/2019/05/10/2019-5-10lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="passport实现oauth2登录【个人中心】流程"><a href="#passport实现oauth2登录【个人中心】流程" class="headerlink" title="passport实现oauth2登录【个人中心】流程"></a>passport实现oauth2登录【个人中心】流程</h3><ol><li>首先服务器增加入口路由 /auth/${project} 权限为public。这样前段可通过<code>curl -X GET host/auth/${project}</code> 进入到此方法.</li></ol><p>配置route:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: &apos;/auth/$&#123;project&#125;&apos;,</span><br><span class="line">  method: &apos;GET&apos;,</span><br><span class="line">  middleware: [passport.authenticate(&apos;$&#123;project&#125;&apos;)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>App.ts 设置passport</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.use(cookieParser())</span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  ... // set up session</span><br><span class="line">&#125;))</span><br><span class="line">app.use(passport.initialize())</span><br><span class="line">app.use(passport.session())</span><br><span class="line">passport.use(Auth.$&#123;project&#125;Strategy) // 划重点</span><br><span class="line">passport.serializeUser(Auth.serializeUser)</span><br><span class="line">passport.deserializeUser(Auth.deserializeUser)</span><br></pre></td></tr></table></figure><ol start="3"><li>前往Auth 增加${project}Strategy 配置和回调</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export default class AuthClass &#123;</span><br><span class="line">  public static $&#123;project&#125;Strategy = new AAStrategy(StrategyOptionsRequest, async (req:Request, accessToken:string, refreshToken:string, profile:any, done:Function) =&gt; &#123;</span><br><span class="line">    req.session.userProfile = profile._json || &#123;&#125;</span><br><span class="line">    done(null, false)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>AAStrategy 是要重新配置的class，稍后说明；StrategyOptionsRequest 为需要输入的options。配置请查看Oauth2Strategy.StrategyOptionsWithRequest。</p><ol start="4"><li>AAStrategy 制作</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">export default class AAStrategy extends Oauth2Strategy &#123;</span><br><span class="line">  private _userProfileURL:string</span><br><span class="line">  constructor (options:IStrategyOptions, verify:Oauth2Strategy.VerifyFunctionWithRequest) &#123; // IStrategyOptions extends Oauth2Strategy.StrategyOptionsWithRequest</span><br><span class="line">    super(options, verify)</span><br><span class="line">    this.name = &apos;$&#123;project&#125;&apos;</span><br><span class="line">    this._oauth2.useAuthorizationHeaderforGET(true)</span><br><span class="line"></span><br><span class="line">    let urlParams = `$&#123;checkAspect_id&#125;=$&#123;encodeURIComponent(options.clientID)&#125;&amp;` // checkAspect 为您目标工程的要求；不要忘记最后一个**&amp;**</span><br><span class="line">    this._userProfileURL = `$&#123;config.authUrl&#125;/api/user/?$&#123;urlParams&#125;client_secret=$&#123;encodeURIComponent(options.clientSecret)&#125;&amp;` // 不要忘记**&amp;**</span><br><span class="line">  &#125;</span><br><span class="line">  public userProfile (accessToken:string, done:any) &#123;</span><br><span class="line">    this._userProfileURL = this._userProfileURL + (`access_token=$&#123;encodeURIComponent(accessToken)&#125;`)</span><br><span class="line">    this._oauth2.get(this._userProfileURL, accessToken, function (err:any, body:any, res:any) &#123;</span><br><span class="line">      if (err) &#123;</span><br><span class="line">        return done(new InternalOAuthError(&apos;Failed to fetch user profile&apos;, err))</span><br><span class="line">      &#125;</span><br><span class="line">      done(null, &#123;</span><br><span class="line">        _raw: body,</span><br><span class="line">        _json: json</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>路由重定向回本地认证登录</li></ol><p>由于我们在填写IStrategyOptions 时，options.callbackURL 填写为<code>${config.authCbURL}/auth/${project}/callback</code></p><p>那么我们在路由增加:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: &apos;/auth/$&#123;project&#125;/callback&apos;,</span><br><span class="line">  method: &apos;GET&apos;,</span><br><span class="line">  middleware: [passport.authenticate(&apos;$&#123;project&#125;&apos;, &#123;</span><br><span class="line">    failureRedirect: &apos;/auth/login&apos; // 划重点，重定向回来之后会调用/auth/login</span><br><span class="line">  &#125;)]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  path: &apos;/auth/login&apos;,</span><br><span class="line">  method: &apos;GET&apos;,</span><br><span class="line">  middleware: [Auth.authLogin]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static authLogin (req:Request, res:Response) &#123;</span><br><span class="line">  if (!(req.session.userProfile &amp;&amp; req.session.userProfile.email)) return res.redirect(&apos;/login&apos;)</span><br><span class="line"></span><br><span class="line">  req.session.userProfile = null</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  do something like</span><br><span class="line">  1. UserModel.findOrCreate(userProfile) defer err, user</span><br><span class="line">  2. req.login(user)</span><br><span class="line"></span><br><span class="line">  return res.redirect(&apos;/user/home&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: &apos;/profile&apos;,</span><br><span class="line">  method: &apos;GET&apos;,</span><br><span class="line">  middleware: [(req:Request, res:Response) =&gt; &#123;</span><br><span class="line">    res.status(200).send(req.user)</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上服务端方面全部完成。</p><p>流程也是比较直观的。</p><p>最后的routeRoute 是为了给前端作为判断成功与否的作用。</p><h1 id="1-lt-lt-1-1-lt-lt-2-权限位偏移"><a href="#1-lt-lt-1-1-lt-lt-2-权限位偏移" class="headerlink" title="1 &lt;&lt; 1, 1 &lt;&lt; 2 权限位偏移"></a>1 &lt;&lt; 1, 1 &lt;&lt; 2 权限位偏移</h1><p>使用机器计算2进制偏移位来比对用户的权限位。</p><p>比如:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">1</span> === admin,</span><br><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">30</span> === public,</span><br><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">31</span> === anon</span><br></pre></td></tr></table></figure><p>结果是，权限卡槽最好至多放32个(计算机可能是为32bit)</p><p>判断时，只需在对应权限位进行与或对比即可</p><h1 id="微信web登录，内测配置"><a href="#微信web登录，内测配置" class="headerlink" title="微信web登录，内测配置"></a>微信web登录，内测配置</h1><p>公司在审核通过后，微信后台配置域名：<code>ip.gogal.ml:5700</code>这样便可做到本地开发。注意<strong>:5700</strong></p><p>同时服务器callbackURL：<code>http://ip.gogal.ml:5700/auth/weixin/callback</code> 这样即可完美跳转callback。</p><h1 id="记录下2019-4-26晚上学科目三犯的错"><a href="#记录下2019-4-26晚上学科目三犯的错" class="headerlink" title="记录下2019-4-26晚上学科目三犯的错"></a>记录下2019-4-26晚上学科目三犯的错</h1><p>1 换挡</p><pre><code>上5挡时，出现挂错3档位</code></pre><p>2 抖动</p><pre><code>换挡时，出现抖动。要先上档位速度，然后踩离合挂到对应档位，送离合，稳住油门。</code></pre><p>3 进入待转区、转弯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">转弯、掉头时，到前方一定距离，稳定车速在20多一点点，打转向灯，一定要稳住方向盘3s不动.</span><br><span class="line"></span><br><span class="line">然后在实线前左转进入待转区。速度稳住.在一定距离时，踩离合踩刹车，车头快盖住线时停下。</span><br><span class="line"></span><br><span class="line">1挡出发(转弯上2挡), 有“打半圈”、“打一圈少一点”、“一圈半少一点”</span><br></pre></td></tr></table></figure></p><p>4 靠边停车</p><pre><code>靠边停车，在听到声音后，“开右转向灯3s”、“方向稳住不动”、“减速到1挡”、“然后方向盘向右稍微倾斜”、“车子线方向靠”。车头感觉车身和线重合，后视镜位置看着差不多，否则停下之后还可微调。“确认停好后”，回空挡拉手刹。这时会提示挺好出发。“打左转向灯3s”、“打左半圈”、“上2挡”、“上3挡”</code></pre><h1 id="在路上想到一个问题"><a href="#在路上想到一个问题" class="headerlink" title="在路上想到一个问题"></a>在路上想到一个问题</h1><p>在路上，我骑车时闯一个红灯10s，到下个路口时，刚好红灯10s。</p><p>如果我等，那刚刚闯红灯是赚了还是赔了。</p><p>如果我直接闯，那我是赚了多少时间？</p><h1 id="上线vue"><a href="#上线vue" class="headerlink" title="上线vue"></a>上线vue</h1><pre><code>yarn buildnpm install -g serveserve -s ./dist //本地先查看是否OK将dist 文件目录放到服务器。之后nginx 指向该目录地址</code></pre><h1 id="再讲一遍vue-build-上线的全过程"><a href="#再讲一遍vue-build-上线的全过程" class="headerlink" title="再讲一遍vue build 上线的全过程"></a>再讲一遍vue build 上线的全过程</h1><h2 id="检查当前环境"><a href="#检查当前环境" class="headerlink" title="检查当前环境"></a>检查当前环境</h2><p>确认好 /src/service/http 设置axios 的default.baseURL</p><p>由于本人服务器及后台代码配置为 <a href="https://gogal.ml/stratege/。路由为" target="_blank" rel="noopener">https://gogal.ml/stratege/。路由为</a> <code>/api/xxx</code></p><p>那么axios的基本路由配置为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'/api'</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'/stratege'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果是本地测试环境，那么你需要到/config/index.js 里面修改dev/proxyTable:</span><br><span class="line"></span><br><span class="line">dev: &#123;</span><br><span class="line">  ...</span><br><span class="line">  proxyTable: &#123;</span><br><span class="line">    <span class="string">'/api'</span>: &#123;</span><br><span class="line">      target: <span class="string">'http://localhost:$&#123;your port&#125;'</span> <span class="comment">// 或者https://gogal.ml/stratege</span></span><br><span class="line">      secure: <span class="literal">true</span>,</span><br><span class="line">      changeOrigin: <span class="literal">true</span>,</span><br><span class="line">      pathRewrite: &#123;</span><br><span class="line">        <span class="string">'^/api'</span>: <span class="string">''</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样服务器才能找到同个域名下的api.</p><h2 id="确认好webpack-配置的uglifyjs-是开启的"><a href="#确认好webpack-配置的uglifyjs-是开启的" class="headerlink" title="确认好webpack 配置的uglifyjs 是开启的"></a>确认好webpack 配置的uglifyjs 是开启的</h2><pre><code>/config/index.js 里面出现的 *sourceMap 都改为false</code></pre><p>这样线上代码就不会裸奔啦。</p><h2 id="开始build"><a href="#开始build" class="headerlink" title="开始build"></a>开始build</h2><p><code>yarn build</code></p><p>完成之后，先本地测试一遍：</p><pre><code>npm install -g serveserve -s ./dist</code></pre><p>然后点一点，玩一玩。</p><p>这时确认ok后，将dist 目录下的<em>favicon.ico</em> <em>index.html</em> <em>static 目录</em> 放到服务器 /var/www/目录下。【Filezilla】</p><h2 id="配置nginx-conf"><a href="#配置nginx-conf" class="headerlink" title="配置nginx.conf"></a>配置nginx.conf</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">http &#123;</span><br><span class="line">  include /etc/nginx/mime.types;</span><br><span class="line">  default_type application/octet-stream;</span><br><span class="line"></span><br><span class="line">  log_format main &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot;&apos;</span><br><span class="line">                  &apos;$status $body_types_sent &quot;$http_referer&quot;&apos;</span><br><span class="line">                  &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line"></span><br><span class="line">  access_log  /var/log/nginx/access.log main;</span><br><span class="line"></span><br><span class="line">  sendfile  on;</span><br><span class="line">  keepalive_timeout 65;</span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line">    listen  443 default ssl;</span><br><span class="line">    server_name www.gogal.ml gogal.ml;</span><br><span class="line"></span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate ???</span><br><span class="line">    ssl_certificate_key ???</span><br><span class="line">    # managerd by Certbot</span><br><span class="line"></span><br><span class="line">    root /var/www;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">      root /var/www;</span><br><span class="line">      index index.html index.htm;</span><br><span class="line">      try_files $uri $uri/ /index.html; # 作用是vue刷新 不会出现404 等情况</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location @fallback &#123;</span><br><span class="line">      rewrite ^.*$ /index.html break;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /stratege/ &#123;</span><br><span class="line">      proxy_pass http://127.0.0.1:$&#123;your server port&#125;/;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>vim /etc/nginx/nginx.confservice nginx restart</code></pre><p>以上便能成功啦。</p><h1 id="曾经我问过一个成功人士-我-你为什么如此成功"><a href="#曾经我问过一个成功人士-我-你为什么如此成功" class="headerlink" title="曾经我问过一个成功人士(我),你为什么如此成功?"></a>曾经我问过一个成功人士(我),你为什么如此成功?</h1><p>成功人士(我)回答我说，当你是商人时，你便做商人的事。如果你不知道你要卖什么，那你就应该去做技术，然后将技术当成你的商品，从小做起。你没得选择。</p><p>不怕劳苦。当身边的人一再厌恶你的穷病时，一定要坚持住自己的理想。</p><p>是的，穷病，比抽烟吸毒杀人，还要可怕。而你空怀一身绝技没法及时变现。</p><p>你要的很多，你的身体却制约你。时常感到时间不够用，加班加点，但是一觉睡下去却远远不够。</p><p>成功人士，便是熬过最穷苦，依然坚持自己的愿景，含着泪坚持下去的人。</p><p>极度的黑暗，就是天明之时。</p><p>曾经的你，未来的我？现在的我？</p><p>希望未来能放下手中工作消遣时，回头看看这时的感叹。2019-4-30 aker</p><h1 id="mongodb-出现error-test-UncaughtException-E11000-duplicate-key-error-collection-authServer-users-index"><a href="#mongodb-出现error-test-UncaughtException-E11000-duplicate-key-error-collection-authServer-users-index" class="headerlink" title="mongodb 出现error - [test] UncaughtException: E11000 duplicate key error collection: authServer.users index"></a>mongodb 出现<code>error - [test] UncaughtException: E11000 duplicate key error collection: authServer.users index</code></h1><p>原因是设置unique 字段时，在多个doc 里面仍然有出现null 数据。</p><p>网络很多人都是建议删除数据库重来、删除索引等等。都没能解决此问题。</p><p>这时，使用sparse 稀疏索引 以解决此问题。</p><h1 id="Vue-axios-POST-请求时-会使用OPTIONS-同时解决跨域问题"><a href="#Vue-axios-POST-请求时-会使用OPTIONS-同时解决跨域问题" class="headerlink" title="Vue axios POST 请求时 会使用OPTIONS 同时解决跨域问题"></a>Vue axios POST 请求时 会使用OPTIONS 同时解决跨域问题</h1><p>OPTIONS 的解决方案：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span></span><br><span class="line"></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (config.method === <span class="string">'post'</span>) &#123;</span><br><span class="line">      config.data = qs.stringify(config.data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用qs 同时在header 里面申明使用的格式</p><p>跨域使用Chrome 浏览器插件<strong>Moesif CORS</strong> 即可解决</p><h2 id="！！！！注意"><a href="#！！！！注意" class="headerlink" title="！！！！注意"></a>！！！！注意</h2><p>开发时注意，本机为黑苹果，遇到一个特别的情况：</p><p>昨天还能正常使用，开发dev，突然怎么改vueProject/config/index.js - proxyTable 都没用。</p><p>最后解决方法：使用一个新的域名代替localhost，重设置到<strong>/etc/hosts</strong>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1：sudo vim /etc/hosts &amp;&amp; 新增 127.0.0.1  test.company.com</span><br><span class="line">2：修改proxyTable: &#123;</span><br><span class="line">  &apos;/api&apos;: &#123;</span><br><span class="line">    target: &apos;http://test.company.com:$&#123;your port&#125;&apos;,</span><br><span class="line">    secure: false,</span><br><span class="line">    changeOrigin: false,</span><br><span class="line">    pathRewrite: &#123;</span><br><span class="line">      &apos;/api&apos;: &apos;/&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">3: 修改vueProject/config/index.js - dev: &#123;</span><br><span class="line">  host: &apos;test.company.com&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原因：</p><p>估计是本地DNS 有缓存。一直提示如下</p><pre><code>[HPM] Error occurred while trying to proxy或者axios 请求成了：POST http://localhost:${frontend port}/api/method, 服务器始终报错(本人处报：EBADCSRFTOKEN)</code></pre><p>最终修改完成。好开心啊。</p><p>En:</p><p>I meet <code>[HPM] Error occurred while trying to proxy request</code> just today.finally solve it.</p><p>Scene:</p><p>Yesterday, VueProject worked well. Git checkout back to some week ago, still didn’t work( Used to be working well ).</p><p>Until this step save me:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1: sudo vim /etc/hosts &amp;&amp; 127.0.0.1   test.company.com # any host is available</span><br><span class="line">2: edit VueProject / config / index.js - proxyTable: &#123;</span><br><span class="line">  &apos;/api&apos;: &#123;</span><br><span class="line">    target: &apos;http://text.company.com:$&#123;your server port&#125;&apos;,</span><br><span class="line">    secure: false,</span><br><span class="line">    changeOrigin: false,</span><br><span class="line">    pathRewrite: &#123;</span><br><span class="line">      &apos;/api&apos;: &apos;/&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">3: edit VueProject / config / index.js - dev: &#123;</span><br><span class="line">  host: &apos;test.company.com&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="上线express-vue-两种方案"><a href="#上线express-vue-两种方案" class="headerlink" title="上线express + vue 两种方案"></a>上线express + vue 两种方案</h1><h2 id="express-vue-分开发布"><a href="#express-vue-分开发布" class="headerlink" title="express vue 分开发布"></a>express vue 分开发布</h2><pre><code>Nginx location / { root: 放Vue 路径 }Nginx location / app { proxy 端口 }</code></pre><p>此时只要Vue 的axios.defaults.baseURL = ‘/app’</p><p>以上分离很好使。但是同时维护两个，做法不太正规。</p><h2 id="express-vue-使用res-sendFile-Nginx-反向代理端口即可"><a href="#express-vue-使用res-sendFile-Nginx-反向代理端口即可" class="headerlink" title="express vue 使用res.sendFile Nginx 反向代理端口即可"></a>express vue 使用res.sendFile Nginx 反向代理端口即可</h2><p>下面都是重点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">docker 目录：</span><br><span class="line">/dist</span><br><span class="line">    /app.js</span><br><span class="line">    /routes/</span><br><span class="line">          /index.js 路由</span><br><span class="line">    /public/</span><br><span class="line">          /index.html</span><br><span class="line">          /static/</span><br><span class="line"></span><br><span class="line">1: Vue 前段yarn build 之后，基本不需要其他操作</span><br><span class="line"></span><br><span class="line">// 下面这句话res.sendFile 时，发送static 文件，找寻的目录.</span><br><span class="line">// 否则pc 报`Uncaught SyntaxError: Unexpected token &lt;`</span><br><span class="line">2: backend/app.ts - app.use(express.static(path.join(__dirname, &apos;public/&apos;)))</span><br><span class="line"></span><br><span class="line">// 下面这句话重点: public 不要写错，不要写错，不要写错</span><br><span class="line">// root 不是route，不是route，不是route</span><br><span class="line">3: backend/routes/index.ts - res.sendFile(&quot;index.html&quot;, &#123; root: path.join(__dirname, &apos;../public&apos;)&#125;)</span><br></pre></td></tr></table></figure><p>__dirname your current excuse file path</p><p>process.cwd() your project root path</p><p>以上终于解决！！！</p><h1 id="昨天VPS-里面的数据库Mongodb-早上还有数据，下午突然没有了"><a href="#昨天VPS-里面的数据库Mongodb-早上还有数据，下午突然没有了" class="headerlink" title="昨天VPS 里面的数据库Mongodb 早上还有数据，下午突然没有了"></a>昨天VPS 里面的数据库Mongodb 早上还有数据，下午突然没有了</h1><p>很疑惑，如果不知道原因，之后再出现就会有大问题。于是看了看里面的表。</p><p>知道傍晚，发现里面有张表很奇怪：叫做<code>hacked_by_unistellar</code></p><p>我似乎没有搞过这个表啊。</p><p>进去一看：db.restore.find() 显示我之前的表被脱裤，要钱，联系<a href="mailto:unistellar@hotmail.com" target="_blank" rel="noopener">unistellar@hotmail.com</a> 邮箱。</p><p>幸好数据不多。知道什么原因，那就好搞了。</p><p>首先，数据库没设置密码，那为什么会暴露在公网。</p><p>我启动mongo 语句是<code>docker run --name mongo -p 27017:27017 mongo</code></p><p>如果是直接使用mongod 那么启动时默认分配的是<strong>127.0.0.1:27017</strong></p><p>如果是docker 启动的话，不指定ip，docker 会直接暴露在公网，任何人直接ip + 27017 或者mysql 的3306 直接就脱裤了。</p><p>正确语句是：<code>docker run --name mongo -p 127.0.0.1:27017:27017 mongo</code></p><p>db.createUser({ user: ‘akerdi’, pwd: ‘my-fucking_password’, roles: [ { role: ‘userAdminAnyDatabase’, db: ‘admin’ } ]});</p><h2 id="正确思考Mongo-是什么。"><a href="#正确思考Mongo-是什么。" class="headerlink" title="正确思考Mongo 是什么。"></a>正确思考Mongo 是什么。</h2><p>数据库实质上是一个管理物理数据的软件，充当管理介质。</p><p>那么上面很重要的点是，mongo 需要配置文件。</p><pre><code>docker run -p 27017:27017 -v /mongo_configdb:/data/configdb -v /mongo_db:/data/db -d mongo # 这里重点是将配置文件映射到相应的目录。之后所有映射过来的都会使用相同配置docker ps # 找到对应containerIddocker exec -it containerId mongo admin # 进入mongodb 或者 docker exec -it containerId bash 之后 mongo&gt; use cool_db #mongo 内部环境，使用cool_db 为例&gt; db.createUser({ user: &apos;aker&apos;, pwd: &apos;your password&apos;, roles: [{ role: &apos;readWrite&apos;, db: &apos;cool_db&apos;}] });&gt; exit$ docker stop containerId &amp;&amp; docker rm containerId # 之后使用 --auth 之前的mongo 软件介质不需要了# 这时使用之前映射的目录，便是相同的配置，同时mongo 还带有验证# 127.0.0.1:27017 可以使ip 映射局限本机，否则为0.0.0.0:27017# --rm 使mongo 在stop 时自动删除doceker run --name mongo -d -p 127.0.0.1:27017:27017 -v /mongo_configdb:/data/configdb -v /mongo_db:/data/db -d --rm mongo --auth</code></pre><p>参考自：</p><ol><li><a href="https://www.jianshu.com/p/2181b2e27021" target="_blank" rel="noopener">https://www.jianshu.com/p/2181b2e27021</a></li><li><a href="https://stackoverflow.com/questions/34559557/how-to-enable-authentication-on-mongodb-through-docker" target="_blank" rel="noopener">https://stackoverflow.com/questions/34559557/how-to-enable-authentication-on-mongodb-through-docker</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-3-25lesson</title>
      <link href="/2019/04/25/2019-3-25lesson/"/>
      <url>/2019/04/25/2019-3-25lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="安装黑苹果"><a href="#安装黑苹果" class="headerlink" title="安装黑苹果"></a>安装黑苹果</h1><h3 id="制作黑苹果至关重要的一步：选对硬件"><a href="#制作黑苹果至关重要的一步：选对硬件" class="headerlink" title="制作黑苹果至关重要的一步：选对硬件"></a>制作黑苹果至关重要的一步：选对硬件</h3><p>示例操作硬件：</p><blockquote><p>cpu: i7 8700k (不要用AMD，不好装) \<br>motherboard: Gigabyte Z370HD3P (推荐) \<br>显卡: 独显 GTX 1050ti (推荐Rx560，拆机显卡不贵，不知道链接问本人)</p></blockquote><p>好了，如果你是这硬件，你就完成80%了，否则移步<a href="https://www.tonymacx86.com/" target="_blank" rel="noopener">tonymacx86</a>找找对应硬件的配置等。安装步骤都是一样，配置和驱动不同而已。</p><h3 id="准备材料"><a href="#准备材料" class="headerlink" title="准备材料"></a>准备材料</h3><ol><li>苹果官网下的一个.dmg 系统文件。(比如high sierra 10.13.6)</li><li>一个16G左右U盘(系统盘大约6G 左右)</li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">Clover EFI bootloader 下载地址</a></li><li><a href="https://mackie100projects.altervista.org/download-clover-configurator/" target="_blank" rel="noopener">Clover configuration 下载地址</a></li></ol><p>本教程默认使用Mac 环境下操作，制作U盘；Windows 操作google之，步骤类似。<br>本教程为纯净版Vanilla 方法(大神取得名字)至简安装方案.</p><h3 id="生成U盘启动器"><a href="#生成U盘启动器" class="headerlink" title="生成U盘启动器"></a>生成U盘启动器</h3><h4 id="下载对应系统"><a href="#下载对应系统" class="headerlink" title="下载对应系统"></a>下载对应系统</h4><p><a href="https://pan.baidu.com/s/1Ujfi8X6hBDuQVlSWuulNbw" target="_blank" rel="noopener">百毒云 10.13.6 下载地址</a>(下载慢找我，不要花钱买百毒云会员)</p><p>双击系统.dmg 文件，安装成为app，移到/finder/Applications</p><h4 id="制作U盘启动器-白苹果U盘启动器"><a href="#制作U盘启动器-白苹果U盘启动器" class="headerlink" title="制作U盘启动器(白苹果U盘启动器)"></a>制作U盘启动器(白苹果U盘启动器)</h4><p>打开-Mac磁盘工具，点击顶部<strong>显示所有设备</strong>，找到你的U盘，点击<strong>抹掉</strong></p><ol><li>U盘取名macinstaller</li><li>格式为Mac OS Extended(Journaled) -&gt; Mac OS 拓展(日志式)</li><li>方案: GUID分区图</li></ol><p>完成后退出</p><p>打开terminal</p><blockquote><p>sudo ${系统.app 拖到此处}/Contents/Resources/createinstallmedia –volume /Volumes/macinstaller</p></blockquote><p>前面是系统盘制作路径，后面volume 空间是抹掉取名为macinstaller 的U盘路径</p><p>然后就是开始加载，时间比较久，直到出现<code>Install media now available at &quot;/Volumes/Install macOS high sierra&quot;</code></p><h4 id="黑苹果引导Clover"><a href="#黑苹果引导Clover" class="headerlink" title="黑苹果引导Clover"></a>黑苹果引导Clover</h4><p>之前制作白苹果步骤完成。下面使用Clover 转黑苹果</p><p><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">Clover EFI bootloader 下载地址</a></p><p>点击下载的Clover</p><ol><li>介绍 - 继续</li><li>请先阅读 - 继续</li><li>目的宗卷 - 更改安装位置：选择我们的白苹果U盘</li><li>安装类型 - 安装</li><li>安装 - 选择(仅安装UEFI 开机版本、安装Clover 到EFI 系统区)(UEFI Drivers 下拉仅选择VBoxHfs-64、ApfsMemoryFix-64、AptioMemoryFix-64) ,其他都不选；然后点击安装</li><li>安装完成关闭</li></ol><h4 id="config-plist"><a href="#config-plist" class="headerlink" title="config.plist"></a>config.plist</h4><p><a href="https://mackie100projects.altervista.org/download-clover-configurator/" target="_blank" rel="noopener">Clover configuration 下载地址</a></p><ol><li>Mount EFI - Efi Partitions - U盘分区 - 点击Mount Partition 并输入电脑密码</li><li>Mount EFI - Efi Partitions - U盘分区 - 点击Open Partition 打开文件夹</li><li>EFI - CLOVER - config.plist 使用Clover configuration 打开</li><li>Kexts Installer - OS Version下拉选择Other</li><li>Kexts Installer - 选择Lilu、WhateverGreen、FakeSMC 点击下载</li><li>步骤【5】下载完弹出框，选中全部的5个传感器全部install</li><li><a href="https://github.com/corpnewt/Hackintosh-Guide/blob/master/Configs/CoffeeLake/config.plist" target="_blank" rel="noopener">新的config.plist</a>替换现在U盘Mount的EFI - CLOVER - config.plist</li><li>clover configuration 打开U盘的Mount的EFI</li><li>SMBIOS 选择iMac17.1</li></ol><p>U盘启动器至此全部完成</p><h3 id="安装黑苹果-1"><a href="#安装黑苹果-1" class="headerlink" title="安装黑苹果"></a>安装黑苹果</h3><h4 id="BIOS设置"><a href="#BIOS设置" class="headerlink" title="BIOS设置"></a>BIOS设置</h4><blockquote><p>Intel Virtualization Technology: Enabled (docker 要用) \<br>Vt-d:disable<br>XHCI Handoff: enabled (不然USB 等设备没法识别) \<br>Fast Boot: Disabled \<br>Secure Boot/OS Type: Other OS (有就选) \<br>SATA to AHCI \<br>Boot 启动使用U盘 Partition</p></blockquote><h4 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h4><ol><li>在Clover 引导界面选择名为<code>Boot macOS Install from macOS high sierra</code>(默认第一个)</li><li>安装进入verbose 啰嗦模式</li><li>会自动重启几次</li><li>之后进入macOS Utilities(macOS 使用工具)</li><li>使用磁盘工具抹掉磁盘</li><li>点击顶部<strong>显示所有设备</strong>，找到你要安装硬盘，点击抹掉：名字取macos；类型：【1】 U盘取名macinstaller【2】 格式为Mac OS Extended(Journaled) -&gt; Mac OS 拓展(日志式)【3】 方案: GUID分区图</li><li>回到macOS Utilities 界面，选择Install macOS</li><li>【确定】【确定】之后，选择你要安装的安装盘macos</li><li>安装过程会重启几次，确保从硬盘启动而不是U盘启动(默认帮你选好了，确定下即可)</li></ol><h4 id="选择国家界面"><a href="#选择国家界面" class="headerlink" title="选择国家界面"></a>选择国家界面</h4><p>选中国</p><p>然后一直点下一步，能跳过则跳过。之后再设置。</p><p>创建电脑账户(这个名字一定要取好，之后不好改；有mac 系统的大bug)</p><h4 id="替换U盘启动EFI-至硬盘启动EFI"><a href="#替换U盘启动EFI-至硬盘启动EFI" class="headerlink" title="替换U盘启动EFI 至硬盘启动EFI"></a>替换U盘启动EFI 至硬盘启动EFI</h4><ol><li>clover configuration - Mount EFI - 挂载Mount U盘、macOS 的EFI分区</li><li>将U盘的EFI 整个替换硬盘的EFI文件夹</li></ol><h4 id="拔出U盘-重启启动"><a href="#拔出U盘-重启启动" class="headerlink" title="拔出U盘 重启启动"></a>拔出U盘 重启启动</h4><p>Boot 使用硬盘的Partition 启动</p><h3 id="查找驱动"><a href="#查找驱动" class="headerlink" title="查找驱动"></a>查找驱动</h3><p>黑苹果难就难在找驱动，通过查找通用驱动为例。</p><blockquote><p>屏幕左上角🍎 - 关于本机 - 系统报告 查看确实的驱动 \<br>比如缺失以太网卡、音频 \<br>去主板官网确认网卡声卡的型号 \<br>比如Gigabyte z370 HD3P - 产品规格 - 音效 - <strong>内建Realtek@ ALC1220</strong> 那么下载<a href="https://github.com/acidanthera/AppleALC/releases" target="_blank" rel="noopener">AppleALC</a> \<br><a href="https://bitbucket.org/RehabMan/os-x-intel-network/src" target="_blank" rel="noopener">网卡驱动</a></p></blockquote><p>NVIDIA webDriver驱动可以直接安装对应驱动：<a href="https://www.tonymacx86.com/threads/nvidia-releases-alternate-graphics-drivers-for-macos-high-sierra-10-13-6-387-10-10-10-40.255913/" target="_blank" rel="noopener">NVIDIA webDriver</a></p><p>如果是集成显卡UHD Graphics 630：</p><ol><li>clover configuration打开硬盘EFI - CLOVER - config.plist</li><li>Devices &gt; FakeID &gt; IntelGFX = 0x59128086</li><li>Graphics &gt; ig-platform-id = 0x59120000</li><li>Graphics &gt; 打钩Inject Intel(似乎有点重要,否则还是会闪,显卡7M)</li><li>SMBIOS &gt; Select iMac17.1</li></ol><p>有双屏幕需求的，DVI + HDMI 插上没反应的可以试试：</p><ol><li>Clover configuration - Graphics - NVCap: 04000000 00000100 0E000000 00000007 00000000</li><li>Video Ports: 2</li></ol><p>关闭啰嗦模式：</p><ol><li>Boot - Arguments 删除<strong>-v</strong></li></ol><h4 id="驱动安装方法"><a href="#驱动安装方法" class="headerlink" title="驱动安装方法"></a>驱动安装方法</h4><p>把下载下来的.kext 驱动放到硬盘的EFI - CLOVER - kexts - Other 下，重启即可生效。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://zhuanlan.zhihu.com/p/55256660" target="_blank" rel="noopener">黑苹果麦金塔</a></p><p><a href="https://www.tonymacx86.com" target="_blank" rel="noopener">tonymacx86</a></p><p><a href="https://blog.daliansky.net/macOS-High-Sierra-10.13.6-17G65-Release-Version-with-Clover-4596-original-mirror.html" target="_blank" rel="noopener">windows 制作mac参考</a></p><p><a href="https://www.tonymacx86.com/threads/success-8700k-gigabyte-z370-hd3p-uhd-graphics-630-macos-high-sierra-mojave.239402/" target="_blank" rel="noopener">tonymacx86 - i7 8700k</a></p><p><a href="https://www.tonymacx86.com/threads/nvidia-releases-alternate-graphics-drivers-for-macos-high-sierra-10-13-6-387-10-10-10-40.255913/" target="_blank" rel="noopener">tonymacx86 - Nvidia webDriver</a></p><p><a href="https://github.com/enify/blog/issues/2" target="_blank" rel="noopener">windows 制作mac参考2</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-4-22lesson</title>
      <link href="/2019/04/25/2019-4-22lesson/"/>
      <url>/2019/04/25/2019-4-22lesson/</url>
      
        <content type="html"><![CDATA[<p>记录最近将近一个月的生活</p><p>新工作进展的很顺利。我们老大实力很强，为人也相当平顺。简直就是佩服这些老大。<br>我表示，我的人生轨迹永远都是运气超级好的那个，很神奇。比如，我考大学；学计算机；做网管；出来实习iOS；iOS的几年；碰到可爱的老婆；生了个阿黄；转岗顺利。不过好运大家都有，都围绕自己转，不过很多人没去努力抓住罢了。可能中间哪里间歇，断档了，那当然好运就断了。就比如，有时你会发现，你过红绿灯，一路都是绿灯。<br>刚进公司完成这几个大功能（老大分配的任务非常适合我成长，循序渐进那种）：</p><ol><li>注册增加nickname</li><li>网页界面显示版本号</li><li>mongo 对日志保存一年</li><li>用户下载软件，保存日志</li><li>用户绑定手机号，填写验证码。绑定、解除绑定、登录二次验证过程，oauth登录页面二次验证(第三方库参数外部输入)</li><li>vue 提取component</li><li>管理员 管理用户界面-管理员增加筛选功能</li><li>完成后端接口请求次数限制功能</li><li>修改浏览器退出，再进入页面，此时却需要重新登录bug(主要前段bug，cookie 存在内存中，web客户端死了，便需要重启了)</li><li>解决用户登录后退出，frontend 会多次请求profile bug</li><li>提供客户端VMProtect 接口。实现【1】 管理员输入secret 等；【2】和脚本(keyGen)交换信息返回客户端</li><li>完成多个license 增加、修改</li><li>用户授权页面排序(前段加后端)</li><li>backend抽取license 模块</li><li>增加editor 编辑者权利范围</li><li>将个人中心 重写成Typescript</li></ol><p>工作中是如此。尽我最大努力去学习、熟悉、解决错误。</p><p>学科目二大概4、5次就去考试了，最重要的是压离合，压的我腿都酸了。考试前一周日，我选择400块套餐，教练带着我走了1、2、3号线真实考试场景；本来有意再花500块，考试内的考试教官一些<em>特殊服务</em>，但是想想自己试试，应该没太大问题的(看来是对的，其实教官就是在出发时，对你很温柔-交钱了嘛；倒车时稍微喊一喊，其他没什么帮助，省了一笔巨款)。<br>科目二19.4.2 早早去考场，拿完号再去转了一圈,就去考场坐着等考试.<br>轮到我进去，把号拿了，手机放到柜子去一个房间等。好多人在门前等在叫号，一些人先去考了，有高兴的回来的，有沮丧不开心的。我看着他们，内心平淡。然后过了很久，大概要叫到我了吧，开始有一丢丢紧张，然后我告诉自己，我有不得不过的理由，不能把时间耗在这里。方法很有效。<br>我的叫号到了”一号线“，我平淡的前往车子，启动，慢慢往前，还是和压离合一样。<br>第一个坎：倒车入库。我把车子最高点对准前方标杆，倒车时肩膀线对准水管头，往右打死，慢慢倒车。发现有压线的可能，于是我把方向盘往左打一些，然后再往右打死，然后车子还是压线了，挂了。很不甘心，后面都没尝试就挂了。然后见没人喊，我就继续把左边倒库试一遍。发现管理台有人喊我回原点重考。好吧，于是我开回去，让师傅调试重考了。</p><p>重考时慢慢往前，前面转弯处有两辆车堵在那里，蛋疼，还没从刚才失败情绪中，但是我要将其转化为动力，我有不得不过的理由！前方通车，我往前，得，倒车有一个菇凉考试，那就停在那里等她。等了好久，那姑娘考完倒库，没挂，然后从左边出库。？what？左边是入口咋出去！于是她前倒后倒，把自己时间超时，被考官喊回去了。悲伤的故事。</p><p>轮到我了，我慢慢往前，把车子摆正，最高点正对标杆。倒退时，肩膀线正对水管头，稍微再过10公分(有个过度黑框)然后右打死。慢慢倒着，然后进来后，发现没叫，说明没问题。于是出库，肩膀线对准左边第一个柱子，左打死。倒车时，肩膀线对准左边一个标志物，左打死，车子慢慢倒入库中，左肩膀线对准一个框框内，停稳。没叫，没叫说明我安全了。于是我小心的出库，往前侧方停车。<br>路上左后镜保证不压线即可，最高点正对一个模糊的线。往前有个标志点对准肩膀线停下。往后倒，肩膀线对准左边一个砖头，右打死；左后镜看到第一个黄黑交接，方向盘回一半，再看到一个黄黑交接，反向盘回完，往后倒，左轮轧着晃条，左打死，再慢慢退，注意看右后视镜中车身和线平行，停下，回空挡，拉手刹。出库时，先上一档，出发，然后最高点对准标志物回完，稍微往前一点，右打死，车身快摆正时回完。这个地方要小心，很窄，容易压线，否则就挂了。这两个最麻烦的完了，接下来好很多。前方是直角转弯，一路有点小激动，腿有点小抖。<br>激动也要完成，不能松懈！最高点最准，肩膀线到标志物左打死，成功过关。下一关坡道定点。<br>我上去时，最高点对准，左侧不能压线，那就往有一点点，扣分就扣分吧，然后最高点肩膀线对其。fuck，左边两辆车，看不见！不过老子高啊！！！我看得见歪脖子树！！！于是安安全全停下。拉手刹3s，放下手刹，慢抬离合，稳住离合，慢放刹车。又成功。下一个s弯。<br>s弯算是比较好过的，一定要慢，科目二就是学习压离合，慢，蠕动，反正不限时，不要停下被扣分就可以了。s弯过去最后一格障碍物有点突出稍微小心，往左拉一点，然后往右拉一点，进入窄路掉头。<br>窄路掉头其实挺宽的，倒的时候稍微多贪心一点点，安全就好，然后很平顺就出去了。出去时，小心别压线。<br>难得都没了，接下来是上海多考的3项：进隧道、模拟高速停车打卡、紧急情况处置。(我再窄路掉头就已经开启灯了，管他呢，想怎么开就怎么开，不算扣分的，教练说)，倒数第二个栏关掉灯光。<br>模拟高速停车打卡，离合位置对准路上钉子，到位停车，回空挡拉手刹，然后上一档，放手刹。出发时稍微往右点(不然之前往左靠拢可能继续前行不小心碰到线，挂了)。<br>紧急停车，就是听到播报，立即停车然后打开紧急灯光，闪8下，继续往前。<br>往前就回到原点了。<br>教官出来说我考通过了，我想问多少分，他说过了就好了，管他多少分。算了，心情好，不知道无所谓，我没给教官好处，肯定是这个态度。哈哈。社会是用钱打通的。<br>给同是张教练一起考试的同学大拇指，成功，给她们点安慰和鼓励。<br>我出去和张教练报喜，顺便等另两位考试菇凉好运。<br>一起的另一个大叔，第二次考还是失败，没有模拟过。好懊悔，一直表示，还是要模拟，等会就去模拟。然后两位菇凉出来，也说没过。悲伤的故事，今天考试的就我一个通过了。<br>回去上班去了，心情大好。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-3-27lesson</title>
      <link href="/2019/04/25/2019-3-27lesson/"/>
      <url>/2019/04/25/2019-3-27lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="connect-mongo-用户登录后杀死浏览器-用户还得重新登录-bug-解决过程"><a href="#connect-mongo-用户登录后杀死浏览器-用户还得重新登录-bug-解决过程" class="headerlink" title="connect-mongo 用户登录后杀死浏览器,用户还得重新登录 - bug 解决过程"></a>connect-mongo 用户登录后杀死浏览器,用户还得重新登录 - bug 解决过程</h3><p>表现为用户正常登录。cookie、session 被正常记录。把浏览器关闭又打开时，需要重新登录。</p><p>猜测：</p><ol><li>cookie 没有记录</li></ol><p>不对，记录了。front 在<strong>SignIn</strong>时<code>Cookies.set(&#39;secret&#39;, userInfo)</code>。每次打开时都是有的。</p><ol start="2"><li>session 没有记录</li></ol><p>流程对的。cookieParser、expressSession、passport.initialize、passport.session、passport.serilizeUser、passport.deserializeUser</p><p>但是注意到mongo 的session 表里面，expires、originalMaxAge 等都为null,说明session 写进去了，但是设置session expire 方式不对：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.use(expressSession(&#123;</span><br><span class="line">    name:</span><br><span class="line">    secret</span><br><span class="line">    maxAge: expireTime</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">以上设置过期时间方法不对，可以使用下面两种方法之一：</span><br><span class="line"></span><br><span class="line">[1] 全部永久统一设置</span><br><span class="line">expressSession(&#123;</span><br><span class="line">    name:</span><br><span class="line">    secret:</span><br><span class="line">    cookie:</span><br><span class="line">        maxAge: expireTime //这是统一设置方式的正确方式</span><br><span class="line">&#125;)</span><br><span class="line">[2] 灵活设置session过期时间</span><br><span class="line">用户确认登录后，使用req.session.cookie.expire = expireTime</span><br></pre></td></tr></table></figure><p>以上正确的解决了session 设置过期问题。</p><p>然后接下来尝试登录操作。发现登录后，退出浏览器，重新打开浏览器并进入页面，发现又打开了登录页。</p><p>难道问题还在？首先排除之前已经成功解决了cookie session 设置问题；是backend 有问题还是frontend 有问题？</p><p>这时尝试使用浏览器打开某个没有界面的接口时，居然打开了，同时返回了用户的基本信息！说明后端的确没有问题，后端将cookie 认证过后的信息正确的返回了。</p><p>后端校验没有问题，那么该问题就可能由frontend产生，frontend自己验证，自己处理了该route？</p><p>尝试找了下源码，确实发现了其在route.beforeEach(SPA 第一次加载或者重刷新调用)方法中，自我检验了一番，但是却缺少验证信息，自己误判自己。</p><blockquote><p>从上面分析得到，全栈工程需要先各自分析问题由来和可能出处。当都有问题时就会很难判别，这时可以从一些不正常的地方打开突破口，一个个解决后，才能知道靠近真相。</p></blockquote><p>这也是我第一次跟着老大一起改第一个大bug。自己没能贡献太多帮助，测试过程方法不熟练、分析来由不清晰、尝试过程比较靠蒙。</p><p>多多努力啊，努力才是回报老大苦心栽培！！</p><h3 id="U盘格式为Fat32-最多只能4G-左右内容"><a href="#U盘格式为Fat32-最多只能4G-左右内容" class="headerlink" title="U盘格式为Fat32 最多只能4G 左右内容"></a>U盘格式为Fat32 最多只能4G 左右内容</h3><p>Mac 大文件总是复制不进U盘，是因为Fat32格式原因。但是格式为NTFS 格式时Mac 又识别不了。</p><p>解决：取github 下载NTFS X；或者Mac 里面的NTFS 操作软件即可识别并进项curd 操作。</p><h3 id="同局域网传输文件方法"><a href="#同局域网传输文件方法" class="headerlink" title="同局域网传输文件方法"></a>同局域网传输文件方法</h3><p>PC.A在相关文件夹使用Python 打开权限<code>python -m SimpleHTTPServer 8000</code></p><p>意思是打开8000 端口。此时另一台打开浏览器，输入${PC.A.ip:8000}即可进入该文件夹。同时选取对应文件即可下载</p><h3 id="terminal-zsh-翻墙"><a href="#terminal-zsh-翻墙" class="headerlink" title="terminal zsh 翻墙"></a>terminal zsh 翻墙</h3><pre><code>vim ~/.zshrc # 修改terminal 源文件</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias proxy=&apos;export all_proxy=socks5://127.0.0.1:$&#123;port&#125;&apos; # port 一般为1080；查看：- 偏好设置 - 高级 - 本地Socks5监听端口</span><br><span class="line">alias unproxy=&apos;unset all_proxy&apos;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source ~/.zshrc</span><br><span class="line">curl cip.cc # 显示了国内地址</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxy</span><br><span class="line">curl cip.cc # 已翻墙的地址</span><br></pre></td></tr></table></figure><pre><code>unproxy # 关闭翻墙</code></pre><p><a href="https://github.com/mrdulin/blog/issues/18" target="_blank" rel="noopener">参考</a></p><h3 id="centos6增加Swap分区"><a href="#centos6增加Swap分区" class="headerlink" title="centos6增加Swap分区"></a>centos6增加Swap分区</h3><p>1.检查swap大小和硬盘空间</p><pre><code>free -m</code></pre><p>2.添加交换文件</p><pre><code>mkdir -p /opt/temp# 增加内存为2Gdd if=/dev/zero of=/opt/temp/swap bs=1024 count=2048000</code></pre><p>3.创建交换空间</p><pre><code>mkswap -f /opt/temp/swap</code></pre><p>4.启动新增加的2G交换空间</p><pre><code>swapon /opt/temp/swap</code></pre><p>5.修改/etc/fstab 使新加的2G交换空间在系统重新启动后自动生效</p><pre><code>echo &quot;/opt/temp/swap swap swap defaults 0 0&quot; &gt;&gt;/etc/fstab</code></pre><p>6.重新启动系统</p><pre><code>reboot</code></pre><p><a href="https://blog.csdn.net/lym152898/article/details/77133260" target="_blank" rel="noopener">参考</a></p><h3 id="Dockerfile-容器不能连接另一个容器的端口"><a href="#Dockerfile-容器不能连接另一个容器的端口" class="headerlink" title="Dockerfile 容器不能连接另一个容器的端口"></a>Dockerfile 容器不能连接另一个容器的端口</h3><p>错误原因是自身错误，情况：我以前就是写127.0.0.1 连接本地mongo、redis，但是我忘了我以前使用的是docker-compose</p><p>我现在不想用docker-compose，操作是使用真实物理地址, 如192.168.1.2、server Ip，反正不能为127.0.0.1 即可。</p><p>这样即可成功，仅仅只是这个错误.</p><p>导致我一个大中午在：构建容器400多M、上传容器、运行-出错，反复。本地debug运行都是可以连接的。然后我本地使用容器，咦，果然连不上。</p><h3 id="重新Certbot-auto"><a href="#重新Certbot-auto" class="headerlink" title="重新Certbot-auto"></a>重新Certbot-auto</h3><p>域名过期，重新搞了个免费的域名:gogal.ml <a href="freenom.com">官网</a><br>控制台等会还要用到，需要填写certbot token</p><p>首先去<a href="https://certbot.eff.org/lets-encrypt" target="_blank" rel="noopener">certbot 官网</a>，我选择centos6-nginx 于是是这里-<a href="https://certbot.eff.org/lets-encrypt/centos6-nginx" target="_blank" rel="noopener">直达</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cd</span> ~/</span><br><span class="line"><span class="variable">$mkdir</span> download &amp;&amp; <span class="built_in">cd</span> download</span><br><span class="line"><span class="variable">$wget</span> https://dl.eff.org/certbot-auto</span><br><span class="line"><span class="variable">$sudo</span> mv certbot-auto /usr/<span class="built_in">local</span>/bin/certbot-auto</span><br><span class="line"><span class="variable">$sudo</span> chown root /usr/<span class="built_in">local</span>/bin/certbot-auto</span><br><span class="line"><span class="variable">$sudo</span> chmod 0755 /usr/<span class="built_in">local</span>/bin/certbot-auto</span><br><span class="line"></span><br><span class="line"><span class="variable">$pip</span> install certbot-nginx</span><br></pre></td></tr></table></figure><p>到这里需要先前去nginx.conf 填写对应443 的server_name。 比如：server_name <a href="http://www.gogal.ml" target="_blank" rel="noopener">www.gogal.ml</a> gogal.ml;下面会用到</p><p>$/usr/local/bin/certbot-auto –server <a href="https://acme-v02.api.letsencrypt.org/directory" target="_blank" rel="noopener">https://acme-v02.api.letsencrypt.org/directory</a> –manual –preferred-challenges dns  –installer nginx -d *.gogal.ml -d gogal.ml # gogal.ml 就是我的域名</p><p>前几句都可以直接忽略，yes or enter</p><p>直到出现这句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">Please deploy a DNS TXT record under the name</span><br><span class="line">_acme-challenge.gogal.ml with the following value:</span><br><span class="line"></span><br><span class="line">EfurJLgnrwahc7g_6k7odGVXp6sffOruJaDceBdiAmU</span><br><span class="line"></span><br><span class="line">Before continuing, verify the record is deployed.</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></pre></td></tr></table></figure><p>这时将里面那个拷贝到freenom 控制台-managedns</p><p>Add Records</p><p>name 填 <strong>_ACME-CHALLENGE</strong><br>Target 填 <strong>${你自己得到的那个，比如EfurJLgnrwahc7g_6k7odGVXp6sffOruJaDceBdiAmU}</strong></p><p>回到ssh 按下enter 键，之后还有几步都没那么关键了。</p><p>这时你用postman 可以测试，之前的都是可用的了。</p><p>这里提一点：一开始我碰到certbot 升级的问题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Saving debug log to /var/log/letsencrypt/letsencrypt.log</span><br><span class="line"></span><br><span class="line">How would you like to authenticate with the ACME CA?</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">1: Nginx Web Server plugin (nginx)</span><br><span class="line">2: Spin up a temporary webserver (standalone)</span><br><span class="line">3: Place files in webroot directory (webroot)</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">Select the appropriate number [1-3] then [enter] (press &apos;c&apos; to cancel): 1</span><br><span class="line">Plugins selected: Authenticator nginx, Installer None</span><br><span class="line">Obtaining a new certificate</span><br><span class="line">Performing the following challenges:</span><br><span class="line">http-01 challenge for gogal.ml</span><br><span class="line">Client with the currently selected authenticator does not support any combination of challenges that will satisfy the CA. You may need to use an authenticator plugin that can do challenges over DNS.</span><br><span class="line">Client with the currently selected authenticator does not support any combination of challenges that will satisfy the CA. You may need to use an authenticator plugin that can do challenges over DNS.</span><br></pre></td></tr></table></figure><p>我就是直接前往官网，下载最新的certbot-auto 即解决了。</p><h3 id="利用Vue-2-x-Templates-Legacy-脚手架搭建项目"><a href="#利用Vue-2-x-Templates-Legacy-脚手架搭建项目" class="headerlink" title="利用Vue 2.x Templates(Legacy) 脚手架搭建项目"></a>利用Vue 2.x Templates(Legacy) 脚手架搭建项目</h3><p><a href="https://cli.vuejs.org/guide/creating-a-project.html#vue-create" target="_blank" rel="noopener">Vue 官网</a></p><pre><code>yarn global add @vue/cli-initvue init webpack &lt;my-project&gt;</code></pre><p>接下来就可以愉快的写了</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-2-19lesson</title>
      <link href="/2019/02/19/2019-2-19lesson/"/>
      <url>/2019/02/19/2019-2-19lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="记录最近学习nodejs"><a href="#记录最近学习nodejs" class="headerlink" title="记录最近学习nodejs"></a>记录最近学习nodejs</h1><h2 id="V8引擎-对类操作的加速"><a href="#V8引擎-对类操作的加速" class="headerlink" title="V8引擎 对类操作的加速"></a>V8引擎 对类操作的加速</h2><p>V8 引擎是google 邀请巴克为chrome 写的通用js底层引擎。<br>V8 创建类采用aClass = {}，如果有新的属性，则会生成一个隐藏bClass = { this.name = “b” }， 同时将aClass 指向bClass。aClass 会因为js 的GC 技术稍后销毁。这将带来巨大的性能优化。</p><p>最佳做法：一次性声明aClass 属性，且尽量不要用 delete 方法。</p><h2 id="CommonJS-类如何分割"><a href="#CommonJS-类如何分割" class="headerlink" title="CommonJS 类如何分割"></a>CommonJS 类如何分割</h2><p>web 全局有window，node 全局有global属性。相当于<code>var a = 0</code>;全局都会有<code>a</code>属性。<br>CommonJS 采用给每个被加载出来的js文件都变成某个函数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> name = aKer;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>这时就变成一个个模块。</p><h2 id="js-定义类的方法："><a href="#js-定义类的方法：" class="headerlink" title="js 定义类的方法："></a>js 定义类的方法：</h2><p>参考自：<a href="https://www.cnblogs.com/meteorcn/p/node_mianshiti_interview_question.html" target="_blank" rel="noopener">https://www.cnblogs.com/meteorcn/p/node_mianshiti_interview_question.html</a></p><p>pluz，我背诵上面的参考网址就去面试js了。运气爆棚。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">构造函数方法定义类</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"aKer"</span></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="keyword">this</span>.name) &#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br><span class="line">person.sayName()</span><br><span class="line"></span><br><span class="line">对象创建方法定义类</span><br><span class="line"><span class="keyword">var</span> Person = &#123;</span><br><span class="line">    name: <span class="string">"aKer"</span>,</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="keyword">this</span>.name); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="built_in">Object</span>.create(Person);</span><br><span class="line">person.sayName();</span><br><span class="line"></span><br><span class="line">极简主义法(参考自 阮一峰博客), 推荐使用</span><br><span class="line"><span class="keyword">var</span> Cat = &#123;</span><br><span class="line">    createNew: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> cat = &#123;&#125;;</span><br><span class="line">        cat.name = <span class="string">"aBai"</span>;</span><br><span class="line">        cat.makeSound = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="string">"mmm"</span>); &#125;;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> cat1 = Cat.createNew();</span><br><span class="line">cat1.makeSound();</span><br><span class="line">这时继承就会如：</span><br><span class="line"><span class="keyword">var</span> Animal = &#123;</span><br><span class="line">    createNew: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> animal = &#123;&#125;;</span><br><span class="line">        animal.sleep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; alert(<span class="string">"sleep"</span>); &#125;;</span><br><span class="line">        <span class="keyword">return</span> animal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> Cat = &#123;</span><br><span class="line">    createNew: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> cat = Animal.createNew();</span><br><span class="line">        cat.name = <span class="string">"aHei"</span>;</span><br><span class="line">        cat.makeSound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; alert(<span class="string">"mmm"</span>); &#125;;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> cat1 = Cat.createNew();</span><br><span class="line">cat1.sleep();</span><br></pre></td></tr></table></figure><h2 id="js类继承方法："><a href="#js类继承方法：" class="headerlink" title="js类继承方法："></a>js类继承方法：</h2><ul><li>原型链法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"animal"</span>;</span><br><span class="line">&#125;</span><br><span class="line">Animal.prototype.sayName = &#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = Animal.prototype;</span><br><span class="line">Person.prototype.constructor = <span class="keyword">new</span> Animal;</span><br></pre></td></tr></table></figure><ul><li>属性自制法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (prop <span class="keyword">in</span> Animal.prototype) &#123;</span><br><span class="line">    Person.prototype[prop] = Animal.prototype[prop];</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.constructor = <span class="string">"Person"</span>;<span class="comment">//or new Person</span></span><br></pre></td></tr></table></figure><ul><li>构造器应用法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    Animal.call(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="js常用设计模式：单例，工厂，代理，装饰，观察者模式"><a href="#js常用设计模式：单例，工厂，代理，装饰，观察者模式" class="headerlink" title="js常用设计模式：单例，工厂，代理，装饰，观察者模式"></a>js常用设计模式：单例，工厂，代理，装饰，观察者模式</h2><ul><li><p>单例</p></li><li><p>工厂：同样形式参数返回不同实例</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Factory</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Factory.prototype.getInstance = <span class="function"><span class="keyword">function</span>(<span class="params">className</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="string">"new"</span> + className + <span class="string">"()"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.name = <span class="string">"Person1"</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.name = <span class="string">"Animal1"</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> Factory();</span><br><span class="line"><span class="keyword">var</span> person1 = factory.getInstance(<span class="string">"Person"</span>);</span><br><span class="line"><span class="keyword">var</span> animal1 = factory.getInstance(<span class="string">"Animal"</span>);</span><br></pre></td></tr></table></figure><ul><li><p>代理</p></li><li><p>观察者</p></li></ul><h2 id="实现一个简单的http服务器"><a href="#实现一个简单的http服务器" class="headerlink" title="实现一个简单的http服务器"></a>实现一个简单的http服务器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/html"</span> &#125;);</span><br><span class="line">    res.write(<span class="string">"aaa"</span>);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;).listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h2 id="child-process"><a href="#child-process" class="headerlink" title="child_process"></a>child_process</h2><ul><li>spawn</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">"child_process"</span>);</span><br><span class="line"><span class="keyword">var</span> child = cp.spawn(<span class="string">"echo"</span>, [<span class="string">"you"</span>, <span class="string">"hellow"</span>]);</span><br><span class="line">child.stdout.pipe(process.stdout);</span><br></pre></td></tr></table></figure><ul><li>fork</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fork-parent.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">"child_process"</span>);</span><br><span class="line"><span class="keyword">var</span> child = cp.fork(<span class="string">"./fork-child.js"</span>);</span><br><span class="line">child.on(<span class="string">"message"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"parent get message from child"</span>, msg);</span><br><span class="line">&#125;)</span><br><span class="line">child.send(<span class="string">"parent send msg to child"</span>);</span><br><span class="line"></span><br><span class="line">fork-child.js</span><br><span class="line"></span><br><span class="line">process.on(<span class="string">"message"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"child get msg from parent:"</span>, msg);</span><br><span class="line">    process.send(<span class="string">"child send msg to parent to ask for money!"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="判断用户密码时要注意什么"><a href="#判断用户密码时要注意什么" class="headerlink" title="判断用户密码时要注意什么"></a>判断用户密码时要注意什么</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkApiKey</span>(<span class="params">apiKeyFromDb, apiKeyReceived</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (apiKeyFromDb === apiKeyReceived) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>比较密码时，不能泄露任何信息，因此比较必须在固定时间完成。否则，可以使用<a href="https://en.wikipedia.org/wiki/Timing_attack" target="_blank" rel="noopener">timing attacks</a>来攻击你的应用。为什么会这样呢?Node.js使用V8引擎，它会从性能角度优化代码。它会逐个比较字符串的字母，一旦发现不匹配时就停止比较。当攻击者的密码更准确时，比较的时间越长。因此，攻击者可以通过比较的时间长短来判断密码的正确性。使用cryptiles可以解决这个问题:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkApiKey</span>(<span class="params">apiKeyFromDb, apiKeyReceived</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cryptiles.fixedTimeComparison(apiKeyFromDb, apiKeyReceived)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="MySql-索引为什么SELECT-速度快"><a href="#MySql-索引为什么SELECT-速度快" class="headerlink" title="MySql 索引为什么SELECT 速度快"></a>MySql 索引为什么SELECT 速度快</h2><p><strong>引自廖雪峰大大</strong></p><blockquote><p>索引的效率取决于索引列的值是否散列，即该列的值如果越互不相同，那么索引效率越高。反过来，如果记录的列存在大量相同的值，例如gender列，大约一半的记录值是M，另一半是F，因此，对该列创建索引就没有意义。\<br>\<br>可以对一张表创建多个索引。索引的优点是提高了查询效率，缺点是在插入、更新和删除记录时，需要同时修改索引，因此，索引越多，插入、更新和删除记录的速度就越慢。\<br>\<br>对于主键，关系数据库会自动对其创建主键索引。使用主键索引的效率是最高的，因为主键会保证绝对唯一。</p></blockquote><h2 id="随机生成密码方法"><a href="#随机生成密码方法" class="headerlink" title="随机生成密码方法"></a>随机生成密码方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function randomString(length)</span><br><span class="line">&#123;</span><br><span class="line">    var charset = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;;</span><br><span class="line">    var i;</span><br><span class="line">    var result = &quot;&quot;;</span><br><span class="line">    var isOpera = Object.prototype.toString.call(window.opera) == &apos;[object Opera]&apos;;</span><br><span class="line">    if(window.crypto &amp;&amp; window.crypto.getRandomValues)</span><br><span class="line">    &#123;</span><br><span class="line">        values = new Uint32Array(length);</span><br><span class="line">        window.crypto.getRandomValues(values);</span><br><span class="line">        for(i=0; i&lt;length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            result += charset[values[i] % charset.length];</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    else if(isOpera)//Opera&apos;s Math.random is secure, see http://lists.w3.org/Archives/Public/public-webcrypto/2013Jan/0063.html</span><br><span class="line">    &#123;</span><br><span class="line">        for(i=0; i&lt;length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            result += charset[Math.floor(Math.random()*charset.length)];</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    else throw new Error(&quot;Your browser sucks and can&apos;t generate secure random numbers&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(randomString(10))</span><br></pre></td></tr></table></figure><h2 id="BDD-TDD-区别"><a href="#BDD-TDD-区别" class="headerlink" title="BDD/TDD 区别"></a>BDD/TDD 区别</h2><p><strong>此为其他处转载，忘记出处，侵权删</strong></p><p>BDD是一种敏捷软件开发的技术。它对TDD的理念进行了扩展，在TDD中侧重点偏向开发，通过测试用例来规范约束开发者编写出质量更高、bug更少的代码。而BDD更加侧重设计，其要求在设计测试用例的时候对系统进行定义，倡导使用通用的语言将系统的行为描述出来，将系统设计和测试用例结合起来，从而以此为驱动进行开发工作。</p><h2 id="柯里化函数"><a href="#柯里化函数" class="headerlink" title="柯里化函数"></a>柯里化函数</h2><p><strong>此为其他处转载，忘记出处，侵权删</strong></p><p>ES 5的 bind()方法。<br>在pomelo的一些demo 里面可能会不理解这么一句话<br>session.on(‘closed’, onUserLeave.bind(null, this.app));</p><p>var onUserLeave = function(app, session) {<br>  if(!session || !session.uid) {<br>        return;<br>    }<br>    app.rpc.chat.chatRemote.kick(session, session.uid, app.get(‘serverId’), session.get(‘rid’), null);<br>};<br>你可能会有这样的疑问</p><ol><li>为什么onUserLeave 会有两个参数? </li><li>函数的bind() 第一个参数null 什么什么意思，结合第一个问题，这里就传了一个参数？那么那个session 还是怎么传过来的？ <br>这个函数 bind() 方法是ES 5 新增的一个特性。用于将函数绑定到某个对象上。<br>那么这里bind()的方法的作用是什么呢？<br>要明白这里的bind()的用法，首先我们需要了解一种函数式编程技术—柯里化（currying）<br>Wiki是这么定义的: 在计算机科学中，柯里化（Currying），是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术。<br>为了帮助理解这里写一个小例子(来自于Javascript 权威指南第六版 p191)<br>var sum = function(x, y){<br> return x+y;<br>}<br>//创建一个类似于sum的新函数，但this的值绑定到null<br>//并且第一个参数绑定到1， 这个新函数的期望只传入一个实参<br>var succ = sum.bind(null, 1);</li></ol><p>console.log(succ(2)); //输出 3； x 绑定到1，并传入2作为实参</p><p>//另外一个做累计计算的函数<br>var sum2 = function(y ,z){<br>    return this.x + y + z;<br>}</p><p>//绑定this 和 y<br>var bindSum2 = sum2.bind({x : 1}, 2);<br>console.log(bindSum2(3)); //输出 6； this.x 绑定到1，y绑定到2， z 绑定到3.<br>上面这个例子就是柯里化的应用了，现在我们回到pomelo看下，chatpomelo例子里面怎么使用这个柯里化技术。<br>现在，应该能解决开头的第一个问题了，那么第二个问题，我们需要阅读一下pomelo的源码<br>阅读源码sessionService.js 464-478<br>从这十几行代码和柯里化的知识，我们就能够明白为什么onUserLeave为什么会有两个参数了。<br>var onUserLeave = function(app,  session){</p><p>}<br>最后的参数是通过柯里化的技术把单参数 session 传到我们多参数函数里面。</p><h2 id="CentOS6-Nginx-配置免费ssl"><a href="#CentOS6-Nginx-配置免费ssl" class="headerlink" title="CentOS6 Nginx 配置免费ssl"></a>CentOS6 Nginx 配置免费ssl</h2><p><a href="https://certbot.eff.org/lets-encrypt/centos6-nginx" target="_blank" rel="noopener">Certbot</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir /root/download/</span><br><span class="line">cd /root/download/</span><br><span class="line">wget https://dl.eff.org/certbot-auto</span><br><span class="line">#设置权限</span><br><span class="line">chmod a+x certbot-auto</span><br></pre></td></tr></table></figure></p><p>这时得到certbot-auto 文件夹</p><p>./certbot-auto –nginx #这里会对nginx 服务器配置，同时会对conf 文件修改<br>(中间出现<strong>ImportError: No module named virtualenv</strong>, $pip install virtualenv)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(certbot-auto renew 刷新)</span><br><span class="line"></span><br><span class="line">//lsgood.top *.lsgood.top为我的域名，请填写自己的域名</span><br><span class="line">certbot-auto certonly -d *.lsgood.top -d lsgood.top</span><br></pre></td></tr></table></figure><p>修改nginx.conf：<br>server {<br>    listen 443 default ssl;<br>    server_name lsgood.top;<br>    ssl on;<br>    ssl_certificate xxxxxxxxx;#这个会被自动填写,是ssl 的公钥<br>    ssl_certificate_key xxxxx;#同上,是ssl 的私钥</p><pre><code>#其他不用设置可以</code></pre><p>}</p><p>在设置 certbot 的时候需要注意碰到以下单词时，是需要到域名解析后台修改文件：</p><blockquote><p>Please deploy a DNS TXT record under the name _acme-challenge.lsgood.com with the following value:\<br>\<br>xxxxxxxxxxxxxxx\<br>\<br>Before continuing, verify the record is deployed.</p></blockquote><p>这意思是让你在继续下面之前，确保域名解析后台增加了以_acme-challenge 为前缀的子域名，同时将<code>xxxxxxxxxxxxxxx</code> 拷贝至里面的<strong>记录值</strong>一栏（记录类型为TXT）</p><p>参考:</p><p><a href="https://juejin.im/post/5b07c42c51882538c2203b2f#heading-2" target="_blank" rel="noopener">https://juejin.im/post/5b07c42c51882538c2203b2f#heading-2</a></p><p><a href="https://segmentfault.com/a/1190000017081357" target="_blank" rel="noopener">https://segmentfault.com/a/1190000017081357</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-1-20lesson</title>
      <link href="/2019/01/21/2019-1-20lesson/"/>
      <url>/2019/01/21/2019-1-20lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="最近记录及经历"><a href="#最近记录及经历" class="headerlink" title="最近记录及经历"></a>最近记录及经历</h1><p>记录下最近忙的事情：</p><ol><li><p>面试后台</p></li><li><p>vps 重启导致没进入centos 系统，同时需要重启ssserver</p></li><li><p>公司组织活动</p></li></ol><h2 id="面试后台"><a href="#面试后台" class="headerlink" title="面试后台"></a>面试后台</h2><p>2019/1/17 晚上6:15 赶紧从锦江乐园开着那个破小电驴赶去仙霞路。终于在约定7点前3分钟到达亩的地。<br>进入后，笔试+机试。<br>笔试有</p><ul><li>module.epxorts 有什么特点</li><li>2个Node.js API 有什么区别</li><li>Node.js 使用什么库可以创建原生服务器，代码。</li><li>Node.js 子程序、子程序生成和沟通</li><li>js 什么是回调，如何防止回调地狱</li></ul><p>机试</p><p>express + pug + vue.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">index.jade</span><br><span class="line"></span><br><span class="line">template.</span><br><span class="line">    ...布局</span><br><span class="line">scripts.</span><br><span class="line">    ...scripts</span><br><span class="line"></span><br><span class="line">输入&quot;[&quot;a&quot;,&quot;1&quot;,&quot;2&quot;,&quot;1&quot;,&quot;b&quot;,&quot;3&quot;,&quot;4&quot;,&quot;a&quot;]&quot;</span><br></pre></td></tr></table></figure><p>将输入的文本传到后台，后台进行去重、排序得到<br>[“1”,”2”,”3”,”4”,”a”,”b”]<br>然后传递回前台展示</p><p>做这题的时候vue.js 基本都会，但是pug 的混合有点懵。<br>express 没有watch file 更新服务器的便利，我给加了supervisord 库。<br>给的电脑是linux系统，键盘啥的，却都是windows 的操作。好烦，一直用ctrl+s，这啥玩意。一直担心这次修改的代码是未同步的。<br>字又很小很小那种、没有鼠标使用触控板，那个垃圾触控板啊。<br>外面又很吵。</p><p>反正最后我只剩下“排序、去重”这俩 面试经理认为去网页找就好了的功能，我自己认为还算完成度高的（我还加了比如responseFormat、util、controller 分出操作）。<br>中间有个卡了点时间的地方：.jade template 里面想import 一个库，不行，最后找到ajax post 方法。</p><p>之后面试经理问了些工作经历、一些别的知识点等等。</p><p>做完面试，从晚上7点搞到了近晚上10点了都（确实时间长了点，不过跟环境有关吧，我自己环境搭起来，那就会特别特别爽，很快就能好，毕竟能断点嘛）。然后骑着已经一点电都没有的电驴推了好长一段路，幸好幸好没有下雨。推一会，骑一会，终于找到充电点，才终于回到家了。</p><p>第一次后台面试，感觉能胜任，没啥。<br>我现在还在做一个资源下载网页、真·聊天软件。这几天给他整好来，我觉得明年年初必定能很OK！！！</p><h2 id="vps重启、ssserver-启动"><a href="#vps重启、ssserver-启动" class="headerlink" title="vps重启、ssserver 启动"></a>vps重启、ssserver 启动</h2><p>首先我vps（搬瓦工CN2 专线）安装两次系统，导致重启之后，先点击左侧“terminal interaction”，然后会有新开一个网页版的操作交互页面，在提示“ESC”时， 需要按ESC 键进入选取系统页面，选取自己的server（我安装centos 6 x86），然后就可以进入centos 操作系统。</p><p>ssserver 我这里参考这篇<a href="https://github.com/Helinhan/-shadowsocks-serverspeeder-/issues/1" target="_blank" rel="noopener">git issue</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssserver -c /etc/shadowsocks.json -d start</span><br><span class="line">ssserver -c /etc/shadowsocks.json -d stop</span><br></pre></td></tr></table></figure><h2 id="新的公司“哇塞运动”公司组织活动"><a href="#新的公司“哇塞运动”公司组织活动" class="headerlink" title="新的公司“哇塞运动”公司组织活动"></a>新的公司“哇塞运动”公司组织活动</h2><p>时间：19.1.18 ~ 19.1.19<br>地点：苏州半岛阳澄湖酒店<br>事件：公司组织年会，团建</p><p>早上坐了一个半小时的大巴到达。休息半小时后，每个人先在一个大面板签字，留影。接着是茶话会，点评公司优秀员工，主管点评员工，回顾一年来事迹、点滴。</p><p>茶话会快结束了，还有剩余时间，我提议“成语接龙”，10s 没接上成语的同学发红包。玩了几圈，已经接近11点半，大家意犹未尽，但是还是抓紧休息时间，12点集合午饭时间。</p><p>中午饭简洁实在：吃饱。下午有活动，所以主要还是吃饱，晚上才是重头戏，不能和晚上抢了风头。有些同学还会有嫌弃说简陋，但是见其也吃的不多，这也是我疑惑的地方。人果然都是不同的，我是来则安，而总会有人嫌弃这嫌弃那，而自己却又服务得不多。</p><p>我做好自己的角色就好了，更不必理会不同的心声。</p><p>吃完饭，回酒店休息了下，那40分钟，终于把我的ssserver 重启回去了。提一点：酒店的网络估计国家有监管，百度搜索很多稍稍敏感东西都被屏蔽了，感觉不到gov 的意图，总觉得很多小丑想在我身边窥视我的一举一动。浑身不自在！</p><p>中午2点集合，集体出发去酒店附近的草地做运动。<br>首先大家分队，做些热身运动。<br>接着分成的两组开始接力跑。我们这组输了，原因有2：我们这组妹纸多一个；开头有个同学返回时没把接力棒传递，延迟数s之久。<br>开心即好。</p><p>接下来我们还是2队比拼过跳绳速度。这个在接下来体现在团队合作。比如<strong>黑洞</strong>同学加油，减少错误率，手感好的同学，多个一起进入，加速进程。我们这队先跳，有几个”黑洞”同学，但不敢置信的是二队的黑洞才是最厉害的！着实拖着队友，哈哈。</p><p>这两个游戏之后，还有三个游戏：报数抱团，毒圈丢球，撕名牌。</p><p>报数抱团：中间同学报数，然后其他队友围成圈，报数时其他同学报成对应数字。<br>我怎么输的，在第三波时，数字8，我站过去是9，只能牺牲小我牺牲啦。</p><p>毒圈丢球：全员分成四个队，中间一个队伍，其他三个队使用软球，将中间队伍砸下。</p><p>撕名牌：大家身穿小外衣，两队颜色。背后由正反胶贴着自己的铭牌。大家分成两队，根据时间，慢慢缩小毒圈。大家互相开撕。</p><p>这里说几个有意思的：撕的铭牌，那个黏度，三个男的扯都扯不下来。我当时被三个人撕都撕不下，哈哈，活到了最后。我觉得人事部一个小姑凉撕的人可就多，好多人被她撕撕撕。我一直躲躲躲，躲到了比赛最后，胜利✌️。<br>这游戏包括了好几波，都快喘不过气了。玩的没心没肺啊，如同回到大学时期。公司强项不愧是做策划执行的，线下的执行简直没话说的。</p><p>大家玩完之后回酒店休息了下。没一会去吃晚饭。</p><p>晚饭吃的就稍微更好了。这次喝的酒也稍微多了一些，米西米西。好吃的有一个小虾米，很嫩很滑口；苏州必带鸡汤么；烤猪脚很香；期间蒋总、翟总述说自己往事，公司建立来由，张总10年没放弃。2005年创建“点傲”，2014启动哇塞，合并为“冠脉堂”。期间张希亮，张总喝多了，说点傲团队，人员坚持下去，十年后还是大家伙，张总自己掏钱给留着的伙伴5w报答。确实，这就是新兴的互联网不能比的。互联网人，自身难保，随时可能被开，还想着自己留在公司？？（耳边有些小伙伴传来问是冠脉堂全员吗？小声嘀咕问。有这想法的人，看来年龄尚浅，未来前路只能在他人鼻息下留存啊）</p><p>吃完之后回到酒店休息了下，就已经要晚上的晚会表演了。我们技术部本来要彩排一下的，已经来不及，直接开始了。</p><p>我在这也有个小项目，就是唱<strong>革命人永远年轻</strong>这首歌。这首红歌，是大学红歌比赛时，我作为领唱，身后都是老师、院长、同学们，台下是几千人的同学，当时的我激动、紧张，使得我不经意间，不自觉、无法控制的腿抖。这次我要打破自己，表达自己。</p><p>其实我在粉粉的时候就有多次code review、技术分享，在实践，表达，突破。这次很成功的表演（会不会是人比较少的原因，再也没有腿抖，也没有丝许不安？应该不是吧，哈哈）。</p><p>翟总为我们深情朗诵，蒋总给我带来一曲古典的<strong>梨花颂</strong>。这首歌我高二的时候特别喜欢，喜欢不得了，现在老了，在工作场景耕耘，眼前早已不是夜景烟花，桃色满目了。<br>我们技术部有俩节目。有一个”兔子舞”，得了，崩盘。之后我们大合唱<strong>明天会更好</strong>,只能凭借真诚，最好还好，收了场。<br>边表演节目，边抽奖，反正我是没能拿到什么奖，阳光普照吧。<br>我觉得一等奖倒是挺意外，而且老板们脸都要绿的那种。平时最不干活，干活老喊累，推诿，能力最差的前端同学得到了，哈哈，我觉得老板脸，不是很好看，哈哈。</p><p>接下来大家吃东西，唱歌，那玩个游戏。有个人带上眼罩，转三圈，然后在场地抓人，抓到人之后要猜出试谁。这个游戏也挺好玩的，我一直没被抓到过，之后一次请缨，有意思。这期间有个哥们为了猜出另一个哥们是谁，上上下下摸了个遍，都快亲上去了。哈哈</p><p>基本这天就这么过去了，第二天回上海，然后那天下午，我们还加了半天班，想猴头菇了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-1-5lesson</title>
      <link href="/2019/01/05/2019-1-5lesson/"/>
      <url>/2019/01/05/2019-1-5lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="Dockerfile-install-very-slow"><a href="#Dockerfile-install-very-slow" class="headerlink" title="Dockerfile install very slow"></a>Dockerfile install very slow</h1><p>According to <a href="https://christianfei.com/posts/Cache-speed-up-docker-node-modules/" target="_blank" rel="noopener">this artical</a>, I resolve an issue that i have to load all <strong>node_module</strong> files very time;</p><p>This method help with: building the same package.json and and same file path, would never ever to load every file again, but first would still very slow.</p><p>do step:</p><p>first add your <strong>.dockerignore</strong> with:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.git</span><br><span class="line">.results</span><br><span class="line">script</span><br><span class="line">*Dockerfile*</span><br><span class="line">node_modules</span><br><span class="line">package-lock.json</span><br></pre></td></tr></table></figure><p>then:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">8.12</span>.<span class="number">0</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">ARG</span> NODE_ENV=development</span><br><span class="line"><span class="keyword">ENV</span> NODE_ENV=$NODE_ENV</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span> /watchvideo_server</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span> package.json yarn.lock ./</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span> . /watchvideo_server</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span> yarn</span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> node</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">9526</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span> ["yarn", "start"]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3&quot;</span><br><span class="line">services:</span><br><span class="line">  mysql:</span><br><span class="line">    build: ./mysql</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;4444:3306&quot;</span><br><span class="line">  watch:</span><br><span class="line">    build: .</span><br><span class="line">    hostname: watch</span><br><span class="line">    command: yarn debug</span><br><span class="line">    volumes:</span><br><span class="line">      - ./dist:/watchvideo_server/dist</span><br><span class="line">      - ./package.json:/watchvideo_server/package.json</span><br><span class="line">      - ./yarn.lock:/watchvideo_server/yarn.lock</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;9526:9526&quot;</span><br><span class="line">      - &quot;9222:9222&quot;</span><br><span class="line">    depends_on:</span><br><span class="line">      - mysql</span><br><span class="line">    links:</span><br><span class="line">      - mysql</span><br><span class="line">    environment:</span><br><span class="line">      - DATABASE_HOST=mysql</span><br></pre></td></tr></table></figure><h2 id="I’m-making-a-media-site"><a href="#I’m-making-a-media-site" class="headerlink" title="I’m making a media site"></a>I’m making a media site</h2><p>When 2018.6, I decided to make some games to try earning some money and advertise.</p><p>But gov said NO: gov suddenly gave a notify, field of game would become more difficult.</p><p>OK, when 2018.12, I change my mind to make a media site to provide some picture sources and ability of watching video.</p><p>But gov immediatly gave notify: master of <strong>BT video site</strong> was caughted and get 3 year of prison with 80w RMB ticket.</p><p>Ability of IT worker is very difficultlly control by zh gov, so they afraid of any man is out of control.</p><p>If you feel comfortable with that ease, you will done soon or later.</p><p>I’m would never be.</p><h1 id="Man-become-poverty"><a href="#Man-become-poverty" class="headerlink" title="Man become poverty"></a>Man become poverty</h1><p>Man dare to chanllenge for fight, but during recent couple of year, harsh enviroument is expressing more tough to not getting close to the civilization and ability.</p><p>Man died by kind of poverty.</p><p>Poverty caused by not treating them as power, but treating tasty word as governance model.</p><p>So Man deserve poverty by not taking seriously of bazoo?</p><p>fucking bazooer!!!</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-12-31lesson</title>
      <link href="/2019/01/01/2018-12-31lesson/"/>
      <url>/2019/01/01/2018-12-31lesson/</url>
      
        <content type="html"><![CDATA[<blockquote><p>一年的最后一天,补一个日记。<br>希望明年真正做到盈利。<br>汪汪汪</p></blockquote><h1 id="New-VPS-Centos6-config"><a href="#New-VPS-Centos6-config" class="headerlink" title="New VPS Centos6 config"></a>New VPS Centos6 config</h1><p>//查看系统位数<br>file /bin/ls<br>getconf LONG_BIT<br>uname -a || uname -r</p><p>service docker start/stop (当前为1.7.1)<br><a href="https://stackoverflow.com/questions/35385853/yum-install-error-docker" target="_blank" rel="noopener">https://stackoverflow.com/questions/35385853/yum-install-error-docker</a><br>yum install <a href="http://yum.dockerproject.org/repo/main/centos/6/Packages/docker-engine-1.7.1-1.el6.x86_64.rpm" target="_blank" rel="noopener">http://yum.dockerproject.org/repo/main/centos/6/Packages/docker-engine-1.7.1-1.el6.x86_64.rpm</a><br>这个包才是存在的</p><p>yum install -y wget</p><p>centos 6 安装Nginx<br><a href="https://www.cyberciti.biz/faq/install-nginx-centos-rhel-6-server-rpm-using-yum-command/" target="_blank" rel="noopener">https://www.cyberciti.biz/faq/install-nginx-centos-rhel-6-server-rpm-using-yum-command/</a> </p><p>之上一直因为centos6 的epel-release 这个扩展源 老是装不进，所以在安装一堆东西时，总是显示“nothing to do”。<br>我一直以为EPEL 是装进去的，而且是最新的，然而并没有安装进去。<br><a href="https://unix.stackexchange.com/questions/153566/installing-epel-repository-on-centos-fails" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/153566/installing-epel-repository-on-centos-fails</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -ev epel-release-6-8.noarch</span><br><span class="line">yum update</span><br><span class="line">rpm -ivh http://dl.fedoraproject.org/pub/epel/6/$(uname -i)/epel-release-6-8.noarch.rpm</span><br></pre></td></tr></table></figure></p><p>安装入这个后，yum 源就有python-pip 了</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-12-24lesson</title>
      <link href="/2018/12/24/2018-12-24lesson/"/>
      <url>/2018/12/24/2018-12-24lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="购买了一个服务器，折腾了一天给相关环境整理了下。"><a href="#购买了一个服务器，折腾了一天给相关环境整理了下。" class="headerlink" title="购买了一个服务器，折腾了一天给相关环境整理了下。"></a>购买了一个服务器，折腾了一天给相关环境整理了下。</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OS: centos 6 x86_64 # docker 一定要64位</span><br><span class="line">服务器采用docker + koa + mongodb</span><br><span class="line">前端采用Next.js + mobx + antd 组合</span><br></pre></td></tr></table></figure><h1 id="服务器配置"><a href="#服务器配置" class="headerlink" title="服务器配置"></a>服务器配置</h1><p>由于docker 在centos6 下只能采用1.7.1 版本，导致docker-compose 只能采用1.5.2 版本。</p><p>环境要求：python2.7.12;.yml file version为1</p><p><a href="CentOS6.x 安装 Docker 和 Docker Compose">参考博文</a></p><p>服务器Dockerfile:</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">8.12</span>.<span class="number">0</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span> /server</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span> . /server</span><br><span class="line"><span class="keyword">RUN</span> npm install</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">9527</span></span><br><span class="line"><span class="keyword">CMD</span> ["yarn", "start"]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mongo:</span><br><span class="line">  image: &quot;mongo:3.6.9-stretch&quot;</span><br><span class="line">  volumes:</span><br><span class="line">    - ./data:/data/db</span><br><span class="line">  ports:</span><br><span class="line">    - &quot;27017:27017&quot;</span><br><span class="line">web:</span><br><span class="line">  build: .</span><br><span class="line">  command: npm start</span><br><span class="line">  volumes:</span><br><span class="line">    - ./dist:/server/dist</span><br><span class="line">  ports:</span><br><span class="line">    - &quot;9527:9527&quot; #我就想用这个端口</span><br><span class="line">  links:</span><br><span class="line">    - mongo</span><br></pre></td></tr></table></figure><p>package.json/script:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "watch": "tsc -w -p ./src",</span><br><span class="line">    "debug": "nodemon --watch ./dist --inspect=0.0.0.0:9222 --nolazy ./dist/www.js",</span><br><span class="line">    "docker-debug": "docker-compose up",</span><br><span class="line">    "start": "node ./dist/www.js",</span><br><span class="line">    "mocha-test": "mocha -t 8000 --recursive "</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>运行docker 出现<code>iptables failed - No chain/target/match by that name</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -N DOCKER</span><br><span class="line">service docker restart</span><br></pre></td></tr></table></figure><ul><li>mongodb 总是连不上</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1. docker-compose.yml 的links 不能缺少</span><br><span class="line">2. mongoose.connect(db_url) 的db_url 确认是docker-compose 的image 名。如我的&quot;mongo&quot;</span><br><span class="line">3. 失败重连</span><br><span class="line">const connectWithRetry = () =&gt; &#123;</span><br><span class="line">    console.log(&quot;MongoDB connection with retry&quot;);</span><br><span class="line">    mongoose.connect(db_url, options).then(() =&gt; &#123;</span><br><span class="line">        console.log(&quot;MongoDB is connected&quot;);</span><br><span class="line">    &#125;).catch(err =&gt; &#123;</span><br><span class="line">        console.log(&quot;MongoDB connection unsuccessful, retry after 5 seconds.&quot;);</span><br><span class="line">        setTimeout(() =&gt; connectWithRetry(), 5000)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">connectWithRetry();</span><br></pre></td></tr></table></figure><ul><li>服务器在vscode debug</li></ul><p>参考vscode 原文<a href="https://github.com/Microsoft/vscode-recipes/tree/master/Docker-TypeScript" target="_blank" rel="noopener">我是原文</a></p><h1 id="Nextjs-配置"><a href="#Nextjs-配置" class="headerlink" title="Nextjs 配置"></a>Nextjs 配置</h1><p>接下来是nextjs 推送记录</p><ol><li>nextjs 编译环境有要求：RAM 1G</li></ol><p>我服务器就1G，不然编译的时候会报”code 137”,提示内存不足，同时导致服务器mongodb 一直弹提示<code>centos mongodb [ftdc] serverStatus was very slow: { after basic: 163, after asserts:</code>。</p><p>解决办法是采用开发机器<code>yarn build</code> 后，将<strong>.next</strong> 文件夹git commit ，然后同步过来。</p><ol start="2"><li>nextjs 使用pm2 start:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/zeit/next.js/issues/109</span><br><span class="line"># for development</span><br><span class="line">pm2 start npm --name &quot;next&quot; -- run dev</span><br><span class="line"></span><br><span class="line"># for production</span><br><span class="line">npm run build</span><br><span class="line">pm2 start npm --name &quot;next&quot; -- start</span><br></pre></td></tr></table></figure><ol start="3"><li>nextjs 需要在域名根目录运行， 否则出现static 静态路由找不到。其他route 也会找不到的情况。</li></ol><p>nginx 配置如:</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> www.lsgood.top lsgood.top;</span><br><span class="line">    <span class="attribute">root</span> /var/www;</span><br><span class="line">    <span class="attribute">index</span> index.html index.htm;</span><br><span class="line">    <span class="attribute">location</span> ~^/facicon\.ico$ &#123;</span><br><span class="line">        <span class="attribute">root</span> /var/www;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:9005;</span><br><span class="line">        <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Connection <span class="string">'upgrade'</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_cache_bypass</span> <span class="variable">$http_upgrade</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> /japeneeza/ &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9527/;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>nextjs 没有storage；同时 server side 获取不到cookie</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">yarn add js-cookie cookieParser</span><br><span class="line"></span><br><span class="line">cookie <span class="keyword">set</span> <span class="keyword">get</span> cookie (自行参考cookie 保存token)</span><br><span class="line">eg: jsCookie.<span class="keyword">set</span>("token", $&#123;token&#125;)</span><br><span class="line"></span><br><span class="line">server.js(express)</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">"cookieParser"</span>)</span><br><span class="line">server.use(cookieParser())</span><br><span class="line"></span><br><span class="line">然后在pages 里的pageClass.getInitialProps = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">&#123;ctx&#125;</span>) =&gt; </span>&#123;</span><br><span class="line">    cosnt &#123; req &#125; = ctx;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"token:"</span>, req.cookies.token)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="让你知道技术的力量"><a href="#让你知道技术的力量" class="headerlink" title="让你知道技术的力量"></a>让你知道技术的力量</h1><p>A: 什么？不相信我的能力？<br>A(咆哮): 我要让你们知道 the ability of super technology!!!</p><p>门外, 砰砰砰: 开门，查水表.</p><p>A: 大家快点收拾东西，藏起来，丢到窗外，快点快点。。。</p><p><a href="本来想做一个视频网站，想想还要各种“证”，到时先做小的视频网站，，然后转成会员卖套图吧。国内什么都做不了，什么都不能做，国家要各种屁民听话。我觉得公务员们不认为自己是中国人，他们认为自己是体制人，是平民的上司。他们凭什么呀？都是我们纳税人养着的服务人员，怎么就有这么多的特权？纳税的意义在哪里？好好活着吧。"></a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-12-9lesson</title>
      <link href="/2018/12/09/2018-12-9lesson/"/>
      <url>/2018/12/09/2018-12-9lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="2018-11-20"><a href="#2018-11-20" class="headerlink" title="2018-11-20"></a>2018-11-20</h1><p>最近有所感悟：<br>你的工资起点、增长点 不在于你的能力大小，而是在于你职位的不同。</p><p>先说说我和以前同事（周）对比：他是做nodejs、我是做iOS；他往服务器深度拓展，我往客户端in/out 和多媒体，我觉得能力上互有所长，互有高低，基本持平；但是工资的起点，企业认可点也是不同的。</p><p>再比如现在来到这家初创型公司，我从四年努力过来，也成为了当前同事年龄最大那一批人了。能力我觉得应该是最强的，但我仍然还只是iOS 开发，就是苦力劳动者；我旁边是“产品经理”，年龄与我相仿，但交流之中便知是半路出家，可还是丝毫不影响他作为“经理”的角色。很多产品的处理、遇到问题的解决方案、思路都没成形，但是一些团队中遇到问题，却需要他来解答。</p><p>当然，小公司，就是这样，我当然也没必要在乎这些点，感想感悟罢了。</p><p>小团队里面，当然有点可笑，互联网是科技产业，不是艺术行业。“运营”主导，这种理念，基本都是小公司的思维。觉得有东西可以“运营”了，然后“产品经理”们给产品换换皮，挪挪位置就可以了。</p><p>我和周有时也交流，他也非常赞同我的观点：早点换职业-后台。</p><p>我来如今的公司，也算巧合：之前公司莫名其妙离职；中秋+国庆导致面试周期变短–&gt; 社保断了被老婆“打系”；附近周围找工作（地域限制）；今年形势也不是很好 等等因素。既来之，则安之。安是为了过度，正好将多余时间实践我学习的网页、后台。跨度的没关系，拼命就好（真不能学太多，消化不过来。最近一直有发现，学一个就忘掉了之前那个，不过还好的就是，当时学习的手感还在）。</p><p>定个决心：明年暑假6、7 月份，必然开始找后台开发工作！！！</p><p>nextjs 在centos 32bit i386 打包completed, 但是等待很久却失败显示xxx137.原因是centos 内存太低、系统太低。</p><p>18-11-24 又一次聚会。</p><p>这一次聚会四个人，议题是最近学了哪些东西，可以将其分享（我就是纯旁听的，偷学技术的）。我、周俊、周俊前同事（高级前端）、周俊以前的领路人（php兄弟连“莫楠”，目前在一家公司做项目经理）。聚会地点就是莫楠倾情提供的他们公司会议室。<br>大家先在“闸北”-“大融城” 吃 <strong>麻辣香锅</strong> （我又是吃饭最慢的，牙疼）。接着我们前往莫楠提供的会所地点，楼下莫楠大哥演示了下他们公司提供的食品柜，就是那种自助购买食品柜机。接着上楼开讲啦。<br>周俊先主要讲ipfs.讲到其中p2p，类似于autossh。接着讲到如何使用pm2 负载均衡。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">测并发</span><br><span class="line">1: ab -c 100 -n 1000 http://localhost:3002(1000个并发数)(mac 默认带个进程并发数1024个)</span><br><span class="line">2: wrk</span><br><span class="line"></span><br><span class="line">现在pm2 并发:</span><br><span class="line">pm2 -i(max) app.js</span><br><span class="line"></span><br><span class="line">docker k8s kubernetes</span><br><span class="line"></span><br><span class="line">mqtt</span><br><span class="line"></span><br><span class="line">awesome node</span><br><span class="line"></span><br><span class="line">electron shadowsocks</span><br><span class="line"></span><br><span class="line">xgplyer</span><br></pre></td></tr></table></figure><p>接下来是前端哥们讲了他做的一些东西，第三方js库，使用docker 能力，一键开启所有的能力。（这里我注意到docker 能力，回去后整整忙活一个多星期适应了docker 运用）。</p><p>我本来是旁听的，不过大家奉献那么多，我就又鼓吹了卡通、动漫、盗版，这一类不与技术有关的变现道路。</p><p>4点多，我们三个还有空，前往星巴克继续撸，继续问。这里互相交流的就更多了，比如探讨ipfs 可能变现能力和ss 直接变现。</p><p>6点多，一起吃火锅去。中间大家一度思路集合说做一个盗版视频网站、软件（后面似乎大家忙，往后推迟）。一直吃到晚上10点，然后3人挤到一辆电动车，周俊开着前往地铁站。</p><p>一天吃两顿火锅，第二天就有点生病，持续了2个星期还没好，夜夜带着病战斗完成这次集合所学。不枉此行。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-12-1lesson</title>
      <link href="/2018/12/01/2018-12-1lesson/"/>
      <url>/2018/12/01/2018-12-1lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="最近继续服务修行"><a href="#最近继续服务修行" class="headerlink" title="最近继续服务修行"></a>最近继续服务修行</h1><h2 id="打造docker-容器守护"><a href="#打造docker-容器守护" class="headerlink" title="打造docker 容器守护"></a>打造docker 容器守护</h2><p>采用docker-compose 多重容器聚合，一键配置。<br>一开始配置上出问题，mongodb连接不上。<br>当前成功配置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3&quot;</span><br><span class="line">services:</span><br><span class="line">mongo:</span><br><span class="line">image: &quot;mongo:3.6.9-stretch&quot;</span><br><span class="line">volumes:</span><br><span class="line">- ./data:/data/db</span><br><span class="line">ports:</span><br><span class="line">- &quot;27017:27017&quot;</span><br><span class="line">redis:</span><br><span class="line">image: &quot;redis:alpine&quot;</span><br><span class="line">web:</span><br><span class="line">build: .</span><br><span class="line">image: nodejap</span><br><span class="line">command: npm run debug</span><br><span class="line">volumes:</span><br><span class="line">- ./dist:/server/dist</span><br><span class="line">ports:</span><br><span class="line">- &quot;3000:9527&quot;</span><br><span class="line">- &quot;9222:9222&quot;</span><br><span class="line">links:</span><br><span class="line">- mongo</span><br><span class="line">depends_on:</span><br><span class="line">- mongo</span><br></pre></td></tr></table></figure><p>mongo先启动，然后到了web 启动的时候，配置启动采用<a href="https://github.com/docker/hub-feedback/issues/1255" target="_blank" rel="noopener">github issue</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">autoIndex: <span class="literal">true</span>,</span><br><span class="line">reconnectTries: <span class="number">30</span>,</span><br><span class="line">reconnectInterval: <span class="number">500</span>,</span><br><span class="line">poolSize: <span class="number">10</span>,</span><br><span class="line">bufferMaxEntries: <span class="number">0</span>,</span><br><span class="line">useNewUrlParser: <span class="literal">true</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> connectWithRetry = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"MongoDB connection with retry"</span>);</span><br><span class="line">mongoose.connect(db_url, options).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"MongoDB is connected"</span>);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"MongoDB connection unsuccessful, retry after 5 seconds."</span>);</span><br><span class="line">setTimeout(connectWithRetry, <span class="number">5000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">connectWithRetry();</span><br></pre></td></tr></table></figure><p>这时，每次启动最后一行就都是<code>web_1_9cf04d6b74a9 | MongoDB is connected</code></p><p>接下来顺顺利利的写不久，遇到两个问题：</p><p>首先得知Schema 有<code>_id</code> 和<code>id</code>区分。</p><p><code>_id</code> 是为了分布式而取的对象，根据时间戳生成，当然就具有createdAt 的能力。</p><p><code>id</code> 是字符串，唯一字符串。</p><p>再者遇到unique 对象可以重复创建相同键：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Automattic/mongoose/issues/7194</span><br><span class="line"></span><br><span class="line">mongoose.set(&quot;debug&quot;, true);</span><br><span class="line">mongoose.set(&apos;useNewUrlParser&apos;, true);</span><br><span class="line">mongoose.set(&apos;useFindAndModify&apos;, false);</span><br><span class="line">mongoose.set(&apos;useCreateIndex&apos;, true);</span><br></pre></td></tr></table></figure><p>原因是mongodb 升级上来，这篇必看的，被我这半路出家的终于花了<em>周六</em>一天才解决掉。</p><h2 id="使用vscode-配合docker-compose-yml-debug"><a href="#使用vscode-配合docker-compose-yml-debug" class="headerlink" title="使用vscode 配合docker-compose.yml debug"></a>使用vscode 配合docker-compose.yml debug</h2><p>参考这篇<a href="https://github.com/Microsoft/vscode-recipes/tree/master/Docker-TypeScript" target="_blank" rel="noopener">vscode 官方原文</a></p><p>使用起来太爽了。</p><h2 id="再分享我的Dockerfile-的长相"><a href="#再分享我的Dockerfile-的长相" class="headerlink" title="再分享我的Dockerfile 的长相"></a>再分享我的Dockerfile 的长相</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM node:<span class="number">8.12</span><span class="number">.0</span>-alpine</span><br><span class="line"></span><br><span class="line">WORKDIR /server</span><br><span class="line"></span><br><span class="line">COPY . /server</span><br><span class="line">RUN npm install</span><br><span class="line"></span><br><span class="line">EXPOSE <span class="number">9527</span></span><br><span class="line">CMD [<span class="string">"yarn"</span>, <span class="string">"debug"</span>]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-11-14lesson</title>
      <link href="/2018/11/14/2018-11-14lesson/"/>
      <url>/2018/11/14/2018-11-14lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><p>create-react-app</p><p>功能有：<br>···</p><h2 id="axios-网络获取数据"><a href="#axios-网络获取数据" class="headerlink" title="axios 网络获取数据"></a>axios 网络获取数据</h2><h2 id="rem-手机距离适配，同时添加less-loader"><a href="#rem-手机距离适配，同时添加less-loader" class="headerlink" title="rem 手机距离适配，同时添加less-loader"></a>rem 手机距离适配，同时添加less-loader</h2><p>yarn add less less-loader<br>yarn add autoprefixer</p><p>在/public/index.html <head><meta name="generator" content="Hexo 3.8.0"></head> 中间插入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;!<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(i[a])<span class="keyword">return</span> i[a].exports;<span class="keyword">var</span> n=i[a]=&#123;<span class="attr">exports</span>:&#123;&#125;,<span class="attr">id</span>:a,<span class="attr">loaded</span>:!<span class="number">1</span>&#125;;<span class="keyword">return</span> e[a].call(n.exports,n,n.exports,t),n.loaded=!<span class="number">0</span>,n.exports&#125;<span class="keyword">var</span> i=&#123;&#125;;<span class="keyword">return</span> t.m=e,t.c=i,t.p=<span class="string">""</span>,t(<span class="number">0</span>)&#125;([<span class="function"><span class="keyword">function</span>(<span class="params">e,t</span>)</span>&#123;<span class="string">"use strict"</span>;<span class="built_in">Object</span>.defineProperty(t,<span class="string">"__esModule"</span>,&#123;<span class="attr">value</span>:!<span class="number">0</span>&#125;);<span class="keyword">var</span> i=<span class="built_in">window</span>;t[<span class="string">"default"</span>]=i.flex=<span class="function"><span class="keyword">function</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a=e||<span class="number">100</span>,n=t||<span class="number">1</span>,r=i.document,o=navigator.userAgent,d=o.match(<span class="regexp">/Android[\S\s]+AppleWebkit\/(\d&#123;3&#125;)/i</span>),l=o.match(<span class="regexp">/U3\/((\d+|\.)&#123;5,&#125;)/i</span>),c=l&amp;&amp;<span class="built_in">parseInt</span>(l[<span class="number">1</span>].split(<span class="string">"."</span>).join(<span class="string">""</span>),<span class="number">10</span>)&gt;=<span class="number">80</span>,p=navigator.appVersion.match(<span class="regexp">/(iphone|ipad|ipod)/gi</span>),s=i.devicePixelRatio||<span class="number">1</span>;p||d&amp;&amp;d[<span class="number">1</span>]&gt;<span class="number">534</span>||c||(s=<span class="number">1</span>);<span class="keyword">var</span> u=<span class="number">1</span>/s,m=r.querySelector(<span class="string">'meta[name="viewport"]'</span>);m||(m=r.createElement(<span class="string">"meta"</span>),m.setAttribute(<span class="string">"name"</span>,<span class="string">"viewport"</span>),r.head.appendChild(m)),m.setAttribute(<span class="string">"content"</span>,<span class="string">"width=device-width,user-scalable=no,initial-scale="</span>+u+<span class="string">",maximum-scale="</span>+u+<span class="string">",minimum-scale="</span>+u),r.documentElement.style.fontSize=a/<span class="number">2</span>*s*n+<span class="string">"px"</span>&#125;,e.exports=t[<span class="string">"default"</span>]&#125;]);</span><br><span class="line">      flex(<span class="number">100</span>, <span class="number">1</span>);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>然后在/config/webpack.config.dev.js 增加</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pxtorem = <span class="built_in">require</span>(<span class="string">'postcss-pxtorem'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">                oneOf: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        test: <span class="regexp">/\.(svg)$/i</span>,</span><br><span class="line">                        loader: <span class="string">'svg-sprite-loader'</span>,</span><br><span class="line">                        include: [</span><br><span class="line">                        <span class="built_in">require</span>.resolve(<span class="string">'antd-mobile'</span>).replace(<span class="regexp">/warn\.js$/</span>, <span class="string">''</span>), <span class="comment">// 1. svg files of antd-mobile</span></span><br><span class="line">                        path.resolve(__dirname, <span class="string">'../src/icons'</span>), <span class="comment">// folder of svg files in your project</span></span><br><span class="line">                        ]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                        use: [</span><br><span class="line">                        <span class="built_in">require</span>.resolve(<span class="string">'style-loader'</span>),</span><br><span class="line">                        <span class="built_in">require</span>.resolve(<span class="string">'css-loader'</span>),</span><br><span class="line">                        &#123;</span><br><span class="line">                            loader: <span class="built_in">require</span>.resolve(<span class="string">'postcss-loader'</span>),</span><br><span class="line">                            options: &#123;</span><br><span class="line">                            ident: <span class="string">'postcss'</span>, <span class="comment">// https://webpack.js.org/guides/migrating/#complex-options</span></span><br><span class="line">                            plugins: <span class="function"><span class="params">()</span> =&gt;</span> [</span><br><span class="line">                                autoprefixer(&#123;</span><br><span class="line">                                browsers: [<span class="string">'last 2 versions'</span>, <span class="string">'Firefox ESR'</span>, <span class="string">'&gt; 1%'</span>, <span class="string">'ie &gt;= 8'</span>, <span class="string">'iOS &gt;= 8'</span>, <span class="string">'Android &gt;= 4'</span>],</span><br><span class="line">                                &#125;),</span><br><span class="line">                                pxtorem(&#123; <span class="attr">rootValue</span>: <span class="number">100</span>, <span class="attr">propWhiteList</span>: [] &#125;)</span><br><span class="line">                            ],</span><br><span class="line">                            &#125;,</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            loader: <span class="built_in">require</span>.resolve(<span class="string">'less-loader'</span>),</span><br><span class="line">                            options: &#123;</span><br><span class="line">                            modifyVars: &#123; <span class="string">"@primary-color"</span>: <span class="string">"#1DA57A"</span> &#125;,</span><br><span class="line">                            &#125;,</span><br><span class="line">                        &#125;],</span><br><span class="line">                    &#125;]</span><br><span class="line">            &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="yarn-run-eject-和-antd加入"><a href="#yarn-run-eject-和-antd加入" class="headerlink" title="yarn run eject 和 antd加入"></a>yarn run eject 和 antd加入</h2><p>由于需要使用mobx 的”@” decorator 功能。yarn run eject 解开webpack 之后<br><code>yarn add babel-plugin-transform-decorators-legacy --dev</code>,<br>同时/package.json 加上</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">"babel": &#123;</span><br><span class="line">    "plugins": [</span><br><span class="line">        "transform-decorators-legacy",</span><br><span class="line">        [</span><br><span class="line">            <span class="string">"import"</span>, &#123; <span class="attr">"libraryName"</span>: <span class="string">"antd-mobile"</span>, <span class="attr">"style"</span>: <span class="string">"css"</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时为了打包yarn build 项目路由能找到静态文件,在/package.json <code>&quot;homepage&quot;: &quot;.&quot;</code>. <strong>重要</strong></p><h2 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/src</span><br><span class="line">    /axios</span><br><span class="line">    /components</span><br><span class="line">    /constants</span><br><span class="line">    /icons</span><br><span class="line">    /pages//各个页面的page</span><br><span class="line">    /router/index//路由中心</span><br><span class="line">    /routes//各级路由和总根路由</span><br><span class="line">    /store//各个store和index store</span><br><span class="line">    /utils</span><br><span class="line">    index.js</span><br><span class="line">    index.css</span><br><span class="line">package.json</span><br></pre></td></tr></table></figure><h2 id="解决编译后某个bug"><a href="#解决编译后某个bug" class="headerlink" title="解决编译后某个bug"></a>解决编译后某个bug</h2><p>/public/index.html <head><meta name="generator" content="Hexo 3.8.0"></head> 中间加上:<br><code>&lt;script type=&quot;text/babel&quot; src=&quot;./lander.js&quot;&gt;&lt;/script&gt;</code></p><h2 id="build"><a href="#build" class="headerlink" title="build"></a>build</h2><p>build 的语法同样很重要，否则出现Nginx 配置路由，启动build 后的项目变成阅览文件目录:<br><code>$ PUBLIC_URL=http://lsgood.top yarn build</code></p><p>原由是/public/index.html 的link 写到：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"manifest"</span> <span class="attr">href</span>=<span class="string">"%PUBLIC_URL%/manifest.json"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"shortcut icon"</span> <span class="attr">href</span>=<span class="string">"%PUBLIC_URL%/favicon.ico"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意PUBLIC_URL(当时不知道解决方案，花了三天，愁的都长痘痘了).</p><h2 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80 default_server;</span><br><span class="line">        server_name www.lsgood.top lsgood.top;</span><br><span class="line"></span><br><span class="line">        root /var/www;</span><br><span class="line">        index index.html index.htm;      </span><br><span class="line">        # Any route that doesn&apos;t have a file extension (e.g. /devices)</span><br><span class="line">        location ~ ^/favicon\.ico$ &#123;</span><br><span class="line">            root /var/www;</span><br><span class="line">        &#125;</span><br><span class="line">        location / &#123;</span><br><span class="line">            try_files $uri $uri/ /index.html;</span><br><span class="line">            index index.html;</span><br><span class="line">            proxy_set_header   Host             $host;</span><br><span class="line">            proxy_set_header   X-Real-IP        $remote_addr;</span><br><span class="line">            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header   X-Forwarded-Proto  $scheme;</span><br><span class="line">        &#125;</span><br><span class="line">        location @fallback &#123;</span><br><span class="line">            rewrite ^.*$ /index.html break;</span><br><span class="line">        &#125;</span><br><span class="line">        location /girlS/ &#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:8000/girl.v1/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /popcircle/ &#123;</span><br><span class="line">            root /root/Work/game/;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这样多个路由就能看到不同点了</p><h2 id="Mobx-在上面的使用"><a href="#Mobx-在上面的使用" class="headerlink" title="Mobx 在上面的使用"></a>Mobx 在上面的使用</h2><p>/src/store/下存储着各个store 具体事务，index 是其中的集合体。</p><p>/src/index.js 下导入“mobx-react” 的Provider，引入了所有的store。</p><p>这样在使用时，如/store:topics.js, /pages:Default.js inject关联store:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@inject(<span class="function">(<span class="params">&#123;topics, status&#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">    data: topics.data</span><br><span class="line">&#125;))</span><br><span class="line">@observer <span class="class"><span class="keyword">class</span> <span class="title">DefaultClass</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...this.props.data<span class="comment">//就拿出来了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>store.js 里面一般会有4个方法:{ observable, action, useStrict }<br>action 的作用是，强制用户在该方法下更改被observable 的属性, 用法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@observable data;</span><br><span class="line">@action.bound updateData(val) &#123;</span><br><span class="line">    <span class="keyword">this</span>.data = val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时,action.bound 可以正确获得this 指针.</p><p>最后export 这个单例对象:<code>export default new Store();</code>，放到/src/store/index.js 的<code>export default {store}</code>下,完成合并store，以便所有节点都可以inject.<br>···</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-11-10lesson</title>
      <link href="/2018/11/10/2018-11-10lesson/"/>
      <url>/2018/11/10/2018-11-10lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="双十一-怎么消费只放假一天的周末"><a href="#双十一-怎么消费只放假一天的周末" class="headerlink" title="双十一 怎么消费只放假一天的周末"></a>双十一 怎么消费只放假一天的周末</h1><p>因为上海国际进口博览会召开，公司周末调休。今天是周六放假，周日上班（调休了）。<br>我之前也有和周俊（粉粉可萌node 后台，我的js 都是他无私教入门的，非常异常感谢他）交流说找时间一起吃个饭。前两天遇到问题找他，刚好他”猫咪死了，女朋友分了，工作丢了，刚好又拿到offer了“。其实遇到这么多事，还是挺伤心的。坏事多磨，哈哈。然后约周六中午一起吃，喊上高祥（粉粉可萌上一任iOS）一起小聚一个。</p><p>只有一天的周末，三个光棍齐聚陆家嘴2号口。</p><p>先聊了聊各自家常：</p><blockquote><p>周俊拿30k offer，当场给，但是再尝试尝试还有别的面试不，面试了两个月了（两点：30k有点多，有丢丢羡慕哟，不过希望能呆久点，稳定为好；面试了两个月，希望他赶紧有个好结果）；他女朋友是因为她家里人不同意他们在一起（艰难）；周俊前几天还约了一个外国回来的硕士妹子（给力，不过说后面没后文了，所以吃饭期间我们都调侃他，多补补腰子）；之前公司解散员工还没获得补偿（他的心态就是最近再看看能不能有补偿，有多少算多少，我也觉得是，不然挺好费时间的，得不偿失）；之前的是区块链公司；</p></blockquote><blockquote><p>高祥如今在浦东一个ezbuy 电子商务的公司，呆一年多（我和周俊就比较惨，一直奔波）；公司采用swift，之前可以内推我的（可惜了，不过当时我已经住在闵行，应该不会去浦东，跨度挺大，plus我还没被内推过，下次尝试尝试）；儿子6个月了在身边，老婆和他一起带着（这时候孩子挺不好带，真辛苦了，他们父母有帮助就好了）；他之前也学js，但是没有实践、没继续学下去（实践很重要）；他正要学go（多学一些挺重要，我和他都感悟到，不能被前端单一技能拖死，哈哈）；他大概20k左右（我要的真是太少了，他听到我在粉粉才14k，也觉得我粉粉要的太少了，不过我自己觉得当时自己确实太差，刻苦点吧）；</p></blockquote><blockquote><p>听讲，我刚去时候的前台菇凉怀孕，伟哥知道想把她辞了，这样就不会有休产假之类的。后来也不愿意给赔偿。最后是仲裁解决的。<br>我觉得伟哥，还好吧，原来还有这一面。看来我确实一心宅，不了解“市事”。</p></blockquote><p>以上不能算八卦的吧，嘎嘎，米西米西，我就记下来吧，反正我当这博文是我的日记本，记录记录身边朋友，哈哈。</p><p>我们吃完午餐去附近星巴克找了个位置坐下来，三个人围在一起学习交流起来了。</p><p>首先周俊讲了<strong>Nuxt.js</strong> 可以快速搭一个网站（我选择成熟的React 的框架：<strong>Next.js</strong> – 纯React.js 用<code>create-react-app</code> 搭起来的挺多麻烦事的，试试新的吧）。说了服务器创建、网页、ElementUI，这些我都懂，vary OK，感谢一年来的拼了狗命的努力。</p><p>然后我们探讨了下</p><ol><li>数据传输加密。我本来的设想是RSA 传递”AES 的secretKey“ 之后使用AES 加密数据进行传输。后来探讨下来，确实，”服务器怎么存储 IP 和对应的 secretKey” 这种行为是异想天开（我没想通就提出来问，好事）。直接采用：AES 或者JWT，，其实就是直接是<strong>客户端和服务器端同时保存相同secretkey</strong>这种方法。不要太太太复杂化解决，加上https，基本都是OK 的了。</li><li>区块链 nodejs 怎么接触：使用go语言写的以太坊项目，就可以有区块链功能啦，棒棒哒💯。</li><li>如何保证网站不会被爬数据，周俊推荐一个开源的拖动图片对位的东西，就能解决机器拖库拉。</li></ol><p>接着我来给他们展示我之前写的<strong>girl</strong>项目服务器，还有<strong>girl</strong> 网页代码，然后推荐他们可以做做小游戏盈利，给他们看了我之前写的小游戏代码。</p><p>之后剩下我和周俊（祥哥先回去了，孩子重要，嘿嘿），我让他考考我js一些问题，我可能打算明年冬天转换服务器工作，突破，嘿嘿😜。</p><p>有这么几个问题：</p><ol><li>es6 let</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="keyword">let</span> a = <span class="number">0</span>;(<span class="keyword">var</span> a = <span class="number">0</span>;)</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br></pre></td></tr></table></figure><ol start="2"><li>bind/call</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name: <span class="string">"zhoujun"</span>;</span><br><span class="line">    <span class="keyword">get</span>: function () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">    name: <span class="string">"aKer"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj.get());</span><br><span class="line">如何输出aKer</span><br><span class="line"></span><br><span class="line">obj.get.bind(obj2)()</span><br><span class="line">obj.get.call(obj2)</span><br></pre></td></tr></table></figure><ol start="3"><li>如何实现继承</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">我记得node 有个inherit 的模块，很方便就可以继承，但是忘记怎么搞了。</span><br><span class="line">那我们直接解决实际问题：</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"zhoujun"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">B.prototype = <span class="keyword">new</span> A();<span class="comment">//意思是源头采用A 里面的数据、对象、方法，但是导致B 成为了A'</span></span><br><span class="line">B.prototype.constructor = B;<span class="comment">//意思是使B 成为的A' 转换回B，B 的this 就正确的为B，而不是A了。</span></span><br></pre></td></tr></table></figure><ol start="4"><li>考了个算法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">给定一个包含N个整数的数组A，假设这个数组表示的是一条链条，其中</span><br><span class="line">每个元素表示链条上的一环。现在我们想把这条链条断成<span class="number">3</span>小部分。我们需 要做的就是断开不相连的两个环，更确切的说，我们需要断开环P、Q (<span class="number">0</span>&lt;P&lt;Q&lt;N<span class="number">-1</span>, Q-P &gt; <span class="number">1</span>)，得到三个小链条[<span class="number">0</span>,P<span class="number">-1</span>],[P+<span class="number">1</span>,Q<span class="number">-1</span>],[Q+<span class="number">1</span>,N<span class="number">-1</span>]。 上述操作的成本是A[P]+A[Q]。</span><br><span class="line">例如:数组A为 A[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line">A[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">A[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">A[<span class="number">3</span>] = <span class="number">6</span></span><br><span class="line">A[<span class="number">4</span>] = <span class="number">3</span></span><br><span class="line">A[<span class="number">5</span>] = <span class="number">7</span></span><br><span class="line">我们可以选择如下方式断开链条 - (<span class="number">1</span>，<span class="number">3</span>):成本是 <span class="number">2</span>+<span class="number">6</span> = <span class="number">8</span> - (<span class="number">1</span>，<span class="number">4</span>):成本是 <span class="number">2</span>+<span class="number">3</span> = <span class="number">5</span> - (<span class="number">2</span>，<span class="number">4</span>):成本是 <span class="number">4</span>+<span class="number">3</span> = <span class="number">7</span></span><br><span class="line">写一个函数</span><br><span class="line">int breakchain(int A[], int N);</span><br><span class="line">对任一个给定的链条，返回断开链条的最低成本，比如上面的例子中， 需要返回最低成本<span class="number">5</span></span><br><span class="line">假设:</span><br><span class="line">- N是整数，范围[<span class="number">5</span>,<span class="number">100000</span>]</span><br><span class="line">A的元素是范围在[<span class="number">1</span>,<span class="number">1000000000</span>]的整数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">解法有两个，高祥用了两个小时，我用了<span class="number">5</span>分钟（我的方法比较消耗性能估计，采用空间换时间）</span><br><span class="line"><span class="number">1.</span> 读懂题目，那就是头尾去掉的所有数“取其中最小三个数，必然能构成解”（他们两个采用的这个）</span><br><span class="line"><span class="number">2.</span> </span><br><span class="line"><span class="keyword">let</span> results = [];</span><br><span class="line"><span class="keyword">let</span> resulti = [];</span><br><span class="line"><span class="keyword">let</span> resultj = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; arr.length <span class="number">-1</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = i+<span class="number">1</span>; j &lt; arr.length<span class="number">-1</span> - i; j++) &#123;</span><br><span class="line">        <span class="keyword">let</span> result = arr[i] + arr[j];</span><br><span class="line">        results.push(result);</span><br><span class="line">        resulti.push(i);</span><br><span class="line">        resultj.push(j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">j 层<span class="keyword">for</span> 循环找到最小一堆i 和j；</span><br><span class="line">然后i 层得到所有j 层获取的最小值然后比较谁是最小的那一对。</span><br><span class="line">啊哈，比较消耗资源。</span><br></pre></td></tr></table></figure><p>5分钟我没有解决完“方法2”，只解决完一半（想问题时，想太久怕周俊无聊，哈哈）。</p><p>也算幸好找到了一些思路，开心开心。虽然性能差、与最终答案不正对，不过还是开心，哈哈。</p><p>晚上回到家，看看阿黄，写完博文，已经是双十一凌晨30分，赶紧入睡，明天要上班的哟，哎呦不错哟。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-11-9lesson</title>
      <link href="/2018/11/09/2018-11-9lesson/"/>
      <url>/2018/11/09/2018-11-9lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="上线React-Mobx-Antd-build-Nginx-经历"><a href="#上线React-Mobx-Antd-build-Nginx-经历" class="headerlink" title="上线React+Mobx+Antd + build + Nginx 经历"></a>上线React+Mobx+Antd + build + Nginx 经历</h1><p>首先非常开心，自己找遍解决方案，终于来到终点：<a href="http://lsgood.top" target="_blank" rel="noopener">http://lsgood.top</a> 我的第一个网页。<br>该网页由爬虫爬了一个二次元图片的网站，然后一个Typescript koa 后台提供数据，再由Reactjs 网页展现。</p><p>首先遇到的第一个大山：centos 装mongodb </p><p>先使用yum 安装mongodb，然后一直报”no package is avialable. nothing to do”, 我是mongodb 官网教程，建了一个.repo 来整的，然后又学会去redhat 的源找找看看。都在的，可以的呀。</p><p>然后找到<code>$ getconf LONG_BIT</code>终于得知我的是32位。那就说明yum 的那些源都是x86 ，查看一番：果然。屁颠屁颠去看了有哪些32位mongodb 的我可以用。</p><p>google 找到一个csdn 里面有个2.x 版本的，装上去果然可以启动，把我开心的呀。然后服务器用mongoose 2.x 版本及以下都不可用。一番寻找，找到<br><a href="https://blog.csdn.net/will5451/article/details/78642759" target="_blank" rel="noopener">CSDN centos用yum安装mongodb及 32位linux（centos）下mongoDB的安装</a>  的文章。采用wget 下载相应的版本。前往<a href="https://www.mongodb.com/download-center/community" target="_blank" rel="noopener">官网工具下载区</a> ，一开始也不明白哪个我真的可以用，最后终于找到排到最后一个的3.0x 版本的真的真的是32bit。</p><p>快速放到服务器启动起来的时候，真的开心啊。</p><p>然而一心以为后面React 网页yarn build 应该很简单，没想到又是一番挫折。</p><p>既然数据好了，赶紧打包我的第一个React 应用。<code>yarn build</code> 很快！</p><p>然后配置一下Nginx，把build 出来的文件拖到<code>/root/Work/web/girl</code> 目录下,Nginx 如下配置</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> www.lsgood.top lsgood.top;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> /girl/ &#123;</span><br><span class="line">        <span class="attribute">root</span> /root/Work/web/;</span><br><span class="line">        <span class="attribute">index</span> index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先出来一个问题：由于不是放在Nginx 根目录，是<code>http://lsgood.top/girl</code> 这样的目录，导致内部css 资源、static 资源 找不到根路由，找的是<code>http://lsgood.top/xxxstaticxxx</code> 的目录资源，那就在package.json 加上一个field <code>homepage: &quot;.&quot;</code> 。</p><p>这个解决之后出现一个花费我1.5 天寻找是React 内部问题，还是Nginx 没有配置好的问题：Nginx 配置路由(不同根目录)要么出现<code>Uncaught SyntaxError: Unexpected token &lt;</code> ；要么整个页面就是空白，同时查看<strong>右键 - 检查 - Sources</strong> 将我的React 程序目录源代码全部展示出来了。</p><p>说明并没有启动我对应的index.html。我不明白为什么会出现这样，期间问了我以前同事，但还是没有答案（毕竟突然给他看，不明白里面所写，也忙，然后没有解出来）。</p><p>然后1天过去后，我让现在后台帮忙，放到可以运行的网页那边看看。一开始怕他们麻烦，推荐他说，直接放文件名后面，就不用建立子域名。然后还是失败！</p><p>这样我还是不知道是哪边的问题，我又又又google 找了下，有说不要放在<a href="http://host/girl/" target="_blank" rel="noopener">http://host/girl/</a> 子目录，放到Nginx根目录。我赶紧让后台帮忙再试一波！</p><p>果然！成功，不过index 首页是OK，但是路由却进不去了。首页OK，路由有问题，说明React 应用没问题，Nginx 配置错误了，同时React 里面的路由也出错了。</p><p>我又双叒叕google，找到这篇<a href="https://blog.csdn.net/Sophie_U/article/details/80006723" target="_blank" rel="noopener">关于react 在打包后：“找不到资源路径”的问题、部署到服务器二级目录 “打开为空白” 的问题</a> 这里说到一个很重点的信息：<strong>browserRouter/PUBLIC_URL/NGINX</strong> 这么几个重点词语。我还真用到了browserRouter， 问题也确实是<strong>访问时页面空白，没有报错</strong> 这种情况。</p><p>那我就采用他的办法（花了一个下午加加班到晚上8点多）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1. React 在build 时:</span><br><span class="line">$ PUBLIC_URL=http://lsgood.top/ yarn build</span><br><span class="line">2. 将build 的子文件全部放到 /var/www/ 下面</span><br><span class="line">3. Nginx conf 配置：（参考 https://gkedge.gitbooks.io/react-router-in-the-real/content/nginx.html）</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    server_name www.lsgood.top lsgood.top;</span><br><span class="line"></span><br><span class="line">    root /var/www;</span><br><span class="line">    index index.html index.htm;      </span><br><span class="line">    # Any route that doesn&apos;t have a file extension (e.g. /devices)</span><br><span class="line">    location ~ ^/favicon\.ico$ &#123;</span><br><span class="line">        root /var/www;</span><br><span class="line">    &#125;</span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ /index.html;</span><br><span class="line">        index index.html;</span><br><span class="line">        proxy_set_header   Host             $host;</span><br><span class="line">        proxy_set_header   X-Real-IP        $remote_addr;</span><br><span class="line">        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header   X-Forwarded-Proto  $scheme;</span><br><span class="line">    &#125;</span><br><span class="line">    location @fallback &#123;</span><br><span class="line">        rewrite ^.*$ /index.html break;</span><br><span class="line">    &#125;</span><br><span class="line">    location /girlS/ &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8000/girl.v1/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /popcircle/ &#123;</span><br><span class="line">        root /root/Work/game/;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>完美！</p><p>服务器也能运行、游戏也能运行、网页也成功运行了。</p><p>这三天的努力，愁的我都长了个痘痘，至少解决问题都是自己解决的，又get 到一个技能。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-10-31lesson</title>
      <link href="/2018/10/31/2018-10-31lesson/"/>
      <url>/2018/10/31/2018-10-31lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="记录最近干了啥玩意"><a href="#记录最近干了啥玩意" class="headerlink" title="记录最近干了啥玩意"></a>记录最近干了啥玩意</h3><p>进的公司人事、开发都给我特别的说明：比较有时间做自己的事，不会特别特别的忙。好吧，都这么说，真的真的希望不会特别忙，正和我意了。公司不忙，不代表我会慢下自己的脚步。</p><p>进公司，前两天，哟，也是用黑苹果开发-&gt;我喜欢。和要离职的开发交接了相关文件，然后他继续用公司电脑，然后我？？？我没电脑，哎我去。。。中午赶忙请假回住所拿自己电脑了。进去后第一件事就是改一个推送消息+应用内消息，读了读里面的代码，写的不是很好，不好不好。。。<br>接下来一直都很闲，就把React 一套生态链学完了：React+Mobx+antd+scss。</p><p>React 语法不难，难在于React、整个生态体系。</p><p>我抄写了<a href="https://github.com/Juliiii/React-Cnode" target="_blank" rel="noopener">React-Cnode</a> 三遍，终于有所感悟。这个难点在于：1. 版本需要对应，否则里面属性有更改；2. mobx 有decorator 模式；3. scss、svg-sprite-loader 在webpack.config.dev 里面有需要配置的地方；4. antd 需要加装babel-plugin-import 的一个插件。</p><p>学完了React 的web 软件开发，我获得的技能点有：</p><blockquote><p>OpenGL ES<br>iOS<br>白鹭<br>React<br>爬虫<br>Nodejs Server</p></blockquote><p>技能点满了没有？点满了没有？？？</p><p>学完了React 等于是走完软件前端全部基础技能。内心也没有多大的触动。没有想象中的激动，没有想象中的学完后会刺激、放松之类的，反正很平静。我觉得还缺少一味良药：将技术化为金钱。</p><p>粗人！动不动就钱钱钱。。。</p><p>氮素，因为真的没有自由支配的资金，所以才张嘴闭嘴谈到钱。哪天我比那些说我庸俗的人更有钱的时候，角色就会对换，体验就不一样了。</p><p>接下来的一星期，还是等待下个版本的设计，于是我动手爬了一个二次元网站的数据、图片。看着数据、图片一个一个收入囊中，体验是非常佳的。使用MongoDB 保存也是极度简单。接着写了一个Typescript koa 的server，之后就可以撸一个web 页面展示展示啦。</p><p>其中遇到一个大问题：公司过手用着的黑苹果在设置当中被我改了个名字，随后管理员丢失了。管理员就这样丢失了？？What？？悲催的事就是这么来的：不能装软件、不能拿到sudo 权限，反正就只能简单用一用，别的啥都干不了。</p><p>这么悲催，硬着头皮买了个U盘，重录入mac osx。</p><blockquote><p>CPU: i7<br>主板: 技嘉(啥型号，不知道)<br>显卡: 英伟达GTX750Ti</p></blockquote><p>要求：mac 开发只要能运行显卡驱动就好了，要求简单。</p><p>首先找了很多教程，这个教程看的很直白：<a href="https://github.com/enify/blog/issues/2" target="_blank" rel="noopener">https://github.com/enify/blog/issues/2</a> 非常感谢这位大哥</p><p>U盘制作挺快的，在windows 上将&gt; 8G的U盘按照上面网址大哥给的工具“DiskGenius” 格式化、转换分区表类型为GUID格式（当时我那显示是另一个条目名称，但是位置还是在那个位置）；</p><p>去黑苹果论坛找到一个叫做<strong>macOS … With Clover</strong> 的系统镜像在淘宝“黑苹果论坛代下”，价格5毛，然后百度云盘下载太慢，淘宝买了6.9元一个月百度云盘。</p><p>使用另一个软件：“TransMac” 找到U盘 选择“Format Disk for Mac”，然后选择“Restore with Disk Image” 选项，选择<strong>macOS … With Clover</strong> 系统镜像。然后就是等待将U盘设置为该系统的启动盘。</p><p>设置EFI 文件夹里面的config为对应自己配置的config。我这里是i7 就选择其中的6代、7代那个config</p><p>在BIOS 中设置U盘启动项，进入后第一个苹果标志Enter 进入，会进到写MAC 界面。选择<strong>磁工具盘</strong>，<strong>抹掉数据</strong>抹掉左上角OS X 的硬盘，然后退出回到之前界面，选择<strong>安装 macOS</strong> 中间会重启，然后记得选择第二个苹果标志（现在是安装到硬盘，第一个是U盘）。直到进入五国之类的。</p><p>进入之后要做的两件事：<strong>固化Clover</strong>、<strong>英伟达显卡驱动</strong></p><p>显卡驱动参考<a href="https://www.jianshu.com/p/becfe67a90bf" target="_blank" rel="noopener">简书</a><br><a href="https://www.insanelymac.com/forum/topic/324195-nvidia-web-driver-updates-for-macos-high-sierra-update-08302018/" target="_blank" rel="noopener">NVIDIA Web Driver</a>下载下来的找不到GTX750Ti.</p><p>然后找到<a href="https://blog.csdn.net/longyc2010/article/details/51531288" target="_blank" rel="noopener">文章</a><br>在clover 里面找到有加<string>slide=0 dart=0 darkwake=1 nvda_drv=1 kext-dev-mode=1</string>clover  这么几个的打钩，然后重启就有了。<br>第一次安装，顺利。</p><p>就这样点亮了黑苹果技能树！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-10-17lesson</title>
      <link href="/2018/10/29/2018-10-17lesson/"/>
      <url>/2018/10/29/2018-10-17lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="2018-10-17"><a href="#2018-10-17" class="headerlink" title="2018-10-17"></a>2018-10-17</h1><p>之前找工作，赶在了10月15号前入职（10月9号到岗），这样社保没有断，也算解决了尴尬的处境。</p><p>国庆节放假，前三天认真学习，打打游戏。后面几天，突然老婆发神经，对，发神经，搞的不愉快，在倒数2天傍晚离开老婆自己一个人去跑步散心。于是那天晚上老婆又爬身上求我原谅。我看重原则，家人什么都是对的，但是原则不能错。后来怎么样，那只能原谅呗，嘎嘎。</p><p>10月放假完第一天，有2个面试和傍晚的前往之前的复试（商谈工资）；</p><p>早上去离不远一家搞智能硬件互联的公司，直接就给offer，但是离自己心里预期低；</p><p>下午一家在七宝名叫<a href="小二郎">xx</a> 的一个婴幼儿教育的公司。约我去面试的女的面容姣好（去的时候刚好上楼遇见），保养很好，很美（无他不好的见解）。然后一个老头面试（说话结巴），先让我自我简介。我就巴拉巴拉说了自己的简况。然后他就问一个问题“数据结构”。是的，这个是我们系主任教的课，我听的特他妈认真。但是离校那么久，早还给老师了，而且当时也没学好，毕竟光听，没有真正实践的地方，没办法没办法。然后他就抓着这个点，说来面试的太差。哎哟，握草，现在面试iOS不仅要算法，还要数据结构很好？而且工资给的还非常低（8~15k，相对要做的领域，是非常低的，而且公司给的肯定就只有12k）？然后我就开始怼他，反正我又不是找不到工作的人。这种老头子能力肯定也是不咋地，要求却蛮多，脑子又不灵光，话都说不流利。肯定是忽悠公司花高价请自己来，说自己算法多好多好，实际一点产出都没有的人。现在互联网跟他的年龄早已不相仿。我敢断言：这个公司又会像以前我经历过的一些公司一样，不同的是，现在这个公司资金比我以前的要雄厚（毕竟我以前公司都比较穷，这个似乎会大一些），但是这种老古董定然给他败光！</p><p>现在我又要屁颠屁颠灰溜溜滚蛋咯。</p><p>回去到家再写了写东西，傍晚去复试。公司之前做线下运动的，线下有一定的资源，转线上。工资没有多高，社保又快到了，看老板眼神，跟着干吧，希望能带我脱离苦海吧。</p><p>于是，又一次找工作历程经历完了。<br>有苦有乐，苦更多吧。更加让我续满动力实践自己的server！！！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-9-27lesson</title>
      <link href="/2018/09/27/2018-9-27lesson/"/>
      <url>/2018/09/27/2018-9-27lesson/</url>
      
        <content type="html"><![CDATA[<h1 id="最近是面试期么"><a href="#最近是面试期么" class="headerlink" title="最近是面试期么"></a>最近是面试期么</h1><h2 id="内心一定要淡定"><a href="#内心一定要淡定" class="headerlink" title="内心一定要淡定"></a>内心一定要淡定</h2><h3 id="记录下最近面试问到的一些问题"><a href="#记录下最近面试问到的一些问题" class="headerlink" title="记录下最近面试问到的一些问题"></a>记录下最近面试问到的一些问题</h3><p>之前从粉粉离开时，也没想到这是一个多事之秋。去了一家动漫IP 的公司，人没去之前老板已经有意决定停下互联网业务的，结果其中一个合伙人说再试一波，于是我以为其是想做事，就进去当小白鼠了。进去之后改版页面完，没目的没计划了。做了一个egret ”消消乐“的微信小游戏，学了该学的OpenGLES，然后中秋之前跟我说部门解散，，，</p><p>大哥，这才三个月啊。</p><p>所以说是一个多事之秋吧。</p><p>好吧，出来面试吧。</p><p>现在是9月份，面试第一个公司：”第一弹“，我个人觉得面试过程还好，然后说不合适。好吧，不合适就不合适吧，可惜了，距离我挺近的，比较看重距离。</p><p>面试题里面有个题目：[1, … 100] 内 不等随机大小无序数，求最大的数和第二大的数。</p><p>这个我做的时候直接是冒泡排序。但是有两层for 循环，效率不好，下面会给出最佳答案。</p><p>第二家说想做一个短视频、即时通讯、webRTC 这一类产品。我不看好，不能跟，而且离得有点远，开发员工才几个人，工资也很低。大哥，做这类的工资不可能才15k 啊，，，做成个半成品，全是SDK 的，我不愿意把青春花在简单组合各类SDK上面，做完到时发现不赚钱，老板说解散，到时我又屁颠屁颠要出来找工作，何必。后来，之前面试的小哥打电话过来问意愿，那边那个老板也打电话过来问意愿，只能拒绝。没有投靠的意义，看的出来老板只是想试试水。</p><p>第三家在之前我就有去面试的地方：徐汇慧谷创业中心。这家是做 AI提供用户数据给出用户穿衣服方案的公司。在找iOS 开发。先来个小胖哥，上来就说我看了你的博客了，还挺好，直接让技术经理来考你。这小胖哥有意思，人好。然后技术大哥来了就问技术的事，不与iOS 相关的，先问TCP协议（我没看面试题之类的（最近在搞网页）答得不好），然后出了两个题目：</p><ol><li>数组array[1~n] 随机大小无序，求从大到小第k个数。解法：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> nums[n] = [<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span> (int i=<span class="number">0</span>;i&lt;array.count;i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> element = array[i];</span><br><span class="line">    <span class="keyword">if</span> (nums[element]) &#123;<span class="comment">//如果有值</span></span><br><span class="line">        nums[element] = nums[element] ++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        nums[element] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这个时候从n 到 1 如果内部是&gt;1 的都是有值的，&gt;2那就是有两个值. 于是第k 个值也能得出。</span></span><br></pre></td></tr></table></figure><p>这正是“第一弹”笔试的比较好的答案吧。</p><ol start="2"><li>有一个圆盘时钟，从00:00:00 ~ 24:00:00 过程有多少次秒针、分针、时针是全部重叠的。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="number">360</span>°/<span class="number">60</span> * n; <span class="comment">//秒针一圈第n秒时在什么角度</span></span><br><span class="line"><span class="keyword">let</span> m = <span class="number">360</span>°/(<span class="number">60</span>*<span class="number">60</span>) * n; <span class="comment">//分针一圈第n秒时在什么角度</span></span><br><span class="line"><span class="keyword">let</span> h = <span class="number">360</span>°/(<span class="number">12</span>*<span class="number">60</span>*<span class="number">60</span>) * n; <span class="comment">//时针一圈第n秒时在什么角度</span></span><br><span class="line"><span class="keyword">for</span> (int n=<span class="number">0</span>; n&lt;<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>; n++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (s / <span class="number">360</span>° == m / <span class="number">360</span>° == h / <span class="number">360</span>°) &#123;<span class="comment">//除以360° 是让其点化为单位角度</span></span><br><span class="line">        <span class="comment">// 这就是相遇的点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这两个挺考智商的。但是我的脑子不好，我的学习都是不断的抄写他人知识，融合这些知识，所以直接回答纯粹的算法题我答的不好。比如第1题我还是使用冒泡排序，嘿嘿。当时甚至于冒泡排序还写错了。比较紧张吧：因为先回答了圆盘时钟的问题，却一直没解出来，导致思绪乱了，后面答第一个问题也更乱了。</p><p>下面是借口，借口：</p><p>一直学习，没顾上看面试题，没顾上看看算法题。面试完确实对我心里有点打击：我就是做个iOS，现在还需要算法了？iOS没有算法啊，苹果都给你优化过了，你写再好，比得过人家一个api？但是话说来，算法才是程序的灵魂，没有灵魂，写再多api 也不是程序。</p><p>我的观点是，面试的时候遇到了什么不清晰的地方，就好好记录下来。平常学必要的，不要全都学，现在那么多知识点，哪里学的完。这没什么好狡辩，尽力无悔即可。</p><p>唉，换工作比较麻烦，我早自知。但是我相信，现在困惑、困难，“树挪死，人挪活”，艰难刻苦总会过去的吧（目前还在艰难困苦中）。学到、实践到就是没白费过。</p><h4 id="今天2018-9-26-两个面试。"><a href="#今天2018-9-26-两个面试。" class="headerlink" title="今天2018.9.26 两个面试。"></a>今天2018.9.26 两个面试。</h4><p>上午的面试面着面着，快一小时了，才知道他们要招员工到张江去上班的，唉，我看你是10k~15k过来试着面试面试，没想到你比我还皮，这个比较浪费时间，，算了心平气和滚蛋了，嘎嘎。</p><p>下午离得稍微有点远，叫”Ratta” 雷塔的一个公司。我觉得功能方向稍微有点不太合适，也是试试去面试吧。</p><p>先笔试：考跟之前算法一样的东西（现在全部公司的笔试题都一样了？）。答题吧。</p><p>里面还有一个是跟我的APP“哈皮涂色”很类似的同步数据、展示数据的题目。<br>面试的是写c、c++ 的大哥。这人对基本数据比较了解。说一个数据{x:x,y:y,color:color} 这样一个int 数据元素要占用多少位？我肯定不知道啊，我就说bytes 是4字节，多少位我不知道。他说32位（int 是32位，NSInteger 是64，问这个干嘛哟，这个是读取速度，不是储存大小，我感觉这个大哥不是很靠谱，个人感觉）。然后他想问的如何压缩可以将数据不会存储那么大。我一时间哪能那么快想出来啊，能想出来答出来，那我肯定之前做过了，碰到过了，不然我答什么呀。</p><p>之后就是问随意的问题。</p><p>其中给他看了我的“哈皮涂色”，估计他有点懵逼了：这是他们公司的主营功能。他们有个硬件进行绘画，我直接就是手机上直接画。他们有点想知道核心功能，我才不告诉他们嘞，要知道？得花钱。</p><p>然后问了一些技术上的问题，他也做了些功课：</p><ol><li>堆和栈的区别(还别说，没看面试题，我也都快忘光了，随便解答) 。</li></ol><blockquote><p>一个由c/C++编译的程序占用的内存分为以下几个部分：</p><ul><li>栈区（stack）— 由编译器自动分配释放，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈。</li><li>堆区（heap） — 一般由程序员分配释放， 若程序员不释放，程序结束时可能由OS回收。注意它与数据结构中的堆是两回事，分配方式倒是类似于链表。</li><li>全局区（静态区）（static）—，全局变量和静态变量的存储是放在一块的，初始化的全局变量和静态变量在一块区域，未初始化的全局变量和未初始化的静态变量在相邻的另一块区域。程序结束后由系统释放。</li><li>文字常量区 —常量字符串就是放在这里的。程序结束后由系统释放。</li><li>程序代码区—存放函数体的二进制代码。</li></ul></blockquote><ol start="2"><li>反射机制（从没用过~查询得知，其实就是使用字符动态查找创建类、方法，方便网络和客户端交互。反正我没这么用，多不安全啊。）</li><li>https（我说上家公司没处理过，不过之前公司处理过，iOS 这里只需在网络那里配置下就好了，如果要双向验证，那就在iOS本地增加配置一个公钥，额，他还不信，害我跑回来看教程，没错啊，客户端要处理的真的很少。服务端也不多，nodejs 之前的我看过相关的教程，就增加配置个证书文件嘛）</li></ol><p><a href="https://www.jianshu.com/p/6b561705de06" target="_blank" rel="noopener">参考网址</a></p><p>单向验证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//在你封装的网络工具类请求前初始化时增加以下代码</span><br><span class="line">AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];</span><br><span class="line">//设置证书模式，AFSSLPinningModeNone，代表前端包内不验证</span><br><span class="line">//在单向认证时，前端不放证书，服务器去验证</span><br><span class="line">AFSecurityPolicy *securityPolicy = [AFSecurityPolicy policyWithPinningMode:AFSSLPinningModeNone];</span><br><span class="line">// 如果是需要服务端验证证书，需要设置为YES</span><br><span class="line">securityPolicy.allowInvalidCertificates = YES;</span><br><span class="line">//validatesDomainName 是否需要验证域名，默认为YES；</span><br><span class="line">securityPolicy.validatesDomainName = NO;</span><br><span class="line">//设置验证模式</span><br><span class="line">manager.securityPolicy = securityPolicy;</span><br></pre></td></tr></table></figure><p>双向验证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//在你封装的网络工具类请求前初始化时增加以下代</span><br><span class="line">AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];</span><br><span class="line">//设置验证证书，该模式下许愿把证书打包进项目里，进行验证</span><br><span class="line">AFSecurityPolicy *securityPolicy = [AFSecurityPolicy policyWithPinningMode:AFSSLPinningModeCertificate];</span><br><span class="line">//证书的路径</span><br><span class="line">NSString *cerPath = [[NSBundle mainBundle] pathForResource:@&quot;xxx&quot; ofType:@&quot;.cer&quot;];</span><br><span class="line">NSData *dataSou = [NSData dataWithContentsOfFile:cerPath];</span><br><span class="line">NSSet *set = [NSSet setWithObjects:dataSou, nil];</span><br><span class="line">securityPolicy.allowInvalidCertificates = YES;</span><br><span class="line">securityPolicy.validatesDomainName = YES;</span><br><span class="line">[securityPolicy setPinnedCertificates:set];</span><br><span class="line">//将验证方式赋值给管理者</span><br><span class="line">manager.securityPolicy = securityPolicy;</span><br></pre></td></tr></table></figure><p>HTTPS 处理过程是在“[应用层] - <strong>[SSL/TLS]</strong> - [TCP] - [IP]”之间。HTTP 的TCP 握手是三次，但是HTTPS 握手需要更多次，因为这里使用非对称加密、对称加密等加密手段对数据进行保护。</p><p>首先先理解加解密数据性能，非对称加密RSA 性能需要CPU 计算，寻找素数，耗时相对大，优点就是公钥可以公布，但是如果仅做一次，互相之间传递secretKey 就是非常好的；对称加密AES 速度快，但是需要互相之间都保存有secretKey。</p><p>HTTPS 使用到的加密算法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">非对称加密算法：RSA，DSA/DSS </span><br><span class="line">对称加密算法：AES，RC4，3DES </span><br><span class="line">HASH算法：MD5，SHA1，SHA256</span><br></pre></td></tr></table></figure><p>最简单的理解或者说模拟出一个HTTPS 一次传输过程要处理的事（只讲算法之间要干的事，更多请阅读下面参考链接讲解的过程）：</p><ul><li><p>客户端一开始和服务端使用公钥加密这次要使用的secretKey。因为大家都没有私钥，所以也不怕被截取。</p></li><li><p>服务器保存此次对应的人和对应的secretKey，同时可以使用AES 对从客户端收到了secretKey 的回应，加密的密钥就是secretKey。</p></li></ul><p>服务端使用RSA 使用secretKey 私钥加密数据给客户端。</p><p>客户端使用该secretKey 来给数据进行AES 加密。</p><p>这样就完成加解密的过程了。</p><p>上面的过程比较简单化，HTTPS 还做了很多，不过我只理解简单的，然后把他写下来。</p><p>可以参考<a href="http://www.cnblogs.com/Yfling/p/6670495.html" target="_blank" rel="noopener">HTTPS加密原理</a></p><h3 id="继续看面试题"><a href="#继续看面试题" class="headerlink" title="继续看面试题"></a>继续看面试题</h3><p>1:SEL Method</p><p>SEL 方法编号：<br>SEL methodId = @selector(func1);<br>执行SEL:<br>[self performSelector:methodId withObject:nil];<br>IMP 获得和使用:<br>IMP methodPoint = [self methodForSelctor:methodId];<br>调用：methodPoint();<br>IMP objectMethodPoint = [object methodFor:@selector(message)]<br>调用：theResult = objectMethodPoint(anObject, aSelector);</p><p>2:<br>反射机制<br>系统Foundation 下有这几个反射API</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FOUNDATION_EXPORT NSString *NSSTringFromSelector(SEL aSelector);</span><br><span class="line">FOUNDATION_EXPORT SEL NSSelectorFromString(NSString *aSelectorName);</span><br><span class="line">FOUNDATION_EXPORT NSString *NSStringFromClass(Class aClass);</span><br><span class="line">FOUNDATION_EXPORT Class __nullable NSClassFromString(NSString *aClassName);</span><br><span class="line">FOUNDATION_EXPORT NSString *NSStringFromProtocol(Protocol *proto) NS_AVAILABLE(10_5, 2_0);</span><br><span class="line">FOUNDATION_EXPORT Protocol * __nullable NSProtocolFromString(NSString *namestr) NSAVAIABLE(10_5, 2_0);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)isKindOfClass:(Class)aClass;</span><br><span class="line">- (BOOL)isMemberOfClass:(Class)aClass;</span><br><span class="line">- (BOOL)conformsToProtocol:(Protocol *)aProtocol;</span><br><span class="line">- (BOOL)respondsToSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure><p>3:NSDictionary</p><p>iOS 的NSDictionary 是使用hash表来实现key value 的键值映射和存储的。于Typescript 一样，键都是转为string 类型查找。<br>根据这篇文章<a href="https://www.jianshu.com/p/915356e280fc" target="_blank" rel="noopener">参考</a> 能更深入了解NSDictionary 实现思路。</p><p>首先NSArray 是没有hash 表来映射快速查找方法。时间复杂度就是o(n),数据长度。NSDictionary 在setObject 时提前判别对象hash 值是否已经存在。判别分两步：Step1：== 运算符判别对象指针是否相等；Step2:判别是否是同一类型；Step3:判别内在属性是否相等</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)isEqual:(id)object &#123;</span><br><span class="line">    if (self == object) &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    if (![object isKinkOfClass:[Person class]]) &#123;</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line">    return [self isEqualToPerson:(Person *)object];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (BOOL)isEqualToPerson:(Person *)person &#123;</span><br><span class="line">    if (!person) &#123;</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BOOL haveEqualNames = (!self.name &amp;&amp; !person.name) || (self.name isEqualToString:person.name);</span><br><span class="line">    BOOL haveEqualbirthday = (!self.birthday &amp;&amp; !person.birthday) || (self.birthday isEqualToDate:person.birthday);</span><br><span class="line"></span><br><span class="line">    return haveEqualNames &amp;&amp; haveEqualBirthdays;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上部分可以采用RunTime 寻找属性判别。</p><p>Hash Table 查找成员过程：Step1：通过hash值直接找到目标位置；Step2：如果目标位置上有多个相同hash值成员，再按照数组方式查找。</p><p>Hash 调用时间：对象被添加至NSSet、设置NSDictionary 的key 时调用。</p><p>正确重置Person 的hash 方式实现：</p><p>大神Mattt Thompson在Equality中给出的结论就是</p><blockquote><p>In reality, a simple XOR over the hash values of critical properties is sufficient 99% of the time(对关键属性的hash值进行位或运算作为hash值)</p></blockquote><p>正确返回重置hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (NSUInter)hash &#123;</span><br><span class="line">    return [self.name hash] ^ [self.birthday hash];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4:Block</p><p>Block本质就是对象，因为本身就有指针。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, const char * argv) &#123;</span><br><span class="line">    void (^block)() = ^&#123;</span><br><span class="line">        printf(&apos;hello world&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    block();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用clang 指令<br><code>clang -rewrite-objc main.m</code> 得到一个cpp 文件。<br>定义完block，创建了一个函数，在创建结构体时，同时把函数指针也传进去了。之后就可以拿出来使用了。</p><p>5：线程间通讯<a href="https://www.jianshu.com/p/f9f3952a4a74" target="_blank" rel="noopener">参考网址</a></p><p>1) NSThread</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (void)thread &#123;</span><br><span class="line">    NSString *imageUrlString;</span><br><span class="line">    [self performSelectorInBackground:@selector(loadImage:) withObject:imageUrlString];</span><br><span class="line">&#125;</span><br><span class="line">- (void)loadImage:(NSString *)imageUrlString &#123;</span><br><span class="line">    NSData *imageData = [NSData dataWithContentURL:[NSUrl urlWithString:imageUrlString]];</span><br><span class="line">    [self performSelectorOnMainThread:@selector(updateUI:) withObject:imageData];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2) GCD</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (void)gcd &#123;</span><br><span class="line">    NSString *imageUrlString;</span><br><span class="line">    __Weak typeof(self) weakSelf = self;</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</span><br><span class="line">        NSData *imageData = [NSData dataWithContentURL:[NSUrl urlWithString:imageUrlString]];</span><br><span class="line">        dispatch_async(dispatch_get_main_queue, ^&#123;</span><br><span class="line">            weakSelf.imageView.image = [UIImage imageWithData:imageData];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3) NSOperation</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void)operation &#123;</span><br><span class="line">    __weak typeof(self) weakSelf = self;</span><br><span class="line">    DownLoadOperation *downLoadOp = [DownLoadOperation new];</span><br><span class="line">    downLoadOp.imageUrlString = xxx;</span><br><span class="line">    downLoadOp.finishedBlock = ^(UIImage *image) &#123;</span><br><span class="line">        [[NSOperationQueue mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line">            weakSelf.imageView.image = image;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;;</span><br><span class="line">    NSOperationQueue *concurrentQueue = [NSOperationQueue new];</span><br><span class="line">    [concurrentQueue addOperation:downLoadOp];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@interface DownloadOperation : NSOperation</span><br><span class="line">@property (nonatomic, copy) NSString *imageUrlString;</span><br><span class="line">@property (nonatomic, copy) FinishedBlock finishedBlock;</span><br><span class="line">@end</span><br><span class="line">@implementation DownloadOperation</span><br><span class="line">- (void)main &#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        NSData *imageData = [NSData dataWithContentURL:[NSUrl urlWithString:self.imageUrlString]];</span><br><span class="line">        if (self.finishedBlock)</span><br><span class="line">            self.finishedBlock([UIImage imageWithData:imageData]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>4) 加密算法</p><p><a href="https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434501504929883d11d84a1541c6907eefd792c0da51000" target="_blank" rel="noopener">廖雪峰-node-crypto</a></p><p>MD5和SHA1</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">const</span> hash = crypto.createHash(<span class="string">'md5'</span>);<span class="comment">//crypto.createHash('sha1');/sha256/sha512</span></span><br><span class="line">hash.update(<span class="string">'Hello, world'</span>);</span><br><span class="line">hash.update(<span class="string">'hello, nodejs'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(hash.digest(<span class="string">'hex'</span>));</span><br></pre></td></tr></table></figure><p>Hmac 可以把Hmac理解为用随机数“增强”的哈希算法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">const</span> hmac = crypto.createHmac(<span class="string">'sha256'</span>, <span class="string">'your secret-key'</span>);</span><br><span class="line">hmac.update(<span class="string">'Hello, world'</span>);</span><br><span class="line">hmac.update(<span class="string">'Hello, nodejs'</span>);</span><br><span class="line">hmac.digest(<span class="string">'hex'</span>);</span><br></pre></td></tr></table></figure><p>AES 对称加密算法，加解密都用同一个密钥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aesEncrypt</span>(<span class="params">data, key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> cipher = crypto.createCipher(<span class="string">'aes192'</span>, key);</span><br><span class="line">    <span class="keyword">let</span> crypted = cipher.update(data, <span class="string">'utf8'</span>, <span class="string">'hex'</span>);</span><br><span class="line">    crypted += cipher.final(<span class="string">'hex'</span>);</span><br><span class="line">    <span class="keyword">return</span> crypted;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aesDecrypt</span>(<span class="params">encrypted, key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> decipher = crypto.createDecipher(<span class="string">'aes192'</span>, key);</span><br><span class="line">    <span class="keyword">let</span> decrypted = decipher.update(encrypted, <span class="string">'hex'</span>, <span class="string">'utf8'</span>);</span><br><span class="line">    decrypted += decipher.final(<span class="string">'utf8'</span>);</span><br><span class="line">    <span class="keyword">return</span> decrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = <span class="string">'Hello, this is a secret message!'</span>;</span><br><span class="line"><span class="keyword">let</span> key = <span class="string">'Password'</span>;</span><br><span class="line"><span class="keyword">let</span> encrypted = aesEncrypted(data, key);</span><br><span class="line"><span class="keyword">let</span> decrypted = aesDecrypted(encrypted, key);</span><br></pre></td></tr></table></figure><p>RSA 加解密，非对称加密</p><p>首先得到对应的公钥和私钥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),</span><br><span class="line">    crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadKey</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fs.readFileSync(file, <span class="string">'utf8'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> prvKey = loadKey(<span class="string">'./rsa-prv.pem'</span>),</span><br><span class="line">    pubKey = loadKey(<span class="string">'./rsa-pub.pem'</span>),</span><br><span class="line">    message = <span class="string">'Hello, world'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> enc_by_prv = crypto.privateEncrypt(prvKey, Buffer.from(message, <span class="string">'utf8'</span>));</span><br><span class="line"><span class="comment">//enc_by_prv.toString('hex');</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dec_by_pub = crypto.publicDecrypt(pubKey, enc_by_prv);</span><br><span class="line"><span class="comment">//dec_by_pub.toString('utf8');</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//然后还可以反过来对称加密</span></span><br></pre></td></tr></table></figure><p>5) category 里添加属性</p><p>category 它是在<strong>运行期编译</strong>的时候加上的，编译完成后对象内存已经确定，不能添加“_”的成员变量。</p><p>runtime 能添加对象的原因是因为：关联对象由AssociationsManager 管理，AssociationManager 里面是一个静态AssociationsHashMap 来存储所有的关联对象的。所以直接保存新的关联对象kv键值对即能添加成功。</p><p>6) autoreleasepool</p><p>autoreleasepool本质上就是一个指针堆栈</p><p>@autoreleasepool{} 其实是实现了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void *poolToken = objc_autoreleasePoolPush();</span><br><span class="line">objc_autoreleasePoolPop(poolToken);</span><br></pre></td></tr></table></figure><p>7) KVC KVO深入研究</p><p><a href="https://www.jianshu.com/p/37a92141077e" target="_blank" rel="noopener">参考博客</a></p><p>KVC 运用isa-swizzling 类型混合指针机制。</p><p>[site setValue:@”sitename” forKey:@”name”]; -&gt;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SEL sel = sel_get_uid(&quot;setValue:forKey:&quot;);</span><br><span class="line">IMP method = objc_msg_lookup(site-&gt;isa, sel);</span><br><span class="line">method(site, sel, @&quot;sitename&quot;, @&quot;name&quot;);</span><br></pre></td></tr></table></figure><p>KVC实现分三步.Step1:根据方法名找到运行方法所需要的环境参数；Step2:从自己isa指针结合参数找到具体方法实现接口；Step3:直接查找得来具体方法实现。</p><p>KVO在这篇文章能很好的解释<a href="https://www.jianshu.com/p/d657ad764aaa" target="_blank" rel="noopener">博客</a></p><p>KVO后续。。。</p><h3 id="系统默认注册5个Mode"><a href="#系统默认注册5个Mode" class="headerlink" title="系统默认注册5个Mode:"></a>系统默认注册5个Mode:</h3><ol><li>kCFRunLoopDefaultMode:App 默认Mode，主线程。</li><li>UITrackingRunLoopMode:界面跟踪Mode，ScrollView 追踪触摸滑动，保证界面滑动时不受其他Mode 影响。</li><li>UIInitializationRunLoopMode:在刚启动App时进入的第一个Mode, 启动完成后就不在使用。</li><li>GSEventReceiveRunLoopMode:接受系统时间内部Mode,通常用不到。</li><li>kCFRunLoopCommonModes</li></ol><p>–</p><p>NSTimer 对象以NSDefaultRunLoopMode(kCFRunLoopDefaultMode) 添加到主运行循环后，滑动scrollView NSTimer 却不动了？</p><blockquote><p>NSTimer 是在defaultRunLoop 调用消息的，当我们滑动scrollview 的时候, NSDefaultRunLoopMode 模式自动切换成UITrackingRunLoopMode 下。所以NSTimer 需要在NSRunLoopCommonMode</p></blockquote><h3 id="RunTime-添加类、方法、实例变量"><a href="#RunTime-添加类、方法、实例变量" class="headerlink" title="RunTime 添加类、方法、实例变量"></a>RunTime 添加类、方法、实例变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Class myClass = objc_allocateClassPair([NSObject class], &quot;Person&quot;, 0);</span><br><span class="line"></span><br><span class="line">class_addMethod 其中types参数为&quot;i@:@“，按顺序分别表示：具体类型可参照[官方文档](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html)i </span><br><span class="line">返回值类型int，若是v则表示void@ 参数id(self): SEL(_cmd)@ id(str)</span><br><span class="line">  V@:表示返回值是void 带有SEL参数 （An object (whether statically typed or typed id)</span><br><span class="line"></span><br><span class="line">class_addMethod(myClass, @selector(addMethodForMyClass:), (IMP)addMethodForMyClass, &quot;V@:&quot;);</span><br><span class="line"></span><br><span class="line">BOOL isSuccess = class_addIvar(myClass, &quot;name&quot;, sizeof(NSString *), 0, &quot;@&quot;);</span><br></pre></td></tr></table></figure><h3 id="探讨atomic-一定是线程安全么"><a href="#探讨atomic-一定是线程安全么" class="headerlink" title="探讨atomic 一定是线程安全么"></a>探讨atomic 一定是线程安全么</h3><p>atomic 是在getter 和setter 存取方法的线程保证原子性，并不能保证整个对象的存取动作是线程安全的。</p><p>在不同线程中写、读同一个对象，虽然写、读过程是原子性，但是由于等待之后，得到被修改的对象，还是：最终结果属于不可预测。</p><p>要保证存、读可预测，可使用下面几个api锁住存取动作，保证线程安全、可预测：</p><p>NSLock/NSLockLock/@synchronized(obj){}/pthread_mutex_t/OSSPinLock</p><p>其中性能比较:</p><p>OSSPinLock &gt; pthread_mutex_t &gt; NSLockLock &gt; NSLock &gt; @synchronized</p><h3 id="读YY作者提的几点优化TableView-效率"><a href="#读YY作者提的几点优化TableView-效率" class="headerlink" title="读YY作者提的几点优化TableView 效率"></a>读YY作者提的几点优化TableView 效率</h3><p>对于GPU 等待显示器在一次VSync 时间内，CPU 或者GPU 没有完成内容提交，则那一帧就会被丢弃，等待下一次VSync 再显示，而这时显示器就保留了之前的内容不变，这就是界面卡顿的原因。</p><p>CPU 应该优化处理的几个点：</p><ol><li>对象创建</li><li>对象调整：frame、bounds 会对CALayer 绘制、创建动画等有比较大开销</li><li>对象销毁，可以用一个小Tip：把对象捕获到block 中，然后扔到后台队列去销毁：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSArray *tmp = self.array;</span><br><span class="line">self.array = nil;</span><br><span class="line">dispatch_async(queue, ^&#123;</span><br><span class="line">    [tmp class];</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>布局计算</li><li>Autolayout（复杂试图尽量使用其他如ComponentKit、AsyncDisplayKit 代替）</li><li>文本计算（尽量缓存）</li><li>文本渲染</li><li>图片解码</li><li>图像绘制（CoreGraphic 是线程安全的，可以放到后台进行绘制）</li></ol><h3 id="最近在搞React-Mobx-这一套"><a href="#最近在搞React-Mobx-这一套" class="headerlink" title="最近在搞React + Mobx 这一套"></a>最近在搞React + Mobx 这一套</h3><p>我已经确定使用这套组合了。因为直接使用vue 感觉没有成就感。React 函数式 + 初学Mobx 的便利(redux 实在是太繁琐了，很多例子很被他绕晕了，真的真的放弃，虽然已经有点入门redux 了；)</p><p>html首先碰到</p><p>第一个问题:<code>Warning: A component is changing an uncontrolled input of type checkbox</code></p><p>原因是我的(input:checkbox) 在checkd时出现传递了undefined 进去，需要判别一下:<code>(this.props.todo.finished === null ||this.props.todo.finished === undefined) ? false : this.props.todo.finished</code></p><p>第二个问题:<code>Warning: Each child in an array or iterator should have a unique &quot;key&quot;</code></p><p>原因是在组件内部如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;for(...)&#123;&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>有for循环，那么需要给里面的子控件加上key={aString} 的参数:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &#123;this.props.todolist.todos.map(todo =&gt; (</span><br><span class="line">        &lt;TodoView todo=&#123;todo&#125; key=&#123;todo.id.toString()&#125;&gt;&lt;/TodoView&gt;</span><br><span class="line">    ))&#125;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-9-16lesson.md</title>
      <link href="/2018/09/16/2018-9-16lesson-md/"/>
      <url>/2018/09/16/2018-9-16lesson-md/</url>
      
        <content type="html"><![CDATA[<h2 id="2018-8-27"><a href="#2018-8-27" class="headerlink" title="2018/8/27"></a>2018/8/27</h2><p>typedef CF_ENUM(uint32_t, CGImageAlphaInfo) {</p><pre><code>kCGImageAlphaNone,               /* For example, RGB. */kCGImageAlphaPremultipliedLast,  /* For example, premultiplied RGBA */kCGImageAlphaPremultipliedFirst, /* For example, premultiplied ARGB */kCGImageAlphaLast,               /* For example, non-premultiplied RGBA */kCGImageAlphaFirst,              /* For example, non-premultiplied ARGB */kCGImageAlphaNoneSkipLast,       /* For example, RBGX. */kCGImageAlphaNoneSkipFirst,      /* For example, XRGB. */kCGImageAlphaOnly                /* No color data, alpha data only */</code></pre><p>};</p><h2 id="重写OpenGL-纹理篇出错原因"><a href="#重写OpenGL-纹理篇出错原因" class="headerlink" title="重写OpenGL 纹理篇出错原因"></a>重写OpenGL 纹理篇出错原因</h2><ol><li>glDrawxx 函数是必要的，把东西呈现上去的</li><li>纹理贴上去，很糊（<code>glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);</code>可以解决纹理模糊问题），有颗粒点，不晓得为啥。</li><li>纹理的图片索引定点，没有完全弄懂。</li></ol><p>###<br>离开“粉粉”二个月了，来谈谈周身变化。</p><ol><li>找了个离得比较近的公司，上下班骑车更快到啦。</li><li>早上9点出发上班。路上买包子，一路吃过去，吃饭正常后，精神状态等都好多了，记忆力现在强多了。</li><li>晚上相对回住所吃饭就早多了。太舒服了好吧。终于不用吃完饭，一看，哦，10点半了。写东西的么得了，现在吃完饭，楼下逛一圈还能有时间写、学东西。棒！</li><li>空闲时间增加，不会那么那么那么的忙累、紧迫。因为“粉粉”给一个功能都是临界时间，然后拼命写，发现中间有逻辑漏洞，或者涉及其他，于是其实相对的给的时间是一个完整开发时间的70%。根本不够，严重不够！<br>也由于空闲时间多了，我把OpenGL 终于入门了。小公司同时由于没有产品定位等，目前去做游戏去了，iOS 放一旁。不要太好，我就喜欢学新的东西。哈哈</li><li>周末都是双休了，学知识、去办事情、不亦乐乎啊。</li><li>以前是工作压力大，现在是赚钱压力大，想方法自己赚钱的压力。所以，出了“粉粉”，心里开心。已经没有太多要问的，在里面该学的也拼命学够了。<br>开森！</li></ol><h3 id="pod-install-失败"><a href="#pod-install-失败" class="headerlink" title="pod install 失败"></a>pod install 失败</h3><p>弹出#-bash: /usr/local/bin/pod: /usr/local/opt/ruby/bin/ruby: bad interpreter: No such file or directory#<br>查到<a href="https://www.jianshu.com/p/e4a70c40bfea" target="_blank" rel="noopener">https://www.jianshu.com/p/e4a70c40bfea</a><br>先尝试<br><code>$ brew link --overwrite cocoapods</code><br>我这里提示#Error: No such keg: /usr/local/Cellar/cocoapods#</p><p>于是直接执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall cocoapods</span><br><span class="line"></span><br><span class="line">brew install ruby</span><br><span class="line"></span><br><span class="line">brew link --overwrite cocoapods</span><br><span class="line">``` </span><br><span class="line">完美解决问题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 价值</span><br><span class="line">之前一直在想，什么能保值？</span><br><span class="line">什么才是有价值的？</span><br><span class="line">RMB？美元？黄金？车子、房子、实物、食物？</span><br><span class="line">RMB 会贬值，如果货币超发，政府和人民抢钱，最后就会和津巴布韦币一样；反正RMB 价值话语权不在自己手上，我不认同；</span><br><span class="line">中国那么多富二代、官二代，一个个拽得一批，我想，我要比王思聪有钱，我说话能“喷喷喷”他一脸、“滋滋滋”格力一姐一脸。有什么好嘚瑟的，最多不赚你钱，凶个奶子。</span><br><span class="line">不跟他们一般见识，百年人生而已，活好自己的，不用比较。他们会斥责下属，说明很看重身份、排名、地位、权力。自己有余粮，活得潇洒，心是红的，眼睛黑的，何必跟这些眼睛变红了，心就变黑了的人计较，继续。</span><br><span class="line">美元？同样，美国也想抢其他国家的钱。货币只是一种等值替换，跟RMB 好那么一丢丢，毕竟他相对信誉体系稳定；</span><br><span class="line">但是，货币不如实物，毕竟人这一生就只有短短百年，如果是“龙哥”这类就更要珍惜，活在社会只有短短10数年，其他都在监狱度过，然后就躺下了。</span><br><span class="line">所以，让自己这一生过的舒坦，那就实物：有车有房、有实物、有食物。我觉得我会那么知足点。</span><br><span class="line">但是，有没有更好的，实物等都是会消耗的，没有前景，所以也不是我想探讨的，我这里直接给出答案：</span><br><span class="line">女人、技术。</span><br><span class="line">就是这两个玩意s，复数。</span><br><span class="line">集合多几个女人，多个技术，持续不断赚钱，才是能保值的。</span><br><span class="line">人多，力量大，自己女人，还有什么不可信任（不过女人多几个后，信任度肯定会降低，毕竟是女人这种生物，爱的不均与，不患寡而患不均嘛）。</span><br><span class="line">技术去学习，各种学习，不必全都创新、研发，只需将他人技术学会，和自己的技能点融合，运用，产出。</span><br><span class="line"></span><br><span class="line">最近也一直感受到，其实技术赚钱，这事是可以做到的，但是要持续耕耘，不断推陈出新。反正只要你在领域付出、思考，就能有收获（不要钻牛角尖，大家不是傻子）。</span><br><span class="line">所以接下来大家懂了吧，什么才是将财富聚集、保存实力的方法了吧：多聚集信任之人（最好是女人，毕竟女人好玩嘛），然后深入技术，去运用，去产出。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### Cannot find module &apos;webpack&apos;</span><br><span class="line">在安装完webpack 之后，出现标题提示，使用`npm link webpack`</span><br><span class="line"></span><br><span class="line">## glTexParameteri方法说明</span><br><span class="line"></span><br><span class="line">设置纹理循环模式、设置纹理过滤模式</span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/d04421024/article/details/5089641</span><br><span class="line"></span><br><span class="line">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLEAMP);</span><br><span class="line">GLTEXTURE_2D:操作2D 纹理；GL_TEXTURE_WRAP_S:S方向上的贴图模式;GL_CLAMP:将纹理坐标限制在0.0~1.0范围内，超过作拉伸填充</span><br><span class="line"></span><br><span class="line">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP);</span><br><span class="line"></span><br><span class="line">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</span><br><span class="line">GL_TEXTURE_MAG_FILTER:放大过滤；GL_LINEAR：线性过滤，使用距离当前渲染像素中心最近的4个像素加权平均值；</span><br><span class="line"></span><br><span class="line">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_NEAREST);</span><br><span class="line">GL_TEXTURE_MIN_FILTER:缩小过滤；GL_LINEAR_MIPMAP_NEAREST：使用GL_NEAREST 对最接近当前多边形的解析度的两个层级贴图进行采样，然后用这两个值进行线性插值。</span><br><span class="line"></span><br><span class="line">## glTexImage2D</span><br><span class="line"></span><br><span class="line">加载图像数据并上传纹理</span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/jeffasd/article/details/78135588</span><br><span class="line"></span><br><span class="line">glTexImage2D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, const GLvoid *pixels)</span><br><span class="line"></span><br><span class="line">target: 指定活动纹理单元的目标纹理。GL_TEXTURE_2D, GL_TEXTURE_CUBE_MAP_POSITIVE_X, GL_TEXTURE_CUBE_MAP_NEGATIVE_X, GL_TEXTURE_CUBE_MAP_POSITIVE_, GL_TEXTURE_CUBE_MAP_NEGATIVE_Y, GL_TEXTURE_CUBE_MAP_POSITIVE_Z, 或GL_TEXTURE_CUBE_MAP_NEGATIVE_Z。</span><br><span class="line"></span><br><span class="line">level: 指定详细程度编号。级别0是基本图像级别。级别n是第n个缩略图缩小图像。</span><br><span class="line"></span><br><span class="line">internalformat: 指定纹理的内部格式。必须是下列符号常量之一：GL_ALPHA, GL_LUMINANCE, GL_LUMINANCE_ALPHA, GL_RGB, GL_RGBA.</span><br><span class="line"></span><br><span class="line">width, height</span><br><span class="line"></span><br><span class="line">border: 指定边框宽度。必须为0.</span><br><span class="line"></span><br><span class="line">format: 指定纹理数据格式。必须匹配internalformat。 下面符号被接受: GL_ALPHA, GL_RGB, GL_RGBZ, GL_LUMINANCE, GL_LUMINANCE_ALPHA.</span><br><span class="line"></span><br><span class="line">type: 指定纹理数据的数据类型。下面的符号值被接受: GL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT_5_6_5, GL_UNSIGNED_SHORT_4_4_4_4, GL_UNSIGNED_SHORT_5_5_5_1.</span><br><span class="line"></span><br><span class="line">data: 指向内存中图像数据的指针。</span><br><span class="line"></span><br><span class="line">## glActiveTexture(GLenum texUnit)</span><br><span class="line"></span><br><span class="line">https://www.douban.com/note/627332677/</span><br><span class="line"></span><br><span class="line">该函数选择一个纹理单元，线面的纹理函数将作用于该纹理单元上，参数为符号常量GL_TEXTUREi.</span><br><span class="line">Active 应该理解为选择(Select)某纹理单元(Texture Unit)，即表示后续的glEnable(GL_TEXTURE_2D) 和glBindTexture(GL_TEXTURE_2D, texture)作用域此所选的纹理单元。</span><br></pre></td></tr></table></figure></p><p>void glActiveTexture(GLenum textureUnit) {<br>    currentTextureUnit = textureUnit - GL_TEXTURE0;<br>}</p><p>void glBindTexture(GLenum textureTarget, GLuint textureObject) {<br>    TextureUnit *texUnit = &amp;textureUnits[currentTextureUnit];<br>    switch(textureTarget) {<br>        case GL_TEXTURE_1D: texUnit-&gt;targetTexture1D = textureObject; break;<br>        case GL_TEXTURE_2D: texUnit-&gt;targetTexture1D = textureObject; break;<br>        case GL_TEXTURE_3D: texUnit-&gt;targetTexture1D = textureObject; break;<br>        case GL_TEXTURE_CUBEMAP: texUnit-&gt;targetTextureCube = textureObject; break;<br>    }<br>}<br><code>`</code></p><h2 id="回顾最近学习OpenGLES-学习参考路线"><a href="#回顾最近学习OpenGLES-学习参考路线" class="headerlink" title="回顾最近学习OpenGLES 学习参考路线"></a>回顾最近学习OpenGLES 学习参考路线</h2><p>一个合适自己的学习路线比什么什么讲师什么什么高级书都重要一万倍，如果找到了对应的路，将对带给自己事半功倍的效果。<br>我直接说出根据哪个博客，那些系列，之后再讲这些博客能得到什么。</p><ol><li><a href="https://www.jianshu.com/u/a309d4c4dc47" target="_blank" rel="noopener">简书-清墨</a></li><li><a href="https://zhuanlan.zhihu.com/zangqilong" target="_blank" rel="noopener">知乎-叶孤城的iOS杂货铺</a></li><li><a href="https://www.jianshu.com/u/815d10a4bdce" target="_blank" rel="noopener">简书-落影</a></li></ol><p>以上是按顺序学习。</p><p>清墨的博文教学很简单易懂，这个大哥应该去当老师。很细心，能把他全部学完，就能做个3D 的场景了。他最后一个提问：为什么图片模糊，线段有棱角？<br>解答是:</p><ol><li><code>glTexParamiv</code> 的 <code>gl_Texture2D_Mag_Filter</code>、<code>gl_Texture2D_Min_Filter</code> 设置为<code>gl_clamp_to_edge</code>，这样线段就不会有棱角;</li><li>将<code>self.view.contentFactor</code> 设置为<code>[UIScreen mainSceen].scale</code>, 同时设置各个要放大的地方为相应倍数，这样图片就不会模糊。</li></ol><p>iOS 码农介的吴彦祖在知乎开了新的ID：叶孤城。名号多，但是写的也是非常好。同时期待他能写出更多好文章，小弟很受用，非常非常感谢。<br>他的<strong>从0打造一个GPUImage</strong>从(1)~(6.2)学完就能做一个pipeline 滤镜。</p><p>提醒一点，必须先学完清墨的博文，叶孤城估计太忙，中间一小部分没有完全讲透一些语句的作用，会很疑惑。</p><p>落影的文章很全，先学习OpenGLES 文集，不要学太深(目前要用的知识学完就好)，然后看GPUIMage 文集。对落影大哥的文集点评一下，他的文集很全，但是注释的关键地方都少，代码关键地方注解还不够。有些很迷糊。</p><p>可以理解为升级版学习。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-8-3lesson</title>
      <link href="/2018/08/25/2018-8-3lesson/"/>
      <url>/2018/08/25/2018-8-3lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="2018-8-3"><a href="#2018-8-3" class="headerlink" title="2018/8/3"></a>2018/8/3</h3><h3 id="TS-使用enum-出现-ts-Operator-‘-’-cannot-be-applied-to-types"><a href="#TS-使用enum-出现-ts-Operator-‘-’-cannot-be-applied-to-types" class="headerlink" title="TS 使用enum 出现[ts] Operator ‘==’ cannot be applied to types"></a>TS 使用enum 出现[ts] Operator ‘==’ cannot be applied to types</h3><p><code>[ts] Operator &#39;==&#39; cannot be applied to types &#39;CheckCleanStep.Idle | CheckCleanStep.Input&#39; and &#39;CheckCleanStep.Check&#39;.</code><br>Typescript 出现和这个issue <a href="https://github.com/Microsoft/TypeScript/issues/15835" target="_blank" rel="noopener">https://github.com/Microsoft/TypeScript/issues/15835</a> 一样。<br>目前解决方法是，在判别的时候，强制判别类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if ((checkStep as CheckCleanStep) == CheckCleanStep.Check) &#123;</span><br><span class="line">    //do stuff</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="周末写Typescript-游戏有感"><a href="#周末写Typescript-游戏有感" class="headerlink" title="周末写Typescript 游戏有感"></a>周末写Typescript 游戏有感</h3><ol><li><p>egret TypeScript 游戏在lib 选项，是es5，于是在要用到Map、Set 时，需要给其添加上<strong>es6</strong> 才能使用。<br>由于在最终打包时，只能打为es5，尴尬的一幕出现了：Map 在’for of’ 语句 提示，在es5 中，不能使用literial，没有这玩意(该为es6 新增对象)一样。<br>使用’for in’ 出现的问题是该loop 不会进入。<br>还有一种备选办法是：Array.from(map.keys()/map.values())<br>这样在每次都需要创建新的Array。<br>最终我的处理是map.forEach((value, key) =&gt; {})</p></li><li><p>之前写法是Object =&gt; {} 保存数据格式。简直太js，于是全部改为对象处理。啊，啊，，爽。</p></li><li>需要注意的是Map、Set 在需要正确使用set、add、get、size、delete等。千万千万别<code>map[key] = value;</code>变成使用{} 对象方法了。</li><li>egret 中exml 的元件是在this 对象中。</li><li>游戏的好不好玩并不是功能。体现在对游戏的难度分级和结果回馈。<br>难度分级就是由简单到复杂，由平缓到陡峭。<br>结果肯定明了：分数不能低的难看啊，怎么的，玩个200多分、300分，心里爽啊。20分就难看啦。</li><li>断点修改，好用，for 循环的断点，太好用，简直。</li><li>逻辑、玩法多打注释。毕竟游戏跟需求是天生姻缘。</li><li>合理的建立对象。合理的摆放对象坐标。</li><li>对象初始化。如果知道对象初始化为null，数组初始化个数，则在申明时就给其定义规则。</li><li>egret.Sound 这个类，不能被继承！我继承就报错，之后接触多了再看原因。</li><li>声音播放有个大坑。初始化完我就播放，老是会播放惜败，似乎要延时播放才可以。<br>其 示例- 声音播放 教程，是初始化完成、界面显示完成后，用户点击播放，那么微信、QQ、网页、模拟器都是播放正常的。<br>但是修改成mp3 加载完成立即播放，就也是QQ、模拟器能播放，其他都不能播放了。</li></ol><h3 id="nginx-出现permission-delay"><a href="#nginx-出现permission-delay" class="headerlink" title="nginx 出现permission delay"></a>nginx 出现permission delay</h3><ol><li>原因是控制该nginx 的能力为nobody，权限不够。<br>改为<code>user root;</code>能暂时解决该问题。但是安全性不够。</li><li>设置egret 游戏服务器<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server</span><br><span class="line">        &#123;</span><br><span class="line">                listen 80;</span><br><span class="line">                server_name www.lsgood.top lsgood.top;</span><br><span class="line">                root /root/Work/web/;</span><br><span class="line">                index index.html;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li></ol><p>web 目录下是popcirle 的文件夹游戏<br>web/popcircle/index.html<br>所以最终游戏目录为：<a href="http://lsgood.top/popcircle/index.html" target="_blank" rel="noopener">http://lsgood.top/popcircle/index.html</a></p><h3 id="egret-打包小游戏的坑"><a href="#egret-打包小游戏的坑" class="headerlink" title="egret 打包小游戏的坑"></a>egret 打包小游戏的坑</h3><ol><li>打包显示index.html “data-scale-mode” 的模式”showAll” 错误，改成”fixedWidth”</li><li>做小游戏，申请wxAppid，在微信选择面板一定要选择游戏，不然会出现提示”app.json”找不到，因为此时换成了”game.json”</li><li><strong>VM4477:1 gameThirdScriptError ReferenceError: Boom is not defined</strong><br>出现的问题是:egret - scripts - wxgame - wxgame.ts 里面”async onFile(file: plugins.File) {“ 方法最后一句<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (filename == &apos;main.js&apos;) &#123;</span><br><span class="line">        content += &quot;;window.Main = Main;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">file.contents = new Buffer(content);</span><br></pre></td></tr></table></figure></li></ol><p>改成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (filename == &apos;main.js&apos;) &#123;</span><br><span class="line">        content += &quot;;window.Main = Main;&quot;;</span><br><span class="line">        [&quot;Circle&quot;,  &quot;GameData&quot;,</span><br><span class="line">        &quot;GameOverLayer&quot;, &quot;GameScene&quot;, &quot;Kill&quot;].forEach(v =&gt; &#123;</span><br><span class="line">                content += `window.$&#123;v&#125;=$&#123;v&#125;;`</span><br><span class="line">        &#125;); </span><br><span class="line">        &#125;</span><br><span class="line">file.contents = new Buffer(content);</span><br></pre></td></tr></table></figure></p><p>添加的为你要加入的新的类名。空的不要添加！</p><ol start="4"><li>玩的时候闪屏:index.html 的”data-frame-rate” 改为60桢(之前的是30)</li><li>调用第三方库，小程序找不到，比如particle<br>解决方法：在egret - scripts - wxgame - wxgame.ts 里面”async onFile(file: plugins.File) {“ 方法<br>对应增加一句,如：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (filename == &quot;libs/modules/particle/particle.js&quot; || filename == &quot;libs/modules/particle/particle.min.js&quot;) &#123;</span><br><span class="line">        content += &quot;;window.particle = particle;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>表示链接新的库</p><ol start="6"><li>egret 粒子系统内存问题<br><a href="https://xmanyou.com/egretde-li-zi-xi-tong-nei-cun-xie-lou/" target="_blank" rel="noopener">https://xmanyou.com/egretde-li-zi-xi-tong-nei-cun-xie-lou/</a><br>参考的这篇。先删掉再说，嘿嘿。<br>在要离开页面的地方：this.particleSys.close(true);</li><li>openDataContext 是公共域，开放权限的地方。其他都为主域。<br>公共域只允许进数据。platform.js 通过<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const openDataContext = wx.getOpenDataContext();</span><br><span class="line">openDataContext.postMessage(data);</span><br></pre></td></tr></table></figure></li></ol><p>把data 传进去,然后openDataContext.index.js 接受：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function addOpenDataContextListener () &#123;</span><br><span class="line">        wx.onMessage((data) =&gt; &#123;</span><br><span class="line">                if (data.command == &apos;open&apos;) &#123;&#125;</span><br><span class="line">                else if (data.command == &apos;loadRes&apos;) &#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后里面去拿数据、展示页面等。<br>openDataContext 只有postMessage、onMessage、shareCanvas 三个可以和外部交互的功能。<br>所以另起一个Promise function 走不通；<br>往postMessage 传入callback 也是不行的：postMessage 只接受基础变量，其他的会被过滤。</p><p>这时 <code>wx.getFriendCloudStorage</code> 这个方法只允许在公共域处理拿数据、处理数据、展示数据！<br>同时记住：get 回来的数据最后一层是string 哟。</p><p><code>wx.setUserCloudStorage</code> 可以在各个地方获取。<br>我直接写在platform.js 下另起一个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setWxStorage(dataStr) &#123;</span><br><span class="line">        return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">                wx.setUserCloudStorage(&#123;</span><br><span class="line">                        KVDataList: [&#123; key: &quot;score&quot;, value: dataStr &#125;],</span><br><span class="line">                        success: res =&gt; &#123;</span><br><span class="line">                                resolve(res);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        fail: res =&gt; &#123;</span><br><span class="line">                                reject(res);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>注意，value 一定要是str就可以了。</p><ol start="8"><li>头像没有显示出来。不知道为啥。当你选择下一页的时候居然又出来了。先这样吧。</li><li>自己最高分方案是使用本地缓存，然后判别是否有更高分进行setUserCloudStorage。</li><li>由于openDataContext权限问题，那么好友分数排序就只能从getFriendCloudStorage 数据之后进行json 对象化，转换数据格式、然后排序。<br>排序使用js 的Array.prototype.sort((n1, n2) =&gt; {}) 高阶函数排序。</li><li>当前判别是否是wxgame 还是h5，使用platform.openDataContext == null。</li></ol><h3 id="记录微信小游戏打包过程。"><a href="#记录微信小游戏打包过程。" class="headerlink" title="记录微信小游戏打包过程。"></a>记录微信小游戏打包过程。</h3><p>个人微信账号，只需填写两个资料：1游戏自审自查报告；2计算机软件著作权登记证书。<br>游戏自审自查这里采用一个jpg，申明微信小游戏在一开始添加了“健康安全提示语”，且截图小游戏加载页面；其他包括授权、公司名称等；同时还有公司的对此发行软件责任等。<br>计算机著作权登记证书 是去软件著作权中心申请（plz，去那边申请太慢。如果小游戏还比较小，可以先网上找个著作权ps 凑和，不然要等很久）。</p><p>公司账号需要填写4个资料等，很麻烦。这个资料没找齐，没搞。</p><p>游戏创作完成后，直接点击顶部的上传，即可上传测试文件。在微信公众号:<a href="https://mp.weixin.qq.com" target="_blank" rel="noopener">https://mp.weixin.qq.com</a> 登录之后 - 开发管理 - 开发版本 里面会有最新的开发包。在下拉选项卡中“发布测试” 可以发布一个包含填写的测试人员们内部测试的包。如果点击“提交审核”则直接发布release。接下来就是填写信息然后发布啦。<br>流量主，这个功能有个门槛，需要用户达到1000个以上才可以申请。</p><h3 id="看raywenderlich-网站文章英语对高考英语失利有感"><a href="#看raywenderlich-网站文章英语对高考英语失利有感" class="headerlink" title="看raywenderlich 网站文章英语对高考英语失利有感"></a>看raywenderlich 网站文章英语对高考英语失利有感</h3><p>高考一直有个遗憾，前三科手感超出我的预期。英语是最后一科，而我也是班里英语前三，第一位置偶尔也能轮换位置的人，在最后却发挥失常。<br>有几个原因，其中一个与今天“有感” 有关联。</p><ol><li>前三科太轻松，超过了我的预期，特别是我最不熟练的数学、理综。<br>心存侥幸（我的运气一直是爆表的，感觉和住在庵堂旁边有关系），心里稍稍在高考第二天下午放松。</li><li>那天中午也由于太高兴，自己内心有估算的，于是玩起2011年火热的iPod 街霸游戏。<br>我确实还是没有长大啊，内心的开心，总得释放，不能与他人语（成绩还要1个月后出来，要低调），那就释放玩游戏；心想“下午正是我最拿手的英语，简单”。</li><li>我一直贯彻“李阳英语”理念，一直拼命的读，没事看看文章。特点是平时的交流都能顺利，我觉得基本能和外国人日常交流。<br>虽然脑袋中午放松，成绩也不能低到哪里去，所以出弱势问题，可能：<br>贯彻的“李阳英语”理念也有一个弊端，那就是对高考学术型的英语不一样。<br>高考学术型，听力比模拟考时正式，听得时候平常心里是不翻译，而是直接内心模拟出场景，高考时，心里紧张（外加中午没休息好），硬是内心一句一句翻译却跟不上读速了；<br>笔试部分也由于听力失利（自己感受的出来，蒙的比例比以前多多了），感觉有一点点困顿，不太在状态；心里有点后悔中午没休息好；<br>总的来说，有得有失，到现在内心也已翻不出大波浪，时过境迁。要是我更多分，我还会想现在这样么？或许会有那么点不一样吧，也许吧。</li></ol><h3 id="掌握知识点的表现"><a href="#掌握知识点的表现" class="headerlink" title="掌握知识点的表现"></a>掌握知识点的表现</h3><p>当你能描述出那个知识点，同时将他比喻出来。比如面向过程和面向对象，你就可以这样比喻：同样是煮一杯咖啡，面向过程是讲步骤过程化，每个步骤要干什么，满足什么条件，于是就出来了什么咖啡；面向对象的不同点是，关注的是拆解元素，比如承装的被子，煮咖啡机器，水元素，model 这一很重要的概念。<br>所以我也能大致确认，大部分的知识点，可以使用我们日常一些元素，环境描述，那么你就真正得到了该知识。</p><h3 id="微信分享时，背景声音在回来后没有再播放"><a href="#微信分享时，背景声音在回来后没有再播放" class="headerlink" title="微信分享时，背景声音在回来后没有再播放"></a>微信分享时，背景声音在回来后没有再播放</h3><p>找到wxgame 全局搜索<code>var innerAudioContext = wx.createInnerAudioContext();</code><br>找到了weapp-adapter.js 下856行，<br>然后下面添加这两句即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wx.onShow(function () &#123;</span><br><span class="line">        innerAudioContext.play();</span><br><span class="line">&#125;);</span><br><span class="line">wx.onAudioInterruptionEnd(function () &#123;</span><br><span class="line">        innerAudioContext.play();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="这几天终于把微信排行榜的问题搞好啦。非常给力。接下来就是微信分享，别人点击后得到相应礼品、物品值-三个可以和外部交互的功能。"><a href="#这几天终于把微信排行榜的问题搞好啦。非常给力。接下来就是微信分享，别人点击后得到相应礼品、物品值-三个可以和外部交互的功能。" class="headerlink" title="这几天终于把微信排行榜的问题搞好啦。非常给力。接下来就是微信分享，别人点击后得到相应礼品、物品值+ 三个可以和外部交互的功能。"></a>这几天终于把微信排行榜的问题搞好啦。非常给力。接下来就是微信分享，别人点击后得到相应礼品、物品值+ 三个可以和外部交互的功能。</h3><h3 id="这两天看OpenGL-遇到的等等数学知识思考大学为什么没学会，或者说没学-盘点下"><a href="#这两天看OpenGL-遇到的等等数学知识思考大学为什么没学会，或者说没学-盘点下" class="headerlink" title="这两天看OpenGL 遇到的等等数学知识思考大学为什么没学会，或者说没学 盘点下"></a>这两天看OpenGL 遇到的等等数学知识思考大学为什么没学会，或者说没学 盘点下</h3><p>遇到的有欧拉角 四元数、笛卡尔坐标、齐次方程组、万向节；<br>这么些需要建模，知道大概，然后将其映射到目前工业、图形学重要应用的知识，居然在大学只是书里画了个图，黑板上一直写，快考试的时候说会考，仅此而已？<br>为什么不是老师们代码建模，把形状形态，大致描绘出来？中间会出一些问题，带着问题思考，生动形象点？难道还如授课的教授们当年学习般，只有靠“拼命学”才能“突出重围”么？<br>教授年纪都比较大，但是前缘的技术也是需要接触的。让更生动的计算机科学和数学结合，让更多人参与到知识的海洋中，而不是一些死记硬背，目的只是“拼命学”“突出重围”的一小部分人得到知识的一小部分；<br>大部分人都可以参与，可以互相讨论。更多人参与才能带动领域的增强，讨论才能出点子，才能出一些人想不到的思绪。<br>然而并没用。<br>如今离开大学，我又重新看这些晦涩难懂的知识。能稍稍理解，如果要进一步理解呢？那就是直接将他们画出来，运用起来。</p><h3 id="小游戏登录解密"><a href="#小游戏登录解密" class="headerlink" title="小游戏登录解密"></a>小游戏登录解密</h3><p>首先准备小游戏的appid 和appsecret。之后会用到<br>用户wx.login 的时候得到code；<br>用户wx.getUserInfo 的时候得到a = {encryptedData:xxx, iv:xxx, userInfo:xxx};<br>a 里面的userInfo 数据不完善，没有用户ID。其他更多信息。通过去微信服务器得到一个session_key可以解开。<br>在这个目录里面有该资料：<br>code 就是登陆时候返回的code。APPID 为小游戏APPID。SECRET 为小游戏的密钥。<br><code>https://api.weixin.qq.com/sns/jscode2session?appid=APPID&amp;secret=SECRET&amp;js_code=JSCODE&amp;grant_type=authorization_code</code><br>会返回</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//正常返回的JSON数据包</span><br><span class="line">&#123;</span><br><span class="line">  &quot;openid&quot;: &quot;OPENID&quot;,</span><br><span class="line">  &quot;session_key&quot;: &quot;SESSIONKEY&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后通过hmac_sha256解密得到数据信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">signature = hmac_sha256( post_data, session_key )</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-7-23lesson</title>
      <link href="/2018/08/02/2018-7-23lesson/"/>
      <url>/2018/08/02/2018-7-23lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="2018-7-23"><a href="#2018-7-23" class="headerlink" title="2018/7/23"></a>2018/7/23</h3><p>今天又发布了Colox 的第二版本，感悟到其中一些思想。<br>要做好一个完整，商用的产品，需要经过：</p><ol><li>核心功能研发</li><li>整体方向，回款（产品售卖、广告营收、产品获利、周边发展等）</li><li>UI 整体视觉</li><li>上线</li><li>开发营收</li><li>产品推广、改进</li></ol><p>这几个阶段我觉得是个人开发很好的流程，而且一经决定一定要坚持下去。<br>我好几次都把产品开发拖的很长。原因有几个：</p><ol><li>我在学习后台（当时有这么好的学习资源）</li><li>后台差不多了，也使用当时的语言js 学习游戏开发（也是刚好有这资源）</li><li>一直的学习，心却是有点累。</li></ol><p>所以有时在家里搞着搞着，才搞了一个功能，或者某些小功能就退却，打游戏到了深夜。<br>之前在粉粉，每天下班回来晚，已经是半条命；现在新的公司终于终于能抽出空了呀！而且目前还在开发阶段，也不会特别特别紧，所以整体感觉都好了很多。<br>目前把产品推进，“哈皮涂色” 进入到了开发营收。我觉得可以有这几个点营收：</p><ol><li>设置页面给一个二维码，是“鼓励开发哥哥，让他快马加鞭做出更好的产品”</li><li>横幅广告、激励性广告营收</li><li>内购该产品</li></ol><h3 id="CollectionView-里面layer-frame-frame"><a href="#CollectionView-里面layer-frame-frame" class="headerlink" title="CollectionView 里面layer.frame = frame"></a>CollectionView 里面layer.frame = frame</h3><p><a href="http://adad184.com/2015/11/10/disable-uicollectionview-implicit-animation/" target="_blank" rel="noopener">http://adad184.com/2015/11/10/disable-uicollectionview-implicit-animation/</a><br>UICollectionView.reloadData 时会做隐式动画。<br>可以使用以下三种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//方法一</span><br><span class="line">[UIView performWithoutAnimation:^&#123;</span><br><span class="line"></span><br><span class="line">    [collectionView reloadItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:index inSection:0]]];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">//方法二</span><br><span class="line">[UIView animateWithDuration:0 animations:^&#123;</span><br><span class="line">    [collectionView performBatchUpdates:^&#123;</span><br><span class="line">        [collectionView reloadItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:index inSection:0]]];</span><br><span class="line">    &#125; completion:nil];</span><br><span class="line">&#125;];</span><br><span class="line">    </span><br><span class="line">//方法三</span><br><span class="line">[UIView setAnimationsEnabled:NO];</span><br><span class="line">[self.trackPanel performBatchUpdates:^&#123;</span><br><span class="line">    [collectionView reloadItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:index inSection:0]]];</span><br><span class="line">&#125; completion:^(BOOL finished) &#123;</span><br><span class="line">    [UIView setAnimationsEnabled:YES];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p><p>但是我要做的是一个gradientLayer 的布局(单元格形状不一样，布局是一样的)，不得已。<br>于是这句话拯救了我，不然我就要用一张图片解决我问题了，问题是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如果你的cell中还包含有CALayer的动画 比如这样</span><br><span class="line">- (void)layoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [super layoutSubviews];</span><br><span class="line">    </span><br><span class="line">    self.frameLayer.frame = self.frameView.bounds;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>解决方法是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[CATransaction begin];</span><br><span class="line">[CATransaction setDisableActions:YES];</span><br><span class="line">self.frameLayer.frame = self.frameView.bounds;</span><br><span class="line">[CATransaction commit];</span><br></pre></td></tr></table></figure></p><h3 id="LaunchScreen-storyboard-动态设置版本号"><a href="#LaunchScreen-storyboard-动态设置版本号" class="headerlink" title="LaunchScreen.storyboard 动态设置版本号"></a>LaunchScreen.storyboard 动态设置版本号</h3><p><a href="https://www.jianshu.com/p/5253f671436b" target="_blank" rel="noopener">https://www.jianshu.com/p/5253f671436b</a><br>哈哈，连header 都是拿的原作者的。<br>小弟这里记录记录。</p><ol><li>选中LaunchScreen.storyboard 的label，为该label 的Show the Identity inspector(XCode 最右边栏从左到右边：文本、问好、xx -&gt; 就是这玩意啦),在Document - Label 填入”APP_VERSION”.</li><li>点击Project - Target - Build Phases - “New Run Script Phase”</li><li>给新创建的”Run Script” 改名为 “Update Launch Version”, 同时展开它</li><li>在Shell 后面输入 <code>/bin/bash</code>，然后在下面输入脚本语句写入:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">versionNumber=$(/usr/libexec/PlistBuddy -c &quot;Print :CFBundleShortVersionString&quot; &quot;$&#123;PROJECT_DIR&#125;/$&#123;INFOPLIST_FILE&#125;&quot;)</span><br><span class="line">sed -i bak -e &quot;/userLabel=\&quot;APP_VERSION\&quot;/s/text=\&quot;[^\&quot;]*\&quot;/text=\&quot;v $versionNumber\&quot;/&quot; $PROJECT_DIR/XXT/resource/Base.lproj/LaunchScreen.storyboard</span><br></pre></td></tr></table></figure></li></ol><p>以上script 注意3个点:</p><ol><li><code>$PROJECT_DIR/XXT/resource/Base.lproj/LaunchScreen.storyboard</code><br><code>XXT</code>是工程target 名。</li><li><code>/resource/</code> 是对应LaunchScreen 位置(ps 我改过他的位置了)</li><li><code>sed</code> 前面有折行。如果运行正确，效果没出来的，给<code>sed</code> 前面折行</li></ol><p>至此以后就不用那么麻烦了。</p><h3 id="记录一次iOS-上传release-包出现”ITMS-90037”，debug-正常"><a href="#记录一次iOS-上传release-包出现”ITMS-90037”，debug-正常" class="headerlink" title="记录一次iOS 上传release 包出现”ITMS-90037”，debug 正常"></a>记录一次iOS 上传release 包出现”ITMS-90037”，debug 正常</h3><ol><li>debug 非常正常。打包到fir.im 里面OK。</li><li>上传testfly 的时候，总是出现<code>ERROR ITMS-90037: &quot;This bundle is invalid. The Info.plist file is missing or could not be parsed. Please check it for embedded control characters.&quot;</code><br>查google，大部分说<blockquote><p>问题描述：这个包是无效的。Info。plist文件丢失或不能被解析。请检查plist的字符。<br>问题解决：info.plist 里面有一个非法字符，用终端打开这个文件查看一下，可能会有中文的字符或其他不能识别的字符。</p></blockquote></li></ol><p>但是我大眼瞪小眼还是没看出来。<br>从另一个角度：APP 之前可以上传；中间重大改版，里面用到了AliyunvideoPlayer 我觉得有问题。<br>然后我看到这篇文章：<a href="https://www.jianshu.com/p/f62c7767e16b" target="_blank" rel="noopener">https://www.jianshu.com/p/f62c7767e16b</a><br>里面链接到这篇<a href="https://blog.csdn.net/q_littlestone/article/details/51000112" target="_blank" rel="noopener">https://blog.csdn.net/q_littlestone/article/details/51000112</a> 里面的这篇：<a href="http://ios.jobbole.com/84323/" target="_blank" rel="noopener">http://ios.jobbole.com/84323/</a><br>终于找到了最终问题，并说明了原因：<br>里面有第三方framework。其framework 里面的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bundle version</span><br><span class="line">Bundle identifier</span><br><span class="line">Bundle versions string, short</span><br></pre></td></tr></table></figure></p><p>没有和项目自己的对应。如果你自己还有bundle，里面取名不要使用<strong>Info.plist</strong> 或者<strong>info.plist</strong><br>处理办法：</p><ol><li>改变自己bundle 里面的Info.plist / info.plist</li><li>讲第三方的Info.plist 里面的 “Bundle version/Bundle identifier/Bundle versions string, short” 改为和主Info.plist 内容一致。<br>最终终于通过了。<br>我的天，我花了快1天半呀。<br>需要不断尝试，同时看是否能上传成功，同时也要和以前对比。<br>打包、上传。半条命。</li></ol><h3 id="记录一次Xcode-release-下打包CFBundleVersion-1"><a href="#记录一次Xcode-release-下打包CFBundleVersion-1" class="headerlink" title="记录一次Xcode release 下打包CFBundleVersion +1"></a>记录一次Xcode release 下打包CFBundleVersion +1</h3><p>打包增加CFBundleVersion 需要另外考虑一件事：几个同事之间打包，build 号可能会污染。可以使用时间或者git 上传次数。<br>当前使用的是自动+1 操作。<br>首先</p><ol><li>在Build Phases 里面增加一个Run script.</li><li>修改下名字，比如：AutoIncreaseBuildVersion</li><li>把其拖到第一个下面</li><li>增加script 如：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">// 判断是哪个configuration</span><br><span class="line">// Release Debug 或者只自定义的配置</span><br><span class="line">if [ &quot;Release&quot; != &quot;$&#123;CONFIGURATION&#125;&quot; ]</span><br><span class="line">// 如果是Release做哪些事情</span><br><span class="line">then</span><br><span class="line">// 如果不是Release做哪些事情</span><br><span class="line">    exit 0 退出 不执行下面的代码</span><br><span class="line">fi</span><br><span class="line">buildNumber=$(/usr/libexec/PlistBuddy -c &quot;Print CFBundleVersion&quot; &quot;$INFOPLIST_FILE&quot;)</span><br><span class="line">buildNumber=$(($buildNumber + 1))</span><br><span class="line">/usr/libexec/PlistBuddy -c &quot;Set :CFBundleVersion $buildNumber&quot; &quot;$INFOPLIST_FILE&quot;</span><br></pre></td></tr></table></figure></li></ol><p>上面的exit 0 可以注释也可以加上。效果就是其他CONFIGURATION 不会执行下面动作</p><p><strong>跟随时间变化</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">buildNumber=$(date +%Y%m%d%H%M%S)</span><br><span class="line">/usr/libexec/PlistBuddy -c &quot;Set :CFBundleVersion $buildNumber&quot; &quot;$INFOPLIST_FILE&quot;</span><br></pre></td></tr></table></figure></p><p><strong>获取info.plist信息 CFBundleVersion 可以更改为想获取的信息的名字</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildNumber=$(/usr/libexec/PlistBuddy -c &quot;Print :CFBundleVersion&quot; &quot;$&#123;PROJECT_DIR&#125;/$&#123;INFOPLIST_FILE&#125;&quot;)  </span><br><span class="line">shortVersion=$(/usr/libexec/PlistBuddy -c &quot;Print :CFBundleShortVersionString&quot; &quot;$&#123;PROJECT_DIR&#125;/$&#123;INFOPLIST_FILE&#125;&quot;)  </span><br><span class="line">buildNumber=`date +&quot;%m%d&quot;`  </span><br><span class="line">buildNumber=&quot;$shortVersion.$buildNumber&quot;  </span><br><span class="line"></span><br><span class="line">// 设置info.plist</span><br><span class="line">/usr/libexec/PlistBuddy -c &quot;Set :CFBundleVersion $buildNumber&quot; &quot;$&#123;PROJECT_DIR&#125;/$&#123;INFOPLIST_FILE&#125;&quot;</span><br></pre></td></tr></table></figure></p><p><strong>修改项目显示名称为版本号（适用于不同版本号装到一个机器里面，便于区分是哪个版本）</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#/bin/bash</span><br><span class="line">if [ &quot;Release&quot; != &quot;$&#123;CONFIGURATION&#125;&quot; ]; then</span><br><span class="line"></span><br><span class="line">DisplayName=$(/usr/libexec/PlistBuddy -c &quot;Print CFBundleShortVersionString&quot; &quot;$INFOPLIST_FILE&quot;)</span><br><span class="line">DisplayName=&quot;ep$&#123;DisplayName&#125;-I&quot;</span><br><span class="line">/usr/libexec/PlistBuddy -c &quot;Set :CFBundleDisplayName $DisplayName&quot; &quot;$INFOPLIST_FILE&quot;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line"></span><br><span class="line">DisplayName=&quot;真正的项目名称&quot;</span><br><span class="line">/usr/libexec/PlistBuddy -c &quot;Set :CFBundleDisplayName $DisplayName&quot; &quot;$INFOPLIST_FILE&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure></p><h3 id="记录一次使用Egret-wing-调试出现"><a href="#记录一次使用Egret-wing-调试出现" class="headerlink" title="记录一次使用Egret wing 调试出现"></a>记录一次使用Egret wing 调试出现</h3><p>“No such module: atom_renderer_v8_util”<br>崩溃到这一句”return process.binding(<code>atom_${process.type}_${name}</code>)”</p><p>然后换成debug 用chrome 可以用几次，但是用出错。<br>明明没有代码错误，把代码拷到另一个工程，又能运行。<br>最终解决：把翻墙关了。<br>网上也有一些解决方案，但都没有说到点，心里还嘀咕怎么可能跟我shadowSocks 有关。<br>后来确实没有再出现了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018/6/28lesson</title>
      <link href="/2018/07/21/2018-6-28lesson/"/>
      <url>/2018/07/21/2018-6-28lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="2018-6-28"><a href="#2018-6-28" class="headerlink" title="2018/6/28"></a>2018/6/28</h3><p>记录一下这几天的事<br>之前从粉粉离职，原因有很多很多方面导致我在这大热天毅然决然的选择离开.</p><ol><li>工资从未提升，哪怕变动或者变少都行，表示公司有一定考核.<br>2.周末采取单双休，双休的时候感觉太幸福了；单休的时候，周日等于没有休息，等于连上12天班。饥饿策略。</li><li>项目采用快速迭代策略，2周一版本，代码质量要管控、逻辑要管控、需求没有明确特别是需求不明确，做到一定才发现有些有冲突，或者有些和另外东西结合了，或者导致另外东西也要变动，然而时间也是被一并算进迭代版本里面。正如最后要走时，旭哥和我开玩笑的说‘在外面公司好点，因为他们不懂代码，粉粉技术懂，所以就会很紧，以后你就会舒服啦’。是的，他们懂代码他们也为我尽量宽松了些，但是细节可能在做到的时候才会碰到。</li><li>公司感受不到我的存在位置，我就是个码农？这不是我想要的。</li></ol><p>进粉粉目的如同我刚上大学就知道自己绝不会考研一样：‘我是来学技术的’。学完如果公司还有我存在的意义，那么我会选择留下来，以上总总都没有。</p><p>后来和根根（前粉粉安卓组成员）聊天时，他说的也正是我明了的：<strong>粉粉 是不是觉得 举步维艰</strong> 、<strong>陷入泥潭一样？</strong></p><p>所以我预算的最好的时间就是学完，前端学完，后端学完，溜了溜了。<br>期间面试了有十数家公司。</p><p>有+我才3个开发的公司，产品基本等于设想的。</p><p>有要做区块链 的公司（好多家都想蹭这个热度）</p><p>有做广告SDK 的（当时去到该处，我先看他们代码，告诉他们这要做什么，对我来说有什么理解、难处等等）</p><p>有做心理学社交的，我当时先让他电话面试，别他们觉得不合适，我就可以不用过去了</p><p>也有做公司产品+外包的</p><p>我拒绝了几个（3、4个，六月份找工作确实不好找）</p><p>我被拒绝了2次一个做医疗社交的，看他开价12 - 19，，又看到他们内部技术，我的天，那就意思意思17左吧，，真没漫天要价。一个做看小说的，似乎有个产品叫“漫画”似乎要很牛逼的，，我特么不写着我自己期望的嘛，你特么喊我过来，问的问题我以为什么鬼。搞得很牛逼的样子，反正不用理这个。继续自己的学习发展，确实很都比的人）</p><p>得到4、5个offer。最后来到一个也是做社交的小公司。正好可以把从粉粉学到的运用上去。</p><p>老实说，当时看到他们的代码，有种熟悉又不熟悉的味道。代码规范、格式，这里不存在的。创建者是个php 的小哥（即将离开），能力不咋滴（产品逻辑、规范、Wiki、流程都不知道）还拽的250似得。我也懒得和这种性格有缺陷的人多聊一会，问documents 有没有？不存在的，全部是3、4年前写的种使用字典；服务端也别想有documents。反正一团糟。哈哈。反正所有东西都是3、4年前那一套。</p><p>那我就慢慢来好了，我不急，急不来，自己好好规划规划就可以了。</p><p>来到这个公司，有几个特点。</p><p>优点：公司有自己目前主营业务。新来了个小哥php 、规范等和自己有共同语言，产品负责人和c 哥很像。多年产品人，设计，游戏设计。新来的那个小哥也做白鹭游戏，这个是我想要的。之后可能也会分配做些游戏。老板似乎是宁波人，公司方面也有和宁波政府合作。这个和我也有点想去宁波发展发展有点好处。额，还可以还可以。</p><p>缺点：确实没有粉粉明面上的热闹，进来之后感觉我有点无足轻重。技术垃圾到极点（目前都走光了，剩下产品大哥-长得有点像‘无所谓’的杨坤，和php 小哥）。老板性格、说话有点像干辉，哈哈。老板一点都不懂技术，但是比较会被技术说的云里雾里，然后似懂非懂。老板管理上不咋滴的。</p><p>好吧，吐槽吐槽就到这里了。不多说，溜了溜了。</p><h3 id="UICollectionView-addSubviews-UIView-内部有autolayout-CollectionView-视觉出bug"><a href="#UICollectionView-addSubviews-UIView-内部有autolayout-CollectionView-视觉出bug" class="headerlink" title="UICollectionView addSubviews UIView 内部有autolayout CollectionView 视觉出bug"></a>UICollectionView addSubviews UIView 内部有autolayout CollectionView 视觉出bug</h3><p>错误确定为：<br>CollectionView addSubviews 里面不能存在内部有约束的UIView。<br>否则其直接导致CollectionView 内部结构、内部约束直接紊乱。<br>其上的新增detailInfoview 有两种方法可以处理<br>1：如同当前新建view 处理，内部全部为frame 布局。目前来看似乎还不错<br>2：在CollectionViewLayout 上多流出来一个layoutAttributes，给第一个，然后frame 由代理DataSource 从controller 得到。这样等于得到一个特定cell</p><h3 id="Xcode-插件还能用"><a href="#Xcode-插件还能用" class="headerlink" title="Xcode 插件还能用"></a>Xcode 插件还能用</h3><p>curl -fsSL <a href="https://raw.github.com/alcatraz/Alcatraz/master/Scripts/install.sh" target="_blank" rel="noopener">https://raw.github.com/alcatraz/Alcatraz/master/Scripts/install.sh</a> | sh<br>但是提示 <strong>xcrun: error: unable to find utility “xcodebuild”, not a developer tool or in PATH</strong></p><p><a href="https://www.jianshu.com/p/ff1d99fe1d17" target="_blank" rel="noopener">https://www.jianshu.com/p/ff1d99fe1d17</a></p><p>opened Xcode.<br>Preferences<br>Locations<br>Selected the Command Lin Tools: (选择xcode版本)</p><p>-&gt; <strong>Alcatraz successfully installed!!1!🍻  Please restart your Xcode (9.4).</strong></p><p>然后解决Xcode 8 之后不能使用Alcatraz</p><p><a href="https://www.jianshu.com/p/0b541f145a1a" target="_blank" rel="noopener">https://www.jianshu.com/p/0b541f145a1a</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem install update_xcode_plugins</span><br><span class="line">$ update_xcode_plugins</span><br><span class="line">$ update_xcode_plugins --unsign</span><br></pre></td></tr></table></figure><p><strong>Choose which Xcode you would like to unsign (use arrows): Xcode (9.1) [Signed]: /Applications/Xcode.app</strong><br><code>$ Y</code></p><p>似乎出现了Xcode 关闭之后，再打开，PackageManager 不见了。<br>解决请参考：</p><p><a href="https://www.jianshu.com/p/a9448154c09e" target="_blank" rel="noopener">https://www.jianshu.com/p/a9448154c09e</a></p><p>之后确实都出来了，不知是否这个原因</p><h3 id="iOS-转场动画"><a href="#iOS-转场动画" class="headerlink" title="iOS 转场动画"></a>iOS 转场动画</h3><p>很久没有做转场动画了。这里把遇到的坑填一填。</p><h3 id="如果程序中改变了某个空间的transform-不要使用frame；视觉bug-是其会变成CGRectZero"><a href="#如果程序中改变了某个空间的transform-不要使用frame；视觉bug-是其会变成CGRectZero" class="headerlink" title="如果程序中改变了某个空间的transform 不要使用frame；视觉bug 是其会变成CGRectZero"></a>如果程序中改变了某个空间的transform 不要使用frame；视觉bug 是其会变成CGRectZero</h3><p><a href="https://www.jianshu.com/p/9dfd337e8266" target="_blank" rel="noopener">https://www.jianshu.com/p/9dfd337e8266</a><br>应该使用bounds+center</p><h3 id="iOS-某个VC-rotation-还有statusBar-状态"><a href="#iOS-某个VC-rotation-还有statusBar-状态" class="headerlink" title="iOS 某个VC rotation 还有statusBar 状态"></a>iOS 某个VC rotation 还有statusBar 状态</h3><p>//<a href="http://www.jianshu.com/p/4196d7cf95f4" target="_blank" rel="noopener">http://www.jianshu.com/p/4196d7cf95f4</a><br>BaseNavigationViewController:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/*顶部状态栏 接下来会调用该viewController 的</span><br><span class="line">- (BOOL)prefersStatusBarHidden &#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line">- (UIStatusBarStyle)preferredStatusBarStyle &#123;</span><br><span class="line">    return UIStatusBarStyleLightContent;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line">-(UIViewController *)childViewControllerForStatusBarStyle&#123;</span><br><span class="line">    return self.topViewController;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>程序默认为<strong>UIInterfaceOrientationMaskPortrait</strong><br>那么在BaseNavigationViewControlelr<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(UIInterfaceOrientationMask)supportedInterfaceOrientations&#123;</span><br><span class="line">    return UIInterfaceOrientationMaskPortrait;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>在需要的ViewController加入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)shouldAutorotate &#123;</span><br><span class="line">    return !self.isLocked;</span><br><span class="line">&#125;</span><br><span class="line">//这个比较重要。这里告诉了system 当前到底支持哪些种旋转方式</span><br><span class="line">- (UIInterfaceOrientationMask)supportedInterfaceOrientations &#123;</span><br><span class="line">    if (self.isLocked) &#123;</span><br><span class="line">        return UIInterfaceOrientationMaskPortrait;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return UIInterfaceOrientationMaskPortrait|</span><br><span class="line">            UIInterfaceOrientationMaskLandscapeLeft|</span><br><span class="line">            UIInterfaceOrientationMaskLandscapeRight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation</span><br><span class="line">&#123;</span><br><span class="line">    if (self.isLocked) &#123;</span><br><span class="line">        return toInterfaceOrientation = UIInterfaceOrientationPortrait;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    return (toInterfaceOrientation == UIInterfaceOrientationPortrait);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>以上即可在相关view 里面控制rotate。</p><h3 id="最近老婆看电视剧太多又说不看了，我想到的是，又一个新的轮回开始了"><a href="#最近老婆看电视剧太多又说不看了，我想到的是，又一个新的轮回开始了" class="headerlink" title="最近老婆看电视剧太多又说不看了，我想到的是，又一个新的轮回开始了"></a>最近老婆看电视剧太多又说不看了，我想到的是，又一个新的轮回开始了</h3><p>2018/7/9<br>她说看太多不想看了。那我们来预测一下接下来她会怎么做，然后每天记录她当天的态度。</p><p>什么是新的轮回？那就是，难受，不看电视剧，所以连同什么综艺节目（跑男、唱歌的、宝宝剧场）都不会看。当然，对于黄妈肯定是一开始很义正言辞的。<br>于是最近的3天到5天（最长5天，不可能超过5天，这也要考虑进去周末休息日）她一天比一天难受。很想看，但是又还记得刚说过的话。<br>下一个阶段是工作回来太累了，回到家不知道干什么，毕竟工作属于需要静下心来的；于是她就花点时间做菜，做好吃的。这阶段属于过渡期，这几天饭菜之类的都会可口一些吧。<br>当然过渡期不能称为阶段，因为这很短，大约2天~3天。期间还会有不应期，菜饭做好吃好，不想写东西，又睡不着，此时还不能看任何视频，这就难受了。于是就趴在床上看淘宝。<br>腐女嘛，不是看视频就是看淘宝，看淘宝还不买的那种，因为她知道她没钱。我要是店主，我肯定不开淘宝店了。页面统计数据挺好看的，就是没人买-&gt;都是她这种小妮子光看不买系列。<br>下一个阶段就是有些忘记之前说过的话啦，没全忘记那种。在一起吃饭时，她会嘿嘿嘿的偷笑，拿出iPad，怼到我面前，就像是我们一起看，看综艺节目（当前还不敢看电视剧的）。看着看着，然后又趴到床上看淘宝。<br>接下来的2~3天左右就会发现她捧着iPad在床上看看综艺节目演变成偷偷看韩剧，这时回头看她，她是带着耳机的，时不时偷笑；说她的时候，她就会不好意思，然后又继续看，有时也会放下。此时她的睡眠也不会熬夜。<br>其实这阶段还属于偷偷看。不敢光明正大看，也不能不看，估计不看的话，会，会，会坏掉的。<br>再接下来，有两个阶段，可以合并为一个。<br>先是吃饭的时候看韩剧，一起看一起看（说实话，那些逗逼韩剧那么多人看，我都想转行拍片了，没技术没含量没思想）。然后就是，自己一个人在后面，边吃零食、边看电视剧啦。<br>快乐的一个人看电视剧，手边总有吃的。因为没有吃的，她会把吃的扒拉过来放在身边，没吃嗑一点。</p><p>实际：<br>第1~3天（7月9号为第1天）：<br>第1天：<br>第1天晚上回去，一菜一汤。然后屁颠屁颠坐下来看看weex。由于立马不看电视剧，接口看了下QQ，点开了QQ空间，里面看了好一会视频。看到我喝酒，怕被我打，赶紧不看了。<br>接着又看了会weex，手机上开发者页面，这么小屏幕，肯定看不下去，于是东搞搞西搞搞，这晚就过去了。<br>比较关键的是，她自己不能看视频，还不让我打游戏，，，这神逻辑。我又没说我不打游戏。我打游戏休闲娱乐，她居然也不让我看。哈哈。<br>第2天：<br>第2天晚上回去，进门就看到她开始看综艺节目啦。看来之前多次轮循，现在比较明目张胆了。我一说之后，马上收起来，屁颠屁颠去拿饭吃了。<br>今天晚上她身体不舒服，搞七搞八，视频又不能看，于是吃完饭差不多9点多了，就自己睡着了。<br>第3天：<br>第3天晚上回去，你懂得，饭也没煮，一开门就看到她在那看电视剧了。<br>嘿，这个转换的快啊。她赶紧收起来，然后不好意思屁颠屁颠去给我热粥。我吃饭时，让她做code review。那个脾气倔的，嘴巴都嘟起来，一直抠脚。我的天，不过是聊聊天而已，说实话，心里有点晦气-&gt;什么鬼。<br>然后她跑上床，又开始看起来了。我说了三次她才停下来，厉害厉害。</p><p>第3天之后我就不必再写了，这人没救了。丢阿黄一个人在家，自己整天整夜看电视剧，沉迷的很。<br>最近工作也是不顺，整天还这么沉迷，“还一点点没看完，就快看完了”。<br>整天说，不准再打这么多游戏了；多写东西，别老打游戏；还撇着嘴，埋怨我整天打游戏。<br>我的天，我都很少打游戏好吧。<br>我打游戏有准则，她看视频都是没有限度的。她视电视剧犹如猛兽，所以老是说不看了，然而还是沉迷不止。<br>我觉得游戏是休闲，是比赛，我不觉得打游戏如何堕落。<br>她这简直是找抽。</p><h3 id="申明init-入口"><a href="#申明init-入口" class="headerlink" title="申明init 入口"></a>申明init 入口</h3><p>申明initWithURL:(id)xx 入口有两种方法。<br>1: initWithURL:(id)xx NS_DESIGNATED_INITIALIZER;使用宏提示其为为设计入口。<br>这时会出现：<br><!--https://blog.csdn.net/zcube/article/details/51657417--><br>如果用了NS_DESIGNATED_INITIALIZER，那么警告中出现init还是initWithNibName或是其它，取决于你的继承的父类类型：</p><p>UIViewController</p><p>Method override for the designated initializer of the superclass ‘-initWithNibName:bundle:’ not found<br>Method override for the designated initializer of the superclass ‘-initWithCoder:’ not found<br>UIView</p><p>Method override for the designated initializer of the superclass ‘-initWithFrame:’ not found<br>Method override for the designated initializer of the superclass ‘-initWithCoder:’ not found<br>NSObject</p><p>Method override for the designated initializer of the superclass ‘-init’ not found</p><p>那么就实现比如UIView 的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (instanceType)initWithFrame:(CGRect)frame &#123;return [self initWithURL:nil];&#125;</span><br><span class="line">- (instancetype)initWithCoder:(NSCoder *)aDecoder &#123;return [self initWithURL:nil];&#125;</span><br></pre></td></tr></table></figure></p><p>2: 把其他的入口设置为NS_UNAVAILABLE</p><h3 id="这几天上传两个APP-收到2-1-拒绝大礼包"><a href="#这几天上传两个APP-收到2-1-拒绝大礼包" class="headerlink" title="这几天上传两个APP 收到2.1 拒绝大礼包"></a>这几天上传两个APP 收到2.1 拒绝大礼包</h3><ol><li>首先是我写的一个房产计算器的项目。<br>一开始是因为在标题里面有<strong>免费</strong>的字样，去掉之后就出来2.1 大礼包了。<br>2.1 礼包说我这可能有隐藏功能、有贷款方面东西。</li></ol><p>我回复邮件说，我这绝对没有隐藏功能，也没有贷款方面的东西。因为觉得世面上的不好用、广告太多等，所以做了个这个功能。这个功能也是自主研发的，不是市面上的抄袭品。</p><ol start="2"><li>还有一个涂色的项目。<br>上来直接就是2.1 大礼包。<br>我猜测原因是我展示页面出现<strong>免费</strong>字样，引导了用户。还有就是可能有隐藏功能。</li></ol><p>目前这两个项目我都做了广告，所以也不具备广告功能。我回复涂色项目的，我们没有隐藏功能，免费是因为素材时设计师们的心血，但是为了分享这份灵感，所以使用免费，但是绝没有付费，更不用说，除苹果外的第三方付费了。<br>免费同时也因为市面上其他APP 都是要付费的，我们就专打免费策略。最后，我们删除了展示页面的那张带有<strong>免费</strong>字样的图片。 </p><p>最后再说一句：如果是原数据被拒绝，同时你认为不必要上传新的二进制，你就直接回复该邮件。<br>然后静静等待，不需要点击#提交以供审核#。如果点了，那么相当于重新审核，可能会等待7~8天。<br>相关帖子：<a href="http://www.cocoachina.com/bbs/read.php?tid-298671-page-1.html" target="_blank" rel="noopener">http://www.cocoachina.com/bbs/read.php?tid-298671-page-1.html</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-5-9lesson</title>
      <link href="/2018/05/20/2018-5-9lesson/"/>
      <url>/2018/05/20/2018-5-9lesson/</url>
      
        <content type="html"><![CDATA[<p>2018/04/23</p><h3 id="Clang-Attributes-黑魔法小记"><a href="#Clang-Attributes-黑魔法小记" class="headerlink" title="Clang Attributes 黑魔法小记"></a>Clang Attributes 黑魔法小记</h3><p><a href="http://blog.sunnyxx.com/2016/05/14/clang-attributes/#objc_requires_super" target="_blank" rel="noopener">http://blog.sunnyxx.com/2016/05/14/clang-attributes/#objc_requires_super</a></p><p>objc_subclassing_restricted</p><p>objc_requires_super</p><p>objc_boxable</p><p>constructor/desctructor</p><p>objc_runtime_name</p><h3 id="Mac-启动服务配置"><a href="#Mac-启动服务配置" class="headerlink" title="Mac 启动服务配置"></a>Mac 启动服务配置</h3><p>redis<br>start: redis-server /usr/local/etc/redis.conf<br>stop:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps axu|grep redis  ## 查找redis-server的PID</span><br><span class="line">kill -9 PID</span><br></pre></td></tr></table></figure><p>mysql<br>start<br>mysql-server start</p><h3 id="2018-05-07交涉"><a href="#2018-05-07交涉" class="headerlink" title="2018/05/07交涉"></a>2018/05/07交涉</h3><p>2017年2月来到粉粉，一开始一直学习进阶姿态。当时c哥来了不久，要成立一个海外团队。当时的人选是LPD(我猜的，毕竟我刚来不太久5月，而LPD 刚好在那个时候选择了回家发展)，后来大师、我、c哥去小会议室说明了计划，任务。<br>我在6、7月份的时候开始和c哥合作，为了合作更愉快，c哥甚至于搬到我位置边。那个时候我只想着更好的处理，学习，进阶，发展。是的，那个时候和他合作的一款绘图，简直让我开心不已，我和他不断交谈，不断完善。后来正要开始一款记账软件的时候，老板也已经没有耐心：没有产品思维，没有变现途径，当断则断的砍掉了该业务。当时我iOS、一个安卓、一个实习编辑(他的口头禅：原来是你小子，把皇君给我的好吃都给吃了回扣了)、c哥就此分开。实习编辑直接辞职；c哥也还想挽回一些结果，但还是回天乏力，于是也选择了离开；我和安卓又回到了之前的岗位了(好奇，我们居然不开掉了？虽然工资一年来没有变化，但是实力绝对学够了，幸好当时没离开，学到就是值);<br>c哥离开前给了我份设计稿，一种MetaBall 的设计记账软件。当时我花了九牛二虎之力，万分努力打磨出来。核心物件出来了，我们又继续打磨产品，打磨整个工程。一开始上线是在c哥账号，叫”Drop”， 后改名叫”小池记账”，再后来改名叫”小泉记账”；<br>真正的问题开始在2018年1月左右。<br>c哥打算喊我去他们公司开发。我心里思考是，如果我去了，按照c哥性格，我估计工资高不到哪去，肯定说什么创业啦，不要在意这么多啦，好好完成功能等等等；学的东西肯定也是不够的。<br>于是c哥说，能把源码给到他们。他的承诺是3个月10w 量，给我3w(我和他一人一半，算是6w)；我不看重这个，这个不是买断，也不是完全合作，我源码一给，相当于我没有任何有利地位了。最终做法：我同意3个月给他尝试，源码给他(核心效果代码做静态库处理，就这他还想要源码，说他们员工很轴，估计当时他就像独吞全部成果吧)，2500给我(相当于5000两人，我做事公平)；<br>我们当时有一款矢量图软件，我有“商店”，但是素材商品快速制作在于c哥手，直到2018年5月终于得到该技术，也就是2018年5月5日周六我前往他们公司，然后c哥终于回忆起来制作历程交付与我(其实教程我之前有一份不完整的，要提交给公司的，但是谁也看不懂，做不出来)。同时作为回馈，我给他们公司员工做一下技术指导，指导过程发现，他们公司的其他好几款其他APP，比如“Uki”，还有其他APP的核心代码都从我那份拷贝得来。这是技术流失。<br>然后如标题，2018年5月7号周一，我与c哥交涉“drop”下一步合作事宜，这天离当时已经有4月多之久(当时的考虑就是还没得到制作画画素材技术，不谈论该话题)；<br>当时我问这个话题的时候，他以为我要3w 的承诺；我说我知道没有10w 的量，但是3个月已过，接下来怎么继续合作；他还说接下来10w 日货，还是承诺2w；兄得，如果把所以权，都给你，就跟我没什么事一样了，拿到我所有源码就这么为所欲为么？那要这么说，我来替你运营，日活10个人，我给你1千万；那些没有意义的承诺。<br>我的字典里一直有句话：</p><blockquote><p>不要跟比自己境况差的人，讨价还价<br>更不要跟比自己有钱的人，抢着买单</p></blockquote><p>能让则让，小弟这么拼命给你干活，你就拿到我源码就“你要介意的话，我们下一版代码会重新写”；我的意思很简单，商业利益失败，朋友还要交的，c哥接下来一句“包括涂色的布局ui也不要用我的设计，既然在意就说清楚，大家都有知识产权对吧”，直接挑明了朋友都没得做。那算了，说明我的意义就这么大，就是那个有静态库的源码的价值。<br>行行行，你是项目负责人，全是你的成就。我啥都没有起到作用，毕竟代码书写被你改了嘛。<br>后来的几天，我全力工作，优化那个涂色项目。接下来其实我完全可以就这么卖了“drop”源码，或者开源了，反正对我意义不大，我的能力不是只有drop。得了芝麻“有静态库的源码”丢了西瓜。<br>之前这么崇拜你的我，也算清醒。我觉得我不太吃亏。对我来说，重要的是涂色项目，一个完整生态，商品和商店，而且可以量产。<br>其实回顾来说，我觉得做人真不必如此，你的钱是我10倍多，我连午饭都要去很远很远的食堂，晚饭省钱饿着回家吃的我，都不舍得花钱，有孩子要养，最近又有买房需求，再说，涂色素材技术本应回交公司，我当时还特意解决了c哥公司很多重大崩溃技术，我觉得您真不必如此。<br>最后一次尊重。您高升就好。“drop”我会留下自己开发，不然对你们公司肯定是致命的，毕竟全公司都花时间搞那个了，我公开出去，或者自己搞个差不多的，我的功能肯定比你多，开发比你快、稳定，然后就跟着你的ISO，蹭你们热量，你们会白做的！<br>接下来我继续加油，避开他以前的设计范畴，一些以前我也参与的设计我就不必客气，这不全是你的功劳，不全是你的成就。都是一起探讨出来的，当时我的努力，我身后要保护的人，都提醒我，该客气时客气，该凶时就该认真对待了！<br>之前去他们公司，看他们的代码，确实，一个成功的产品，开发的人还是很重要的。代码规范，模块划分。我猜想，c哥现在公司应该开不久，或者说开不大。<br>前几天开了些文章，他国对中国封锁核弹、氢弹技术，中国克服困难做出来了；他国对中国封锁航天技术，中国又突出重围。我想我也正需要这股拼劲。这几天硬着头皮，老婆小小的学了把一个方便设计的软件，我自己搞了搞ps，把开源的声音、字体、图片等都找全；<br>给自己软件做东西，你会发现，你总是这个做简单点，那个可以省略就省略吧。于是做的总是自己都不满意。回头想想，你给公司做的时候你会这样么？你肯定是硬着头皮也要搞出来，能搞出来的就搞得更好那种。<br>你要的是，把做公司的那种态度用到写自己的上面，同时，规划好时间，集中精力攻破难关。<br>这次学到的东西也很多很多，同时也警醒自己，有些事情一定要思考思考在思考，一定不能出大错。这次错误，算是损失，但是很能忍。<br>毕竟也学了那么多，同时还长进了这么多。<br>应该应该的，小弟就该吃糠，小弟家人就是垃圾，不应该有这么多思想，不应该要求这么多。<br>timestamp: 2018/5/9 田小新</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018-04-22lesson</title>
      <link href="/2018/04/22/2018-04-22lesson/"/>
      <url>/2018/04/22/2018-04-22lesson/</url>
      
        <content type="html"><![CDATA[<p>2018/03/14</p><h3 id="公司引入零食架，却得”破损率”一说"><a href="#公司引入零食架，却得”破损率”一说" class="headerlink" title="公司引入零食架，却得”破损率”一说"></a>公司引入零食架，却得”破损率”一说</h3><p>听到#破损率#这事情，这种说法，我不能接受。<br>作为企业员工，我不觉得该事件缘由仅因为该无由头的数据，然后单方面说退出，然后就过去了。<br>我坐在公司，我作为公司一份子，和大家相处，我不觉得#破损率# === #物品丢盗#!!!<br>或许#破埙率#没有直接了当说明其 === #物品丢盗#，但是各位同事心中其实已经对其隐喻画上等号。</p><ol><li>“破损率”由总量和当前剩余量以及所得量(金额 以下称“所得金”)有关。</li><li>总量由该公司清点，当前剩余量也由该公司清点</li><li>所得金数据也由该公司清点。</li></ol><p>商品购买模式：<br>购买者在商品架直接挑选；<br>微信网页内购买，选中相应商品、数量。付款。</p><p>购买操作复杂，且可能多操作和误操作等无法模拟数据对等情况。<br>对于用户而言，如果卖方没能提供舒适操作，而且没有更多措施防止其己身损失，我想这不是用户的错，这是人的错，或者是，该种买卖信用机制是有问题的。<br>这种将一切信任丢给用户，如果该企业勘察数据到一定量就提出“破损率” 超过xxx，然后退出、无其他正确发言。我觉得一开始就应该提出有这种“商业模式”，或者称“全靠用户信用交易模式”。即使“破损率”接受范围为99%，我觉得该破损情况都有可能变为100%。<br>中间有太多的突破和漏洞:</p><ol><li>该企业下单，指定数量、种类、时间等到相应公司；</li><li>相关商品从仓库到达指定销售架；</li><li>商品从开始卖，隔数天就有人抽查；</li><li>清点“破损率”</li></ol><p>以上的2、3、4点都有可能有问题。<br>“三方”：买方、物品运送过程、清点过程人员以及购买页面的操作方。</p><p>对于一个无法真正确定是否购买，购买流程是否是闭环，那么就会出现其他流程可以做手脚的机会。因为即使做手脚也可能说“破损率”。<br>那么多的疑点，却全由“破损率”，也即我所在公司内部员工心中已有的定义#物品丢盗# 承担。我没有说是否引进这种便捷小零食商架带来的更多的便利，但带来的负面影响却对公司内部营造的团结、互助、信任带来损害。</p><p>综上所述，我不能接受“破损率”一说。</p><h3 id="coreData中integer16-integer32-integer64的区别"><a href="#coreData中integer16-integer32-integer64的区别" class="headerlink" title="coreData中integer16,integer32,integer64的区别"></a>coreData中integer16,integer32,integer64的区别</h3><p>摘抄自: <a href="http://blog.csdn.net/juyufeng_huazhu/article/details/50239699" target="_blank" rel="noopener">http://blog.csdn.net/juyufeng_huazhu/article/details/50239699</a><br>Integer 16 can have minimum value of -32,768 to 32,767<br>Integer 32 can have minimum value of -2,147,483,648 to 2,147,483,647<br>Integer 64 can have minimum value of -very large to very large</p><h3 id="在viewDidLoad处理完的200ms-如果获取得到数据-那么用户将会无感空白过程"><a href="#在viewDidLoad处理完的200ms-如果获取得到数据-那么用户将会无感空白过程" class="headerlink" title="在viewDidLoad处理完的200ms 如果获取得到数据 那么用户将会无感空白过程"></a>在viewDidLoad处理完的200ms 如果获取得到数据 那么用户将会无感空白过程</h3><h3 id="MAC-查看端口占用"><a href="#MAC-查看端口占用" class="headerlink" title="MAC 查看端口占用"></a>MAC 查看端口占用</h3><p>命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lsof -i tcp:port （list open files）</span><br><span class="line">KILL port</span><br></pre></td></tr></table></figure><p>（port替换成端口号，比如6379）可以查看该端口被什么程序占用，并显示PID，方便KILL</p><h3 id="React-CSS-布局"><a href="#React-CSS-布局" class="headerlink" title="React CSS 布局"></a>React CSS 布局</h3><p>父容器的style 需要使用flex 魔盒布局时，是要添加display: flex<br>原因是其默认是display: block<br>最终如 :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.row1 &#123;</span><br><span class="line">    padding: 30px;</span><br><span class="line">    /* align-content: space-around; */</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    background-color: blue;</span><br><span class="line">    #display: flex#</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="运行麒麟子工程代码"><a href="#运行麒麟子工程代码" class="headerlink" title="运行麒麟子工程代码"></a>运行麒麟子工程代码</h3><p>server 有个start_all_mac.sh 的python 脚本，直接开三个terminal 运行各个句子, 注意点：启动顺序是:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node ./hall_server/app.js ../configs_mac.js</span><br><span class="line">node ./account_server/app.js ../configs_mac.js</span><br><span class="line">node ./game_server/app.js ../configs_mac.js</span><br></pre></td></tr></table></figure><p>先开启hall 然后account, 然后game, 不然报错;<br>client 使用scenes：start.scene; 当前CocoaCreator v：1.8; 在运行时出现loadResource 方法找不到：直接注释，直接进入loadScene；<br>浏览器比如： localhost:5876?account=xxx;<br>置顶不同的account 即可debug 测试</p><h3 id="pod-更新出错。重点是brew-link-libyaml"><a href="#pod-更新出错。重点是brew-link-libyaml" class="headerlink" title="pod 更新出错。重点是brew link libyaml"></a>pod 更新出错。重点是brew link libyaml</h3><p><a href="https://stackoverflow.com/questions/9434002/how-to-solve-ruby-installation-is-missing-psych-error" target="_blank" rel="noopener">https://stackoverflow.com/questions/9434002/how-to-solve-ruby-installation-is-missing-psych-error</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew doctor</span><br><span class="line">$ brew link libyaml</span><br></pre></td></tr></table></figure><h3 id="cocoapod-更新极其缓慢，翻墙还是慢"><a href="#cocoapod-更新极其缓慢，翻墙还是慢" class="headerlink" title="cocoapod 更新极其缓慢，翻墙还是慢"></a>cocoapod 更新极其缓慢，翻墙还是慢</h3><p>翻墙可以连接外网了，但是还是很慢。按理不会的，但是原因却在于：翻墙时，浏览器proxy 地址改过，但是terminal 却没有改动，相当于没有翻墙。<br><a href="http://lovean.net/?id=185" target="_blank" rel="noopener">http://lovean.net/?id=185</a><br>使用#export  ALL_PROXY=socks5://127.0.0.1:1080# 将所有proxy 改为该端口，这是翻墙，就非常快了。<br>使用#curl -i <a href="http://ip.cn#" target="_blank" rel="noopener">http://ip.cn#</a> 可以查看当前外网地址看是否翻墙成功</p><h3 id="同源策略、跨域解决方案"><a href="#同源策略、跨域解决方案" class="headerlink" title="同源策略、跨域解决方案"></a>同源策略、跨域解决方案</h3><p><a href="https://www.cnblogs.com/rockmadman/p/6836834.html" target="_blank" rel="noopener">https://www.cnblogs.com/rockmadman/p/6836834.html</a></p><h3 id="自己的centos-操作"><a href="#自己的centos-操作" class="headerlink" title="自己的centos 操作"></a>自己的centos 操作</h3><p>查看redis在哪个processID<br>ps -ef |grep redis</p><p>redis<br>/etc/redis-4.09<br>配置：redis.conf<br>    daemonize no<br>protected-mode yes<br>启动和关闭：<br>                /src<br>                    ./redis-server ../redis.conf     启动redis<br>                    ./redis-cli shutdown        关闭redis</p><p>mysql开启<br>service mysqld start</p><p>git download nvm<br>nvm conf 配置:<br>vim ~/.bashrc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#nvm</span><br><span class="line">export NVM_DIR=&quot;/root/GIT/nvm/&quot;</span><br><span class="line">source &quot;$NVM_DIR/nvm.sh&quot;</span><br></pre></td></tr></table></figure></p><p>保存之后<br>source ~/.bashrc（修改也需要重启）<br>PATH 和 source ./<br>nvm use 8.11.1<br>这样就可以使用8.11.1 版本的node<br>node -v<br>npm -v</p><p>terminal<br>查找某个文件<br>whereis nginx</p><p>cd nginx<br>配置<br>$vim conf/nginx.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 末尾括号外面加上下面这一行</span><br><span class="line">include ./vhost/*.conf;</span><br></pre></td></tr></table></figure></p><p>创建vhost/<a href="http://www.lsgood.top.conf" target="_blank" rel="noopener">www.lsgood.top.conf</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">http</span><br><span class="line">&#123;</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">listen 80;//通用80端口</span><br><span class="line">server_name lsgood.top;</span><br><span class="line">root /root/Blog;//声明目录</span><br><span class="line">index index.html;//html 目录</span><br><span class="line">location / &#123;//这个很重要</span><br><span class="line">proxy_set_header Host $host;</span><br><span class="line">proxy_set_header x-real-ip $remote_addr;</span><br><span class="line">proxy_set_header x-forwarded-for $proxy_add_x_forwarded_for;</span><br><span class="line">proxy_pass http://127.0.0.1:3000/;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后./nginx/sbin/nginx -t</p><p>启动nginx :<br>[root nginx] $./sbin/nginx<br>[root nginx] $./sbin/nginx -c ./conf/nginx.conf<br>reload stop nginx :<br>[root nginx] $./sbin/nginx -s reload/stop</p><p>查看启动服务<br>netstat -nltp<br>查看所有进程<br>ps -ef<br>ps -ef |grep mysql/redis/node/nginx</p><p>修改host<br>vim /etc/hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 lsgood.top</span><br></pre></td></tr></table></figure></p><p>然后ping lsgood.top</p><p>curl <a href="http://lsgood.top" target="_blank" rel="noopener">http://lsgood.top</a><br>curl 127.0.0.1:3000</p><p>腾讯解析域名网站<br>DNSPOD</p><p>ll == ls -l<br>ls -a</p><p>填写nginx.conf<br>参照多个域名同时对应多个路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#最下面添加如</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">a.lsgood.top</span><br><span class="line">location / &#123;</span><br><span class="line">127.0.0.1:3000</span><br><span class="line">&#125;</span><br><span class="line">location /other0/ &#123;</span><br><span class="line">127.0.0.1:3001</span><br><span class="line">&#125;</span><br><span class="line">location /other1/ &#123;</span><br><span class="line">127.0.0.1:3002</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">b.lsgood.top</span><br><span class="line">location / &#123;</span><br><span class="line">127.0.0.1:7000</span><br><span class="line">&#125;</span><br><span class="line">location /other0/ &#123;</span><br><span class="line">127.0.0.1:7001</span><br><span class="line">&#125;</span><br><span class="line">location /other1/ &#123;</span><br><span class="line">127.0.0.1:7002</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>阿里云域名购买<br>/域名-解析<br>    /添加解析<br>        /主机记录选填 “*” 子域名前缀<br>        /记录值填写自己的主机IP, 如176.122.191.87</p><h3 id="我的服务器操作"><a href="#我的服务器操作" class="headerlink" title="我的服务器操作"></a>我的服务器操作</h3><pre><code>·    后台更换    完成·    首页每次需要下载素材bug  完成•    tabbar 栏目图片更换    完成·    banner·    section 栏目 完成50%    完成</code></pre><p>查看redis在哪个processID<br>ps -ef |grep redis</p><p>redis<br>/etc/redis-4.09<br>配置：redis.conf<br>    daemonize no<br>protected-mode yes<br>启动和关闭：<br>                /src<br>                    ./redis-server ../redis.conf     启动redis<br>                    ./redis-cli shutdown        关闭redis</p><p>mysql开启<br>service mysqld start</p><p>git download nvm<br>nvm conf 配置:<br>vim ./.bashrc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#nvm</span><br><span class="line">export NVM_DIR=&quot;/root/GIT/nvm/&quot;</span><br><span class="line">source &quot;$NVM_DIR/nvm.sh&quot;</span><br></pre></td></tr></table></figure></p><p>保存之后<br>source ~/.bashrc（修改也需要重启）<br>PATH 和 source ./<br>nvm use 8.11.1<br>这样就可以使用8.11.1 版本的node<br>node -v<br>npm -v</p><p>terminal<br>查找某个文件<br>whereis nginx</p><p>cd nginx<br>配置<br>$vim conf/nginx.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 末尾括号外面加上下面这一行</span><br><span class="line">include ./vhost/*.conf;</span><br></pre></td></tr></table></figure></p><p>创建vhost/<a href="http://www.lsgood.top.conf" target="_blank" rel="noopener">www.lsgood.top.conf</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">http</span><br><span class="line">&#123;</span><br><span class="line">server&#123;</span><br><span class="line">listen 80;//通用80端口</span><br><span class="line">server_name lsgood.top;</span><br><span class="line">root /root/Blog;//声明目录</span><br><span class="line">index index.html;//html 目录</span><br><span class="line">location / &#123;//这个很重要</span><br><span class="line">proxy_set_header Host $host;</span><br><span class="line">      proxy_set_header x-real-ip $remote_addr;</span><br><span class="line">      proxy_set_header x-forwarded-for $proxy_add_x_forwarded_for;</span><br><span class="line">      proxy_pass http://127.0.0.1:3000/;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后./nginx/sbin/nginx -t</p><p>启动nginx/sbin/nginx</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018/3/4Lesson</title>
      <link href="/2018/03/04/2018-3-3lesson/"/>
      <url>/2018/03/04/2018-3-3lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/10/12</p><h3 id="Xcode-9-beta-3-breaks-the-new-os-log-logger-883"><a href="#Xcode-9-beta-3-breaks-the-new-os-log-logger-883" class="headerlink" title="Xcode 9 beta 3 breaks the new os_log logger #883"></a>Xcode 9 beta 3 breaks the new os_log logger #883</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">if (message) &#123;</span><br><span class="line">        const char *msg = [message UTF8String];</span><br><span class="line">        switch (logMessage-&gt;_flag) &#123;</span><br><span class="line">            case DDLogFlagError     :</span><br><span class="line">                os_log_error(OS_LOG_DEFAULT, &quot;%s&quot;, msg);</span><br><span class="line">                break;</span><br><span class="line">            case DDLogFlagWarning   :</span><br><span class="line">            case DDLogFlagInfo      :</span><br><span class="line">                os_log_info(OS_LOG_DEFAULT, &quot;%s&quot;, msg);</span><br><span class="line">                break;</span><br><span class="line">            case DDLogFlagDebug     :</span><br><span class="line">            case DDLogFlagVerbose   :</span><br><span class="line">            default                 :</span><br><span class="line">                os_log_debug(OS_LOG_DEFAULT, &quot;%s&quot;, msg);</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="记一下昨晚2017-10-30-学习拆换苹果手机电池过程"><a href="#记一下昨晚2017-10-30-学习拆换苹果手机电池过程" class="headerlink" title="记一下昨晚2017/10/30 学习拆换苹果手机电池过程"></a>记一下昨晚2017/10/30 学习拆换苹果手机电池过程</h3><p>1：手机底部螺丝拧开<br>2：用提供的吸盘将屏幕吸起（可以用个牙签什么的顶住，然后一一打开）<br>3：将电池右下角的一个金属盖拧开，有两个螺丝<br>4：此时已经可以拔起该连接线<br>接下来几步是重点：<br>5：刮下电池底部膜，刮到出现白色黏条<br>6：白色黏条最重要！：慢慢把他抽出来。<br>总共左右两条黏条，千万不要抽断，不然要翘起电池，用牙签或其他方便工具卷着给他抽出来。<br>7：然后于是就把电池取出来了。<br>8：装上新电池，测试一下能不能成功开机。<br>9：买电池会送白色黏条。这时留一点在外面，白色黏条箭头在顶部。先把白色黏条黏在电池底部，然后黏在电池仓。<br>10：按着之前方式拧上螺丝，合上盖。<br>完成</p><h3 id="git-回退到本地commit的某个SHA-1"><a href="#git-回退到本地commit的某个SHA-1" class="headerlink" title="git 回退到本地commit的某个SHA-1"></a>git 回退到本地commit的某个SHA-1</h3><p>根据-–soft -–mixed -–hard，会对working tree和index和HEAD进行重置:<br>    git reset -–mixed：此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息<br>    git reset -–soft：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可<br>    git reset -–hard：彻底回退到某个版本，本地的源码也会变为上一个版本的内容</p><p>例如：git reset –hard SHA-1   此时的SHA-1 可以使用sourcetree 查看；或者使用git log 也可查看到该SHA-1</p><h3 id="iOS-手机震动"><a href="#iOS-手机震动" class="headerlink" title="iOS 手机震动"></a>iOS 手机震动</h3><p>// 普通短震，3D Touch 中 Peek 震动反馈<br>AudioServicesPlaySystemSound(1519);</p><p>// 普通短震，3D Touch 中 Pop 震动反馈<br>AudioServicesPlaySystemSound(1520);</p><p>// 连续三次短震<br>AudioServicesPlaySystemSound(1521);</p><h3 id="这里记录一次昨天下午讨论团队职业规划过程及感悟"><a href="#这里记录一次昨天下午讨论团队职业规划过程及感悟" class="headerlink" title="这里记录一次昨天下午讨论团队职业规划过程及感悟"></a>这里记录一次昨天下午讨论团队职业规划过程及感悟</h3><p>既然是团队职业规划，那当时是要将团队提升作为目标。<br>个人升级是最重要，自己不升级，怎么有话题，如何跟别人谈共享、交流、提升？<br>OK，自己升级，学习完，交流，交流之中补足，这很好。<br>最近任务要稍微好些，比刚从海外团队回来时间要充沛一些。早上从10点开始搞，基本下午进度好，能在8点左右完成，回家。此时基本整个人再也不想看电脑屏幕了，我想吐~~~咦，你不是热爱写代码吗？我去你妈的热爱写代码，去你妈的热爱。热爱是建立的单纯的想写代码，当和职业挂钩，每天重重复复，去你妈的还能每时每刻保有最初的心。<br>接着回到家，嗯，团队升级嘛，但是自己还有挺多的事，比如我自己手上还有3、4个小玩意进度才开启；哦，我还没吃饭，世界最好吃的饭是陪家人，于是等老婆也累的半死回到家，俩人在21点到22：20之间吃完饭。这时心里有点空荡荡的，接下来的时间每天比例，一半休息掉（再嘴里吼着“不能浪费时间，学习工作”的，你把头伸过来，大哥给你看个宝贝），另一半写自己的小东西，探索道路。玩能到12点半，工作也能到12点半。<br>第二天早上来，把公司所为的“两小时一次记录工作了啥”的邮件发了。真不知道这“两小时”记录是什么鬼，写重复的也不是，但是不写，更不是，又是心里一句去他妈的, 当然知道这是上上上层安排的，对大师博士还是一如既往尊敬。<br>周六是单双休，周日是都有休息。周六当时的规定是到公司学习，补足，交流，如果工作有没完成的，可以完成。你懂得，工作太足，就怕你闲着，怕你闲出病到时按工伤就不好了，于是基本周六都是工作木有两样。之前我有过思路：如果早上把PPT 赶好，中午的时候和大家交流最近学习、工作进展。那这挺好。但是从来周六都是工作，嘿嘿，这理由真他妈给力。周六要不就是我单纯学习自己的小知识点，但是能拿来讲的没能汇聚，只能自己独自搞一些小工程进行最佳实践。所以大师那句，“都没见你分享几篇”，给蛋疼的，不是不想不愿，而是无时无力。<br>“时间是挤出来的”<br>谁谁谁，这句话谁说的，把头伸过来，我给他看个宝贝。<br>你有生活，我没有生活的啊？你每天都能跟狗一样学习，不知疲倦？每天还跟大学一般拼了这条狗命的？<br>是的，我工作时候用心，我特么在工作中确实拼了这条狗命。每天下班都是难得休息，难得让脑袋放空。<br>团队提升，团队职业规划。这些都是要建立良好的机制，良好的环境。我特么自己忙的死了，还要陪他们玩团队职业规划的游戏。<br>我曰。<br>每天自己加油了。只能自己Add Oil了。<br>之前也有几次，他们讲一些知识，我去学习听讲。如果有机会，我就只能当做code review 来跟进。这是最好的结果了。<br>当然，一切建立在，周六上午能空闲一下的基础上。</p><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>1：由于用到贴图，网上寻觅不得.<br>只说 UIGraphicsBeginImageContext(&lt;#CGSize size#&gt;)-&gt;换成UIGraphicsBeginImageContextWithOptions(&lt;#CGSize size#&gt;,&lt;#Bool opaque#&gt;,&lt;#CGFloat scale#&gt;)<br>上面这句话是重点 scale是缩放因子，使用[UIScreen mainScreen].scale即可；<br>中间的opaque是识别里面有没有alpha通道，如果有通道则填入NO，相反的哦；<br>size则为你的图片的大小，比如上面一张大图，下面一张watermark，这size为大图的大小，毕竟大图在下面，第一个放入的； 这样子图片就会变为高清！！！没错，如果还没有变为高清，是有另一个原因的，那就是你的贴图不是@2x或者@3x的倍率，将其放入图片文件夹或者source，加入后缀，一定使用@3x，@2x也不怎么清晰！！！<br>最后一步才是本文重点.<br>网上没人说，自己尝试出来的</p><p>这一段是苹果私密api，用来找出Reveal的各个APP的bundleID，挺好用的<br>// Class<br>LSApplicationWorkspace_class = objc_getClass(“LSApplicationWorkspace”);<br>//<br>NSObject<em> workspace = [LSApplicationWorkspace_class performSelector:@selector(defaultWorkspace)];<br>//<br>NSArray </em>array = [workspace performSelector:@selector(allApplications)];<br>// id a = array[0];<br>//<br>NSLog(@”apps: %@”, [workspace performSelector:@selector(allApplications)]);</p><h3 id="ASOverLayoutSpec"><a href="#ASOverLayoutSpec" class="headerlink" title="ASOverLayoutSpec"></a>ASOverLayoutSpec</h3><p>这里用到ASStackLayoutSpec 布局。之前都是从上往下布局完，样式OK。<br>但是新的需求来了，要求在其上面加上一个蒙版：<br>布局，我使用ASBackgroundLayoutSpec child 是上面的蒙版；back 是之前的背景布局；<br>但是总是出现拉伸；<br>后来试试使用ASOverLayoutSpec 返回来，试图终于如愿了。</p><h3 id="最近在学习js"><a href="#最近在学习js" class="headerlink" title="最近在学习js"></a>最近在学习js</h3><p>看阮一峰的文章ing…<br>从其早期JavaScript 文章往现在的时间线看。边看边敲command+shift+i<br>看廖雪峰JavaScript 文章</p><h3 id="scrollView-contentSize"><a href="#scrollView-contentSize" class="headerlink" title="scrollView.contentSize"></a>scrollView.contentSize</h3><p>如果scrollView 不想上下出现拉动bug，将contentSize.height 设为0；否则contentSize.width 设为0；会默认设置为等大小试图</p><h3 id="2018-1-10打包静态库-包含第三方库"><a href="#2018-1-10打包静态库-包含第三方库" class="headerlink" title="2018/1/10打包静态库(包含第三方库)"></a>2018/1/10打包静态库(包含第三方库)</h3><p><a href="https://www.jianshu.com/p/155a3cfb765e?utm_campaign=hugo" target="_blank" rel="noopener">https://www.jianshu.com/p/155a3cfb765e?utm_campaign=hugo</a><br><a href="https://www.jianshu.com/p/13bf46df9387" target="_blank" rel="noopener">https://www.jianshu.com/p/13bf46df9387</a><br>1：此处注意一点：需要输出包含有第三方的静态库，那么直接在拖进控件的时候不要选择”add to target”;<br>2：在Build Phrase 的compile Source 确认需要到处的多少个类<br>3：设置适配所有模拟器架构 project -&gt; buildSeting -&gt; Build Active Architecture Only 设为NO<br>以上两个目录把所有需要打包静态库的步骤和所需操作都罗列了。</p><h3 id="创建podSpec"><a href="#创建podSpec" class="headerlink" title="创建podSpec"></a>创建podSpec</h3><p><a href="https://www.jianshu.com/p/d7d1942dd3f1" target="_blank" rel="noopener">https://www.jianshu.com/p/d7d1942dd3f1</a><br>此处source 需要把目录改为对应目录。比如里面的文件夹需要/xxx/$.h/m</p><h3 id="记录一次粉粉匿名做动画CAAnimation-的keyframe-动画和POP-动画同时存在产生的问题"><a href="#记录一次粉粉匿名做动画CAAnimation-的keyframe-动画和POP-动画同时存在产生的问题" class="headerlink" title="记录一次粉粉匿名做动画CAAnimation 的keyframe 动画和POP 动画同时存在产生的问题"></a>记录一次粉粉匿名做动画CAAnimation 的keyframe 动画和POP 动画同时存在产生的问题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">POPAnimatableProperty *property = [POPAnimatableProperty propertyWithName:@&quot;com.ffrj.starMove&quot; initializer:^(POPMutableAnimatableProperty *prop) &#123;</span><br><span class="line">                prop.writeBlock = ^(CALayer *obj, const CGFloat *values) &#123;</span><br><span class="line">                    CGFloat currentTime = values[0];</span><br><span class="line">                    obj.timeOffset = currentTime;</span><br><span class="line">                &#125;;</span><br><span class="line">                prop.threshold = 0.01;</span><br><span class="line">            &#125;];</span><br><span class="line">            POPBasicAnimation *animation = [POPBasicAnimation animation];</span><br><span class="line">            animation.fromValue = @0;</span><br><span class="line">            animation.duration = 0;</span><br><span class="line">            animation.property = property;</span><br><span class="line">            [popArr addObject:animation];</span><br><span class="line">            //</span><br><span class="line">            CGPoint startPoint = YYTextCGRectGetCenter(starBtn.frame);</span><br><span class="line">            CGPoint endPoint = CGPointMake((i+1)*minScaleWidth+30, 35+kTopStatusBarAndNavHeight);</span><br><span class="line">            CGPoint controlPoint = CGPointMake((endPoint.x+30), (YYTextCGRectGetCenter(starBtn.frame).y-endPoint.y)/2.0);</span><br><span class="line">            UIBezierPath *path = [UIBezierPath bezierPath];</span><br><span class="line">            [path moveToPoint:startPoint];</span><br><span class="line">            [path addQuadCurveToPoint:endPoint controlPoint:controlPoint];</span><br><span class="line">            CAKeyframeAnimation *positionAnimation = [CAKeyframeAnimation animation];</span><br><span class="line">            positionAnimation.keyPath = @&quot;position&quot;;</span><br><span class="line">            positionAnimation.path = path.CGPath;</span><br><span class="line">            CABasicAnimation *scaleAnimation = [CABasicAnimation animationWithKeyPath:@&quot;transform.scale&quot;];</span><br><span class="line">            scaleAnimation.fromValue    = @1;</span><br><span class="line">            scaleAnimation.toValue      = @0.0;</span><br><span class="line">            CABasicAnimation *opacityAnimation = [CABasicAnimation animationWithKeyPath:@&quot;opacity&quot;];</span><br><span class="line">            opacityAnimation.fromValue  = @1.0;</span><br><span class="line">            opacityAnimation.toValue    = @0.0;</span><br><span class="line">            CAAnimationGroup *animationGroup = [CAAnimationGroup animation];</span><br><span class="line">            [animationGroup setAnimations:@[positionAnimation,scaleAnimation, opacityAnimation]];</span><br><span class="line">            animationGroup.duration = 1.0;</span><br><span class="line">            animationGroup.removedOnCompletion=NO;</span><br><span class="line">            animationGroup.fillMode=kCAFillModeForwards;</span><br><span class="line">            [starBtn.layer addAnimation:animationGroup forKey:@&quot;animationGroup&quot;];</span><br><span class="line">            starBtn.layer.speed = 0.0;</span><br></pre></td></tr></table></figure><p>上面是加了CAAnimation 动画， 但是同时还加入了POP 某一个animation 的上下浮动位移动画:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">if (!_startedAnimated) &#123;</span><br><span class="line">        _startedAnimated = YES;</span><br><span class="line">        [self.starArray enumerateObjectsUsingBlock:^(UIButton * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">            POPBasicAnimation *basicAnimation = [POPBasicAnimation animationWithPropertyNamed:kPOPLayerPositionY];</span><br><span class="line">            basicAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">            basicAnimation.duration = 1.3;</span><br><span class="line">            basicAnimation.beginTime = CACurrentMediaTime()+(arc4random()%30*0.033);</span><br><span class="line">            basicAnimation.toValue = @(obj.centerY-8);</span><br><span class="line">            basicAnimation.autoreverses = YES;</span><br><span class="line">            basicAnimation.repeatForever = YES;</span><br><span class="line">            [obj.layer pop_addAnimation:basicAnimation forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这时出现了浮动POP 动画无法启动情况。<br>这里处理为: 在 prop.writeBlock 里面，使用贝塞尔数值计算进行位移。</p><h3 id="这里记录一次js-function-和箭头函数不同点"><a href="#这里记录一次js-function-和箭头函数不同点" class="headerlink" title="这里记录一次js function 和箭头函数不同点"></a>这里记录一次js function 和箭头函数不同点</h3><ul><li>function 里面的this 指针是内部函数，外部需要const 一个。</li></ul><p>箭头函数 由于内部将this 置空，他是没有this 的，他的this 属于外部调用的。同时，由于没有this 指针，所以其arguments 也是undefined 的。</p><ul><li>module.export = xxx / exports default xxx / export = xxx 区别</li></ul><h3 id="写一个比较简洁的iOS-并发获取数据，combine-之后返回"><a href="#写一个比较简洁的iOS-并发获取数据，combine-之后返回" class="headerlink" title="写一个比较简洁的iOS 并发获取数据，combine 之后返回"></a>写一个比较简洁的iOS 并发获取数据，combine 之后返回</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">- (void)getPlannerRShopBanner</span><br><span class="line">&#123;</span><br><span class="line">    @weakify(self);</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">        @strongify(self);</span><br><span class="line">        __block NSArray *recommandArray = nil;</span><br><span class="line">        __block NSArray *plannerNewsArray = nil;</span><br><span class="line">        __block NSUInteger count = 0;</span><br><span class="line">        dispatch_semaphore_t semaphore_t = dispatch_semaphore_create(0);</span><br><span class="line">        [self.apiSession getPlannerShopBannerAndCallback:^(NSArray *model, PCError *error) &#123;</span><br><span class="line">            if (isValidArray(model) &amp;&amp; model.count &gt; 0) &#123;</span><br><span class="line">                count ++;</span><br><span class="line">                recommandArray = model;</span><br><span class="line">                if (count == 2) &#123;</span><br><span class="line">                    dispatch_semaphore_signal(semaphore_t);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                dispatch_semaphore_signal(semaphore_t);</span><br><span class="line">            &#125;</span><br><span class="line">            [self autoSavePlannerDataChange];</span><br><span class="line">        &#125;];</span><br><span class="line">        [self.apiSession getNewPlannerBannerCallback:^(NSArray *model, PCError *error) &#123;</span><br><span class="line">            if (isValidArray(model) &amp;&amp; model.count &gt; 0) &#123;</span><br><span class="line">                count ++;</span><br><span class="line">                plannerNewsArray = model;</span><br><span class="line">                if (count == 2) &#123;</span><br><span class="line">                    dispatch_semaphore_signal(semaphore_t);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                dispatch_semaphore_signal(semaphore_t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">        dispatch_semaphore_wait(semaphore_t, DISPATCH_TIME_FOREVER);</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            if (count == 2) &#123;</span><br><span class="line">                dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                    self.view.headerRecommandDict = [recommandArray firstObject];</span><br><span class="line">                    self.view.headerPlannerNewsDict = [plannerNewsArray firstObject];</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                DLog(@&quot;没有获取到ad 或者某个ad 获取失败&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="这里记录一个前端在解析json字符串-内容包含-n-产生无法解析且报错情景"><a href="#这里记录一个前端在解析json字符串-内容包含-n-产生无法解析且报错情景" class="headerlink" title="这里记录一个前端在解析json字符串,内容包含#\n# 产生无法解析且报错情景"></a>这里记录一个前端在解析json字符串,内容包含#\n# 产生无法解析且报错情景</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if ([json containsString:@&quot;\n&quot;]) &#123;</span><br><span class="line">        json = [json stringByReplacingOccurrencesOfString:@&quot;\n&quot; withString:@&quot;\\u000A&quot;];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>首先解决方案如上，在解析前先替换该字符为ascii码。</p><p>出现的错误：<code>Printing description of error:Error Domain=NSCocoaErrorDomain Code=3840 &quot;Unescaped control character around character 90.&quot; UserInfo={NSDebugDescription=Unescaped control character around character 90.}</code></p><p>出现的类似语句:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"font"</span>:&#123;&#125;,<span class="attr">"stickDate"</span>:<span class="string">""</span>,<span class="attr">"bookId"</span>:<span class="number">18558</span>,<span class="attr">"diaryType"</span>:<span class="number">0</span>,<span class="attr">"diaryEmotionNode"</span>:&#123;<span class="attr">"content"</span>:<span class="string">"1♡</span></span><br><span class="line"><span class="string">可乐要加冰</span></span><br><span class="line"><span class="string">柠檬要加水</span></span><br><span class="line"><span class="string">我的生活要加你</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">咖啡要加糖</span></span><br><span class="line"><span class="string">披萨要加盐</span></span><br><span class="line"><span class="string">我们的感情要加点油</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">别说什么东南西北都是你</span></span><br><span class="line"><span class="string">别说什么天涯海角都是你</span></span><br><span class="line"><span class="string">别说什么心里眼里都是你</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我只需要你说</span></span><br><span class="line"><span class="string">你的生活加点我.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">或者给我一条人生建议</span></span><br><span class="line"><span class="string">让我和你在一起.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">感情不要甜言蜜语</span></span><br><span class="line"><span class="string">不要纠缠不休.</span></span><br><span class="line"><span class="string">只需要一句“我喜欢你”</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">感谢收听悦兮电台第六期《要加点你》</span></span><br><span class="line"><span class="string">我是主播:苏雨诺</span></span><br><span class="line"><span class="string">编辑:苏雨纤</span></span><br><span class="line"><span class="string">写文:江抒</span></span><br><span class="line"><span class="string">本次播音结束，请大家期待下一期～"</span>,<span class="attr">"imageList"</span>:[]&#125;,<span class="attr">"geo"</span>:&#123;<span class="attr">"region"</span>:<span class="string">"普陀区"</span>,<span class="attr">"city"</span>:<span class="string">"上海市"</span>,<span class="attr">"address"</span>:<span class="string">"上海市普陀区云岭东路靠近东渡国际嘉庭广场"</span>,<span class="attr">"longitude"</span>:<span class="string">"121.387844"</span>,<span class="attr">"latitude"</span>:<span class="string">"31.222706"</span>,<span class="attr">"name"</span>:<span class="string">"东渡国际嘉庭广场"</span>,<span class="attr">"province"</span>:<span class="string">"上海市"</span>&#125;,<span class="attr">"lbsChange"</span>:<span class="number">0</span>,<span class="attr">"lbs"</span>:&#123;<span class="attr">"region"</span>:<span class="string">"普陀区"</span>,<span class="attr">"city"</span>:<span class="string">"上海市"</span>,<span class="attr">"address"</span>:<span class="string">"上海市普陀区云岭东路靠近东渡国际嘉庭广场"</span>,<span class="attr">"longitude"</span>:<span class="string">"121.387844"</span>,<span class="attr">"latitude"</span>:<span class="string">"31.222706"</span>,<span class="attr">"name"</span>:<span class="string">"东渡国际嘉庭广场"</span>,<span class="attr">"province"</span>:<span class="string">"上海市"</span>&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"content"</span>:<span class="string">"23333♡\n可乐要加冰\n柠檬要加水\n我的生活要加你\n\n咖啡要加糖\n披萨要加盐\n我们的感情要加点油\n\n别说什么东南西北都是你\n别说什么天涯海角都是你\n别说什么心里眼里都是你\n\n我只需要你说\n你的生活加点我.\n\n或者给我一条人生建议\n让我和你在一起.\n\n感情不要甜言蜜语\n不要纠缠不休.\n只需要一句“我喜欢你”\n\n感谢收听悦兮电台第六期《要加点你》\n我是主播:苏雨诺\n编辑:苏雨纤\n写文:江抒\n本次播音结束，请大家期待下一期～"</span>,<span class="attr">"imageList"</span>:[]&#125;</span><br></pre></td></tr></table></figure><h3 id="今天2018-2-9-放假过年啦"><a href="#今天2018-2-9-放假过年啦" class="headerlink" title="今天2018/2/9 放假过年啦"></a>今天2018/2/9 放假过年啦</h3><h3 id="2018-2-24-redis-的homebrew-安装"><a href="#2018-2-24-redis-的homebrew-安装" class="headerlink" title="2018/2/24 redis 的homebrew 安装"></a>2018/2/24 redis 的homebrew 安装</h3><p><a href="http://blog.csdn.net/chenshuai1993/article/details/51519384" target="_blank" rel="noopener">http://blog.csdn.net/chenshuai1993/article/details/51519384</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">什么是原子性,什么是原子性操作？</span><br><span class="line">举个例子：</span><br><span class="line">A想要从自己的帐户中转1000块钱到B的帐户里。那个从A开始转帐，到转帐结束的这一个过程，称之为一个事务。在这个事务里，要做如下操作：</span><br><span class="line"> 1. 从A的帐户中减去1000块钱。如果A的帐户原来有3000块钱，现在就变成2000块钱了。</span><br><span class="line"> 2. 在B的帐户里加1000块钱。如果B的帐户如果原来有2000块钱，现在则变成3000块钱了。</span><br><span class="line">如果在A的帐户已经减去了1000块钱的时候，忽然发生了意外，比如停电什么的，导致转帐事务意外终止了，而此时B的帐户里还没有增加1000块钱。那么，我们称这个操作失败了，要进行回滚。回滚就是回到事务开始之前的状态，也就是回到A的帐户还没减1000块的状态，B的帐户的原来的状态。此时A的帐户仍然有3000块，B的帐户仍然有2000块。</span><br><span class="line">我们把这种要么一起成功（A帐户成功减少1000，同时B帐户成功增加1000），要么一起失败（A帐户回到原来状态，B帐户也回到原来状态）的操作叫原子性操作。</span><br><span class="line">如果把一个事务可看作是一个程序,它要么完整的被执行,要么完全不执行。这种特性就叫原子性。</span><br></pre></td></tr></table></figure><blockquote><p>mac 下安装也可以使用 homebrew，homebrew 是 mac 的包管理器。</p></blockquote><p>1、执行 brew install redis</p><p>2、启动 redis，可以使用后台服务启动 brew services start redis。或者直接启动：redis-server /usr/local/etc/redis.conf</p><p>在远程服务上执行命令<br>redis-cli -h host -p port -a password</p><p>查看redis服务是否启动</p><p>ps aux | grep redis</p><p>这篇文章也不错<br><a href="https://www.jianshu.com/p/af33284aa57a" target="_blank" rel="noopener">https://www.jianshu.com/p/af33284aa57a</a></p><h3 id="记一次Mac-node-logger-保存path-权限问题"><a href="#记一次Mac-node-logger-保存path-权限问题" class="headerlink" title="记一次Mac node logger 保存path 权限问题"></a>记一次Mac node logger 保存path 权限问题</h3><p>记一次运行node 服务器，其logger 记录path 在xxxx。<br>该目录没有获得权限，为只读。<br>错误表现：console 一直print：<br>ERROR 29252 [egg-logger] [/data0/wwwlogs/envelop.xxxx.com/logs/xxx-envelop-2000/egg-web.log] Error: EACCES: permission denied, open ‘/data0/wwwlogs/envelop.xxxx.com/logs/xxx-envelop-2018/egg-web.log’<br>解决方案:</p><ol><li><p>ctrl C 打断输出</p></li><li><p>在ternimal cd 到该目录,如:<code>$ cd /data0/wwwlogs/envelop.xxxx.com/logs/xxx-envelop-2000</code></p></li><li>然后 <code>$ chmod -R 777 *</code></li></ol><blockquote><p>将该目录下使用递归 赋予777 权限(chmod : change mode ,-R recursive, 777 可读可写权限)</p></blockquote><h3 id="将本地git-push-到远程repository"><a href="#将本地git-push-到远程repository" class="headerlink" title="将本地git push 到远程repository"></a>将本地git push 到远程repository</h3><p>git init<br>git commit -m “first commit”<br>git remote add origin <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:shaohung001/ahuang_project.git<br>git push -u origin master</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017-08-29lesson</title>
      <link href="/2017/10/06/2017-08-29lesson/"/>
      <url>/2017/10/06/2017-08-29lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/8/29<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NSURL *url = [NSURL URLWithString: @&quot;http://www.baidu.com/s?tn=baiduhome_pg&amp;bs=NSRUL&amp;f=8&amp;rsv_bp=1&amp;rsv_spt=1&amp;wd=NSurl&amp;inputT=2709&quot;];  </span><br><span class="line">NSLog(@&quot;Scheme: %@&quot;, [url scheme]); </span><br><span class="line">NSLog(@&quot;Host: %@&quot;, [url host]); </span><br><span class="line">NSLog(@&quot;Port: %@&quot;, [url port]);  </span><br><span class="line">NSLog(@&quot;Path: %@&quot;, [url path]);  </span><br><span class="line">NSLog(@&quot;Relative path: %@&quot;, [url relativePath]); </span><br><span class="line">NSLog(@&quot;Path components as array: %@&quot;, [url pathComponents]);   </span><br><span class="line">NSLog(@&quot;Parameter string: %@&quot;, [url parameterString]);  </span><br><span class="line">NSLog(@&quot;Query: %@&quot;, [url query]);   </span><br><span class="line">NSLog(@&quot;Fragment: %@&quot;, [url fragment]); </span><br><span class="line">NSLog(@&quot;User: %@&quot;, [url user]); </span><br><span class="line">NSLog(@&quot;Password: %@&quot;, [url password]);</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2012-03-31 18:22:20.904 SmallDemoList[5473:11603] 12131232</span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Scheme: http </span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Host: www.baidu.com </span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Port: (null) </span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Path: /s </span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Relative path: /s </span><br><span class="line">2012-03-31 18:22:20.907 SmallDemoList[5473:11603] Path components as array: ( </span><br><span class="line"> &quot;/&quot;, </span><br><span class="line">) </span><br><span class="line">2012-03-31 18:22:20.916 SmallDemoList[5473:11603] Parameter string: (null) </span><br><span class="line">2012-03-31 18:22:20.917 SmallDemoList[5473:11603] Query: tn=baiduhome_pg&amp;bs=NSRUL&amp;f=8&amp;rsv_bp=1&amp;rsv_spt=1&amp;wd=NSurl&amp;inputT=2709</span><br><span class="line">2012-03-31 18:22:20.917 SmallDemoList[5473:11603] Fragment: (null) </span><br><span class="line">2012-03-31 18:22:20.917 SmallDemoList[5473:11603] User: (null) </span><br><span class="line">2012-03-31 18:22:20.917 SmallDemoList[5473:11603] Password: (null)</span><br></pre></td></tr></table></figure><hr><p>sourcetree 自己比较常用的<br>1：amand 钩子 对本地的进行amand<br>2：将“xxx”重置到本次提交 - 强行合并 丢弃所有工作副本改动       将本地数据回调到选中版本，删除所有工作副本<br>3：要commit 前，查看所有改动，确认所有改动是否正确</p><h3 id="接下来的时间，是时候拆解一个项目，成为一个一个精品轮子了"><a href="#接下来的时间，是时候拆解一个项目，成为一个一个精品轮子了" class="headerlink" title="接下来的时间，是时候拆解一个项目，成为一个一个精品轮子了"></a>接下来的时间，是时候拆解一个项目，成为一个一个精品轮子了</h3><ul><li>日记</li><li>单位换算</li><li>BMI</li><li>手账</li><li>给他们写一个小型聊天demo</li></ul><h3 id="记一次输入键盘-在inputView替换状态resignKeyboard-出现的问题"><a href="#记一次输入键盘-在inputView替换状态resignKeyboard-出现的问题" class="headerlink" title="记一次输入键盘 在inputView替换状态resignKeyboard 出现的问题"></a>记一次输入键盘 在inputView替换状态resignKeyboard 出现的问题</h3><p>其中在 emoji状态，如果resign 那么其会走 showKeyboard 和hideKeyboard ，由于keyboard 比较慢，，会出现completion 最慢，，最后导致界面不能滑动</p><h3 id="导航栏的几种推栈、退栈"><a href="#导航栏的几种推栈、退栈" class="headerlink" title="导航栏的几种推栈、退栈"></a>导航栏的几种推栈、退栈</h3><ol><li>没导航栏-&gt;有导航栏   没导航栏&lt;-有导航栏</li><li>有导航栏-&gt;有导航栏   有导航栏&lt;-有导航栏</li><li>没导航栏-&gt;没导航栏   没导航栏&lt;-没导航栏</li></ol><p>这一类都是需要注意的一个地方，在viewwillApeare 和viewWillDisapear 2个方法里面的对应2个方法优化:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.navigationController.navigationBarHidden = YES;</span><br><span class="line">[self.navigationController setNavigationBarHidden:YES animated:animated];</span><br></pre></td></tr></table></figure></p><h3 id="日期格式"><a href="#日期格式" class="headerlink" title="日期格式"></a>日期格式</h3><p><a href="http://www.cnblogs.com/wayne23/archive/2013/03/25/2981009.html" target="_blank" rel="noopener">http://www.cnblogs.com/wayne23/archive/2013/03/25/2981009.html</a></p><p>时间与日期处理</p><p>主要有以下类：<br>NSDate – 表示一个绝对的时间点<br>NSTimeZone – 时区信息<br>NSLocale – 本地化信息<br>NSDateComponents – 一个封装了具体年月日、时秒分、周、季度等的类<br>NSCalendar – 日历类，它提供了大部分的日期计算接口，并且允许您在NSDate和NSDateComponents之间转换<br>NSDateFormatter – 用来在日期和字符串之间转换</p><p>NSDate</p><p>NSDate用来表示公历的GMT时间(格林威治时间)。 有下面几种初始化方法：</p><ol><li><ul><li>(id)init</li></ul></li></ol><p>默认初始化，返回当前时间，也可以直接调用类方法 +(id)date</p><p>NSDate <em>date = [[NSDate alloc] init];<br>//NSDate </em>date = [NSDate date];<br>NSLog(@”print date is %@”,date);<br>将打印出计算机当前时间：2013-03-04 08:57:20 +0000</p><ol start="2"><li><ul><li>(id)initWithTimeIntervalSinceNow:(NSTimeInterval)seconds</li></ul></li></ol><p>以当前时间的偏移秒数来初始化，也可以直接调用类方法 + (id)dateWithTimeIntervalSinceNow:(NSTimeInterval)seconds</p><p>NSDate <em>date = [[NSDate alloc] initWithTimeIntervalSinceNow:20];<br>//NSDate </em>date = [NSDate dateWithTimeIntervalSinceNow:20];<br>NSLog(@”print date is %@”,date);<br>假如当前时间是2013-03-04 08:57:20 +0000，那么初始化后得到的时间是2013-03-04 08:57:40 +0000</p><ol start="3"><li><ul><li>(id)initWithTimeIntervalSince1970:(NSTimeInterval)seconds</li></ul></li></ol><p>以GMT时间的偏移秒数来初始化，也可以直接调用类方法 + (id)dateWithTimeIntervalSince1970:(NSTimeInterval)seconds</p><p>NSDate <em>date = [[NSDate alloc] initWithTimeIntervalSince1970:-20];<br>//NSDate </em>date = [NSDate dateWithTimeIntervalSince1970:-20];<br>NSLog(@”print date is %@”,date);<br>得到的时间是格林威治时间往前20秒，将打印出：1969-12-31 23:59:40 +0000</p><ol start="4"><li><ul><li>(id)initWithTimeIntervalSinceReferenceDate:(NSTimeInterval)seconds</li></ul></li></ol><p>以2001-1-1 0:0:0的偏移秒数来初始化，也可以直接调用类方法 + (id)dateWithTimeIntervalSinceReferenceDate:(NSTimeInterval)seconds</p><p>NSDate <em>date = [[NSDate alloc] initWithTimeIntervalSinceReferenceDate:80];<br>//NSDate </em>date = [NSDate dateWithTimeIntervalSinceReferenceDate:80];<br>NSLog(@”print date is %@”,date);<br>将打印出：2001-01-01 00:01:20 +0000</p><ol start="5"><li><ul><li>(id)initWithTimeInterval:(NSTimeInterval)seconds sinceDate:(NSDate *)refDate</li></ul></li></ol><p>以基准时间的偏移秒数来初始化，也可以直接调用类方法 + (id)dateWithTimeInterval:(NSTimeInterval)seconds sinceDate:(NSDate *)date</p><p>复制代码<br>NSDate *date1 = [[NSDate alloc] initWithTimeIntervalSinceReferenceDate:20];<br>NSLog(@”print date1 is %@”,date1);</p><p>NSDate <em>date2 = [[NSDate alloc] initWithTimeInterval:10 sinceDate:date1];<br>//NSDate </em>date2 = [NSDate dateWithTimeInterval:10 sinceDate:date1];<br>NSLog(@”print date2 is %@”,date2);<br>复制代码<br>第一个基准时间是2001-01-01 00:00:20 +0000，根据基准时间偏移10秒的结果是2001-01-01 00:00:30 +0000</p><ol start="6"><li><ul><li>(id)distantPast 与 + (id)distantFuture</li></ul></li></ol><p>这两个是类方法，分别用来返回一个极早的时间点和一个极晚的时间点</p><p>NSDate *date = [NSDate distantFuture];<br>NSLog(@”future date is %@”,date);</p><p>NSDate *date2 = [NSDate distantPast];<br>NSLog(@”past date is %@”,date2);<br>distantPast将返回：0001-12-30 00:00:00 +0000，distantFuture将返回：4001-01-01 00:00:00 +0000</p><p>NSDate的常用对象方法：</p><ol><li>-(id)dateByAddingTimeInterval:(NSTimeInterval)seconds</li></ol><p>返回以当前NSDate对象为基准，偏移多少秒后得到的新NSDate对象。(旧方法 - (id)addTimeInterval:(NSTimeInterval)seconds已被弃用)</p><p>NSDate <em>date = [NSDate dateWithTimeIntervalSince1970:0];<br>NSDate </em>date2 = [date dateByAddingTimeInterval:-20];<br>NSLog(@”%@”,date2);</p><ol start="2"><li><ul><li>(BOOL)isEqualToDate:(NSDate *)anotherDate</li></ul></li></ol><p>将当前对象与参数传递的对象进行比较，根据是否相同返回BOOL值</p><p>NSDate <em>date = [NSDate dateWithTimeIntervalSince1970:0];<br>NSDate </em>date2 = [NSDate dateWithTimeInterval:0 sinceDate:date];<br>BOOL isEqual = [date isEqualToDate:date2];<br>NSLog(@”%i”,isEqual);</p><ol start="3"><li><ul><li>(NSDate <em>)earlierDate:(NSDate </em>)anotherDate 与 - (NSDate <em>)laterDate:(NSDate </em>)anotherDate</li></ul></li></ol><p>比较两个NSDate对象，返回较早/较晚的时间点，并以新NSDate对象的形式返回</p><p>复制代码<br>NSDate <em>date = [NSDate dateWithTimeIntervalSince1970:0];<br>NSDate </em>date2 = [NSDate dateWithTimeInterval:-50 sinceDate:date];</p><p>NSDate *date3 = [date earlierDate:date2];<br>NSLog(@”earlier date is %@”,date3);</p><p>NSDate *date4 = [date laterDate:date2];<br>NSLog(@”later date is %@”,date4);<br>复制代码</p><ol start="4"><li><ul><li>(NSComparisonResult)compare:(NSDate *)anotherDate</li></ul></li></ol><p>将当前对象与参数传递的对象进行比较，如果相同，返回0(NSOrderedSame)；对象时间早于参数时间，返回-1(NSOrderedAscending)；对象时间晚于参数时间，返回1(NSOrderedDescending)</p><p>NSDate <em>date = [NSDate dateWithTimeIntervalSince1970:0];<br>NSDate </em>date2 = [NSDate dateWithTimeInterval:-50 sinceDate:date];</p><p>NSInteger result = [date compare:date2];<br>NSLog(@”%i”,result);</p><ol start="5"><li><ul><li>(NSTimeInterval)timeIntervalSince1970</li></ul></li></ol><p>返回当前对象时间与1970-1-1 0:0:0的相隔秒数，也可以这样理解：从1970-1-1 0:0:0开始，经过多少秒到达对象指定时间。</p><p>NSDate *date = [NSDate dateWithTimeIntervalSince1970:50];<br>NSInteger seconds = [date timeIntervalSince1970];<br>NSLog(@”%i”,seconds);<br>将返回结果50</p><ol start="6"><li><ul><li>(NSTimeInterval)timeIntervalSinceReferenceDate</li></ul></li></ol><p>返回当前对象时间与2001-1-1 0:0:0的相隔秒数，也可以这样理解：从2001-1-1 0:0:0开始，经过多少秒到达对象指定时间。</p><p>NSDate *date = [NSDate dateWithTimeIntervalSinceReferenceDate:-30];<br>NSInteger seconds = [date timeIntervalSinceReferenceDate];<br>NSLog(@”%i”,seconds);<br>将返回结果-30，负数代表从2001-1-1 0:0:0开始，倒退30秒到达当前时间。</p><ol start="7"><li><ul><li>(NSTimeInterval)timeIntervalSinceNow</li></ul></li></ol><p>返回当前对象时间与客户端时间的相隔秒数，也可以这样理解：从客户端当前时间开始，经过多少秒到达对象指定时间。</p><p>NSDate *date = [NSDate dateWithTimeIntervalSinceNow:100];<br>NSInteger seconds = [date timeIntervalSinceNow];<br>NSLog(@”%i”,seconds);<br>经测试返回了结果99，但初始化时提供的参数是100。这可能是因为第一句初始化代码到第二句计算代码之间有个1秒内的延时，所以计算时的客户端时间比初始化时的客户端时间快了1秒。</p><ol start="8"><li><ul><li>(NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate</li></ul></li></ol><p>返回当前对象时间与参数传递的对象时间的相隔秒数，也可以这样理解：从参数时间开始，经过多少秒到达对象执行时间。</p><p>NSDate <em>date = [NSDate dateWithTimeIntervalSince1970:0];<br>NSDate </em>date2 = [NSDate dateWithTimeInterval:50 sinceDate:date];<br>NSInteger seconds = [date timeIntervalSinceDate:date2];<br>NSLog(@”%i”,seconds);<br>将返回结果-50，date为1970-1-1 0:0:0，date2为1970-1-1 0:0:50，从date2的时间开始，倒退50秒到达date的时间。</p><p>NSTimeZone</p><p>NSTimeZone表示时区信息。 有下面几种初始化方法：</p><ol><li><ul><li>(id)timeZoneWithName:(NSString <em>)aTimeZoneName / - (id)initWithName:(NSString </em>)aName</li></ul></li></ol><p>根据时区名称初始化。可以调用NSTimeZone的类方法 + (NSArray *)knownTimeZoneNames来返回所有已知的时区名称。</p><p>NSTimeZone <em>zone = [[NSTimeZone alloc] initWithName:@”America/Chicago”];<br>//NSTimeZone </em>zone = [NSTimeZone timeZoneWithName:@”America/Chicago”];<br>NSLog(@”%@”,zone);<br>打印出：America/Chicago (CST) offset -21600</p><ol start="2"><li><ul><li>(id)timeZoneWithAbbreviation:(NSString *)abbreviation</li></ul></li></ol><p>根据时区缩写初始化。例如：EST(美国东部标准时间)、HKT(香港标准时间)</p><p>NSTimeZone *zone = [NSTimeZone timeZoneWithAbbreviation:@”EST”];<br>NSLog(@”%@”,zone);<br>打印出：Asia/Hong_Kong (HKT) offset 28800</p><ol start="3"><li><ul><li>(NSTimeZone *)systemTimeZone</li></ul></li></ol><p>返回系统时区</p><p>NSTimeZone <em>zone = [NSTimeZone systemTimeZone];<br>NSLog(@”%@”,zone);<br>假如时区是上海，打印出的时区信息将会是：Asia/Shanghai (CST (China)) offset 28800，28800代表相对于GMT时间偏移的秒数，即8个小时。(8</em>60*60)</p><ol start="4"><li><ul><li>(NSTimeZone *)localTimeZone</li></ul></li></ol><p>返回本地时区，与systemTimeZone的区别在于：本地时区可以被修改，而系统时区不能修改。</p><p>复制代码<br>[NSTimeZone setDefaultTimeZone:[[NSTimeZone alloc] initWithName:@”America/Chicago”]];</p><p>NSTimeZone <em>systemZone = [NSTimeZone systemTimeZone];<br>NSTimeZone </em>localZone = [NSTimeZone localTimeZone];</p><p>NSLog(@”%@”,systemZone);<br>NSLog(@”%@”,localZone);<br>复制代码<br>打印出的系统时区仍然是：Asia/Shanghai (CST (China)) offset 28800；而本地时区经过修改后，变成了：Local Time Zone (America/Chicago (CST) offset -21600)</p><ol start="5"><li><ul><li>(id)timeZoneForSecondsFromGMT:(NSInteger)seconds</li></ul></li></ol><p>根据零时区的秒数偏移返回一个新时区对象</p><p>NSTimeZone *zone = [NSTimeZone timeZoneForSecondsFromGMT:28800];<br>NSLog(@”%@”,zone);<br>打印出：GMT+0800 (GMT+08:00) offset 28800</p><p>NSTimeZone常用对象方法与类方法：</p><ol><li><ul><li>(NSArray *)knownTimeZoneNames</li></ul></li></ol><p>以数组的形式返回所有已知的时区名称</p><p>NSArray <em>zoneArray = [NSTimeZone knownTimeZoneNames];<br>for(NSString </em>str in zoneArray)<br>{<br>    NSLog(@”%@”,str);<br>}</p><ol start="2"><li><ul><li>(NSString <em>)name / - (NSString </em>)abbreviation</li></ul></li></ol><p>返回时区对象的名称或缩写</p><p>NSTimeZone <em>zone = [NSTimeZone localTimeZone];<br>NSString </em>strZoneName = [zone name];<br>NSString *strZoneAbbreviation = [zone abbreviation];<br>NSLog(@”name is %@”,strZoneName);<br>NSLog(@”abbreviation is %@”,strZoneAbbreviation);<br>name is Asia/Hong_Kong</p><p>abbreviation is HKT</p><ol start="3"><li><ul><li>(NSInteger)secondsFromGMT</li></ul></li></ol><p>得到当前时区与零时区的间隔秒数</p><p>NSTimeZone *zone = [NSTimeZone localTimeZone];<br>int seconds = [zone secondsFromGMT];<br>NSLog(@”%i”,seconds);<br>NSLoale</p><p>NSLoale类返回本地化信息，主要体现在”语言”和”区域格式”这两个设置项。有下面几种初始化方法：</p><ol><li><ul><li>(id)systemLocale</li></ul></li></ol><p>返回系统初始本地化信息</p><p>NSLocale *locale = [NSLocale systemLocale];<br>NSLog(@”%@”,[[locale objectForKey:NSLocaleCalendar] calendarIdentifier]);</p><ol start="2"><li><ul><li>(id)currentLocale / + (id)autoupdatingCurrentLocale</li></ul></li></ol><p>这两个类方法都将返回当前客户端的本地化信息，区别在于：currentLocale取得的值会一直保持在cache中，第一次用此方法实例化对象后，即使修改了本地化设定，这个对象也不会改变。而使用autoupdatingCurrentLocale，当每次修改本地化设定，其实例化的对象也会随之改变。</p><p>下面的代码演示了区别所在，假设初始本地化信息为en_US，先用这两个函数分别初始化两个对象，然后修改本地化设定语言为台湾繁体中文，再重新打印这两个对象的信息：</p><p>复制代码<br>NSLocale <em>locale1;<br>NSLocale </em>locale2;</p><ul><li><p>(IBAction)doTest:(id)sender<br>{<br>  locale1 = [NSLocale currentLocale];<br>  locale2 = [NSLocale autoupdatingCurrentLocale];</p><p>  NSLog(@”%@”,locale1.localeIdentifier); //print “en_US”<br>  NSLog(@”%@”,locale2.localeIdentifier); //print “en_US”<br>}</p></li><li><p>(IBAction)doAgain:(id)sender<br>{<br>  NSLog(@”%@”,locale1.localeIdentifier); //print “en_US”<br>  NSLog(@”%@”,locale2.localeIdentifier); //print “zh_TW”<br>}<br>复制代码</p></li></ul><ol start="3"><li><ul><li>(id)initWithLocaleIdentifier:(NSString *)string</li></ul></li></ol><p>用标示符初始化本地化信息</p><p>NSLocale <em>locale = [[NSLocale alloc] initWithLocaleIdentifier:@”zh_CN”];<br>NSString </em>strSymbol = [locale objectForKey:NSLocaleCurrencySymbol];<br>NSLog(@”%@”,strSymbol);<br>代码用”zh_CN”来初始化对象，然后再打印出对象的货币符号，得到的结果是人民币符号￥</p><p>NSLoale常用对象方法与类方法：</p><ol><li><ul><li>(id)objectForKey:(id)key</li></ul></li></ol><p>根据不同的key返回各种本地化信息，例如下面的代码返回了当前货币符号：</p><p>NSLocale <em>locale = [NSLocale currentLocale];<br>NSString </em>strSymbol = [locale objectForKey:NSLocaleCurrencySymbol];<br>NSCalendar *calendar = [[NSLocale currentLocale] objectForKey:NSLocaleCalendar];</p><ol start="2"><li><ul><li>(NSString *)displayNameForKey:(id)key value:(id)value</li></ul></li></ol><p>显示特定地区代号下相应键的显示名称：</p><p>NSLocale <em>locale = [[NSLocale alloc] initWithLocaleIdentifier:@”zh_CN”];<br>NSString </em>str = [locale displayNameForKey:NSLocaleIdentifier value:@”en_US”];<br>NSLog(@”%@”,str);<br>第一句代码代表以中文来实例化对象，然后得到”en_US”的NSLocaleIdentifier键的显示名称。最后输出的结果是”英文（美国）”</p><p>NSDateComponents</p><p>NSDateComponents封装了具体年月日、时秒分、周、季度等</p><p>复制代码<br>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setEra:1];<br>[compt setYear:2013];<br>[compt setMonth:3];<br>[compt setDay:15];<br>[compt setHour:11];<br>[compt setMinute:20];<br>[compt setSecond:55];<br>[compt setQuarter:2];<br>[compt setTimeZone:[NSTimeZone systemTimeZone]];<br>[compt setWeek:3];<br>[compt setWeekday:4];<br>[compt setWeekOfMonth:3];<br>[compt setWeekOfYear:2];<br>[compt setCalendar:[NSCalendar currentCalendar]];<br>复制代码<br>NSDateComponents相关方法：</p><ol><li>NSCalendar对象的 - (NSDateComponents <em>)components:(NSUInteger)unitFlags fromDate:(NSDate </em>)date</li></ol><p>取得一个NSDate对象的1个或多个部分，用NSDateComponents来封装</p><p>复制代码<br>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [NSDate date];<br>//NSDateComponents <em>compt = [calendar components:NSDayCalendarUnit fromDate:date];<br>NSDateComponents </em>compt = [calendar components:(NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit) fromDate:date];</p><p>NSLog(@”%d,%@”,[compt year],date);<br>NSLog(@”%d,%@”,[compt month],date);<br>NSLog(@”%d,%@”,[compt day],date);<br>复制代码<br>需要注意的是，只有明确指定了unitFlags，NSDateComponents相应的那一部分才有值。</p><ol start="2"><li>NSCalendar对象的 - (NSDateComponents <em>)components:(NSUInteger)unitFlags fromDate:(NSDate </em>)startingDate toDate:(NSDate *)resultDate options : (NSUInteger)opts</li></ol><p>取得两个NSDate对象的时间间隔，用NSDateComponents来封装</p><p>复制代码<br>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [NSDate date];<br>NSDate <em>date2 = [NSDate dateWithTimeInterval:5</em>60<em>60+75 sinceDate:date];<br>NSDateComponents </em>compt = [calendar components:(NSMinuteCalendarUnit|NSSecondCalendarUnit) fromDate:date toDate:date2 options:0];</p><p>NSLog(@”%d”,[compt minute]);<br>NSLog(@”%d”,[compt second]);<br>复制代码<br>有几点需要注意：</p><p>① 得到的NSDateComponents对象可能会包含负数。例如：当toDate比fromDate晚10秒，second部分返回10；当toDate比fromDate早10秒，second部分返回-10</p><p>② 当指定unitFlags返回多个部分时，相隔的时间由多个部分共同组成(而不是独立去表示)。例如：上面的例子时间相差5小时1分15秒，如果指定只返回second部分，将得到18075秒；如果指定返回minute和second部分，将得到301分15秒；如果指定返回hour、minute和second，将得到5小时1分15秒。</p><ol start="3"><li>NSCalendar对象的 - (NSDate <em>)dateFromComponents:(NSDateComponents </em>)comps</li></ol><p>根据NSDateComponents对象得到一个NSDate对象</p><p>复制代码<br>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setYear:2012];<br>[compt setMonth:5];<br>[compt setDay:11];</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [calendar dateFromComponents:compt];<br>//得到本地时间，避免时区问题<br>NSTimeZone <em>zone = [NSTimeZone systemTimeZone];<br>NSInteger interval = [zone secondsFromGMTForDate:date];<br>NSDate </em>localeDate = [date dateByAddingTimeInterval:interval];</p><p>NSLog(@”%@”,localeDate);<br>复制代码</p><ol start="4"><li>NSCalendar对象的 - (NSDate <em>)dateByAddingComponents:(NSDateComponents </em>)comps toDate:(NSDate *)date options:(NSUInteger)opts</li></ol><p>在参数date基础上，增加一个NSDateComponents类型的时间增量</p><p>复制代码<br>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setDay:25];<br>[compt setHour:4];<br>[compt setMinute:66];</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [calendar dateByAddingComponents:compt toDate:[NSDate date] options:0];</p><p>//得到本地时间，避免时区问题<br>NSTimeZone <em>zone = [NSTimeZone systemTimeZone];<br>NSInteger interval = [zone secondsFromGMTForDate:date];<br>NSDate </em>localeDate = [date dateByAddingTimeInterval:interval];</p><p>NSLog(@”%@”,localeDate);<br>复制代码<br>当前时间的基础上，增加25天4小时66秒</p><p>NSCalendar</p><ol><li><ul><li>(id)currentCalendar / + (id)autoupdatingCurrentCalendar</li></ul></li></ol><p>这两个类方法都将返回当前客户端的逻辑日历，区别在于：currentCalendar取得的值会一直保持在cache中，第一次用此方法实例化对象后，即使修改了系统日历设定，这个对象也不会改变。而使用autoupdatingCurrentCalendar，当每次修改系统日历设定，其实例化的对象也会随之改变。</p><p>下面的代码演示了区别所在，假设初始Calendar设定为NSGregorianCalendar(公历)，先用这两个函数分别初始化两个对象，然后修改系统日历为NSJapaneseCalendar(日本和历)，再重新打印这两个对象的信息：</p><p>复制代码<br>NSCalendar <em>calendar;<br>NSCalendar </em>calendar2;</p><ul><li><p>(IBAction)doTest:(id)sender<br>{<br>  calendar = [NSCalendar currentCalendar];<br>  calendar2 = [NSCalendar autoupdatingCurrentCalendar];</p><p>  NSLog(@”%@”,calendar.calendarIdentifier); //print “gregorian”<br>  NSLog(@”%@”,calendar2.calendarIdentifier); //print “gregorian”<br>}</p></li><li><p>(IBAction)doAgain:(id)sender<br>{<br>  NSLog(@”%@”,calendar.calendarIdentifier); //print “gregorian”<br>  NSLog(@”%@”,calendar2.calendarIdentifier); //print “japanese”<br>}<br>复制代码</p></li></ul><ol start="2"><li><ul><li>(id)initWithCalendarIdentifier:(NSString *)string</li></ul></li></ol><p>根据提供的日历标示符初始化</p><p>NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSChineseCalendar];<br>NSLog(@”%@”,calendar.calendarIdentifier);<br>系统中定义的日历有：</p><p>NSGregorianCalendar – 公历<br>NSBuddhistCalendar – 佛教日历<br>NSChineseCalendar – 中国农历<br>NSHebrewCalendar – 希伯来日历<br>NSIslamicCalendar – 伊斯兰历<br>NSIslamicCivilCalendar – 伊斯兰教日历<br>NSJapaneseCalendar – 日本日历<br>NSRepublicOfChinaCalendar – 中华民国日历（台湾）<br>NSPersianCalendar – 波斯历<br>NSIndianCalendar – 印度日历<br>NSISO8601Calendar – ISO8601</p><p>NSCalendar常用对象方法与类方法：</p><ol><li><ul><li>(void)setLocale:(NSLocale *)locale</li></ul></li></ol><p>设置本地化信息</p><p>NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];<br>[calendar setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@”zh_CN”]];<br>NSLog(@”%@”,calendar.locale.localeIdentifier);</p><ol start="2"><li><ul><li>(void)setTimeZone:(NSTimeZone *)tz</li></ul></li></ol><p>设置时区信息</p><p>NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];<br>[calendar setTimeZone:[NSTimeZone timeZoneWithAbbreviation:@”HKT”]];<br>NSLog(@”%@”,calendar.timeZone);</p><ol start="3"><li><ul><li>(void)setFirstWeekday:(NSUInteger)weekday</li></ul></li></ol><p>设置每周的第一天从星期几开始，比如：1代表星期日开始，2代表星期一开始，以此类推。默认值是1</p><p>如图所示，如果从星期天开始，日历的表现形式：</p><p>如果从星期二开始，日历的表现形式：</p><p>NSCalendar *calendar = [NSCalendar currentCalendar];<br>[calendar setFirstWeekday:3];<br>NSLog(@”%i”,calendar.firstWeekday);</p><ol start="4"><li><ul><li>(void)setMinimumDaysInFirstWeek:(NSUInteger)mdw</li></ul></li></ol><p>设置每年及每月第一周必须包含的最少天数，比如：设定第一周最少包括3天，则value传入3</p><p>NSCalendar *calendar = [NSCalendar currentCalendar];<br>[calendar setMinimumDaysInFirstWeek:3];<br>NSLog(@”%i”,calendar.minimumDaysInFirstWeek);</p><ol start="5"><li><ul><li>(NSUInteger)ordinalityOfUnit:(NSCalendarUnit)smaller inUnit:(NSCalendarUnit)larger forDate:(NSDate *)date</li></ul></li></ol><p>获取一个小的单位在一个大的单位里面的序数</p><p>NSCalendarUnit包含的值有：</p><p>NSEraCalendarUnit – 纪元单位。对于NSGregorianCalendar(公历)来说，只有公元前(BC)和公元(AD)；而对于其它历法可能有很多，例如日本和历是以每一代君王统治来做计算。<br>NSYearCalendarUnit – 年单位。值很大，相当于经历了多少年，未来多少年。<br>NSMonthCalendarUnit – 月单位。范围为1-12<br>NSDayCalendarUnit – 天单位。范围为1-31<br>NSHourCalendarUnit – 小时单位。范围为0-24<br>NSMinuteCalendarUnit – 分钟单位。范围为0-60<br>NSSecondCalendarUnit – 秒单位。范围为0-60<br>NSWeekCalendarUnit – 周单位。范围为1-53<br>NSWeekdayCalendarUnit – 星期单位，每周的7天。范围为1-7<br>NSWeekdayOrdinalCalendarUnit – 没完全搞清楚<br>NSQuarterCalendarUnit – 几刻钟，也就是15分钟。范围为1-4<br>NSWeekOfMonthCalendarUnit – 月包含的周数。最多为6个周<br>NSWeekOfYearCalendarUnit – 年包含的周数。最多为53个周<br>NSYearForWeekOfYearCalendarUnit – 没完全搞清楚<br>NSTimeZoneCalendarUnit – 没完全搞清楚</p><p>下面是一些示例：</p><p>① 当小单位为NSWeekdayCalendarUnit，大单位为NSWeekCalendarUnit时(即某个日期在这一周是第几天)，根据firstWeekday属性不同，返回的结果也不同。</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [NSDate dateWithTimeIntervalSinceReferenceDate:10];<br>//[calendar setFirstWeekday:2];<br>int count = [calendar ordinalityOfUnit:NSWeekdayCalendarUnit inUnit:NSWeekCalendarUnit forDate:date];<br>NSLog(@”%d”,count);<br>默认firstWeekday为1(星期天开始)的情况下，得到的结果是2，从下图可以看到是第2天。</p><p>假如firstWeekday被设置为2(星期一开始)的情况下，得到的结果是1，从下图可以看到是第1天</p><p>② 当小单位为NSWeekCalendarUnit，大单位为NSYearCalendarUnit时(即某个日期在这一年中是第几周)，根据minimumDaysInFirstWeek属性不同，返回的结果也不同。</p><p>复制代码<br>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setYear:2013];<br>[compt setMonth:1];<br>[compt setDay:20];</p><p>NSCalendar *calendar = [NSCalendar currentCalendar];</p><p>NSDate *date = [calendar dateFromComponents:compt];</p><p>//[calendar setMinimumDaysInFirstWeek:6];<br>int count = [calendar ordinalityOfUnit:NSWeekCalendarUnit inUnit:NSYearCalendarUnit forDate:date];<br>NSLog(@”%d”,count);<br>复制代码<br>从上图的日历中可以看出，在没有设置minimumDaysInFirstWeek的情况下，1月20日得到的结果是4(第四个周)。</p><p>默认情况下第一个周有5天，如果将minimumDaysInFirstWeek设置为6天，则原本是第一周的1月1日–1月5日被划分到了上一年，返回0；而1月6日–1月12日升为第一周，1月13日–1月19日升为第二周。。依此类推。</p><p>所以需要关注的是minimumDaysInFirstWeek与实际第一周包含天数的大小比较，如果提供的minimumDaysInFirstWeek比实际第一周的天数小，则一切不变；否则统计”一年中第几周”、”一个月中第几周”会产生变化。</p><ol start="6"><li><ul><li>(NSRange)rangeOfUnit:(NSCalendarUnit)smaller inUnit:(NSCalendarUnit)larger forDate:(NSDate *)date</li></ul></li></ol><p>根据参数提供的时间点，得到一个小的单位在一个大的单位里面的取值范围</p><p>复制代码<br>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setYear:2013];<br>[compt setMonth:2];<br>[compt setDay:21];<br>[compt setHour:9];<br>[compt setMinute:45];<br>[compt setSecond:30];</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [calendar dateFromComponents:compt];</p><p>//得到本地时间，避免时区问题<br>NSTimeZone <em>zone = [NSTimeZone systemTimeZone];<br>NSInteger interval = [zone secondsFromGMTForDate:date];<br>NSDate </em>localeDate = [date dateByAddingTimeInterval:interval];</p><p>NSRange range = [calendar rangeOfUnit:NSDayCalendarUnit inUnit:NSYearCalendarUnit forDate:localeDate];</p><p>NSLog(@”%d – %d”,range.location,range.length);<br>复制代码<br>调用这个方法要明确一点，取得的是”范围”而不是”包含”，下面是一些例子：</p><p>① 小单位是NSDayCalendarUnit，大单位是NSYearCalendarUnit，并不是要取这一年包含多少天，而是要取”天”(Day)这个单位在这一年(Year)的取值范围。其实不管你提供的日期是多少，返回的值都是”1–31”。</p><p>② 小单位是NSDayCalendarUnit，大单位是NSMonthCalendarUnit。要取得参数时间点所对应的月份下，”天”(Day)的取值范围。根据参数时间的月份不同，值也不同。例如2月是1–28、3月是1–31、4月是1–30。</p><p>③ 小单位是NSWeekCalendarUnit，大单位是NSMonthCalendarUnit。要取得参数时间点所对应的月份下，”周”(Week)的取值范围。需要注意的是结果会受到minimumDaysInFirstWeek属性的影响。在默认minimumDaysInFirstWeek情况下，取得的范围值一般是”1–5”，从日历上可以看出来这个月包含5排，即5个周。</p><p>④ 小单位是NSDayCalendarUnit，大单位是NSWeekCalendarUnit。要取得周所包含的”天”(Day)的取值范围。下面是一个示例日历图：</p><p>在上图的日期条件下，假如提供的参数是4月1日–4月6日，那么对应的week就是1(第一个周)，可以看到第一个周包含有6天，从1号开始，那么最终得到的范围值为1–6。</p><p>假如提供的参数是4月18日，那么对应的week是3(第三个周)，第三个周包含有7天，从14号开始，那么最终得到的范围值是14–7。</p><p>假如提供的参数是4月30日，那么对应的week是5(第五个周)，第五个周只包含3天，从28号开始，那么最终得到的范围值是28–3。</p><ol start="7"><li><ul><li>(BOOL)rangeOfUnit:(NSCalendarUnit)unit startDate:(NSDate *<em>)datep interval:(NSTimeInterval </em>)tip forDate:(NSDate *)date</li></ul></li></ol><p>根据参数提供的时间点，返回所在日历单位的开始时间。如果startDate和interval均可以计算，则返回YES；否则返回NO</p><p>unit – 日历单位<br>datep – 开始时间，通过参数返回<br>tip – 日历单位所对应的秒数，通过参数返回<br>date – 时间点参数</p><p>复制代码<br>NSDate *dateOut = nil;<br>NSTimeInterval count = 0;</p><p>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setYear:2013];<br>[compt setMonth:3];<br>[compt setDay:22];</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>NSDate </em>date = [calendar dateFromComponents:compt];<br>BOOL b = [calendar rangeOfUnit:NSMonthCalendarUnit startDate:&amp;dateOut interval:&amp;count forDate:date];<br>if(b)<br>{<br>    //得到本地时间，避免时区问题<br>    NSTimeZone <em>zone = [NSTimeZone systemTimeZone];<br>    NSInteger interval = [zone secondsFromGMTForDate:dateOut];<br>    NSDate </em>localeDate = [dateOut dateByAddingTimeInterval:interval];</p><pre><code>NSLog(@&quot;%@&quot;,localeDate);NSLog(@&quot;%f&quot;,count);</code></pre><p>}<br>else<br>{<br>    NSLog(@”无法计算”);<br>}<br>复制代码<br>上面的例子要求返回2013年3月22日当月的起始时间，以及当月的秒数。得到的结果是：2013-03-01 00:00:00 +0000，2678400。(2678400 = 31天 <em> 24小时 </em> 60分 * 60秒)。</p><p>假如将上面的日历单位改为NSWeekCalendarUnit，那么得到的结果是：2013-03-17 00:00:00 +0000，604800。当周的第一天是3月17日。(604800 = 7天 <em> 24小时 </em> 60分 * 60秒)。</p><p>假如将上面的日历单位改为NSYearCalendarUnit，那么得到的结果是：2013-01-01 00:00:00 +0000，31536000。这一年的第一天是1月1日，(31536000 = 365天 <em> 24小时 </em> 60分 * 60秒)。</p><p>NSDateFormatter</p><p>NSDateFormatter的日期格式如下:</p><p>复制代码<br>G – 纪元<br>一般会显示公元前(BC)和公元(AD)</p><p>y – 年<br>假如是2013年，那么yyyy=2013，yy=13  </p><p>M – 月<br>假如是3月，那么M=3，MM=03，MMM=Mar，MMMM=March<br>假如是11月，那么M=11，MM=11，MMM=Nov，MMMM=November</p><p>w – 年包含的周<br>假如是1月8日，那么w=2(这一年的第二个周)</p><p>W – 月份包含的周(与日历排列有关)<br>假如是2013年4月21日，那么W=4(这个月的第四个周)</p><p>F – 月份包含的周(与日历排列无关)<br>和上面的W不一样，F只是单纯以7天为一个单位来统计周，例如7号一定是第一个周，15号一定是第三个周，与日历排列无关。</p><p>D – 年包含的天数<br>假如是1月20日，那么D=20(这一年的第20天)<br>假如是2月25日，那么D=31+25=56(这一年的第56天)</p><p>d – 月份包含的天数<br>假如是5号，那么d=5，dd=05<br>假如是15号，那么d=15，dd=15</p><p>E – 星期<br>假如是星期五，那么E=Fri，EEEE=Friday</p><p>a – 上午(AM)/下午(PM)</p><p>H – 24小时制，显示为0–23<br>假如是午夜00:40，那么H=0:40，HH=00:40</p><p>h – 12小时制，显示为1–12<br>假如是午夜00:40，那么h=12:40</p><p>K – 12小时制，显示为0–11<br>假如是午夜00:40，那么K=0:40，KK=00:40</p><p>k – 24小时制，显示为1–24<br>假如是午夜00:40，那么k=24:40</p><p>m – 分钟<br>假如是5分钟，那么m=5，mm=05<br>假如是45分钟，那么m=45，mm=45</p><p>s – 秒<br>假如是5秒钟，那么s=5，ss=05<br>假如是45秒钟，那么s=45，ss=45</p><p>S – 毫秒<br>一般用SSS来显示</p><p>z – 时区<br>表现形式为GMT+08:00</p><p>Z – 时区<br>表现形式为+0800<br>复制代码<br>NSDateFormatter的两个最实用的方法是dateFromString和stringFromDate，前者将一个字符串经过格式化后变成NSDate对象，后者将NSDate对象格式化成字符串。</p><p>在调用setDateFormat设置格式化字符串时，可以加入一些别的字符串，用单引号来引入，例如：</p><p>[formatter setDateFormat:@”yyyy-MM-dd ‘some ‘’special’’ string’ HH:mm:ss”];<br>使用NSDateFormatter转换时间字符串时，默认的时区是系统时区，例如在中国一般都是北京时间(+8)，如果直接转换会导致结果相差8小时，所以一般的做法是先指定时区为GMT标准时间再转换，例如：</p><p>复制代码<br>NSDateFormatter *formatter = [[NSDateFormatter alloc] init];<br>[formatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];<br>[formatter setDateFormat:@”yyyy-MM-dd HH:mm:ss z”];</p><p>NSDateComponents *compt = [[NSDateComponents alloc] init];<br>[compt setYear:2013];<br>[compt setMonth:3];<br>[compt setDay:13];<br>[compt setHour:1];<br>[compt setMinute:55];<br>[compt setSecond:28];</p><p>NSCalendar <em>calendar = [NSCalendar currentCalendar];<br>[calendar setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];<br>NSDate </em>date = [calendar dateFromComponents:compt];<br>NSLog(@”%@”,date);<br>NSString *str = [formatter stringFromDate:date];<br>NSLog(@”%@”,str);</p><h3 id="关于pop-动画引擎两个例子"><a href="#关于pop-动画引擎两个例子" class="headerlink" title="关于pop 动画引擎两个例子"></a>关于pop 动画引擎两个例子</h3><p>取色功能动效遇到两个比较麻烦的点，<br>1). 今天在做一个动画的时候，使用‘pop’时候，发现动作做完了，然后一个按钮使其回归原位，但是再做动作的时候，就只动了一下。难以查看过程，当我打断点到layoutSubviews的时候，果然进去了。然后不知道是谁调用的，于是我去使用time profile看了那一段时间干了什么事。于是看到了layoutSubviews被调用了，是‘pop’某一块调用了，使view又跑回原位。这时候，要么将布局代码写到其他地方，要么使用UIView的动画，我选择了后者。<br>2). 在一个回馈动效中使用POPSpringAnimation，但是由于滑块可以快速多次滑动，所以在弹性高过预定值，会产生negative值，即负值，这时3D transform中，scaleXY会出现rotate情况，<code>https://github.com/facebook/pop/issues/76</code>，这里采用clamp，在结束时，不超过回弹值。可以使用下面给出的两端中其一都可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-(void)popupMensionNode&#123;</span><br><span class="line">    POPBasicAnimation *nodeAnim = [POPBasicAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    nodeAnim.toValue = [NSValue valueWithCGSize:CGSizeMake(1.f, 1.f)];</span><br><span class="line">    nodeAnim.fromValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    nodeAnim.autoreverses = YES;</span><br><span class="line">    nodeAnim.duration = 0.25;</span><br><span class="line">    [_textNode.layer pop_addAnimation:nodeAnim forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(void)popupMensionNode&#123;</span><br><span class="line">    POPSpringAnimation *imageNodeAnim = [POPSpringAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    imageNodeAnim.toValue = [NSValue valueWithCGSize:CGSizeMake(1.f, 1.f)];</span><br><span class="line">    imageNodeAnim.fromValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    imageNodeAnim.autoreverses = YES;</span><br><span class="line">    imageNodeAnim.clampMode = kPOPAnimationClampEnd;</span><br><span class="line">    imageNodeAnim.springBounciness = 8;</span><br><span class="line">//    imageNodeAnim.springSpeed = 20;</span><br><span class="line">    [_textNode.layer pop_addAnimation:imageNodeAnim forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="今天遇到这么个问题-UIImageView-上面有控件-label-和button-但是看起来很模糊"><a href="#今天遇到这么个问题-UIImageView-上面有控件-label-和button-但是看起来很模糊" class="headerlink" title="今天遇到这么个问题 UIImageView 上面有控件 label 和button ,但是看起来很模糊"></a>今天遇到这么个问题 UIImageView 上面有控件 label 和button ,但是看起来很模糊</h3><p>今天遇到这么个问题 UIImageView 上面有控件 label 和button ,但是看起来很模糊。我当时以为其是否因为是被设置backgroundColor ,但是在设置了UIImageView的图片时，还是模糊。目前未知原因，leave a tag。</p><h3 id="浮点精度计算-http-www-jianshu-com-p-25d24a184016"><a href="#浮点精度计算-http-www-jianshu-com-p-25d24a184016" class="headerlink" title="浮点精度计算  http://www.jianshu.com/p/25d24a184016"></a>浮点精度计算  <a href="http://www.jianshu.com/p/25d24a184016" target="_blank" rel="noopener">http://www.jianshu.com/p/25d24a184016</a></h3><p>NSDecimalNumber <em>price1 = [NSDecimalNumber decimalNumberWithString:@”15.99”];<br>NSDecimalNumber </em>price2 = [NSDecimalNumber decimalNumberWithString:@”29.99”];<br>NSDecimalNumber <em>coupon = [NSDecimalNumber decimalNumberWithString:@”5.00”];<br>NSDecimalNumber </em>discount = [NSDecimalNumber decimalNumberWithString:@”.90”];<br>NSDecimalNumber <em>numProducts = [NSDecimalNumber decimalNumberWithString:@”2.0”];<br>NSDecimalNumber </em>subtotal = [price1 decimalNumberByAdding:price2];//price1+price2<br>NSDecimalNumber <em>afterCoupon = [subtotal decimalNumberBySubtracting:coupon];//subtotal-conpon<br>NSDecimalNumber </em>afterDiscount = [afterCoupon decimalNumberByMultiplyingBy:discount];//afterCoupon<em>discount<br>NSDecimalNumber </em>average = [afterDiscount decimalNumberByDividingBy:numProducts];//afterDiscount/2<br>NSDecimalNumber <em>averageSquared = [average decimalNumberByRaisingToPower:2];//average</em>average<br>NSLog(@”Subtotal: %@”, subtotal);                       // 45.98<br>NSLog(@”After coupon: %@”, afterCoupon);                // 40.98<br>NSLog((@”After discount: %@”), afterDiscount);          // 36.882<br>NSLog(@”Average price per product: %@”, average);       // 18.441<br>NSLog(@”Average price squared: %@”, averageSquared);    // 340.070481</p><h3 id="iOS多target-http-www-cnblogs-com-yajunLi-p-6001132-html"><a href="#iOS多target-http-www-cnblogs-com-yajunLi-p-6001132-html" class="headerlink" title="iOS多target http://www.cnblogs.com/yajunLi/p/6001132.html"></a>iOS多target <a href="http://www.cnblogs.com/yajunLi/p/6001132.html" target="_blank" rel="noopener">http://www.cnblogs.com/yajunLi/p/6001132.html</a></h3><p>iOS 如何创建多个target，同时表达多target的意义</p><h3 id="理解的营收模式"><a href="#理解的营收模式" class="headerlink" title="理解的营收模式"></a>理解的营收模式</h3><p>1：类似onePassword   可以试用1个月 然后，需要购买服务，，收费，，也不贵，，大概也是6、7、10块这样的，永久使用，，，<br>2：限制一些输入，，比如用户可以选择我们给的默认文案，但是用户要自定义，，那就收费，，再给会员予以多个账本创建能力，，，未付费仅能使用1个<br>3：增值服务收费吧；云同步，导出账本，这一类功能开放<br>4：增值服务和广告</p><p>多快好省</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/08/24lesson</title>
      <link href="/2017/08/24/2017-08-24lesson/"/>
      <url>/2017/08/24/2017-08-24lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/08/07<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">vim .gitignore</span><br><span class="line"></span><br><span class="line">*/build/*</span><br><span class="line">*.pbxuser</span><br><span class="line">!default.pbxuser</span><br><span class="line">*.mode1v3</span><br><span class="line">!default.mode1v3</span><br><span class="line">*.mode2v3</span><br><span class="line">!default.mode2v3</span><br><span class="line">*.perspectivev3</span><br><span class="line">!default.perspectivev3</span><br><span class="line">xcuserdata</span><br><span class="line">profile</span><br><span class="line">*.moved-aside</span><br><span class="line">DerivedData</span><br><span class="line">.idea/</span><br><span class="line">*.hmap</span><br><span class="line">DS_Store</span><br><span class="line"></span><br><span class="line">#CocoaPods</span><br><span class="line">Pods</span><br><span class="line">Podfile.lock</span><br><span class="line">build*</span><br><span class="line">pics*</span><br><span class="line">a.diff</span><br></pre></td></tr></table></figure></p><p>这时还没生效，要么全部quit掉，要么clean cache：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">改动过.gitignore文件之后，在repo的根目录下运行：</span><br><span class="line">git rm -r --cached .</span><br><span class="line">git add .</span><br><span class="line">之后可以进行提交：</span><br><span class="line">git commit -m &quot;fixed untracked files&quot;w</span><br></pre></td></tr></table></figure></p><h3 id="最近在学习openGL-ES"><a href="#最近在学习openGL-ES" class="headerlink" title="最近在学习openGL ES"></a>最近在学习openGL ES</h3><p>发现这没有速成方法，遂接下来要每天都抄写熟悉，熟练。这，是一门必修课，肯定会有大用处的。<br>另附学习的metaball学习，还没学成，继续。<br>罗列好的学习网址：</p><ul><li><a href="http://labs.byhook.com/2011/09/26/vector-metaballs/" target="_blank" rel="noopener">http://labs.byhook.com/2011/09/26/vector-metaballs/</a></li><li><a href="https://github.com/Dillion/VectorMetaballs" target="_blank" rel="noopener">https://github.com/Dillion/VectorMetaballs</a></li><li><a href="http://t-machine.org/index.php/2013/10/18/ios-open-gl-es-2-multiple-objects-at-once/" target="_blank" rel="noopener">http://t-machine.org/index.php/2013/10/18/ios-open-gl-es-2-multiple-objects-at-once/</a></li><li><a href="https://www.khronos.org/opengl/wiki/Framebuffer_Object_Extension_Examples" target="_blank" rel="noopener">https://www.khronos.org/opengl/wiki/Framebuffer_Object_Extension_Examples</a></li><li><a href="http://blog.db-in.com/all-about-opengl-es-2-x-part-2/#primitives" target="_blank" rel="noopener">http://blog.db-in.com/all-about-opengl-es-2-x-part-2/#primitives</a></li><li><a href="https://github.com/kesalin/OpenGLES" target="_blank" rel="noopener">https://github.com/kesalin/OpenGLES</a></li><li><a href="http://www.jianshu.com/p/750fde1d8b6a" target="_blank" rel="noopener">http://www.jianshu.com/p/750fde1d8b6a</a></li><li><a href="https://www.raywenderlich.com/3664/opengl-tutorial-for-ios-opengl-es-2-0" target="_blank" rel="noopener">https://www.raywenderlich.com/3664/opengl-tutorial-for-ios-opengl-es-2-0</a></li><li><a href="https://www.raywenderlich.com/4404/opengl-es-2-0-for-iphone-tutorial-part-2-textures" target="_blank" rel="noopener">https://www.raywenderlich.com/4404/opengl-es-2-0-for-iphone-tutorial-part-2-textures</a></li><li><a href="http://blog.csdn.net/icetime17/article/details/50429658" target="_blank" rel="noopener">http://blog.csdn.net/icetime17/article/details/50429658</a></li><li><a href="http://www.cnblogs.com/salam/p/5113572.html" target="_blank" rel="noopener">http://www.cnblogs.com/salam/p/5113572.html</a></li><li><a href="http://mobile.51cto.com/app-show-436793.htm" target="_blank" rel="noopener">http://mobile.51cto.com/app-show-436793.htm</a></li><li><a href="http://blog.csdn.net/yzfuture2010/article/details/7799800" target="_blank" rel="noopener">http://blog.csdn.net/yzfuture2010/article/details/7799800</a></li></ul><p>小的app 的生存之道就只有做好，然后苹果推荐。不然没有推广，再好都没用。是金子总会发光，可会发光的金子，时间一长，人就变了胃口喜欢钞票了。IT，时时刻刻要变化。说这些就是要推荐，那随随便便就可以苹果推荐了？？想多了，我查看了推过苹果推荐的，要么是公司花人力物力累积，要么是大牛写写出来绚丽。所以好的东西，需要的沉淀是必然的。没有花心思，只是小东西，苹果商店不缺，只有好的拼一把，才能出众！！！<br>openGL ES 这是非学不可。只要在我要用的领域学够！！！</p><h3 id="使用宏忽略警告-http-blog-csdn-net-majiakun1-article-details-46424925"><a href="#使用宏忽略警告-http-blog-csdn-net-majiakun1-article-details-46424925" class="headerlink" title="使用宏忽略警告 http://blog.csdn.net/majiakun1/article/details/46424925"></a>使用宏忽略警告 <a href="http://blog.csdn.net/majiakun1/article/details/46424925" target="_blank" rel="noopener">http://blog.csdn.net/majiakun1/article/details/46424925</a></h3><p>1.使用函数指针方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SEL selector = NSSelectorFromString(@&quot;someMethod&quot;);</span><br><span class="line">IMP imp = [_controller methodForSelector:selector];</span><br><span class="line">void (*func)(id, SEL) = (void *)imp;</span><br><span class="line">func(_controller, selector);</span><br></pre></td></tr></table></figure></p><p>当有额外参数时，如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SEL selector = NSSelectorFromString(@&quot;processRegion:ofView:&quot;);</span><br><span class="line">IMP imp = [_controller methodForSelector:selector];</span><br><span class="line">CGRect (*func)(id, SEL, CGRect, UIView *) = (void *)imp;</span><br><span class="line">CGRect result = func(_controller, selector, someRect, someView);</span><br></pre></td></tr></table></figure></p><p>2.使用宏忽略警告<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#pragma clang diagnostic push </span><br><span class="line">#pragma clang diagnostic ignored &quot;-Warc-performSelector-leaks&quot; </span><br><span class="line">   [someController performSelector: NSSelectorFromString(@&quot;someMethod&quot;)]</span><br><span class="line">#pragma clang diagnostic pop</span><br></pre></td></tr></table></figure></p><p>通过使用#pragma clang diagnostic push/pop，你可以告诉Clang编译器仅仅为某一特定部分的代码来忽视特定警告。<br>如果需要忽视的警告有多处，可以定义一个宏<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#define SuppressPerformSelectorLeakWarning(Stuff) \</span><br><span class="line">    do &#123; \</span><br><span class="line">        _Pragma(&quot;clang diagnostic push&quot;) \</span><br><span class="line">        _Pragma(&quot;clang diagnostic ignored \&quot;-Warc-performSelector-leaks\&quot;&quot;) \</span><br><span class="line">        Stuff; \</span><br><span class="line">        _Pragma(&quot;clang diagnostic pop&quot;) \</span><br><span class="line">    &#125; while (0)</span><br></pre></td></tr></table></figure></p><p>在产生警告也就是performSelector的地方用使用该宏，如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SuppressPerformSelectorLeakWarning(</span><br><span class="line">    [_target performSelector:_action withObject:self]</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>如果需要performSelector返回值的话，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id result;</span><br><span class="line">SuppressPerformSelectorLeakWarning(</span><br><span class="line">    result = [_target performSelector:_action withObject:self]</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><h3 id="iOS时区"><a href="#iOS时区" class="headerlink" title="iOS时区"></a>iOS时区</h3><pre><code>ADT = &quot;America/Halifax&quot;;AKDT = &quot;America/Juneau&quot;;AKST = &quot;America/Juneau&quot;;ART = &quot;America/Argentina/Buenos_Aires&quot;;AST = &quot;America/Halifax&quot;;BDT = &quot;Asia/Dhaka&quot;;BRST = &quot;America/Sao_Paulo&quot;;BRT = &quot;America/Sao_Paulo&quot;;BST = &quot;Europe/London&quot;;CAT = &quot;Africa/Harare&quot;;CDT = &quot;America/Chicago&quot;;CEST = &quot;Europe/Paris&quot;;CET = &quot;Europe/Paris&quot;;CLST = &quot;America/Santiago&quot;;CLT = &quot;America/Santiago&quot;;COT = &quot;America/Bogota&quot;;CST = &quot;America/Chicago&quot;;EAT = &quot;Africa/Addis_Ababa&quot;;EDT = &quot;America/New_York&quot;;EEST = &quot;Europe/Istanbul&quot;;EET = &quot;Europe/Istanbul&quot;;EST = &quot;America/New_York&quot;;GMT = GMT;GST = &quot;Asia/Dubai&quot;;HKT = &quot;Asia/Hong_Kong&quot;;HST = &quot;Pacific/Honolulu&quot;;ICT = &quot;Asia/Bangkok&quot;;IRST = &quot;Asia/Tehran&quot;;IST = &quot;Asia/Calcutta&quot;;JST = &quot;Asia/Tokyo&quot;;KST = &quot;Asia/Seoul&quot;;MDT = &quot;America/Denver&quot;;MSD = &quot;Europe/Moscow&quot;;MSK = &quot;Europe/Moscow&quot;;MST = &quot;America/Denver&quot;;NZDT = &quot;Pacific/Auckland&quot;;NZST = &quot;Pacific/Auckland&quot;;PDT = &quot;America/Los_Angeles&quot;;PET = &quot;America/Lima&quot;;PHT = &quot;Asia/Manila&quot;;PKT = &quot;Asia/Karachi&quot;;PST = &quot;America/Los_Angeles&quot;;SGT = &quot;Asia/Singapore&quot;;UTC = UTC;WAT = &quot;Africa/Lagos&quot;;WEST = &quot;Europe/Lisbon&quot;;WET = &quot;Europe/Lisbon&quot;;WIT = &quot;Asia/Jakarta&quot;;</code></pre><h3 id="离开海外部-稍微总结一下"><a href="#离开海外部-稍微总结一下" class="headerlink" title="离开海外部,稍微总结一下"></a>离开海外部,稍微总结一下</h3><p>twitter 分享，是不跳转<br>instagram 只能分享图片<br>twitter 在创建完app key、secret 时需要在permission 里面再设置一项：获得access 能力。同时update。<br>外国在UI上注重的比国内要强很多。外国在矩阵、重度OpenGL 比国内要强很多。</p><h3 id="Reveal-iFile-路径"><a href="#Reveal-iFile-路径" class="headerlink" title="Reveal_iFile_路径"></a>Reveal_iFile_路径</h3><p><a href="http://www.cnblogs.com/blfbuaa/p/7248252.html" target="_blank" rel="noopener">http://www.cnblogs.com/blfbuaa/p/7248252.html</a><br>这时候，我们在Mac浏览器里打开192.168.<em>.**</em>，就能够查看iPhone上的文件系统。并上传文件到iPhone了。</p><p>打开Mac上的Reveal。并选择”Help”-“Show Reveal Library in Finder”。这时候有2个文件：Reveal.framework和libReveal.dylib。</p><p>将Reveal.framework压缩(不能上传文件夹)并上传到iPhone的”/System/Library/Frameworks/”文件夹中，然后解压缩；</p><p>在iFile里打开”应用程序”文件夹(iFile的内置书签)，找到你想查看的APP文件夹里的info.plist文件。查找这个APP的Bundle ID，如果为com.example.domain。</p><p>在Mac上创建libReveal.plist，编辑内容为：<br>“`<br>{<br>Filter={<br>Bundles = “com.example.domain”;<br>}<br>}<br>上传libReveal.plist到”/Library/MobileSubstrate/DynamicLibraries”，也就是和libReveal.dylib在一起。</p><p>最后一步。重新启动iPhone。然后打开想要查看的APP。Mac上的Reveal就有反应啦！</p><h3 id="记一次GPUImage-在export-movie-内存暴涨，崩溃问题"><a href="#记一次GPUImage-在export-movie-内存暴涨，崩溃问题" class="headerlink" title="记一次GPUImage 在export movie 内存暴涨，崩溃问题"></a>记一次GPUImage 在export movie 内存暴涨，崩溃问题</h3><p>原因是在GPUImage 加了UIElementFilter 现实纹理，其在update中需要update 操作。机型是iOS 9 以上，只要视频大于2分钟，就一定出现崩溃现象。原因为，uielement 在update 内部操作中没有进行及时内存释放。此时操作，是将@autoreleasepool { [x update]; }包裹即可解决。 </p><h3 id="记一次比较闹心的事"><a href="#记一次比较闹心的事" class="headerlink" title="记一次比较闹心的事"></a>记一次比较闹心的事</h3><p>之前从海外组回归到原本团队，海外组探求之后，没能做到利益，没办法，其实海外领队和其中内部全部开发:两个开发-.-都知道。这其实是一个没有绝对胜仗可打的局。前面没有路走，只有试试、只有闯闯，成功就成功，失败领队都没有怨言，壮士扼腕，是我觉得的扼腕。<br>回来之后我完成原本project内部的业务部分。正如当时进来时，大师和我们说的，这里面基本都是业务，全是业务。<br>是的，基本都是业务，按照其中条条框框，按部就班，规规矩矩。<br>重回到之前状态，还是没找到感觉，但一回来就给我weex 和内部代码之间的交互。那好，我搞搞，建了个类写一写，写到一半，他们又说继承他们的。好好好，继承你们的，想着他们还可能用得上这个，没去掉，至少之后可以继续扩展下去，就留着那个类，这个留着后话。<br>继承他人的类，那个类不小啊，，700多行，然后其有一些view 是weex 交流。weex 的html是军哥那边搞的，他都没做好，我要和他一起搞。继承的类，想着尽量不动那些代码，就用for 循环 把其上的view 全部删了。那个页面真不要啊，和他们讨论，他们说要是有要添加的，那不就一块没啦。。听到这里我蛋疼的一比。这是weex 页面，客户端要改也是在我新添加的层上加啊。我仅仅是使用你的功能而已，整个view 都应该给你扔了了，全部在我新写的功能页面上才对。虽然我知道，这种删除做法是绝对的错误，但是，他适用在这。<br>接下来是一个打log 的问题上。这个project 能使用的log 有：CCLog、DLog、FSLog、等等等，NSLog 我也不清楚他们有否在Release 上去掉相应的定义，所以尽量不敢用NSLog。那就想着用我以前用的CCLog吧。然而问题又来了，不要打CCLog 啊(我当时还不知道有DLog这玩意)，难道用console window，用断点。我曹，我都骂出来。我现在用的黑苹果，不知为何其在大型项目会这么卡，编译也比较慢。先讲断点，我用的iPhone 6s，project如果不在断点页面运行，那么肯定断点几乎就不相应的；在相应断点页面却也不一定出来，出来也卡的半死。再讲我未断点和断点切换都能卡，我要特么不打log，是别想开发了。而且这种业务型的，不看内里数据，是无法继续的了，这又是一个蛋疼。<br>再说一个我的缺点吧，这是我的不对地方：<br>我不爱写注释。我不写注释，前提是东西简单、业务单项、方法名已经取好了。还有就是我从海外部转回来，作为我安分守己的性格，尽量都是做到不动其他代码，于是出现了我新建一个和之前类名很类似的类，却没有把他删除。我有错这个，但却不能错在我。我回来的时候，什么都没有知会，没有权利，只有义务。说我好歹是中级开发者，代码却没有好好维护，写不好代码，这我就更不同意了，我就一码农，开开心心生活的码农，，，开开心心多好，哈哈哈<br>接下来还是一个蛋疼的地方，注释掉的东西，我有时会留在那里。一个类东西不多，注释掉的有些用处，或者不太占位置，我就不会太在意那些。<br>于是在这次也特别说我的这点，这点我认了。之后勤快些吧，尽量谢谢注释吧，毕竟确实是我不对；如果有需要删除、测试代码等对源码可能造成影响的，我都要注意了；毕竟这也是个人修养，对我有好处，让我升级为好好码农也是不错的。。。<br>继承他人，有我不需要实现的功能，甚至替换他人代码层面，看到那些就蛋疼了。<br>最最最后说一个。我特么一过来就丢给我一个UI、丢一个wiki、我都还是不知道里面什么鬼，要问个人要转好几个弯，来来回回，晕头转向，过去了，大师态度我自己知道，说的很迷糊那种，问回来了还是迷迷糊糊。然而项目已经把时间差不多给你定好了。<br>你说蛋疼不。发版的时间就这么几天，那边都还没做好，下一个要做的功能又来了。<br>这次说我，我觉得很小题大作，我觉得无所谓，我会吸取教训，“小心、小心再小心”而已。我只是那只跳起来的鸡，刚好从海外组过来，是该杀杀锐气的。也为他人警示，警示也是有好处的警示，我认了。<br>规范也没说，那就个人尽量做好即可。我那一两个空文件，project 就卡的半死啦？？<br>那么多的重复库，重复定义，奇奇怪怪的内容、图片，就把我说一通？？<br>这个我嘴里服，心里也不服。说我不把项目当自己的搞，毛蛋！我要是不当回事，我代码就能写成以完成任务为主了。<br>再说之前那个类，那个类是我特么要写着留下来升华的，不用我早删了好伐，虽然不见得目前这个功能还没好，我可能会后面补上，但这个本来我就是要自己写，被你们决定要换思路的好伐，忘记是正常的，我现在还不知道这个weex内部怎么沟通的，脑子还是一团浆糊咧，哪可能记得那个啊。不要说你们写demo的时候第一次写把每个api 铭记，能记住的往后站，大部分都记不住好伐。我特么不标榜自己是多高尚的人，多聪明的人，我特么就是个努力的人，仅仅努力而已，我也不想我能写出多么超级超级好的代码，中国人是需要生活的，不是码神。<br>OK，说了那么多，是该说重点了。<br>这么多年来，我一直说着，学完这一个，是会上升自己空间了，学完这一个，我又更强大了，基本在这个层面的人都是比较好的，普遍普通类别之上的了。但是还是不够。我来当前公司，其实就是奔着学习而来。其实已经大差不差。比如一些思维开拓，一些产品思维、一些业务逻辑，一些控制管理，把控等，在新的知识储备方面也更加的好了，也更多的接触到底层，能做更好的了。<br>其实好的东西不是说拼命往上赶，拼命往上堆叠，就能好的。<br>好的东西，都是要有好的技术，好的底层。正如我之前思考的，很多的好的，能令人轰动的都是别人能学其表，难成其里的，好在了内在，真正的技术。其实现在我所做的，不过就是真的业务员，能研究的机会都不多，再难一点的东西都是局限于业务、功能块内，不能超脱，比如我们的技术领导“大师”，都把东西做到一半了，其他只不过是堆叠。<br>我自己私下，需要有两个地方开花。第一是面向工资编程的实现，没有金钱入手，什么都是没用的。<br>第二是将我这三十岁之前最后一个，最难的的东西学好：opengl。<br>以前确实都不是我该学习该物的时候，但，现在已经可以。以前的知识储备完全不能理解其中变化，现在已经能够得着了，也就是时候了。<br>是时候了。<br>想想兰姐2年5多部电影。我更努力学习难道不应该乎？</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/7/30lesson</title>
      <link href="/2017/07/30/2017-7-30lesson/"/>
      <url>/2017/07/30/2017-7-30lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="新App上传"><a href="#新App上传" class="headerlink" title="新App上传"></a>新App上传</h3><p>上传碰见这事：构建的版本上去了，也出现在构建版本里面，不过过没一会就消失了。由于邮箱什么的都不在我这，过了好久才想起来，用的另一个邮箱，于是去看看有没有什么说明：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Dear developer,</span><br><span class="line">We have discovered one or more issues with your recent delivery for &quot;Color Saga - Coloring book&quot;. To process your delivery, the following issues must be corrected:</span><br><span class="line">Non-public API usage:</span><br><span class="line">The app references non-public symbols in XXT: _UICreateCGImageFromIOSurface</span><br><span class="line">If method names in your source code match the private Apple APIs listed above, altering your method names will help prevent this app from being flagged in future submissions. In addition, note that one or more of the above APIs may be located in a static library that was included with your app. If so, they must be removed.</span><br><span class="line">If you think this message was sent in error and that you have only used Apple-published APIs in accordance with the guidelines, send the app&apos;s nine-digit Apple ID, along with detailed information about why you believe the above APIs were incorrectly flagged, to appreview@apple.com. For further information, visit the Technical Support Information page.</span><br><span class="line">Missing Info.plist key - This app attempts to access privacy-sensitive data without a usage description. The app&apos;s Info.plist must contain an NSCalendarsUsageDescription key with a string value explaining to the user how the app uses this data.</span><br><span class="line">Missing Info.plist key - This app attempts to access privacy-sensitive data without a usage description. The app&apos;s Info.plist must contain an NSPhotoLibraryUsageDescription key with a string value explaining to the user how the app uses this data.</span><br><span class="line">Missing Info.plist key - This app attempts to access privacy-sensitive data without a usage description. The app&apos;s Info.plist must contain an NSBluetoothPeripheralUsageDescription key with a string value explaining to the user how the app uses this data.</span><br><span class="line">Missing Info.plist key - This app attempts to access privacy-sensitive data without a usage description. The app&apos;s Info.plist must contain an NSMicrophoneUsageDescription key with a string value explaining to the user how the app uses this data.</span><br><span class="line">Missing Info.plist key - This app attempts to access privacy-sensitive data without a usage description. The app&apos;s Info.plist must contain an NSMotionUsageDescription key with a string value explaining to the user how the app uses this data.</span><br><span class="line">Once these issues have been corrected, you can then redeliver the corrected binary.</span><br><span class="line">Regards,</span><br><span class="line">The App Store team</span><br></pre></td></tr></table></figure><p>然后就找到这篇文章，唉，，Reavel我按照教程，说不出问题了呀，但还是出这个问题了。</p><p><a href="http://www.cnblogs.com/WayneLiu/p/5251565.html" target="_blank" rel="noopener">http://www.cnblogs.com/WayneLiu/p/5251565.html</a></p><h3 id="YTKNetWork-在cacheData-时出错"><a href="#YTKNetWork-在cacheData-时出错" class="headerlink" title="YTKNetWork 在cacheData 时出错"></a>YTKNetWork 在cacheData 时出错</h3><p>缘由是cacheData数据没有在拿到缓存之后继续跟服务器获取，查到<a href="https://github.com/yuantiku/YTKNetwork/issues/106" target="_blank" rel="noopener">https://github.com/yuantiku/YTKNetwork/issues/106</a><br>处理为下例:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">XXHomeCateListApi *cateListApi = [[XXHomeCateListApi alloc]initWithData:@&#123;@&quot;category_id&quot;:self.cateModel.id,@&quot;start&quot;:input,@&quot;category_name&quot;:self.cateModel.name&#125;];</span><br><span class="line">if ([cateListApi loadCacheWithError:nil]) &#123;</span><br><span class="line">[self requestSuccessWithapi:cateListApi subscriber:subscriber];</span><br><span class="line">&#125;</span><br><span class="line">cateListApi = [[XXHomeCateListApi alloc]initWithData:@&#123;@&quot;category_id&quot;:self.cateModel.id,@&quot;start&quot;:input,@&quot;category_name&quot;:self.cateModel.name&#125;];</span><br><span class="line">[cateListApi startWithoutCache];</span><br><span class="line">[cateListApi startWithCompletionBlockWithSuccess:^(__kindof YTKBaseRequest * _Nonnull request) &#123;</span><br><span class="line">&#125; failure:^(__kindof YTKBaseRequest * _Nonnull request) &#123;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><h3 id="InAPPPurchase"><a href="#InAPPPurchase" class="headerlink" title="InAPPPurchase"></a>InAPPPurchase</h3><p>这几天有做内购遇到的问题</p><ul><li>首先是刚进入先确认一次内购金额和手机当前货币的对比，保存该数据（如果没有获取到则显示默认的美金金额）如</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">+(void)queryProductMoney&#123;</span><br><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">NSArray *googsArray = @[@&quot;0&quot;,@&quot;1&quot;,@&quot;12&quot;];</span><br><span class="line">NSSet *products = [NSSet setWithArray:googsArray];</span><br><span class="line">[[RMStore defaultStore] requestProducts:products success:^(NSArray *products, NSArray *invalidProductIdentifiers) &#123;</span><br><span class="line">NSLog(@&quot;Products loaded&quot;);</span><br><span class="line">NSMutableDictionary *priceDic = [@&#123;&#125; mutableCopy];</span><br><span class="line">[products enumerateObjectsUsingBlock:^(SKProduct*  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">LxDBAnyVar(obj);</span><br><span class="line">NSString *str = [XXPurchaseRequest currencyPriceWithProduct:obj];</span><br><span class="line">[priceDic setObject:str forKey:obj.productIdentifier];</span><br><span class="line">&#125;];</span><br><span class="line">[USERDEFAULT setObject:priceDic forKey:kAPPProduct];</span><br><span class="line">&#125; failure:^(NSError *error) &#123;</span><br><span class="line">&#125;];</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样便能显示出你当前要展示的加个信息了。</p><ul><li>关于内购时省查最严的就是More Info这个关键词。More Info 填写在有持续性扣费，会更加严格，我们当时在“Mine APP” 备注加上<br><code>we have the purchase info at setting page ,click the &quot;Subscription FAQ&quot;&amp;&quot;About&quot; which user purchase info is display there. when user is about to pay, there have a button name &quot;more info&quot; , user can get enough help with that.</code></li></ul><p>然后在相应位置提供more info。特么注明要有如以下词汇：改词汇来自“ColorSaga”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ColorSaga Premium</span><br><span class="line">- With ColorSaga Premium you can subscribe for daily new picture updates and unlimited access to the full picture catalog</span><br><span class="line">- You&apos;ll be able to access all available pictures</span><br><span class="line">- The subscriptions are $2.99 USD weekly, $7.99 USD monthly and $39.99 USD annually or equal to the same price tier that &quot;Apple&apos;s App Store Matrix&quot; determines in other currencies.</span><br><span class="line">- You may cancel a subscription or free-trial anytime via the subscription setting through your iTunes account. This must be done 24 hours before the end of the free-trial or subscription period to avoid being charged.</span><br><span class="line">- Subscription automatically renews unless auto-renew is turned off at least 24-hours before the end of the current period. No cancellation of the current subscription is allowed during active subscription period. Any unused portion of a free-trial period, will be forfeited when the user purchases a ColorSaga Premium</span><br><span class="line"></span><br><span class="line">Terms of use: http://d.fenfenriji.com/colorx/html/termsOfService.html</span><br><span class="line">Privacy policy: http://d.fenfenriji.com/colorx/html/privacyPolicy.html</span><br></pre></td></tr></table></figure><ul><li>技术支持URL</li></ul><p>可以使用github 网址或者博客网址，但是一定要有两个因素：1，该为为xxx提供技术支持 2，该含有联系电话或联系邮箱</p><ul><li>在上线一两天之后开始做一次应用购买以提升曝光率。小技巧</li></ul><p>应用如果有付费情况，然后过几天之后就解开，那么会有一些网站给该应用写报道，称限免应用，这样会出现一波高增长。</p><h3 id="CaLayer-drawInContext-绘图方法，出现-lt-Error-gt-CGContextSetFlatness-invalid-context-0x0-If-you-want-to-see-the-backtrace-please-set-CG-CONTEXT-SHOW-BACKTRACE-environmental-variable"><a href="#CaLayer-drawInContext-绘图方法，出现-lt-Error-gt-CGContextSetFlatness-invalid-context-0x0-If-you-want-to-see-the-backtrace-please-set-CG-CONTEXT-SHOW-BACKTRACE-environmental-variable" class="headerlink" title="CaLayer drawInContext 绘图方法，出现&lt;Error&gt;: CGContextSetFlatness: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable."></a>CaLayer drawInContext 绘图方法，出现<code>&lt;Error&gt;: CGContextSetFlatness: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable.</code></h3><p>在<code>-(void)drawInContext:(CGContextRef)ctx</code>方法开始第一句加上<code>UIGraphicsPushContext(ctx);</code>，因为当前绘图上下文在上层</p><h3 id="UIColor-colorWithPattern-gt-提供一个图"><a href="#UIColor-colorWithPattern-gt-提供一个图" class="headerlink" title="UIColor colorWithPattern-&gt;提供一个图"></a>UIColor colorWithPattern-&gt;提供一个图</h3><p>最近在做绘图工具，思考要一个东西。即要画一个有texture layer的图，没法输入。一开始有想法说在layer的contents，将图片叠加之后的image填为contents，后来重新看到这个方法即想到了，我可以使用color 的其中一个方法colorWithPattern的方法得到texture 图了。</p><h3 id="上海办理公积金"><a href="#上海办理公积金" class="headerlink" title="上海办理公积金"></a>上海办理公积金</h3><p>由于公积金可以付房租，对于待上海人来说能缓解很大很大的压力。这里给出前几天去办理大概过程。<br>地点：##汉中路120号##。地铁下来之后找到#汉中路#出口，走上楼梯之后往右走。大概100米有个不是门的小入口有一个向上的logo，写着上二楼。<br>上二楼之后填写两张表格，记得人多先取等号机。<br>需要的材料：<br>(结婚)结婚证、两人一起去(看情况，那次老婆先去也办成功，尽量一起去吧)、身份证、银行卡(上海银行卡、办理支行,作用是到时办理人员要刷一下)、手机；<br>未结婚的话，除去结婚证其他同样；<br>金额：每人（每户）最多2000，按季度发放，家庭办理一个之后，扣完款没有余额了才能办理另一个人的；<br>办理成功大概需要半个月；<br>上班时间：上午9点到11点40左右 下午一点半到4点半左右；</p><h3 id="通过越狱机iFile-导出手机数据"><a href="#通过越狱机iFile-导出手机数据" class="headerlink" title="通过越狱机iFile 导出手机数据"></a>通过越狱机iFile 导出手机数据</h3><p>由于手机不是完美越狱，很久没更新，导入导出数据都巨麻烦。这里提供一个思路。由于iFunbox提供导入导出路径在Home 的Media文件目录。<br>首先，app 路径在/var/containers/Bundle/Application 里面找到自己要的数据，右上角Edit，右下角Copy。然后点击中间的Home键，翻到Media目录，Paste。<br>在电脑使用iFunbox 到Media目录，然后导出改文件。导入文件也同理反操作。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/0709lesson</title>
      <link href="/2017/07/09/2017-0709lesson/"/>
      <url>/2017/07/09/2017-0709lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="2017-05-31"><a href="#2017-05-31" class="headerlink" title="2017/05/31"></a>2017/05/31</h3><p>使用UIEffectView 的一个坑：UIEffectView的实现方式是将底部的着色吸附到当前View中。我喜欢使用帧动画，pop更加爱，于是出现一个情况，该effectView在上下滑动时，吸附的图片会出现在之前的位置，很不稳定，估计是使用局部变量编写，然后没有着色在之前的rect上面，出现有刷新当前区域指令的时候，就会清楚这块不稳定内容。<br>这个问题重点在动画上。pop帧动画，采用逐步转移，而不是我现在解决使用的UIView动画。UIView动画是点到终点的动画，而pop是过程可逆的过程动画。</p><h3 id="这里记录一次ASDK中滑动卡顿一愣一愣，以及push卡顿。"><a href="#这里记录一次ASDK中滑动卡顿一愣一愣，以及push卡顿。" class="headerlink" title="这里记录一次ASDK中滑动卡顿一愣一愣，以及push卡顿。"></a>这里记录一次ASDK中滑动卡顿一愣一愣，以及push卡顿。</h3><p>ASDK滑动卡顿解决过程，使用将其他因素全部关掉方法。心里解决难，是因为其还有其他可能卡顿因素，所以不觉得是因为在ASDK内容物问题，因为试图由好几个层级嵌套合成。真正卡顿在ASCellNode里面，由于设计图要有cornerRadius ，单元格要有shadow，于是我加在didLoad方法里面。但是每次滑动过程，可能走到了shadow 过程，于是试图又尝试算了一遍。<br>push卡顿问题，首先要理解试图从创建过程，到压栈完成的流程。首先走init方法、接着走pushViewcontroller、viewDidLoad方法、然后走push压栈动画、最后viewwillappear。由于压栈动画是要有主线程的，当然viewDidLoad中也是有主线程卡主，那么也会有进入很慢的过程。<br>这次是因为我加了一个小方法-&gt;使用SVGKit 加载一个svg 然后转成image过程。在其中一个UIView的子UIButton使用了该转换的Image，于是我一次次打log，计算时间消耗，该处消耗0.6s，而且是在主线程，于是该处出现了卡顿。</p><h3 id="锤子和钉子，工具和需求"><a href="#锤子和钉子，工具和需求" class="headerlink" title="锤子和钉子，工具和需求"></a>锤子和钉子，工具和需求</h3><p>前两天在看数据库Realm，后半段功能。然不尽了解内里，所以想问公司其他人了解我所不了解的需求完成过程。但是和他们说的过程中，博士一句话点醒了我：钉子是先存在的，然后找到了锤子解决；而不是拿着锤子寻找钉子。给我的醒悟是，如果我一开始还没有钉子（后半段功能产生的需求），却急于找到锤子，那么没有钉子的需求，很快我也将忘了锤子；所以我慢了下来：在目前碰到的钉子，使用一个个不同的锤子解决。</p><h3 id="记录一次碰到僵尸代码以及解决过程"><a href="#记录一次碰到僵尸代码以及解决过程" class="headerlink" title="记录一次碰到僵尸代码以及解决过程"></a>记录一次碰到僵尸代码以及解决过程</h3><p>当前页面是这样：push到的DetailVC 有navigationDelegate，作为转场代理，DetailVC操作完进入“完成、分享页面”，然后有这一份代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.tabBarController.selectedIndex = 1;</span><br><span class="line">[self.navigationController popToRootViewControllerAnimated:NO];</span><br></pre></td></tr></table></figure></p><p>让其转向tabbar为1（之前tabbarindex=0），然后popToRootVC；这里引导出了一个问题，我再点击Tabbar=0时，此时的navigationDelegate还是detailVC，但是却早已经被dealloc了，于是就崩溃。解决是viewwillDisappear处将navigationDelegate置空。<br>OK，代码解决为之上处理，但是一开始碰到这个crash的时候，程序什么提示都没有，直接进入AppDelegate的“Bad Access XXXX”。查阅资料：<a href="http://www.cocoachina.com/bbs/read.php?tid-257873.html" target="_blank" rel="noopener"></a> :你得先知道哪报错，按下面设一下，结合日志，先找到错误的代码,<br>设置NSZombieEnabled、MallocStackLogging、NSAutoreleaseFreedObjectCheckEnabled、NSDebugEnabled：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. Product-&gt;Edit Scheme...-&gt;Run...-&gt;EnvironmentVariables. </span><br><span class="line">2. add NSZombieEnabled，set the value with YES</span><br><span class="line">3. add MallocStackLogging, set the value with YES.</span><br><span class="line">4. add NSAutoreleaseFreedObjectCheckEnabled, set the value with YES.</span><br><span class="line">5. add NSDebugEnabled, set the value with YES.</span><br></pre></td></tr></table></figure></p><p>这时程序console才会打出说<code>*** -[XXXXXViewC respondsToSelector:]: message sent to deallocated instance 0x134ed5900</code><br>这时又借鉴这两篇文章:<a href="http://www.cnblogs.com/myblog-12368/p/4367034.html" target="_blank" rel="noopener"></a><br><a href="http://blog.csdn.net/smking/article/details/43775523" target="_blank" rel="noopener"></a><br>后一篇跟我的很类似，都是根据VC 和 delegate 之间的关系。然后得以解决</p><h3 id="library-not-found-for-lcrt"><a href="#library-not-found-for-lcrt" class="headerlink" title="library not found for -lcrt"></a>library not found for -lcrt</h3><p>出现这个错误，是因为你的测试版本号太高了，以前Demo的版本低于你能运行的版本，解决：Targets-&gt;General-&gt;Deployment Info-&gt;Deployment Target改为当前Xcode能运行的最低版本</p><h3 id="viewModel-xxxCommand-execute-在其返回executionSignals之前调用，不会走executionSignal方法"><a href="#viewModel-xxxCommand-execute-在其返回executionSignals之前调用，不会走executionSignal方法" class="headerlink" title="[viewModel.xxxCommand execute]在其返回executionSignals之前调用，不会走executionSignal方法"></a>[viewModel.xxxCommand execute]在其返回executionSignals之前调用，不会走executionSignal方法</h3><p>今天调试一个网络，由于试试写法execute方法，这次将其写在executionSignals之前，怎么都不会走，我怎么看写法都不可能错，在将挂起方法：execute写到后面才走。在此记录一个，有机会再看是什么缘由。</p><h3 id="iOS跳转到具体某个应用的设置"><a href="#iOS跳转到具体某个应用的设置" class="headerlink" title="iOS跳转到具体某个应用的设置"></a>iOS跳转到具体某个应用的设置</h3><p><a href="http://blog.csdn.net/jsjxiaobing/article/details/51260753" target="_blank" rel="noopener">http://blog.csdn.net/jsjxiaobing/article/details/51260753</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">NSString * UIApplicationOpenSettingsURLString = @&quot;prefs:root=WIFI&quot;;  </span><br><span class="line">NSURL * url = [NSURL URLWithString:UIApplicationOpenSettingsURLString];  </span><br><span class="line">if([[UIApplication sharedApplication] canOpenURL:url]) &#123;  </span><br><span class="line">    [[UIApplication sharedApplication] openURL:url];  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">About — prefs:root=General&amp;path=About  </span><br><span class="line"> Accessibility — prefs:root=General&amp;path=ACCESSIBILITY  </span><br><span class="line"> AirplaneModeOn— prefs:root=AIRPLANE_MODE  </span><br><span class="line"> Auto-Lock — prefs:root=General&amp;path=AUTOLOCK  </span><br><span class="line"> Brightness — prefs:root=Brightness  </span><br><span class="line"> Bluetooth — prefs:root=General&amp;path=Bluetooth  </span><br><span class="line"> Date&amp; Time — prefs:root=General&amp;path=DATE_AND_TIME  </span><br><span class="line"> FaceTime — prefs:root=FACETIME  </span><br><span class="line"> General— prefs:root=General  </span><br><span class="line"> Keyboard — prefs:root=General&amp;path=Keyboard  </span><br><span class="line"> iCloud — prefs:root=CASTLE  iCloud  </span><br><span class="line"> Storage &amp; Backup — prefs:root=CASTLE&amp;path=STORAGE_AND_BACKUP  </span><br><span class="line"> International — prefs:root=General&amp;path=INTERNATIONAL  </span><br><span class="line"> Location Services — prefs:root=LOCATION_SERVICES  </span><br><span class="line"> Music — prefs:root=MUSIC  </span><br><span class="line"> Music Equalizer — prefs:root=MUSIC&amp;path=EQ  </span><br><span class="line"> Music VolumeLimit— prefs:root=MUSIC&amp;path=VolumeLimit  </span><br><span class="line"> Network — prefs:root=General&amp;path=Network  </span><br><span class="line"> Nike + iPod — prefs:root=NIKE_PLUS_IPOD  </span><br><span class="line"> Notes — prefs:root=NOTES  </span><br><span class="line"> Notification — prefs:root=NOTIFICATIONS_ID  </span><br><span class="line"> Phone — prefs:root=Phone  </span><br><span class="line"> Photos — prefs:root=Photos  </span><br><span class="line"> Profile — prefs:root=General&amp;path=ManagedConfigurationList  </span><br><span class="line"> Reset — prefs:root=General&amp;path=Reset  </span><br><span class="line"> Safari — prefs:root=Safari  Siri — prefs:root=General&amp;path=Assistant  </span><br><span class="line"> Sounds — prefs:root=Sounds  </span><br><span class="line"> SoftwareUpdate— prefs:root=General&amp;path=SOFTWARE_UPDATE_LINK  </span><br><span class="line"> Store — prefs:root=STORE  </span><br><span class="line"> Twitter — prefs:root=TWITTER  </span><br><span class="line"> Usage — prefs:root=General&amp;path=USAGE  </span><br><span class="line"> VPN — prefs:root=General&amp;path=Network/VPN  </span><br><span class="line"> Wallpaper — prefs:root=Wallpaper  </span><br><span class="line"> Wi-Fi — prefs:root=WIFI  </span><br><span class="line"> Setting—prefs:root=INTERNET_TETHERING</span><br></pre></td></tr></table></figure></p><h3 id="记一次Instrument-Time-Profile-过程"><a href="#记一次Instrument-Time-Profile-过程" class="headerlink" title="记一次Instrument - Time Profile 过程"></a>记一次Instrument - Time Profile 过程</h3><p>xcode 8.+在使用Time Profile中，会出现信息不完整，没法指示更多有用的信息。<br>首先由这篇文章：<a href="http://www.cnblogs.com/ym123/p/4324335.html能明白大概操作内容。在xcode" target="_blank" rel="noopener">http://www.cnblogs.com/ym123/p/4324335.html能明白大概操作内容。在xcode</a> 8.+中，CallTree被移动到最下方而不是右下角处。然后跟着走的时候，并没有显示文章中说的<code>图标为黑色头像的就是Time Profiler给我们的提示，有可能存在性能瓶颈的地方，可以逐渐向下展开，找到产生的根本原因。</code>这个；<br>我又找了找这篇文章：<a href="http://www.jianshu.com/p/179d69f636b0" target="_blank" rel="noopener">http://www.jianshu.com/p/179d69f636b0</a><br>原来是需要在Target-Build Settings-Debug Information Format-Debug 选择dwarf-with-dsym，如果没有该选项，需要手动打入。<br>同时开启TimeProfile就可以看到黑色头像，同时各个方法调用栈就出来。<br>我的操作是：先点击你需要debug的附近区域，然后CPU Usage会有很多波动，然后你可以暂停（stop，不是shut down）同时选中该波动区域附近，形成一个区间。然后下方的调用栈即为该时间区域的调用信息。即得到所需要信息。</p><h3 id="记一次硬磕UI、转场遇到的问题"><a href="#记一次硬磕UI、转场遇到的问题" class="headerlink" title="记一次硬磕UI、转场遇到的问题"></a>记一次硬磕UI、转场遇到的问题</h3><p>1：转场的时候alpha很重要，比如pushTransitino的时候，toVC的alpha一开始就要设好，如果animate组，半途还有转变动画，那么会带来感觉像是掉帧的bug。fromVC也一样，多调试这一块，结合Time Profile看这中间有没有其他重操作，提前做，或者之后做。<br>2：pop的时候，与push很像。这里提一点，动作与控制要同步，比如转场里面某一元素，如果动画场景不一致，会带来断层，中间的东西没了，然后又有了。比如我后退，立马把该元素隐藏，但是等到要做动画其实还要几毫秒，于是就会出现断层。这时候最好的就是先在contextView中添好该元素试图覆盖，然后再隐藏。<br>多用动画稿，尽量不要埋头苦调试，没有数值真的很麻烦。</p><h3 id="昨晚看到一个帖子列出好的一些iOS片段，我继续删减，留下适合我，我可能会遇到的"><a href="#昨晚看到一个帖子列出好的一些iOS片段，我继续删减，留下适合我，我可能会遇到的" class="headerlink" title="昨晚看到一个帖子列出好的一些iOS片段，我继续删减，留下适合我，我可能会遇到的"></a>昨晚看到一个帖子列出好的一些iOS片段，我继续删减，留下适合我，我可能会遇到的</h3><h5 id="去除数组中重复的对象"><a href="#去除数组中重复的对象" class="headerlink" title="去除数组中重复的对象"></a>去除数组中重复的对象</h5><p><code>NSArray *newArr = [oldArr valueForKeyPath:@“@distinctUnionOfObjects.self&quot;];</code></p><h5 id="动画切换window的根控制器"><a href="#动画切换window的根控制器" class="headerlink" title="动画切换window的根控制器"></a>动画切换window的根控制器</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// options是动画选项</span><br><span class="line">[UIView transitionWithView:[UIApplication sharedApplication].keyWindow duration:0.5f options:UIViewAnimationOptionTransitionCrossDissolve animations:^&#123;</span><br><span class="line">        BOOL oldState = [UIView areAnimationsEnabled];</span><br><span class="line">        [UIView setAnimationsEnabled:NO];</span><br><span class="line">        [UIApplication sharedApplication].keyWindow.rootViewController = [RootViewController new];</span><br><span class="line">        [UIView setAnimationsEnabled:oldState];</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure><h5 id="由角度转换弧度"><a href="#由角度转换弧度" class="headerlink" title="由角度转换弧度"></a>由角度转换弧度</h5><p>`</p><p>#define DegreesToRadian(x) (M_PI * (x) / 180.0)<br>`</p><h5 id="控制屏幕旋转，在控制器中写"><a href="#控制屏幕旋转，在控制器中写" class="headerlink" title="控制屏幕旋转，在控制器中写"></a>控制屏幕旋转，在控制器中写</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/** 是否支持自动转屏 */</span><br><span class="line">- (BOOL)shouldAutorotate &#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/** 支持哪些屏幕方向 */</span><br><span class="line">- (UIInterfaceOrientationMask)supportedInterfaceOrientations &#123;</span><br><span class="line">    return UIInterfaceOrientationMaskLandscapeLeft | UIInterfaceOrientationMaskLandscapeRight;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">/** 默认的屏幕方向（当前ViewController必须是通过模态出来的UIViewController（模态带导航的无效）方式展现出来的，才会调用这个方法） */</span><br><span class="line">- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation &#123;</span><br><span class="line">    return UIInterfaceOrientationLandscapeLeft | UIInterfaceOrientationLandscapeRight;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="几个常用权限判断"><a href="#几个常用权限判断" class="headerlink" title="几个常用权限判断"></a>几个常用权限判断</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    if ([CLLocationManager authorizationStatus] ==kCLAuthorizationStatusDenied) &#123;</span><br><span class="line">        NSLog(@&quot;没有定位权限&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    AVAuthorizationStatus statusVideo = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];</span><br><span class="line">    if (statusVideo == AVAuthorizationStatusDenied) &#123;</span><br><span class="line">        NSLog(@&quot;没有摄像头权限&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    //是否有麦克风权限</span><br><span class="line">    AVAuthorizationStatus statusAudio = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeAudio];</span><br><span class="line">    if (statusAudio == AVAuthorizationStatusDenied) &#123;</span><br><span class="line">        NSLog(@&quot;没有录音权限&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    [PHPhotoLibrary requestAuthorization:^(PHAuthorizationStatus status) &#123;</span><br><span class="line">        if (status == PHAuthorizationStatusDenied) &#123;</span><br><span class="line">            NSLog(@&quot;没有相册权限&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure><h5 id="判断图片类型"><a href="#判断图片类型" class="headerlink" title="判断图片类型"></a>判断图片类型</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">//通过图片Data数据第一个字节 来获取图片扩展名</span><br><span class="line">- (NSString *)contentTypeForImageData:(NSData *)data</span><br><span class="line">&#123;</span><br><span class="line">    uint8_t c;</span><br><span class="line">    [data getBytes:&amp;c length:1];</span><br><span class="line">    switch (c)</span><br><span class="line">    &#123;</span><br><span class="line">        case 0xFF:</span><br><span class="line">            return @&quot;jpeg&quot;;</span><br><span class="line"> </span><br><span class="line">        case 0x89:</span><br><span class="line">            return @&quot;png&quot;;</span><br><span class="line"> </span><br><span class="line">        case 0x47:</span><br><span class="line">            return @&quot;gif&quot;;</span><br><span class="line"> </span><br><span class="line">        case 0x49:</span><br><span class="line">        case 0x4D:</span><br><span class="line">            return @&quot;tiff&quot;;</span><br><span class="line"> </span><br><span class="line">        case 0x52:</span><br><span class="line">        if ([data length] &lt; 12) &#123;</span><br><span class="line">            return nil;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        NSString *testString = [[NSString alloc] initWithData:[data subdataWithRange:NSMakeRange(0, 12)] encoding:NSASCIIStringEncoding];</span><br><span class="line">        if ([testString hasPrefix:@&quot;RIFF&quot;]</span><br><span class="line">            &amp;&amp; [testString hasSuffix:@&quot;WEBP&quot;])</span><br><span class="line">        &#123;</span><br><span class="line">            return @&quot;webp&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        return nil;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    return nil;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="获取手机和app信息"><a href="#获取手机和app信息" class="headerlink" title="获取手机和app信息"></a>获取手机和app信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *infoDictionary = [[NSBundle mainBundle] infoDictionary];  </span><br><span class="line"> CFShow(infoDictionary);  </span><br><span class="line">// app名称  </span><br><span class="line"> NSString *app_Name = [infoDictionary objectForKey:@&quot;CFBundleDisplayName&quot;];  </span><br><span class="line"> // app版本  </span><br><span class="line"> NSString *app_Version = [infoDictionary objectForKey:@&quot;CFBundleShortVersionString&quot;];  </span><br><span class="line"> // app build版本  </span><br><span class="line"> NSString *app_build = [infoDictionary objectForKey:@&quot;CFBundleVersion&quot;];  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    //手机序列号  </span><br><span class="line">    NSString* identifierNumber = [[UIDevice currentDevice] uniqueIdentifier];  </span><br><span class="line">    NSLog(@&quot;手机序列号: %@&quot;,identifierNumber);  </span><br><span class="line">    //手机别名： 用户定义的名称  </span><br><span class="line">    NSString* userPhoneName = [[UIDevice currentDevice] name];  </span><br><span class="line">    NSLog(@&quot;手机别名: %@&quot;, userPhoneName);  </span><br><span class="line">    //设备名称  </span><br><span class="line">    NSString* deviceName = [[UIDevice currentDevice] systemName];  </span><br><span class="line">    NSLog(@&quot;设备名称: %@&quot;,deviceName );  </span><br><span class="line">    //手机系统版本  </span><br><span class="line">    NSString* phoneVersion = [[UIDevice currentDevice] systemVersion];  </span><br><span class="line">    NSLog(@&quot;手机系统版本: %@&quot;, phoneVersion);  </span><br><span class="line">    //手机型号  </span><br><span class="line">    NSString* phoneModel = [[UIDevice currentDevice] model];  </span><br><span class="line">    NSLog(@&quot;手机型号: %@&quot;,phoneModel );  </span><br><span class="line">    //地方型号  （国际化区域名称）  </span><br><span class="line">    NSString* localPhoneModel = [[UIDevice currentDevice] localizedModel];  </span><br><span class="line">    NSLog(@&quot;国际化区域名称: %@&quot;,localPhoneModel );  </span><br><span class="line"> </span><br><span class="line">    NSDictionary *infoDictionary = [[NSBundle mainBundle] infoDictionary];  </span><br><span class="line">    // 当前应用名称  </span><br><span class="line">    NSString *appCurName = [infoDictionary objectForKey:@&quot;CFBundleDisplayName&quot;];  </span><br><span class="line">    NSLog(@&quot;当前应用名称：%@&quot;,appCurName);  </span><br><span class="line">    // 当前应用软件版本  比如：1.0.1  </span><br><span class="line">    NSString *appCurVersion = [infoDictionary objectForKey:@&quot;CFBundleShortVersionString&quot;];  </span><br><span class="line">    NSLog(@&quot;当前应用软件版本:%@&quot;,appCurVersion);  </span><br><span class="line">    // 当前应用版本号码   int类型  </span><br><span class="line">    NSString *appCurVersionNum = [infoDictionary objectForKey:@&quot;CFBundleVersion&quot;];  </span><br><span class="line">    NSLog(@&quot;当前应用版本号码：%@&quot;,appCurVersionNum);</span><br></pre></td></tr></table></figure><h5 id="获取设备mac地址"><a href="#获取设备mac地址" class="headerlink" title="获取设备mac地址"></a>获取设备mac地址</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">+ (NSString *)macAddress &#123;</span><br><span class="line">    int                 mib[6];</span><br><span class="line">    size_t              len;</span><br><span class="line">    char                *buf;</span><br><span class="line">    unsigned char       *ptr;</span><br><span class="line">    struct if_msghdr    *ifm;</span><br><span class="line">    struct sockaddr_dl  *sdl;</span><br><span class="line"> </span><br><span class="line">    mib[0] = CTL_NET;</span><br><span class="line">    mib[1] = AF_ROUTE;</span><br><span class="line">    mib[2] = 0;</span><br><span class="line">    mib[3] = AF_LINK;</span><br><span class="line">    mib[4] = NET_RT_IFLIST;</span><br><span class="line"> </span><br><span class="line">    if((mib[5] = if_nametoindex(&quot;en0&quot;)) == 0) &#123;</span><br><span class="line">        printf(&quot;Error: if_nametoindex error\n&quot;);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    if(sysctl(mib, 6, NULL, &amp;len, NULL, 0) &lt; 0) &#123;</span><br><span class="line">        printf(&quot;Error: sysctl, take 1\n&quot;);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    if((buf = malloc(len)) == NULL) &#123;</span><br><span class="line">        printf(&quot;Could not allocate memory. Rrror!\n&quot;);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    if(sysctl(mib, 6, buf, &amp;len, NULL, 0) &lt; 0) &#123;</span><br><span class="line">        printf(&quot;Error: sysctl, take 2&quot;);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    ifm = (struct if_msghdr *)buf;</span><br><span class="line">    sdl = (struct sockaddr_dl *)(ifm + 1);</span><br><span class="line">    ptr = (unsigned char *)LLADDR(sdl);</span><br><span class="line">    NSString *outstring = [NSString stringWithFormat:@&quot;X:X:X:X:X:X&quot;,</span><br><span class="line">                           *ptr, *(ptr+1), *(ptr+2), *(ptr+3), *(ptr+4), *(ptr+5)];</span><br><span class="line">    free(buf);</span><br><span class="line"> </span><br><span class="line">    return outstring;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="拿到当前正在显示的控制器，不管是push进去的，还是present进去的都能拿到"><a href="#拿到当前正在显示的控制器，不管是push进去的，还是present进去的都能拿到" class="headerlink" title="拿到当前正在显示的控制器，不管是push进去的，还是present进去的都能拿到"></a>拿到当前正在显示的控制器，不管是push进去的，还是present进去的都能拿到</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (UIViewController *)getVisibleViewControllerFrom:(UIViewController*)vc &#123;</span><br><span class="line">    if ([vc isKindOfClass:[UINavigationController class]]) &#123;</span><br><span class="line">        return [self getVisibleViewControllerFrom:[((UINavigationController*) vc) visibleViewController]];</span><br><span class="line">    &#125;else if ([vc isKindOfClass:[UITabBarController class]])&#123;</span><br><span class="line">        return [self getVisibleViewControllerFrom:[((UITabBarController*) vc) selectedViewController]];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        if (vc.presentedViewController) &#123;</span><br><span class="line">            return [self getVisibleViewControllerFrom:vc.presentedViewController];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return vc;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="AFNetworking监听网络状态"><a href="#AFNetworking监听网络状态" class="headerlink" title="AFNetworking监听网络状态"></a>AFNetworking监听网络状态</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 监听网络状况</span><br><span class="line">    AFNetworkReachabilityManager *mgr = [AFNetworkReachabilityManager sharedManager];</span><br><span class="line">    [mgr setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">        switch (status) &#123;</span><br><span class="line">            case AFNetworkReachabilityStatusUnknown:</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusNotReachable: &#123;</span><br><span class="line">                [SVProgressHUD showInfoWithStatus:@&quot;当前设备无网络&quot;];</span><br><span class="line">            &#125;</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusReachableViaWiFi:</span><br><span class="line">                [SVProgressHUD showInfoWithStatus:@&quot;当前Wi-Fi网络&quot;];</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusReachableViaWWAN:</span><br><span class="line">                [SVProgressHUD showInfoWithStatus:@&quot;当前蜂窝移动网络&quot;];</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    [mgr startMonitoring];</span><br></pre></td></tr></table></figure><h5 id="判断该图片是否有透明度通道"><a href="#判断该图片是否有透明度通道" class="headerlink" title="判断该图片是否有透明度通道"></a>判断该图片是否有透明度通道</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  - (BOOL)hasAlphaChannel</span><br><span class="line">&#123;</span><br><span class="line">    CGImageAlphaInfo alpha = CGImageGetAlphaInfo(self.CGImage);</span><br><span class="line">    return (alpha == kCGImageAlphaFirst ||</span><br><span class="line">            alpha == kCGImageAlphaLast ||</span><br><span class="line">            alpha == kCGImageAlphaPremultipliedFirst ||</span><br><span class="line">            alpha == kCGImageAlphaPremultipliedLast);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="获得灰度图"><a href="#获得灰度图" class="headerlink" title="获得灰度图"></a>获得灰度图</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+ (UIImage*)covertToGrayImageFromImage:(UIImage*)sourceImage</span><br><span class="line">&#123;</span><br><span class="line">    int width = sourceImage.size.width;</span><br><span class="line">    int height = sourceImage.size.height;</span><br><span class="line"> </span><br><span class="line">    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();</span><br><span class="line">    CGContextRef context = CGBitmapContextCreate (nil,width,height,8,0,colorSpace,kCGImageAlphaNone);</span><br><span class="line">    CGColorSpaceRelease(colorSpace);</span><br><span class="line"> </span><br><span class="line">    if (context == NULL) &#123;</span><br><span class="line">        return nil;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    CGContextDrawImage(context,CGRectMake(0, 0, width, height), sourceImage.CGImage);</span><br><span class="line">    CGImageRef contextRef = CGBitmapContextCreateImage(context);</span><br><span class="line">    UIImage *grayImage = [UIImage imageWithCGImage:contextRef];</span><br><span class="line">    CGContextRelease(context);</span><br><span class="line">    CGImageRelease(contextRef);</span><br><span class="line"> </span><br><span class="line">    return grayImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="UILabel设置内边距"><a href="#UILabel设置内边距" class="headerlink" title="UILabel设置内边距"></a>UILabel设置内边距</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">子类化UILabel，重写drawTextInRect方法</span><br><span class="line">- (void)drawTextInRect:(CGRect)rect &#123;</span><br><span class="line">    // 边距，上左下右</span><br><span class="line">    UIEdgeInsets insets = &#123;0, 5, 0, 5&#125;;</span><br><span class="line">    [super drawTextInRect:UIEdgeInsetsInsetRect(rect, insets)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="让手机震动一下"><a href="#让手机震动一下" class="headerlink" title="让手机震动一下"></a>让手机震动一下</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">倒入框架</span><br><span class="line">#import</span><br><span class="line">AudioServicesPlayAlertSound(kSystemSoundID_Vibrate);</span><br><span class="line">或者</span><br><span class="line">AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);</span><br></pre></td></tr></table></figure><h5 id="摇一摇功能"><a href="#摇一摇功能" class="headerlink" title="摇一摇功能"></a>摇一摇功能</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、打开摇一摇功能</span><br><span class="line">    [UIApplication sharedApplication].applicationSupportsShakeToEdit = YES;</span><br><span class="line">2、让需要摇动的控制器成为第一响应者</span><br><span class="line">[self becomeFirstResponder];</span><br><span class="line">3、实现以下方法</span><br><span class="line"> </span><br><span class="line">// 开始摇动</span><br><span class="line">- (void)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event</span><br><span class="line">// 取消摇动</span><br><span class="line">- (void)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event</span><br><span class="line">// 摇动结束</span><br><span class="line">- (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event</span><br></pre></td></tr></table></figure><h5 id="UITextView中打开或禁用复制，剪切，选择，全选等功能"><a href="#UITextView中打开或禁用复制，剪切，选择，全选等功能" class="headerlink" title="UITextView中打开或禁用复制，剪切，选择，全选等功能"></a>UITextView中打开或禁用复制，剪切，选择，全选等功能</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 继承UITextView重写这个方法</span><br><span class="line">- (BOOL)canPerformAction:(SEL)action withSender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">// 返回NO为禁用，YES为开启</span><br><span class="line">    // 粘贴</span><br><span class="line">    if (action == @selector(paste:)) return NO;</span><br><span class="line">    // 剪切</span><br><span class="line">    if (action == @selector(cut:)) return NO;</span><br><span class="line">    // 复制</span><br><span class="line">    if (action == @selector(copy:)) return NO;</span><br><span class="line">    // 选择</span><br><span class="line">    if (action == @selector(select:)) return NO;</span><br><span class="line">    // 选中全部</span><br><span class="line">    if (action == @selector(selectAll:)) return NO;</span><br><span class="line">    // 删除</span><br><span class="line">    if (action == @selector(delete:)) return NO;</span><br><span class="line">    // 分享</span><br><span class="line">    if (action == @selector(share)) return NO;</span><br><span class="line">    return [super canPerformAction:action withSender:sender];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="记录一个“POP”引擎动画后调用了superView的layoutSubViews方法"><a href="#记录一个“POP”引擎动画后调用了superView的layoutSubViews方法" class="headerlink" title="记录一个“POP”引擎动画后调用了superView的layoutSubViews方法"></a>记录一个“POP”引擎动画后调用了superView的layoutSubViews方法</h3><p>今天在做一个动画的时候，使用‘pop’时候，发现动作做完了，然后一个按钮使其回归原位，但是再做动作的时候，就只动了一下。难以查看过程，当我打断点到layoutSubviews的时候，果然进去了。然后不知道是谁调用的，于是我去使用time profile看了那一段时间干了什么事。于是看到了layoutSubviews被调用了，是‘pop’某一块调用了，使view又跑回原位。这时候，要么将布局代码写到其他地方，要么使用UIView的动画，我选择了后者。</p><h3 id="POPSpringAnimation-‘scaleXY’-会出现rotate-情况"><a href="#POPSpringAnimation-‘scaleXY’-会出现rotate-情况" class="headerlink" title="POPSpringAnimation ‘scaleXY’ 会出现rotate 情况"></a>POPSpringAnimation ‘scaleXY’ 会出现rotate 情况</h3><p>在一个回馈动效中使用POPSpringAnimation，但是由于滑块可以快速多次滑动，所以在弹性高过预定值，会产生negative值，即负值，这时3D transform中，scaleXY会出现rotate情况，<code>https://github.com/facebook/pop/issues/76</code>，这里采用clamp，在结束时，不超过回弹值。可以使用下面给出的两端中其一都可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-(void)popupMensionNode&#123;</span><br><span class="line">    POPBasicAnimation *nodeAnim = [POPBasicAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    nodeAnim.toValue = [NSValue valueWithCGSize:CGSizeMake(1.f, 1.f)];</span><br><span class="line">    nodeAnim.fromValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    nodeAnim.autoreverses = YES;</span><br><span class="line">    nodeAnim.duration = 0.25;</span><br><span class="line">    [_textNode.layer pop_addAnimation:nodeAnim forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(void)popupMensionNode&#123;</span><br><span class="line">    POPSpringAnimation *imageNodeAnim = [POPSpringAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    imageNodeAnim.toValue = [NSValue valueWithCGSize:CGSizeMake(1.f, 1.f)];</span><br><span class="line">    imageNodeAnim.fromValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    imageNodeAnim.autoreverses = YES;</span><br><span class="line">    imageNodeAnim.clampMode = kPOPAnimationClampEnd;</span><br><span class="line">    imageNodeAnim.springBounciness = 8;</span><br><span class="line">//    imageNodeAnim.springSpeed = 20;</span><br><span class="line">    [_textNode.layer pop_addAnimation:imageNodeAnim forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面两个带来的效果还是不尽完美，这时可以更进一步，又要同时有Spring动画效果，又要有回弹，那么只能使用自主操作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-(POPSpringAnimation *)popupMensionNode&#123;</span><br><span class="line">    [_popNode.layer pop_removeAllAnimations];</span><br><span class="line">    </span><br><span class="line">    POPSpringAnimation *nodeAnim = self.popNodeAnima;</span><br><span class="line">    nodeAnim.fromValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    nodeAnim.toValue = [NSValue valueWithCGSize:CGSizeMake(1.f, 1.f)];</span><br><span class="line">//    nodeAnim.autoreverses = YES;</span><br><span class="line">    nodeAnim.springBounciness = 6;</span><br><span class="line">    [_popNode.layer pop_addAnimation:nodeAnim forKey:NSStringFromSelector(_cmd)];</span><br><span class="line">    </span><br><span class="line">    POPBasicAnimation *minScaleXYAnimate = [POPBasicAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    minScaleXYAnimate.duration = .2;</span><br><span class="line">    minScaleXYAnimate.toValue = [NSValue valueWithCGSize:CGSizeMake(0.f, 0.f)];</span><br><span class="line">    </span><br><span class="line">    [nodeAnim setCompletionBlock:^(POPAnimation *animation,BOOL complete)&#123;</span><br><span class="line">        if (complete) &#123;</span><br><span class="line">            [_popNode.layer pop_addAnimation:minScaleXYAnimate forKey:@&quot;kminScaleAnimate&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    return nodeAnim;</span><br><span class="line">&#125;</span><br><span class="line">-(POPSpringAnimation *)popNodeAnima&#123;</span><br><span class="line">    if (!_popNodeAnima) &#123;</span><br><span class="line">        _popNodeAnima = [POPSpringAnimation animationWithPropertyNamed:kPOPLayerScaleXY];</span><br><span class="line">    &#125;</span><br><span class="line">    return _popNodeAnima;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这样子便不会出现negative值，不会发生rotate，同时还保留有spring动画的停顿效果，多次快速点击也能相应，不会出问题。</p><h3 id="更换PinRemoteImage已经保存的图片"><a href="#更换PinRemoteImage已经保存的图片" class="headerlink" title="更换PinRemoteImage已经保存的图片"></a>更换PinRemoteImage已经保存的图片</h3><p>这种做法比较少，但是还是会有此需求，比如我现在做的。<br>要更换就要更换两处，memory cache 和disk cache。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PINRemoteImageManager *imageManager = [PINRemoteImageManager sharedImageManager];</span><br><span class="line">[imageManager.cache removeObjectForKeyFromMemory:model.img_url];</span><br><span class="line">NSData *data = UIImagePNGRepresentation(para1.contentImg);</span><br><span class="line">[imageManager.defaultImageCache setObjectInMemory:data forKey:model.img_url withCost:data.length];</span><br><span class="line">[imageManager.cache setObjectOnDisk:data forKey:model.img_url];</span><br></pre></td></tr></table></figure></p><p>model.img_url 是其地址，在disk-&gt;library-&gt;cache-&gt;pincache-&gt;com.pinterest.pinremoteImage目录下，记不清其目录地址，大概是这样的。<br>data是我们要保存的图片的NSData 。</p><h3 id="记一次Apple-Develop-center-加多个device-id经历"><a href="#记一次Apple-Develop-center-加多个device-id经历" class="headerlink" title="记一次Apple Develop center 加多个device id经历"></a>记一次Apple Develop center 加多个device id经历</h3><p>1：首先先下载上面一段话的特殊字，写着实例文件。<br>2：然后我跟着写了其格式：<br>1）第一行为无效文字，苹果不填写，仅做log实例。<br>2）第二行开始，左边填写”devices id+’tab’+名称(名称全部用英文写，不要有中文符号，不要有空格，不要奇奇怪怪东西)”<br>3：然后上传基本就可以了</p><p>如果中间有出问题，尽量分段上传，这样就可以测试时什么个情况了</p><h3 id="iOS解决bug几个方法"><a href="#iOS解决bug几个方法" class="headerlink" title="iOS解决bug几个方法"></a>iOS解决bug几个方法</h3><p>1：用代码管理，每天记录。如果有解决不了的bug，看看几天改了什么，站起来思考（不要坐着）有没有关联；<br>2：如果是在一个文件class 内，可以试试将无关联代码去掉，单方面测试要定位的问题；解决了再回退，最好保存一份文件；<br>3：在断点出左下角+号，有个Exceptions BreakPoint…，直接点击添加，然后运行时自动大部分会自动定位到目标代码；<br>4：如果有崩溃现象，会进入到调用栈，IDE的左上角的小页签会跑到第六个，调用栈里边，这里可以看到你最近的几个方法是怎么跳转的，比如你是哪个线程，调用了哪个栈方法，连续调了哪些方法等等，这个方法很能反应问题实质，你还可以点击到相应的方法，同时打出相应的属性，lldb是可用状态；其他线程的lldb，只能看，不能再记录那些线程的方法属性了；<br>5：看性能损耗，主要还是要看Time Profile;同时僵尸代码的崩溃监控；这个记录由上边的Instrument 记录有记录。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/05/20travel</title>
      <link href="/2017/05/21/2017-05-20travel/"/>
      <url>/2017/05/21/2017-05-20travel/</url>
      
        <content type="html"><![CDATA[<p>今天,晚春公司组织的一次团建活动。用时三天，公司员工基本都前去。</p><p>第一天集合，大家一起坐大巴出发，从楼下直接开到景区，花费三个半小时。刚上车不久，由于是跑着过来，全身都是汗，过没一会我就感觉到很想吐的感觉，幸得带了晕车药。以前都觉得晕车药没用，以后能信任晕车药的药效了。</p><p>中午先在东钱湖边用了午餐（菜肴丰富），然后车子继续开。<br>在东钱湖大家拍了合影后都散开玩。<br>由于一个人无聊，就周围农舍转了转，最后到了湖边休憩。<br>没一会，周围聚拢了一堆伙伴（c哥、鲁强等），在湖边聊聊天，吹吹牛，说说话，感觉在大城市里的紧实放松了下来。<br>集合后前往宁波市中心办理入住。<br>有意思的是我最后一个上车，所以选择坐最后一排，可萌测试“小哥”坐我边上。他1.9m个的腿好长啊，没地放，只能斜着。人高也是有坏处的，我也深有体会，哈哈。小哥一直很关注运动步数，下车时看了下，惊呆了：最后一排，车子震动严重，计数以为真在走动，于是一直在计数，所以他的排行居然是第一。</p><p>入住时我和雨哥cto一间房间，在大堂大家取得房卡便先上楼安顿。我的原则，多和大伙增进友情，毕竟难得有这么多伙伴一起加油。休息了会，大家伙一起约了先去吃饭，再去网吧。去网吧有个好处，只要打上游戏，那么人和人之间的感情就是战友，一起共荣辱，团结、互助、牺牲、胜任等都能体现。</p><p>晚上大家伙一起回去，一路畅聊。晚上洗澡的时候，由于没用过此等喷头，喊上cto帮忙。这里写是因为有几点想说。首先，友情是互助的，你不让人帮忙，聊上话都么得。再者，我看了会喷头图标，不大体会到底怎么开；雨哥一进来，捣鼓了下就好了：雨哥脑袋真的很能理解那些晦涩难解的题：就跟我以前在搞视频遇到的一个难题一般，我当时用了不那么友好的方法，而雨哥却在很短时间内快速定位到最佳方案。这里真的值得我推敲推敲，思考方法方式有待提高。遇到解决方法时间长的情况，我都会变得浮躁些，估计这也是我在学识、经验上的欠缺。</p><p>第二天雪窦山行。刚下车，便下起了小雨。但是我的兴致还是很高，这里绿树环抱的野外，简直是天堂一般。累是累，但是也从中领悟到了些东西。首先是组织纪律性，安全性，我们一行都是很好；其中有各种互动，都是好伙伴；再者是我在走到一个有名的桥边时领悟到一个思想：这个桥是挺有名-&gt;险峻，难行，过桥都在晃动，各种属性叠加使得该桥有一定意义。但是这个景区总不能叫该桥的名字吧？或者说，我遇到的很高的著名瀑布，水花都能打到岸边游客的脸，总不能叫该瀑布的名字吧？是的，一个地方会被大家称颂，一个产品会被大家提及，她是因为内在各个惊喜，各个容易体会的完美才被记录。大家不会因为你叫雪窦山，不会因为其中某个著名桥、瀑布等而欣然前往；但是他们是一个集合，一个一个聚合勾画的场景，就使得大家有迫切欣然前往的动力。</p><p>我也为这次出行，怦然心动中写了两首诗，其中一首很对味雪窦山的壮丽景色，希望能对他添一笔：</p><blockquote><p>雪窦山行<br>倒挂青葱绿，平波卷碧漾。移山别有影，呼啸震癫狂。</p></blockquote><p>妙高台处，很让我感叹，这类小屋才是别墅，其他的只能称之为别屋吧。场临崖壁，居高雾缭。进堂，三阶，步步高升。内有小池鱼戏，边有松树环抱。这就是顶级奢华的低调。也幸得这成为景区，我们才有幸得以观看。</p><p>雪窦寺占地也是挺大的，看到这么好的景色，屋宇，感慨也是蛮多的：和尚庙、总统府总是能占据最好的地段，最好的景色，最好的资源配比。从此得出一个结论，思想拉拢在中国（封建制国家）是最能起到思想禁锢的手段。这种官场、职场中的管控能力不是他人能比。人民们也不得更好的发展。仅仅是寺庙，用的最好的木材（整木），香火、连佛像资金都不需思考，思想管控中的子民们自己主动交出善款。成功不要靠外在的，而是用内在的东西一次次更改其思想，”花钱吧，花钱对自己才是最好的，才是最忠诚的体现“；</p><p>第二天的行程都在溪口古镇，那天在一个饭店吃饭，伙食确实是相当丰富，好吃，赞不绝口。<br>第二天其实大家都走的很累了，去吃饭的时候，去网吧的哥们都扎堆，今天去一个“北疆”饭店，羊肉串一吃，我就知道不是新疆好味道，不过吃饱就行。吃完在楼下等等,看他们说的音乐喷泉。音乐喷泉这玩意我觉得是一个消耗品，在引进来的时候大家都觉得蛮赞的，但是基本1个月过去，周围人理都不理；再过一个月，音乐喷泉估计会老化，要修理什么的，这时又没有钱投进去了；得，就废弃了，这东西就是一个浪费；不过讨好一下，这个设备比如50万，采购的说60万，嘿嘿，棒棒哒；</p><p>晚上去打游戏没昨天那么多人，凑够5人就开打；那个网吧着实贵，最便宜的会员1小时要5块，不是会员10块。我的天，简直是抢。算了，就充个30玩了两天，心里还是心疼。晚上几个人一起回去，说说笑笑，谈谈刚才的操作、意识，回味回味（好像我打的adc 小炮最后把他们坑了，其实内心很对不住）。</p><p>第三天要回去了，每个人的腿都是大考验，这不，过去了三天，我写这的时候在周六了，腿还是酸软无力；<br>早上启程出发，转转1个多小时来到“浙东小九寨”。我在进景区的路上（停车场到景区还有很长一段路）就觉得没聊，应该不会是很给力的地方吧？</p><p>刚进去就看到的溪流，溪流里鹅卵石大大小小。没一会，我们做安卓的“君哥”手里拿着根木棍就去挑战沿水路走鹅卵石之旅了。过一会，一个设计大哥“聪哥”、一个运营大哥“鲁强大哥”也在那走。有意思，我也拿着拾得的竹棍下去走走。走着走着，两位大佬不一会就“下水”了，踏空下去。过没一会，又加入两个女生，都玩得很开，有意思。路上照应，遇到险阻一起互助；有一段路，水不大，但是中间石子很少，我们一起办了好几块大石头建立起了一个能踩踏过去的路。之前鞋子湿了的，想都没想，就过去。我们几个没湿的小心翼翼想着点子终于过去了。<br>在后面一段路，都没办法想出“无伤”过河的法子，全员鞋子都湿了。我算幸运的，只鞋子前跟湿了。大家在一堆大石那里休憩，等着去终点的人们回来。我们在那里泡脚、晒鞋子、晒袜子。刚才玩的忘我，在水路石子上面周转腾挪都还能拼尽全力，现在休憩之后，浑身乏力ing…大家终于使完最后的力，挪动身子往山下去。</p><p>中午吃个饭便启程回上海了。老实说，宁波那边小桥蛮多的，为什么我这么记得住？因为每过一个桥，车子都蹦跶起来，刚迷迷糊糊难受的想睡着，就蹦跶一次，小心脏都给吓跳出来了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/5/21lesson</title>
      <link href="/2017/05/21/2017-5-21lesson/"/>
      <url>/2017/05/21/2017-5-21lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/05/04<br>总结下最近哪里有没有长进。<br>劳动节之前，比较大的收获，估计就是git的时候更熟练了。在处理数据库路上，也有稍许开窍，比较coreData是我一直不喜欢整的一个东西。<br>劳动节放假三天，我花了半天写东西，搞了搞liveQuery，没有结果，卡在那里。花了1天多一点打游戏，莫名烦躁。花了点时间陪丫头去公园看别人开心花钱，我和丫头就这样走走，看看，突然想着，咦，有时间可以来露营，但是要买个帐篷，闲鱼逛逛去。还有的时间就是一直在逛闲鱼，各种逛。闲鱼的模式在于交换二手物品，但是他有几个点别人学不来：</p><ol><li>强大的背景：背靠阿里，值得信赖；</li><li>支付宝第三方保障，信用分可查；</li><li>法院的单都能谈下来，还有什么做不到？ </li><li>精通买卖物品模式；</li><li>其强大的物品推荐能力和搜索推荐物品能力；</li><li>不买即走的概念</li></ol><p>这些都是58、赶集 办不到的地方。</p><h2 id="这几天想着自己的事情，大项目还是要尝试，小的东西也要搞起来，为了精细小功能，加些广告，广告这块要赶紧接触，磨合；什么时候有广告；会员去广告；能不弹出一定不能弹出；项目要写的小而Q；"><a href="#这几天想着自己的事情，大项目还是要尝试，小的东西也要搞起来，为了精细小功能，加些广告，广告这块要赶紧接触，磨合；什么时候有广告；会员去广告；能不弹出一定不能弹出；项目要写的小而Q；" class="headerlink" title="这几天想着自己的事情，大项目还是要尝试，小的东西也要搞起来，为了精细小功能，加些广告，广告这块要赶紧接触，磨合；什么时候有广告；会员去广告；能不弹出一定不能弹出；项目要写的小而Q；"></a>这几天想着自己的事情，大项目还是要尝试，小的东西也要搞起来，为了精细小功能，加些广告，广告这块要赶紧接触，磨合；什么时候有广告；会员去广告；能不弹出一定不能弹出；项目要写的小而Q；</h2><p>git PUSH、PULL 在ssh 都有情况下出现说没法处理，可以在terminal 校验ssh<code>cat ~/.ssh/id_rsa.pub</code>;</p><h2 id="然后在git中更换了ssh还是出现问题-，输入：sudo-killall-HUP-mDNSResponder-然后-git-pull-master-master、然后-git-remote-master-其中的-master-为要处理的HEAD"><a href="#然后在git中更换了ssh还是出现问题-，输入：sudo-killall-HUP-mDNSResponder-然后-git-pull-master-master、然后-git-remote-master-其中的-master-为要处理的HEAD" class="headerlink" title="然后在git中更换了ssh还是出现问题 ，输入：sudo killall -HUP mDNSResponder 然后 git pull master master、然后 git remote master ;其中的#master#为要处理的HEAD"></a>然后在git中更换了ssh还是出现问题 ，输入：<code>sudo killall -HUP mDNSResponder</code> 然后 <code>git pull master master</code>、然后 <code>git remote master</code> ;其中的#master#为要处理的HEAD</h2><p>Undefined symbols for architecture XXXX 昨天有个问题workspace 传到SVN ，然后之前能运行的，现在却pod 很多library找不到。做法是先clean 一次，然后将driveData 全删了。build一下还是不行的话，将pod所有文件全删了，然后重新pod 一份。就可以了。</p><p>cocoapods里Taobao源 改为HTTPS</p><p>Reveal 查看<br>导入Reveal.framework<br>在Link Library 删除Reveal.framework<br>在other link flag 中的DEBug一项中，加入:-ObjC、-lz、-framework、Reveal</p><hr><p>今天做视频的时候重写了滑动条，果然更熟练了，哈哈。<br>这里注意到了一个方法<code>- (void)seekToTime:(CMTime)time toleranceBefore:(CMTime)toleranceBefore toleranceAfter:(CMTime)toleranceAfter</code>这是用来节选视频的中间节点<br>同时测试的时候发现，手机在接下来的页面中都会比较卡，或者会发烫：原来在拍摄的时候，跳转页面，没有关掉视频拍摄；<br>返回去看我以前写的，果然，以前我也是没有关掉视频拍摄。终于找出来我的锅！！！</p><hr><p>在 Mac 上用 SourceTree 克隆 svn 的时候, 出现了 warning: templates not found /usr/local/Git/share/git-core/templates 警告,导致克隆失败. 怎么办呢.</p><p>在终端输入 </p><p>sudo mkdir /usr/local/git</p><p>sudo mkdir /usr/local/git/share</p><p>sudo mkdir /usr/local/git/share/git-core</p><p>sudo mkdir /usr/local/git/share/git-core/templates</p><p>sudo chmod -R 755 /usr/local/git/share/git-core/templates</p><p>前四条创建目录,最后一条给修改目录添加权限. 注意 sudo 创建目录需要输入当前 Mac 用户的密码</p><p>再重新克隆, 云消雨散.</p><hr><p>今天感受到了“火眼精金”那种感觉了：你们可以试试，把眼镜环着热水杯稍微放那么一小会。呵呵，棒棒哒：戴起来的时候眼镜暖暖的，就像火眼精金。哈哈</p><hr><p>什么是响应链，它是怎么工作的？<br>如何访问并修改一个类的私有属性？<br>iOS Extension 是什么？能列举几个常用的 Extension 么？<br>如何把一个包含自定义对象的数组序列化到磁盘？<br>Apple Pay 是什么？它的大概工作流程是怎样的？<br>iOS 的沙盒目录结构是怎样的？ App Bundle 里面都有什么？<br>iOS 的签名机制大概是怎样的？<br>iOS 7的多任务添加了哪两个新的 API? 各自的使用场景是什么？<br>Objective-C 的 class 是如何实现的？Selector 是如何被转化为 C 语言的函数调用的？<br>UIScrollView 大概是如何实现的，它是如何捕捉、响应手势的？<br>Objective-C 如何对已有的方法，添加自己的功能代码以实现类似记录日志这样的功能？<br>+load 和 +initialize 的区别是什么？<br>如何让 Category 支持属性？<br>NSOperation 相比于 GCD 有哪些优势？<br>strong / weak / unsafe_unretained 的区别？<br>如何为 Class 定义一个对外只读对内可读写的属性?<br>Objective-C 中，meta-class 指的是什么？<br>UIView 和 CALayer 之间的关系？<br>+[UIView animateWithDuration:animations:completion:] 内部大概是如何实现的？<br>什么时候会发生「隐式动画」？<br>如何处理异步的网络请求？<br>frame 和 bounds 的区别是什么？<br>如何把一张大图缩小为1/4大小的缩略图？<br>一个 App 会处于哪些状态？<br>Push Notification 是如何工作的？<br>什么是 Runloop？<br>Toll-Free Bridging 是什么？什么情况下会使用？<br>当系统出现内存警告时会发生什么？<br>什么是 Protocol，Delegate 一般是怎么用的？<br>autorelease 对象在什么情况下会被释放？<br>UIWebView 有哪些性能问题？有没有可替代的方案。<br>为什么 NotificationCenter 要 removeObserver? 如何实现自动 remove?<br>当 TableView 的 Cell 改变时，如何让这些改变以动画的形式呈现？<br>什么是 Method Swizzle，什么情况下会使用？</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/05/1lesson</title>
      <link href="/2017/05/01/2017-05-1lesson/"/>
      <url>/2017/05/01/2017-05-1lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/4/12</p><p>这里记录一个关于自定义控件改不改放到window的问题。项目中有一个功能，将控件放到view上，当控件里面获得由delegate将控件的父级试图push到下一个页面，同时，下一个页面不出现该控件。<br>这时候如果控件是挂载keyWindow或者其他上，则会出问题了：push的时候，控件仍然存在。如果有这个需求，可以在计算高度上，给其加上一个property：containerFrameFixY用来适应其他页面中可以偏移的坐标优化。</p><blockquote><p>这是一个最好的时代，也是一个最坏的时代。谁能抓住这个时代的线索，就有机会突破。</p></blockquote><p>我们有数不尽的第三方库、数据库、图片、设计参考等等。基本都可以一个人几天就做一个东西。但是相同的，每个人都有机会，那么每个人的机会都是很大的，自己不努力一转眼就会跑到后面。现在要做的是，做小而精的东西，实现流量变现、流量入口观测、广告营收、产品推广、内容博人眼球！！！<br>现在的路有两条：</p><ol><li>继续研究多媒体，或者更多多媒体能力</li><li>将现今的能力优化，将所学获得额外回报</li><li>对，还有第三条：在[2]的基础上，在继续研究多媒体。</li></ol><p>我觉得最好方法，正是第三条。程序员也是人，没有好的生活保障是没办法将知识扩展深化，那么我现今的目标是在now：2017/04/18开始一个月搞定parse服务器、客户端、cloudCode、liveQuery、push、analysis、产品等 做出来，是的！！！</p><p>学习别人怎么做的，很简单的方法就是对着别人的东西抄一遍；再抄一遍；再再抄一遍；再再再抄一遍；知道抄出心得；再默写一遍，那么基本都有7、8层把握得到他人的精髓了。去年我这么做的，今年再加把劲获得更多的知识和经验！！！先获取事业上的知识，然后再继续深入研究多媒体能力。</p><p>这里提一点有意思的，这几天抄faceBook一个示例，他们在import 一些库的时候，会分类那些作用类，中间隔空格分开。有意思，跟我思路一样，我觉得，这是必须的，好认啊，宁愿多浪费一行空格行得到阅读代码的体验。</p><p>. Ctrl+Command+left/right 返回前一浏览页，进入之前前一浏览页<br>. Ctrl+Alt+left/right 将代码折起来</p><p>2017/04/18</p><p>记录一件事，事情是这样的：昨天晚上加班，下班晚，出门刚好看到老板。打招呼，问我最近适应否，答曰还行。我和老板都感慨”适应难度也是跟项目大小正比，我们产品精细，功能乍看不多，但一接触就知道确实很多，每个都是小而精的。”这时老板打开手机，随意打开几个界面，停留到一个界面：这是最近我开发的一个切面功能。他来来回回滑动那个功能，跟我说，你看这个飞机，飞的很好，还有云，背景，，还有你感觉，这里面的体验也是非常好的，来回切换，非常顺滑。我不动声色的感慨，能让用户觉得使用这个功能很开心，真是会让我这个开发者深受感动啊。开发者和老板之间的关系，我个人觉得工作是互赢的态势，不应该是疲劳驾驶般；但另一方面来讲，由于开发者、工作者需要获得工作资金的来源而和老板成了有主次关系的区别，这也正是为什么我觉得是时候搞一些#务副业#的事。今天回头想想一些事情经过，其实还是有可能老板知道我最近处理这方面功能，毕竟老板其实都是那么随随便便做出某些举动，然后乘机鼓励鼓励下属的行为，应该是吧。不过，最后一句，我很感动，能为他人服务是我的荣幸。我是服务者，至始至终都是大家的服务者，就为了大家的生活便利、开心，如果没有人愿意得到我的服务，那我就是真的失败了。</p><p>今天写到正则，由于需要在判别字符里面的搜索，如：”#[卷卷公主的日常<em>打喷嚏]”，搜索这个字符，这时会出现特殊字符，使用”(%@)”输入字符，则成了”(#[卷卷公主的日常</em>打喷嚏])”,然而”#”、”[“、”]”都为特殊字符，这时要替换里面的字符，此处处理为replaceOccurredString:@”#” -&gt;@”\#”。</p><p><a href="http://stackoverflow.com/questions/11442101/ios-regex-unknown-escape-sequence" target="_blank" rel="noopener">http://stackoverflow.com/questions/11442101/ios-regex-unknown-escape-sequence</a> 这里有答案:</p><blockquote><p>You’re getting the warning because | is not a valid escape sequence in Objective-C (or C or C++ for that matter). The compiler is ignoring that and just using a raw | character instead, so the string you’re actually passing in is @”|(.<em>)|”.<br>To get the behavior you want, you have to escape the backslash in your source code so that the regex engine sees the literal backslash and interprets the | character as a literal instead of as alternation, e.g. @”\|(.</em>)\|”.</p></blockquote><p>最近想了些问题。怎么为他人服务，怎么让他人觉得我的服务到位。</p><p>来到粉粉平台，努力工作，实现自己的人生价值？是的，谁都有其位要去领悟，谁都有机会去得到自己的人生价值。<br>我一直要让自己成为一名真正的服务者，但是来到一个大家庭，成为一份子的同时，与大家共同加油为更多的人服务；和比如我开一个小餐馆，好好为每个顾客从进门的一开始就尽心尽力让他们感到家的体验，这两种是不一样的。有人选择与一个大家庭共进退，分享，共赢；有人会自己寻找一个天地；虽然都是为了“服务”他人而生，只是选择的路，身边的人不同，有自己的择决。</p><p>最近就有这些方面的择决。从小家庭出来的，底子薄，我的事业全是自己走，父母帮不上，那么我小心一点，先从大家庭增长经历，有历练了，那就是时候在共进退方案进化去带领前进，最后自己有直接为大家“服务”的机会。是的，在大家庭，是看不出汪洋大海，那一滴是你的心血。他人是不会说“哟，这个就是你的作品”的，只是匆匆而过，也许稍作停留，可是最终的视线还是远观大的方面。</p><blockquote><p>努力让大家看到你的影子吧，努力让大家看到自己的心血，而不是被淹没，被掩盖！</p></blockquote><ol><li><p>添加远程仓库:<code>git remote add remoteName url</code></p></li><li><p>获取或推送:</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// pull</span><br><span class="line">git pull remoteName branchName</span><br><span class="line">// push</span><br><span class="line">git push remoteName branchName</span><br></pre></td></tr></table></figure><p>评分标准</p><p>态度 10%:<br>考勤<br>主动性<br>自我管理<br>技能 30%:<br>技术能力<br>评估能力<br>执行 30%:<br>完成速度<br>完成质量<br>创新 20%:<br>新技术学习<br>重构能力<br>分享</p><p>iOS 初中高级技能推荐标准</p><p>初级：<br>2-3年工作经验<br>1 熟练使用Foundation CocoaTouch等基础UI框架，配合动画，开发各种常见界面；<br>2 熟练使用网络和图片库，理解同步异步原理，有图片前后处理意识；<br>3 熟练掌握数据持久化；<br>4 能开发自定义界面；<br>5 熟练使用常用第三方框架。<br>关键字：UIKit GCD UITableView AFNetwroking SDWebImage</p><p>中级：<br>3-4年工作经验<br>1 掌握面向对象设计，理解设计模式；<br>2 对常用组件使用有自己的理解；<br>3 了解流行的第三方框架原理，并有自己的封装库；<br>4 开发过自定义界面，能横向对比类似实现。<br>关键字：引入，封装，性能，界面库，网络库</p><p>高级<br>5年以上工作经验<br>1 熟练搭建项目，选择合适的框架，指导初中级开发；<br>2 具备需求分析、技术规划、项目管理能力，带领团队开发；<br>3 善于沟通，管理团队。</p><p>今天和同时旭哥搞版本合并，做法和以前完全不同，每次操作都是慎重处理，合并完那么就会很轻松，这种态度。<br>放一个链接<br><a href="http://blog.sina.com.cn/s/blog_68af3f090100rp5r.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_68af3f090100rp5r.html</a></p><ol><li>是这条命令先查看两个版本差异在哪里,然后打开 a.diff 文件<code>git diff --name-status --diff-filter=A 当前分支 需要合过来分支 &gt; a.diff</code></li><li>切换到主分支，然后使用下面语句，或者用#SourceTree#的合并版本到当前版本 <code>git merge 需要合过来分支</code></li><li>解决冲突</li><li>使用这条命令<code>pod install --verbose --no-repo-update</code>更新那些pod需要更新的文件</li><li>解决冲突之后不要立马commit到本地，先运行一遍，然后将丢失的文件找回来，bug冲突，build不过原因解决掉。</li><li>coommit到本地</li></ol><p>project文件，使用‘当前’我们不熟悉片段的，比如在5.2中，当前“我的”指“5.2”，然后我很清楚合过来的是我做的代码，那么solving trouble using mine</p><p>其他类文件，查看<code>&lt;&lt;&lt;</code>、<code>===</code>、<code>&gt;&gt;&gt;</code>，然后将之解决掉</p><p>由于中途出现了错误，我commit了当前有冲突的代码，然后不知道怎么处理：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git stash                   //将还没push的文件保存至本地</span><br><span class="line">git reset --hard HEAD~1     //将版本commit情况回退到 HEAD~x x为回退第几个版本</span><br></pre></td></tr></table></figure><hr><p>上周做了次code review，是剖析了下我当时写天气时候代码的快慢和质量。<br>在完成天气那段代码，使用js方式分块将独立功能模块自己整合，由外部调用。</p><ol><li>然而外部调用的时候却没有好好管理好这个组织过程，组织过程交给了vc做，当时为了更快没有更好的做一个adapter。我这里设想：我有个天气管理器，他暴露出来需要require的dataSource，和option完成的dataSource，然后在vc提供好相应模块即可。然后天气管理器再产生reloadData方法重新设置内容物。</li><li>代码log，里面由于用到log，所以在有些没有识别价值的log在完成后应当去掉。</li><li>里面出现一些没有意义的变量名。不管如何，还是不要出现这种情况</li><li>在逻辑多、容易混淆，正确的注解将会很大有效的帮助理解。毕竟写这代码和将来某个人来改，将比重做还要难。</li><li>合理使用PM分区，此处给出一段:(下一段代码)</li><li>代码重复优化</li><li>硬编码，在不了解其硬编码在其中有什么意义，一定一定要做好注释</li><li>循环引用的问题，也许多改的一个问题将会提升APP使用体验。</li><li>当时开展活动的是旭哥。他提到的一点：破窗理论，我觉得很有道理，给自己的工作留点心。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - life cycle</span><br><span class="line">#pragma mark - private methods</span><br><span class="line">#pragma mark - event response</span><br><span class="line">#pragma mark - UITablViewDelegate</span><br><span class="line">#pragma mark - getters / setters</span><br></pre></td></tr></table></figure><p>最后总结一点，时间一定要把握好。之上的问题，很大原因也是跟时间不够，为了挤时间，在短时间内达到目的，赶紧转战其他问题。但是在力所能及的问题上，多累一些自己，可能会带来更好的结果吧。<br>这也是一个等效时间转换：自己时间节省了，机器就要多累一些；自己多花时间了，机器就更节省了。如何看待，就看这个功能在用户使用频率问题上多考究考究。毕竟作为人，一定要有所谋，有所舍弃吧。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/4/11Lesson</title>
      <link href="/2017/04/11/2017-4-11Lesson/"/>
      <url>/2017/04/11/2017-4-11Lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/3/23<br>最近用黑苹果开发，稍稍适应了下黑苹果开发了。<br>首先黑苹果如果出现警告、QQ新消息什么的，屏幕会闪一下。这是因为系统要弹出音频警告声，但是没有音频驱动，所以就闪一下吧。查找了下，没有找到可以关掉那玩意的地方。</p><p>最近到粉粉这类公司之后可以感觉得到，这类公司今天都是拼了命了。今天要是不进步，估计要出问题，所以老板也是经常下来“打交道”，转一转了。是时机，也是机会，也是一手扑空等可能机会。完全看自己选择了。</p><p>今天用git在gitLab上签名，以前都是填密码什么的。然后一直连不上git，无法push，今早来，同事让我不要填密码、这个<code>Enter passphrase for key &#39;/Users/xxtstudio/.ssh/id_rsa&#39;:</code>出现也直接按enter就可以了。然后就OK了。一直按enter键哦。</p><p>并发数，并发机子；<br>查询语句优化；<br>数据量大小也会影响客户端获取数据速度；<br>带宽，影响不大；只说了大概用了5M；并发机子用了5个左右；其他基本都是小测试机子；</p><p>这里返回一下滤镜功能话题。<br>我以前的公司处理滤镜时候，是多使用了level色阶滤镜，这样可以很方便在里面添加5个参数，就能达到大部分需求。<br>昨晚公司博士看了些文章，跑过来提议说可以这样处理：使用GPUImageLookupFilter滤镜，先将图片按照某些好的效果在Photoshop里面调节好，然后将GPUImage的原滤镜的方格图在PS里面将之前的数值和step走一遍，这时候GPUImage的原方格图就变了模样。其实这时候就是可被使用的image了。然后在GPUImage里面使用lookup滤镜添加进去，然后就有一定的效果了。</p><p>这里记录一个解决动画不动的一个问题：<br>由于我做的几个动画，比如云从左至右，或者从右至左一个感觉，但是其又有多了一个属性，叫做autoReverse，自动往回走，此时我创建的6个云在被重利用的时候由于动画被autoReverse，所以动画还没有结束，但是记录的动画最长运行时间longestTime已经到了，却出现没有将可用的对象抽出来，所以导致我寻找可用对象时，出错了-》崩溃在for循环里的重复寻找对象当中，然后又被continue，重新寻找。</p><p>这两天接触网络层，先进入浅一点的地方学习。比如GET请求，一般都是静态数据，POST请求，都是动态数据，于是可以使用缓存方式在网络层中将GET请求缓存下来。当然，也有GET是需要实时更新的，于是将你的url+parameter中的parameter实时更新，在判别request.hash是否在缓存中存在时，就能知道GET在缓存中不存在，于是，其还是要去更新。这样子就做到，GET静态数据缓存其数据，要更换则将其hash变动。</p><p><a href="http://blog.csdn.net/sw_gegewu/article/details/51443478" target="_blank" rel="noopener">http://blog.csdn.net/sw_gegewu/article/details/51443478</a><br>UIPageControl是用来显示分页的，一般和scrollerView一起搭配使用，但是UIPageControl的内部属性很少，就仅仅下面的几个，<br>（1）numberOfPages； // 总共有多少页<br>（2）currentPage； // 当前页数<br>（3）hidesForSinglePage； // YES表示当页数只有一个的话就隐藏不显示<br>（4）pageIndicatorTintColor； // 所有页的颜色<br>（5）currentPageIndicatorTintColor； // 当前页的颜色</p><p>如果想要把当前页设置为镂空的，可能就不好办了，但是可以通过给起属性内部赋值，<br>// 设置内部的原点图片<br>[pageControl setValue:[UIImage imageNamed:@”“] forKeyPath:@”pageImage”];<br>[pageControl setValue:[UIImage imageNamed:@”“] forKeyPath:@”currentPageImage”];<br>这样的话就可以达到效果了。</p><p>占位文字颜色设置<br>self.textInputView.attributedPlaceholder = [[NSAttributedString alloc]initWithString:AppLocalString(@”设置日期”) attributes:@{NSForegroundColorAttributeName:[UIColor colorWithHexString:@”#97858A” alpha:1]}];</p><p>此处记录一次纠结的崩溃问题：<br>我在改动之前的缓存策略的时候，由于有些在Build过程中和搜索过程中没有提示一定要更换的api，于是我没有给某几处function更换，某一处位置刚好是图片SDK位置。<br>原先要传进去的是BOOL指针，更换方案使用NSTimeInterVal的指针。<br>两者内存地址空间大小就不一样，于是出现了使用的内存不够，引发了崩溃。此种崩溃在DEBUG环境，竟然没有反应，只有真机Release环境下才会崩溃，头疼的地方来了，需要真机Release测试时，Entitlements的识别文件不是我这个机子。如果我要重新制作Entitlements文件，不知道是否会影响项目某些操作，作罢；<br>看Bugly输出？我这里没有账号查看，另一个同事帮忙看了下，没有发出来，暂时作罢；<br>我手头还有某一个功能急于完成，连续加班两天无果；而且其崩溃位置在其他类似位置有同样表现；我对该APP之前功能没有认知，以为其之前便有存在，想让其延后；<br>等等原因致使这个bug存在几个时日。最后是一个同事配合Bugly将许多行log打在不同位置，看走到哪里，慢慢定位出问题。</p><blockquote><p>总结一下，这个问题是我的锅，也可以不是我的锅，但是我要注意类似的事情再发生。是我的锅，原因在于一系列的原因，加之任务比较重，UI时时改动，功能不明确带来预期时间的延长而使得没有更多时间注重于效能上。<br>不是我的锅在于：之上也说了效能和时间成正比，急于加之诸般成果，必失之他项。无法看到log，等于找到问题能力全部失去：盲人无法行走，除非有个类似于log的拐杖的帮助。<br>我还是要继续稳中求果，切勿操之过急，不过一切基于时间。</p></blockquote><p>记录一个BUG，使用CoreGraphics裁剪Image，却会将Image变大。这个问题还没有认知，之后查出来会记录一下。</p><p>今天花时间阅读了下objc的runtime，理解了以前没能凑在一起看的知识点。网址：<a href="http://www.cocoachina.com/ios/20170301/18804.html" target="_blank" rel="noopener">http://www.cocoachina.com/ios/20170301/18804.html</a></p><ol><li>获取类名</li><li>获取成员变量</li><li>获取成员属性</li><li>获取类的实例方法</li><li>获取协议列表</li><li>动态添加方法实现</li><li>方法实现交换</li><li>属性关联（动态添加相应的属性），完成在一个类中动态添加方法，同时生成set、get方法</li><li>消息处理与消息转发，这一块粗略的看了下，没有深入了解。。。当做看过一下。</li></ol><p>看完这篇，再看这篇<a href="http://www.cocoachina.com/ios/20170228/18798.html，收益匪浅啊" target="_blank" rel="noopener">http://www.cocoachina.com/ios/20170228/18798.html，收益匪浅啊</a></p><p>最近查资料老是觉得这个网站：“xxxxx - 红黑联盟”经常能查到的都是挺不错的别人记录过得文章。简洁易懂类型。<br>再来看我今天想要查找的一个关于UDID和UUID的获取，网址：<a href="http://www.2cto.com/kf/201605/513333.html" target="_blank" rel="noopener">http://www.2cto.com/kf/201605/513333.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UDID，iOS 5以前使用：[[UIDevice cuurrent] uniqueIdenfier] 现在不可能了。现在使用</span><br><span class="line"></span><br><span class="line">NSUUID *uuid = [UIDevice currentDevice].identifierForVendor;</span><br><span class="line">NSLog(@&quot;uuid 1 = %@&quot;,uuid.UUIDString);</span><br><span class="line"></span><br><span class="line">UUID,NSString *uuid = [NSUUID UUID].UUIDString;</span><br></pre></td></tr></table></figure></p><p>这里记录一个bug，我做的一个HUD，继承与UIView。我选择了用keyWindow作为父布局，然后在某些情况下会出现弹出来，又诡异的消失了，牛逼；然后我给他改成windows[0]：第0个，这个时候还会出现第三方库SVProgressHUD和我的HUD一起弹出来，这时会出现window在那，然后全屏点不了了。没办法，使用最后一个招吧，使用APPDelegate的window作为底部试图，这样终于解决了。</p><p>记录git问题。每次打开project，git都会记录，但是这不是我们想要的，我们只想给我们改过的代码进行commit，其他不需要。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /xxxProject</span><br><span class="line">vim .gitignore</span><br></pre></td></tr></table></figure></p><p>然后输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">build/*</span><br><span class="line">*/build/*</span><br><span class="line">*.pbxuser</span><br><span class="line">!default.pbxuser</span><br><span class="line">*.mode1v3</span><br><span class="line">!default.mode1v3</span><br><span class="line">*.mode2v3</span><br><span class="line">!default.mode2v3</span><br><span class="line">*.perspectivev3</span><br><span class="line">!default.perspectivev3</span><br><span class="line">xcuserdata</span><br><span class="line">profile</span><br><span class="line">*.moved-aside</span><br><span class="line">DerivedData</span><br><span class="line">.idea/</span><br><span class="line">*.hmap</span><br><span class="line">DS_Store</span><br><span class="line"></span><br><span class="line">#CocoaPods</span><br><span class="line">Pods</span><br><span class="line">Podfile.lock</span><br><span class="line">build*</span><br><span class="line">pics*</span><br></pre></td></tr></table></figure></p><p>这时还没生效，要么全部quit掉，要么clean cache：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">改动过.gitignore文件之后，在repo的根目录下运行：</span><br><span class="line">git rm -r --cached .</span><br><span class="line">git add .</span><br><span class="line">之后可以进行提交：</span><br><span class="line">git commit -m &quot;fixed untracked files&quot;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/3/18lesson</title>
      <link href="/2017/03/19/2017-3-18lesson/"/>
      <url>/2017/03/19/2017-3-18lesson/</url>
      
        <content type="html"><![CDATA[<p>2017/3/15<br>CoreData的坑<br>说不清，妈的<br>首先是NSOrderSet和NSSet的区别<br>对于One To One和One To Many</p><p>中午的时候看了下JavaScriptCore，对RN以前的对语言转换，混合工作有了一些了解。<br>比如JSValue、JSVirtualMachine、JSContext、JSExport等作用。<br>Native和JS语句调用交互过程、调用、传值，回传等工作过程等。<br>看的地址<a href="https://my.oschina.net/u/2340880/blog/856321" target="_blank" rel="noopener">JSCrotCore博客</a><br>有点意思，关键是能做出的效果很令我感叹。</p><p>有空的时候测试了下另外两个东西：FBNotification、ZipArchive</p><ol><li>ZipArChive比较适用于内容稍微大点的内容物，不然小体积下，似乎压缩效果没有很大差异</li><li>FBNotification这个有个很厉害的地方，弹出的动作、画面都是可控的，屌爆了，非常喜欢。我对于本地发送localNotification发送没去尝试过，有这个轮子，还是不去整那些东西。</li></ol><p>今天给xcode加一个插件，<a href="https://blog.cnbluebox.com/blog/2015/03/05/chisel/" target="_blank" rel="noopener">Chisel</a><br>但是发生了Homebrew-&gt;<br><code>Error: Running Homebrew as root is extremely dangerous and no longer supported.As Homebrew does not drop privileges on installation you would be giving allbuild scripts full access to your system.</code><br>这个没想到要怎么操作，好吧，加个<strong>sudo</strong>估计会好吧，没想到还是不行。<br>百度查了下找到这个网址：<a href="https://segmentfault.com/q/1010000007575129?_ea=1389173" target="_blank" rel="noopener">https://segmentfault.com/q/1010000007575129?_ea=1389173</a></p><p>terminal 里面</p><p>sudo chown -R $(whoami) /usr/local<br>把/use/local的owner換成自己，就有write權限了</p><p>whoami就是一個命令，會echo當前登錄用戶的名字。當然你知道自己的用戶名，比如jack,就直接</p><p>sudo chown -R jack /usr/local<br>也可以</p><p>修改過權限之後，就直接跑</p><p>brew install node<br>不需要再用sudo，因為當前用戶已經有權限寫入/usr/local了或者你用</p><p>ls -ld /usr/local<br>確認一下這個目錄的owner是否已改到自己</p><p>Chisel好东西好东西，给力</p><p>来工作的这么一段时间，接触SourceTree，确实感觉很是强大。版本回滚，合并，文件差异等都是很实用。今天碰到，将一个Branch合进我的版本，然后，我有一个文件和xib都被遗失了。搞了很久，版本我也找不到是哪一个，最后我点击右上角的文件差异化对比，然后将文件给拷贝出来，要不是这一个操作，我估计以后我在合版本，我一定不会再相信电脑了。</p><p>今天很好奇的一个地方：Curl<br>还没看清Curl的操作方式，我先去看了篇<a href="http://www.jianshu.com/p/23cccb3a90b1文章读一读REST" target="_blank" rel="noopener">http://www.jianshu.com/p/23cccb3a90b1文章读一读REST</a> API的架构设计。<br>前面品味不出什么思想，一直到作者的一些感想上面，有点理解REST API设计思路。</p><ol><li>API请求中应该加入API版本号，比如在URL中加入版本号：<a href="https://api.example.com/v1/，这样API升级就可以将api版本也升级了。" target="_blank" rel="noopener">https://api.example.com/v1/，这样API升级就可以将api版本也升级了。</a></li><li>API返回的数据量问题。数据量大的话，估计是得在某些页面数据很大，或者文件传输等，不过视频、图片等估计不能在此列了。</li><li>性能方面我也是赞同的，不过我是前段方面，那么不能做的事，就是不能设计出一些使用猥琐方式暂时完成的功能和逻辑，尽量避免这种错误。</li><li>安全性和用户认证。这一块对于前段来说也是相当重要的。这里其就推荐使用Keychain的方式还有第三方Access Key之类尽可能使其为在启动的时候动态请求。估计这块得用HTTPS加密，然后每几天去更换才能处理好吧。</li></ol><p>OK，想到这里，还是没想明白Curl怎么使用，改天有机会用到的时候才会懂吧。</p><p>### 缓存策略<br>今天刚好做到公司要求的一个问题：缓存策略。<br>要求是将其之前有做的缓存方案，改成带有时间判别的方案，那么如果时间线以内，便不让其再次请求；如果用户手动刷新的话，那就不用去考虑了。</p><p>我自己倒是似懂非懂，直接在其基础上，变换成比较麻烦的方案：<br><img src="http://7xjcms.com1.z0.glb.clouddn.com/2017:3:18.png" alt="未更改保存方案"><br><img src="http://7xjcms.com1.z0.glb.clouddn.com/2017:3:18:getSave.png" alt="未更改获取、外部保存方案"><br>在这个基础上，需要更简易处理，稳定。<br>我觉得要增加一个date，那就说保存的Array外面再包一层Diction吧，增加一个字段：Date<br>诺，就变成了这个不理想的样子：<br><img src="http://7xjcms.com1.z0.glb.clouddn.com/2017:3:18:mine:getFunc.png" alt="更改保存方案"><br><img src="http://7xjcms.com1.z0.glb.clouddn.com/2017:3:18:mine:save.png" alt="更改保存方案"><br>这里的区别主要就是这种改动范围很大，而且把原有的全都换了一遍。虽说我的做法也能满足需求，但姜确实是老的辣，没能更好的解决这个问题。只能说，他们之前把方案讨论好了，我突然插进来的，搞的时候还是迷迷糊糊的，肯定没把所有方案走一遍，没找到最好的，嘿嘿。<br>这里处理是给保存时的方法替换一下，变成传入参数增加一个指针，返回的时候就靠着这个保存了文件本身的信息，保存信息等，作为判别当前时长是否超过1小时。<br>这个方案确实不错。</p><p>记录一个犯的错误。<br>使用Masonry和自动计算行高的Third Part，我将UI贴在了TableViewCell上，而不是TableViewCellWraperView上—&gt;[self addSubview:xx];始终出现控件不如我所想，我觉得不会呀，不可能错呀。<br>过了2天，我突然想起来，TableViewCell是没有自动布局能力的，要写成—&gt;[self.contentView addSubview:xx];</p><p>周六中午得时候自己写了个自我感觉非常良好的主题管理器，基本功能都能达到啦，哈哈，那一刻非常开心。非常开森。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/3/13lesson</title>
      <link href="/2017/03/13/2017-3-13lesson/"/>
      <url>/2017/03/13/2017-3-13lesson/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//创建标准的变换矩阵</span><br><span class="line">CGAffineTransform CGAffineTransformIdentity;</span><br><span class="line">//手动创建变换矩阵</span><br><span class="line">CGAffineTransform CGAffineTransformMake(CGFloat a, CGFloat b, CGFloat c, CGFloat d, CGFloat tx, CGFloat ty);</span><br><span class="line">//创建平移变换</span><br><span class="line">CGAffineTransform CGAffineTransformMakeTranslation(CGFloat tx, CGFloat ty);</span><br><span class="line">//创建缩放变换</span><br><span class="line">CGAffineTransform CGAffineTransformMakeScale(CGFloat sx, CGFloat sy);</span><br><span class="line">//创建旋转变换</span><br><span class="line">CGAffineTransform CGAffineTransformMakeRotation(CGFloat angle);</span><br><span class="line">//判断某个变化是否是来自标准矩阵的变换</span><br><span class="line">bool CGAffineTransformIsIdentity(CGAffineTransform t);</span><br><span class="line">//对某个变换矩阵进行平移变换</span><br><span class="line">CGAffineTransform CGAffineTransformTranslate(CGAffineTransform t, CGFloat tx, CGFloat ty);</span><br><span class="line">//对某个变换矩阵进行缩放变换</span><br><span class="line">CGAffineTransform CGAffineTransformScale(CGAffineTransform t, CGFloat sx, CGFloat sy);</span><br><span class="line">//对某个变换矩阵进行旋转变换</span><br><span class="line">CGAffineTransform CGAffineTransformRotate(CGAffineTransform t, CGFloat angle);</span><br><span class="line">//对某个变换矩阵进行翻转变换</span><br><span class="line">CGAffineTransform CGAffineTransformInvert(CGAffineTransform t);</span><br><span class="line">//对两个变换矩阵进行计算</span><br><span class="line">CGAffineTransform CGAffineTransformConcat(CGAffineTransform t1, CGAffineTransform t2);</span><br><span class="line">//比较两个变换矩阵是否相同</span><br><span class="line">bool CGAffineTransformEqualToTransform(CGAffineTransform t1, CGAffineTransform t2);</span><br><span class="line">//获取应用变换后某点的坐标</span><br><span class="line">CGPoint CGPointApplyAffineTransform(CGPoint point, CGAffineTransform t);</span><br><span class="line">//获取应用变换后某个区域的尺寸</span><br><span class="line">CGSize CGSizeApplyAffineTransform(CGSize size, CGAffineTransform t);</span><br><span class="line">//获取应用变换后某个区域的位置和尺寸</span><br><span class="line">CGRect CGRectApplyAffineTransform(CGRect rect, CGAffineTransform t);</span><br></pre></td></tr></table></figure><p>记录一下矩阵变换含义</p><p>昨天做了下图片PhotoKit取图片，使用PHImageManager 同步获取200*200某张图片直接在cellForItem里面，性能还是不错的。估计得判断GIF，只能在用户点击之后，才能使用方法验证其属性。继续往下做吧。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">2xx  成功  </span><br><span class="line">200  正常；请求已完成。  </span><br><span class="line">201  正常；紧接 POST 命令。  </span><br><span class="line">202  正常；已接受用于处理，但处理尚未完成。  </span><br><span class="line">203  正常；部分信息 — 返回的信息只是一部分。  </span><br><span class="line">204  正常；无响应 — 已接收请求，但不存在要回送的信息。  </span><br><span class="line">3xx  重定向  </span><br><span class="line">301  已移动 — 请求的数据具有新的位置且更改是永久的。  </span><br><span class="line">302  已找到 — 请求的数据临时具有不同 URI。  </span><br><span class="line">303  请参阅其它 — 可在另一 URI 下找到对请求的响应，且应使用 GET 方法检索此响应。  </span><br><span class="line">304  未修改 — 未按预期修改文档。  </span><br><span class="line">305  使用代理 — 必须通过位置字段中提供的代理来访问请求的资源。  </span><br><span class="line">306  未使用 — 不再使用；保留此代码以便将来使用。  </span><br><span class="line">4xx  客户机中出现的错误  </span><br><span class="line">400  错误请求 — 请求中有语法问题，或不能满足请求。  </span><br><span class="line">401  未授权 — 未授权客户机访问数据。  </span><br><span class="line">402  需要付款 — 表示计费系统已有效。  </span><br><span class="line">403  禁止 — 即使有授权也不需要访问。  </span><br><span class="line">404  找不到 — 服务器找不到给定的资源；文档不存在。  </span><br><span class="line">407  代理认证请求 — 客户机首先必须使用代理认证自身。  </span><br><span class="line">415  介质类型不受支持 — 服务器拒绝服务请求，因为不支持请求实体的格式。  </span><br><span class="line">5xx  服务器中出现的错误  </span><br><span class="line">500  内部错误 — 因为意外情况，服务器不能完成请求。  </span><br><span class="line">501  未执行 — 服务器不支持请求的工具。  </span><br><span class="line">502  错误网关 — 服务器接收到来自上游服务器的无效响应。  </span><br><span class="line">503  无法获得服务 — 由于临时过载或维护，服务器无法处理请求。</span><br></pre></td></tr></table></figure><p>遇到一个问题，就是字符里面出现\r\n、\r、\n、\t等特殊字符，做法是将其replace成\r\n、\r、\n、\t、，没有其他做法了，，特殊的是，\r\n需要最先被替换</p><p>//    一列数：-1,2,3,10,15,26…n，写一个方法计算第n个数的值</p><blockquote></blockquote><p>答案：<br>3-&gt;1<br>7-&gt;5<br>11-&gt;?<br>?应该是9<br>然后接下去是<br>隔下去数是加15</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">BOOL needDescount = NO;</span><br><span class="line">int increaseCount = 4;</span><br><span class="line">int totalNum = -1;</span><br><span class="line">while (true) &#123;</span><br><span class="line">if (needDescount) &#123;</span><br><span class="line">increaseCount -=2;</span><br><span class="line">needDescount = YES;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">increaseCount +=4;</span><br><span class="line">needDescount = NO;</span><br><span class="line">&#125;</span><br><span class="line">totalNum +=increaseCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IOS－－ UIView中的坐标转换</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值</span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point toView:(UIView *)view;</span><br><span class="line">// 将像素point从view中转换到当前视图中，返回在当前视图中的像素值</span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point fromView:(UIView *)view;</span><br><span class="line"></span><br><span class="line">// 将rect由rect所在视图转换到目标视图view中，返回在目标视图view中的rect</span><br><span class="line">- (CGRect)convertRect:(CGRect)rect toView:(UIView *)view;</span><br><span class="line">// 将rect从view中转换到当前视图中，返回在当前视图中的rect</span><br><span class="line">- (CGRect)convertRect:(CGRect)rect fromView:(UIView *)view;</span><br><span class="line"></span><br><span class="line">例把UITableViewCell中的subview(btn)的frame转换到 controllerA中</span><br><span class="line"></span><br><span class="line">// controllerA 中有一个UITableView, UITableView里有多行UITableVieCell，cell上放有一个button</span><br><span class="line">// 在controllerA中实现:</span><br><span class="line">CGRect rc = [cell convertRect:cell.btn.frame toView:self.view];</span><br><span class="line">或</span><br><span class="line">CGRect rc = [self.view convertRect:cell.btn.frame fromView:cell];</span><br><span class="line">// 此rc为btn在controllerA中的rect</span><br><span class="line"></span><br><span class="line">或当已知btn时：</span><br><span class="line">CGRect rc = [btn.superview convertRect:btn.frame toView:self.view];</span><br><span class="line">或</span><br><span class="line">CGRect rc = [self.view convertRect:btn.frame fromView:btn.superview];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/3/3lesson</title>
      <link href="/2017/03/03/2017-3-3lesson/"/>
      <url>/2017/03/03/2017-3-3lesson/</url>
      
        <content type="html"><![CDATA[<p>这几天打算使用Bundle管理SVG文件，给项目加上Theme功能。<br>SVG使用，使用的是SVGKit，使用Bundle需要稍微注意写法<br>比如使用寻找Path，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSString *path = [[NSBundle mainBundle] pathForResource:@&quot;AnimalTheme&quot; ofType:@&quot;bundle&quot;];</span><br><span class="line">NSString *ciweiFilePath = [path stringByAppendingPathComponent:@&quot;刺猬.svg&quot;];</span><br><span class="line">SVGKImage *ciweiImage = [SVGKImage imageWithContentsOfFile:ciweiFilePath];</span><br><span class="line">ciweiImage.size = CGSizeMake(30, 30);</span><br><span class="line">ciweiImage.UIImage</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SVGKImage im = [SVGKImage imageNamed:&quot;myImage&quot;];</span><br><span class="line">CGSize originalSize = im.size; // this defaults to the SVG&apos;s internal size</span><br><span class="line">float half = 1.0 / 2.0f;</span><br><span class="line">im.size = CGSizeApplyAffineTransform( im.size, CGAffineTransformMakeScale( half, half ));</span><br><span class="line">SVGKImageView* iv = [[SVGKFastImageView alloc] initWithSVGKImage: im];</span><br><span class="line">[self.view addSubview: iv];</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SVGKImage im = [SVGKImage imageNamed:&quot;myImage&quot;];</span><br><span class="line">im.scale = 0.5f; // NB: this will BE REJECTED if your SVG is non-infinite;</span><br><span class="line">SVGKImageView* iv = [[SVGKFastImageView alloc] initWithSVGKImage: im];</span><br><span class="line">[self.view addSubview: iv];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/3/2lxlesson</title>
      <link href="/2017/03/02/2017-3-2lxlesson/"/>
      <url>/2017/03/02/2017-3-2lxlesson/</url>
      
        <content type="html"><![CDATA[<h3 id="强引用，tableview嵌套"><a href="#强引用，tableview嵌套" class="headerlink" title="强引用，tableview嵌套"></a>强引用，tableview嵌套</h3><ul><li>今天写“仿写墨迹天气app”的时候把用到的tableview单独拿出来创建tableviewcontroller单独管理，本来是这样想的，但是在把tableview贴到首页上的时候出现tableview没有显示完全而嵌套在tableview上的小tableview滑动消失，点击小tableview整个tableview消失的问题，后来经过老公的一番审查之后发现问题出在内存泄漏上，东西被提前释放掉了。具体是这样的，我要把tableviewcontroller上的tableview贴在首页上，但是LXHomeTableViewC *homeTVC = [[LXHomeTableViewC alloc]init];<br>self.a = homeTVC; 这里是强引用，拉住不能提前释放<br>homeTVC.view.frame = CGRectMake(0, 60, SelfSize.width, SelfSize.height-60);<br>[self.view addSubview:homeTVC.view];  这里我拉住了homeTVC。view，如果没有self.a = homeTVC;的话homeTVC就会被提前释放，载体释放了，那么载体上的东西就不可能有用了</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/3/2lesson</title>
      <link href="/2017/03/02/2017-3-2lesson/"/>
      <url>/2017/03/02/2017-3-2lesson/</url>
      
        <content type="html"><![CDATA[<h3 id="记录这几天的发现或者想到了的东西，哈哈"><a href="#记录这几天的发现或者想到了的东西，哈哈" class="headerlink" title="记录这几天的发现或者想到了的东西，哈哈"></a>记录这几天的发现或者想到了的东西，哈哈</h3><ul><li>关于retweeded的数据结构获取，是否可以使用 [quary include@”retweeded”]; [quary include@“retweeded.user”]; </li><li>缓存策略，使用一进去拿缓存，在判别skip数，为0则将这次数据保存替换之前的cache</li><li>collection需要使用<code>self.collectionNode performBatchUpdates:^</code></li><li>如果<code>-(BOOL)shouldBatchFetchForCollectionNode:(ASCollectionNode *)collectionNode</code>为YES，但是不再获取数据，那么就是你没有给上次Batch确认completeBatch</li><li>这里处理了一次collectionNode的获取数据和返回数据的完整逻辑，可以参照，实战demo</li><li>Theme能力由发通知会更好，毕竟如果有缓存，单元格没法刷新，还是需要发通知更改背景颜色、某些图片等，可以一步步更改</li><li>主流方向可以往可爱等线路发展</li><li>小玩意之类往往能点亮用户好奇心，比如“粉粉日记”的首页台灯、不同时间的首页动物、不同时段，该动物、背景会替换，让动物动起来等；每晚开放的树洞功能等</li><li>会员能力很重要，要让他们感到与众不同，代价每次都是一点点就很正确</li><li>首页采用多屏处理，展示不同格局东西。</li><li>首页是很能体现APP动机的地方。如果是微博类，首页就是Feed分类；如果是淘宝类，首页就是商品分类；如果是QQ、微信，首页就是你的聊天列表类；如果是游戏、地图等，首页就是你该展示的地方；“粉粉”这里首页就是展示萌创意、手账的地方，那么他走的主路线就该是这方面功能。</li><li>APP功能太全有时候会成为累赘，可以参考“花瓣”、“Facebook”的分离法，将不同业务分出去，将主功能留下。比如“Facebook”的Message功能就会让你跳出去到另一个App。</li><li>粒度这个东西有时候要考虑清楚，有时候深一点使用组件化，有时候直接写有他的好处</li><li>说一个今天遇到的缓存能力ASDK，当我刷新，我将dataSource的数据都删光了，然后没写好，没有reloadData全部，而是insert数据到当前单元格，下面数据仍然在，ASDK的缓存能力确实太厉害了，然而反观“粉粉”里面的缓存，其实他做的就是将基本数据缓存起来，等还要再cellForItemAtIndexPath的时候，他还是会更新当前的单元格。所以严格意义上说，“粉粉”里面之前的缓存方案，仅是对数据的再次缓存得到快速获取，而不是前缘科技里面的Feed页面写法。</li><li>从前一个公司到现在的粉粉日记领悟到一个思想：前一个公司很在意功能上的全，比如我们要有自己的图片选取工具、纯文字发布能力的特立独行、视频这块大块头的实现类似“美拍”的全逻辑。由于人员的不够，我在竭尽全力下初窥视频骨架，但是公司在一次次的冲击市场下都没有反响中放弃了。其中原因是大骨头很难啃，其他东西没抓住，人员配置不够；粉粉公司反其道，一步一步走，走的路也更早，探索出了抓住青少年人群的美少女“萌”。粉粉到现在才开始有了拍摄视频的能力，而且仅仅只有拍摄这一步，目前还是内测；粉粉每走一步都测试、保证再保证没有问题才将功能加上去。粉粉的选取图片能力还有滤镜能力，目前走到了这么一个地步：使用其他公司的SDK：在功能左下角还有某某SDK的字样。里面框架也是挺卡的，我拿了个iPod5的测试机，FPS有时直接到0了，有些页面写的，连复用都没有；比如图片这块，我们使用qiniu作为图片保存地址，他们使用的UPYun是腾讯的，目前还属于内测阶段，而且他们居然没有看文档，不知道可以图片地址后面拼接image的后缀，让服务器帮忙更改图片属性功能。可以这么说，内容、市场、人员、测试、流程，粉粉都比“呱拍”走的很远，但是一些功能上的，确实“呱拍”使用的前缘功能，要比粉粉走太远：当我已经要试试FaceDetect功能的时候，粉粉才在有拍摄功能。。。</li><li>最近练手了一个自定义CollectionLayout，联系之前看的OpenGL ES 的皮毛，类比到ASDK和autoLayout中布局说明，终于理解了一个原理：程序是死的，目前我接触到的都是死的，他需要人说明，包括每个pixel需要展示什么颜色定义，需要opacity多少，每个点需要人告诉程序。比如手机、电脑在某一快需要展示蓝色，布局定义等都会转化为绝对坐标，绝对坐标再转化为在底层GPU需要的布局信息，GPU在将每一层需要的颜色重叠起来，看需要输出到屏幕的是什么，才最终呈现出来</li><li>如果要判别一个公司的团队实力，可以在看市场竞争能力，我想到作为在iOS技能求职者一个新方法：下一个该公司的APP—&gt;使用iPhone4s看其表现能力，iPhone6不能作为功能测试机，不过可以作为布局测试机！！！</li><li>今天改了下host，进入公司的FTP服务器，改host需要vim的权限，于是我使用sudo vim +“对应文件夹Path” 写完后按左上角esc键盘按键，然后输入<em>:wq</em>意思是write and quit</li><li>今天下午搞了下git branch，之前使用都是小心翼翼，不太懂整，他们搞过来搞过去，嗯哼，还不太给力ing</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/2/20lesson</title>
      <link href="/2017/02/20/2017-2-20lesson/"/>
      <url>/2017/02/20/2017-2-20lesson/</url>
      
        <content type="html"><![CDATA[<p>今天第一次去粉粉日记报到，记录下流程。<br>这几天是大风大雪天，最后一次寒潮，连着2周晚睡晚起，而且还是没有开空调裸睡，，，嘴里一直念叨着<em>我是要做大事之人</em>才哆嗦着起来，，，<br>本来打算今早去体检，怕来回来不及，小电驴也没充电，赶紧吃了俩小面包就出发了。<br>到公司后人事先给我安排到桌子前，没想到公司都用Mac mini，嘿嘿，很久没用啦，开发效率估计要打折，，哈哈<br>我先捣鼓下开启主机，然后写入职表。过了一会，公司每天的早会，我看他们全围成一圈报告，有一定好处，有规划知道做什么是很重要的事。接着我继续下载我可能要用到的软件呀、下homebrew、cocoapods啊；常用软件：蓝灯、Chrome、微信、Reveal等等常用的；设置下电脑，看看PhotoKit（最近要开始gif图片等研究）等。<br>公司里面“粉粉日记”成员蛮多的，才知道粉粉是从2013年的项目到现在，过了一会，他们把代码发过来我先看着了。里面项目有几点想说的，包确实很大，比环球高尔夫还大，但是资源管理很有条例（我自己处理的话尽量用IconFont管理图片资源吧），用的一些技术我没去掌握的有那么几个：JSBridge、Mantal、CoreData、Archive、以及一些其他一些以前没去接触过的。<br>JSBridge以前没有实验对象；Mantal以前觉得对model有入侵；CoreData觉得一些啥啥问题等；Archive没试验对象；之后可以看看哪里有没有契机接触使用等了，，，<br>11点多的时候在钉钉里面和大家大哥招呼，大家群里立马热闹起来了，互开着玩笑。<br>中午一下就来了，和iOS几个一起吃午饭，还不知道这附近怎么吃，跟着他们吃就好了。他们人挺热情的，那么多人在办公室，大家工作有讨论，有去开会，挺热闹；大家吃饭，我们几个在一个厅里吃饭，也是来来回回大家玩闹。<br>下午的时候，我先看了很久的代码。过没一会还要填一些规章、录个指纹啥的，然后人事小妹带我跟大家都走一遍认识认识。我估计记不清，只能记大概范围的工作区，还有去<strong>可萌记账</strong>组走一下，大概知道销售、商务、iOS开发、后台开发、安卓开发、网页开发、UI组、插画组等的位置。也去转了财务、经理处。<br>回来继续看代码，他们安排了一个小任务。<br>这个小任务是本来别的地方有的，我给写到新的地方，不是太难。我考虑的比较多，以为其图片是从外部传递进去控制的，没想到是内部写好，这样估计没法再重新用的；不过另一层也会考虑到不能过度封装，也会带来一些隐患。我也能看到这项目有些没设计好的地方，毕竟项目大了，有些没能全盘思考，总体设计方案很值得我学习，细节方面值得我学习注意规避。<br>有些设计我粗略看了下还没看全。<br>textView的inputView、accessInputView原来是用来代替keyboardPad的，环球高尔夫看到过，没留意，现在清楚了。<br>将代码直接拖到sourceTree建立branch，新建一个branch给代码添分支，这些我居然以前没去搞过，一直花时间写/学新东西，现在有的补上了，，，<br>下午的时候主要就是改那个需求，改成和另一个完全一样，还差和后台人对接数据。到最后7点多了也确实饿了，给上级发了个今天任务完成邮件后先回来吃饭了。发每日任务有个好处，上级对下面的管控，知道过程、进程如何。我看到他们有写一句话的，不过我记录修改习惯早就养成，修改哪里，细节等都会列举，如果有技术手段处理过程、试验过程也会记录，习惯，让我不这么写我也会在便签记下，哈哈。<br>晚上回来，总要学点啥，或者写点啥吧，我问了下parse中<code>I have a mainPostTable and three other tables,three other tables owns mainPostTable&#39;s objectId, how can i count from other three table??</code>这样怎么处理，等待他们回答结果。然后测试数据include “user”这个pointer，哇哈，返回数据了，那就好啦，，哈哈，，首页就差问他们的那个问题啦。<br>等会看看文章，就早点睡了，面对明天新的任务，毕竟给我的任务肯定会越来越重，赶紧在公司的时候多看代码，不然做的效率在不知道相应代码位置的话会吃亏的。<br>再多说一句，加入“粉粉”组有好处，比如知道他们怎么运营，我这里看到的数据最直观；也有坏处，我的一身本事，不能乱显身手，哈哈哈，不要乱加代码嘛，是吧，尽量和原作者手法一致；私下多写自己代码，不然有些自己的东西会忘却的哦，加油2017，，，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/2/18lesson</title>
      <link href="/2017/02/18/2017-2-18lesson/"/>
      <url>/2017/02/18/2017-2-18lesson/</url>
      
        <content type="html"><![CDATA[<p>因为近期离职的原因，生活有点乱，主要就是本来习惯的节奏变化，自己感觉拼不上，倒不是因为离职带来的主要影响。<br>离职这几天有时候晚上会思考我要走什么样的路，有时候晚上玩游戏，玩着玩着就太晚，晚？那也不行嘞，写东西还是要写，于是又变成熬夜，最近2周基本是1点、1点半左右睡。<br>本来我已经拿到一个公司A的offer，那边同学也盛情邀请，但是有几点考虑。第一是我感觉不到那个方向所能带来的前进，第二是做的跟我以前做的有点杂很相似；主要是能有公司B的一个对比。<br>我觉得我是时候往上突破了。这几年沉淀下来的能力也差不多可以破开另一个点了。<br>公司Aoffer拿到的那天下午，我刚好答应公司B隔天去面试。我在接到去公司B邀请面试的电话，心里对公司A评价也很好。有些人可能会觉得我公司A已经有offer不怕没饭吃了，随便去就好了，又不是就你们一家。有时候年轻的气盛不是叫“年轻气盛”，有时候却会成了“自以为是”。我在心里重复给自己鼓气，你是要做大事的人，机会是给有准备的人，给沉心静气，给贤者。<br>我觉得我会爬上顶端，所以我给自己定义都是求职者，虚心求学求职者，公司和求职者双向共赢的姿态。<br>去公司B面试的时候比较正规，毕竟是走的比较前缘。<br>面试的是一个大哥，我一开始介绍自己、项目，他说问几个吧。1：http，我就说计算机硬件课程里面知道的什么3次握手4次挥手，socket在底层利用比如路由头、什么头什么头拼接成数据在物理链传输；2：post协议，我就说比如请求头这块，body体这块，跟get请求大概区别，也说了我以前利用charles请求iTunes的https请求中利用其excuse更改传输数据内容下载不同版本app；3：json转model，他问往上扩展，这个我不知道他想我能给他说什么，那我就往上扩展，说该不该在json转为dic之后需要转为model这个，于是blablabla，后来他说不是想问这个，比如MJExtension，json转为dic之后，找个一个个key值，然后给他赋上–&gt;这么说我终于知道他想问的什么，那我就说使用runTime遍历出来property列表，然后在json中某一属性对应数据，使用kvo给property列表赋值即可；4、5<br>我可真不会紧张，只是不知道他表达的我应该回答哪某一领域，我觉得都是工作几年了，应该不会那么简单的吧，我一直以为是探讨些东西吧。<br>后来我跟这个大哥说了，我这有个offer，可能需要在下午3点前给个回复，求职是相互沟通的过程，如果您们对我不是很满意，那么请直接拒绝我，我都懂，毕竟双向选择啦，不然这里我不敢拖，另一边也不能拖答复延时，诚信为主。他说等会，他把CTO喊来了，CTO又跟我聊了很久。跟CTO聊天，也算是给我后面做的决定定了基础。不是说工资高就去，而是奔着职业规划，我心中路线而去，进这个公司哪个能带给我前进的步伐和台阶。<br>后来面试结束要离开了，他说他们会尽快，2、3点前给我回复。<br>我出门在地铁上公司B前台就打电话过来，给定工资结构说明和工作时间、安排事项等。offer是这样，前台这里口头说好，然后需要我接下来的背景调查，然后写单子审批，然后offer才发到我这里。<br>那天下午回到住所，我跟公司A人事说了决定，邮件回复公司Aoffer邮件。然后等待公司B的一些背景调查配合。公司B基本问一些为什么之前离开公司啦，说了试用期情况啦，然后公司B前台打电话给我之前老板人事们。offer直到隔天下午还没发过来，我也是时不时就看一下邮箱，没有定下来，心确实有点不在焉状态，毕竟另一个offer推掉，如果这个说offer不发了，那我又得继续投简历咯，比较麻烦。<br>大概在隔天晚些时候，offer终于发过来，确定好了。我也没停歇，继续搞我自己的事，我该写的东西还是要写，是吧，嘿嘿，停不下来。<br>今天周六，本来要去体检，早上写东西忘记还在煮粥，粥都煮成饭了，下午去医院看到没人-&gt;我去的时间太晚了，只能回来继续写写文章、写写东西啦。<br>明天计划是处理图文混排和骑车去新公司看看，毕竟不是很远，6km左右，我要坐地铁还要2站转乘1站，还不如看看我的小电驴能不能撑到，不能的话，考虑换一个小电驴^.^。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ASTextNode图文</title>
      <link href="/2017/02/14/ASTextNode%E5%9B%BE%E6%96%87/"/>
      <url>/2017/02/14/ASTextNode%E5%9B%BE%E6%96%87/</url>
      
        <content type="html"><![CDATA[<p>过段时间，写一个关于ASTextNode的图文混排的demo<br>这里才参考一个博客：<br><a href="http://blog.csdn.net/pjk1129/article/details/45559647" target="_blank" rel="noopener">http://blog.csdn.net/pjk1129/article/details/45559647</a><br><a href="http://tutuge.me/2015/04/21/resizable-nstextattachment/" target="_blank" rel="noopener">http://tutuge.me/2015/04/21/resizable-nstextattachment/</a><br>到时讲讲如何实现包括插入image，解析image成string；使用正则将string的标记改为image插入到ASTextNode<br>时间定为这周周末吧</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/2/14lesson</title>
      <link href="/2017/02/14/2017-2-14lesson/"/>
      <url>/2017/02/14/2017-2-14lesson/</url>
      
        <content type="html"><![CDATA[<p>这几天正好离职，离职对于我来说更大的是机遇，更好的确定自己的方向。<br>以前的知识都是积累，就如学校里面学习，你要学线代、微积分、几何、数据结构等等，你还要有专项的如Visual-C、汇编、jave等等工作中可能会用到的语种。但是最后你要确定好自己的方向。<br>你不可能什么都学会，不同的人创建的语法都有自己的特点，什么都学，什么都是皮毛，这是我的观点，没办法，中国人，除了工作，你还要生活啊。。。<br>找工作对我来说，最大的挑战就是-&gt;<code>晕车挑战</code>，有几回头确实很晕，但都还能忍。<br>离职能让你重新审视这个行业,同时去面试的偏重自己的热爱方向，面试的时候比如今天碰到比我厉害，走的比我远的大哥，我不多问几个问题，我不就白去了。所以也可以刚好审视自己以前的研究成果的熟悉度和错误地方。<br>先说前两天去面试的一家：<br>某个资产行业公司，他想做一个类<code>K线PK</code>的即时对战app，团队还没有组件。我这里给他主推一些方案。你需要即时对战，那么对信息的更改，便需要很高，于是推荐<code>Parse</code>服务器、<code>Firebase</code>、<code>自己花钱雇人搭建服务器</code>.K线原型的话，UIKit也能实现，我这方面可以私下花个时间学习写一个，毕竟没搞过，私下自己搞搞也是有点意思。之后可能我自己就会去实现一个可以对战的小游戏，个人兴趣爱好，决心继续发展就不能浪费时间。<br>这个老板比较对生意上在意，我去的时候问的一直都是觉得以前的工作做到位，却前景不看好，我觉得这个大哥估计数学方面或者金融方面浸淫很深，我缺少的就是这方面知识和操作。我从小就没被往这方面培养，肯定不行，算了，人各有道，有机会再说往上爬的事，哈哈。</p><hr><p>昨天去面试的一家是一个做共享自行车🚲类的，一样，和前两天的要做1个小时车过去，我小脑袋晕车晕呀晕呀，摇呀摇呀，回来的时候都是浑浑噩噩的。<br>去到那里，里面感觉还有一点点油漆未干那种味道，办公地点很大，人10来个。反正我来就是来玩的，我哪可能干这行。<br>跟里面大哥聊了会，说了我能带来什么技术，我知道他做后台，我说的很多他也都不懂，他说的一些跟蓝牙某些技术，我1年前搞过BlueTooth这块的peerTalk，继续研究也没啥，看看资料一个个攻克也有可能搞得好，但是现在<strong>ofo</strong>、<strong>摩拜</strong>、<strong>小鸣</strong>等占据了很大市场，算了，我直接说<code>我可能不太适合，我对音视频这块比较热衷，浪费您的时间，打扰了</code>，双方都很客气，知道都不适合，只能算打扰。</p><hr><p>今天去面试的一家叫初生科技的一家公司，他的产品<code>热拉</code>在春节的时候跻身免费榜前十，做的是挺不错的。我有点心动，心动的不是其除去功能的其他原因。我想更了解音视频这块，他们是做的比较好的了。首先我先自我介绍，这东西说来说去就说到我们最近做的<code>呱拍</code>APP，里面使用的技术点、里面负责模块等。<br>大哥对细节比较在意，细节是能体现很多方面的能力。我觉得做东西，就要把他当情人，每天都是热爱，每天都是把情人打扮的更美。<br>这里我们沟通了很多，我记录几天我以前做APP的时候想到不敢确定的一些事情。</p><ul><li>我查阅一些资料，觉得我多个页面都是用到了GPUImage，也就是说context对很多页面都有一些buffer没有清除，他的建议的是在关键页面使用GPUImage，我的拍摄页面需要改掉，单纯给需要添加filter或者MV页面使用GPUImage。</li><li>MV效果中，他的一个说法让我解开MV的真正面纱，使用playItem，先让movieFile process，然后在相应时间play或者seekToTime，跟我想的一模一样。</li><li>关于切换滤镜可能会卡顿，这点和我想的一样，不是那些问题，估计是其他一些什么东西的原因吧，切换某一些filter的时候会有那么点卡顿。</li><li>效果滤镜里边，他说其中有一些可以实现比如detect事件，这个我知道有，不太会用；有一些是效果滤镜，比如画面移动、波纹滤镜等，这个我当时还真没找到。这个就是我比较差的一个地方了，网上资料甚少啊，我当时也没时间处理，光找demo就能花去很多时间。</li><li>关于询问音频打包问题，最终我的操作原来是对的，他们的操作是GPUImage 处理出来视频，然后使用AVFoundation再处理出来视频。没办法，视频、音频只能两个地方分别打包，毕竟GPUImage干的事就是处理AVMediaType的事情。</li><li>我也提出一些观点，在处理每一帧出来的framebuffer中，可以使用CIDetector或者OpenCV的观测点。OpenCV确实没接触，我需要去搞搞的事情啊。</li><li>在学习方向，他给的说3个建议</li></ul><ul><li>第一，demo使用到场景中。这个当然了，硬着头皮上！！！</li><li>第二，做压力测试。比如他提到聊天方面，在一万条数据面前，保存和未保存，读写保护等的情况。我之前没这么做过，这个倒是我真正要学习的，这个或许是我要进入的下一个阶段。其实就是某些场景，耐不耐用的体现。不再是小打小闹啦</li><li>第三，将做出来的东西在github开源，接受大家的考验。这点我赞同，，，，，，一半，哈哈，，，这个是在第二个建议之后的事啦。我现在也有将写出来的项目拿出来，不过都是我的一些测试类的，等到第二个建议实现，才会到达第三个层面吧</li></ul><hr><p>总的来说，离职是件好事，趁着这个时间，好好沉淀，好好实现之前一直想自己做的东西，努力花时间，不要再颓废，每天定时定量完成！！！</p><hr><p>因为离职，有些东西要去规划，要学的可能更知道哪个方向，这里确定好最近要学的东西吧。</p><ul><li>APP中，使用IGListKit进行归类Setting_Module</li><li>使用FxForms填写个人信息表单。</li><li>LiveQuary</li><li>在ASTextNode使用NSAttachment</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/2/13lesson</title>
      <link href="/2017/02/13/2017-2-13lesson/"/>
      <url>/2017/02/13/2017-2-13lesson/</url>
      
        <content type="html"><![CDATA[<p>练习了一个UI试图，嘿嘿，挺好玩的。<a href="http://www.jianshu.com/p/a7f5cab17395" target="_blank" rel="noopener">http://www.jianshu.com/p/a7f5cab17395</a><br>大概长这样<img src="http://cdn1.raywenderlich.com/wp-content/uploads/2015/03/runfinal.gif" alt><br>有兴趣的可以去试试，有时间我看能不能改成代码形式，嘿嘿。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017/2/10lesson</title>
      <link href="/2017/02/10/2017-2-10lesson/"/>
      <url>/2017/02/10/2017-2-10lesson/</url>
      
        <content type="html"><![CDATA[<p>parse-server出现<code>[Error]: schema mismatch for feedPost.pageInfo; expected String but got Pointer&lt;pageInfo&gt; (Code: 111, Version: 1.14.2)</code><br>保存不进去。<br>原理是因为server在我们创建类的时候，为类保存了一个总纲类似的table<em>_SCHEMA</em>,我之前创建feedPost table的时候，总纲给pageInfo定义为string，这时候改成Pointer，那么需要做的要么是删除table<em>_SCHEMA</em>，要么更改里面某一条collection里的pageInfo类型啦。</p><hr><p>NSString中提取单词 enumerateSubstringsInRange NSCharacterSet CFStringTokenizerRef<br>看了这篇网址给的说明<a href="http://blog.csdn.net/god_chong/article/details/49589499" target="_blank" rel="noopener">http://blog.csdn.net/god_chong/article/details/49589499</a></p><h4 id="function1"><a href="#function1" class="headerlink" title="function1:"></a>function1:</h4><p>NSString <em>popo = @”Lorem __ ! @ () “” ipsum “” dolar ?~  </em> # $  % ^ &amp; &lt; &gt;{}\ |;:sit  amet.”;<br>[popo enumerateSubstringsInRange:NSMakeRange(0, popo.length) options:NSStringEnumerationByWords usingBlock:^(NSString <em> _Nullable substring, NSRange substringRange, NSRange enclosingRange, BOOLBOOL </em> _Nonnull stop) {<br>    NSLog(@”substring     :%@”,substring);<br>    NSLog(@”substringRange:%lu,length:%lu”,(unsigned long)substringRange.location,substringRange.length);<br>    NSLog(@”enclosingRange:%lu,length:%lu \n\n”,(unsigned long)enclosingRange.location,enclosingRange.length);<br>}];<br>打印如下：<br>2015-11-02 17:22:07.244 AFNetWorkingDemo[8620:300513] substring     :Lorem<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] substringRange:0,length:5<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] enclosingRange:0,length:6   </p><p>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] substring     :__<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] substringRange:6,length:2<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] enclosingRange:6,length:11   </p><p>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] substring     :ipsum<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] substringRange:17,length:5<br>2015-11-02 17:22:07.245 AFNetWorkingDemo[8620:300513] enclosingRange:17,length:7   </p><p>2015-11-02 17:22:07.246 AFNetWorkingDemo[8620:300513] substring     :dolar<br>2015-11-02 17:22:07.246 AFNetWorkingDemo[8620:300513] substringRange:24,length:5<br>2015-11-02 17:22:07.246 AFNetWorkingDemo[8620:300513] enclosingRange:24,length:33   </p><p>2015-11-02 17:22:07.246 AFNetWorkingDemo[8620:300513] substring     :sit<br>2015-11-02 17:22:07.246 AFNetWorkingDemo[8620:300513] substringRange:57,length:3<br>2015-11-02 17:22:07.273 AFNetWorkingDemo[8620:300513] enclosingRange:57,length:5   </p><p>2015-11-02 17:22:07.273 AFNetWorkingDemo[8620:300513] substring     :amet<br>2015-11-02 17:22:07.273 AFNetWorkingDemo[8620:300513] substringRange:62,length:4<br>2015-11-02 17:22:07.273 AFNetWorkingDemo[8620:300513] enclosingRange:62,length:5</p><h4 id="function2"><a href="#function2" class="headerlink" title="function2:"></a>function2:</h4><p>CFStringRef string1 = (__bridge CFStringRef)([NSString stringWithFormat:@”Lorem    ipsum dolar   sit  amet.”]); // Get string from somewhere<br>    CFLocaleRef locale = CFLocaleCopyCurrent();<br>CFStringTokenizerRef tokenizer =<br>CFStringTokenizerCreate(<br>                        kCFAllocatorDefault<br>                        , string1<br>                        , CFRangeMake(0, CFStringGetLength(string1))<br>                        , kCFStringTokenizerUnitWord<br>                        , locale);<br>CFStringTokenizerTokenType tokenType = kCFStringTokenizerTokenNone;<br>unsigned tokensFound = 0;<br>while(kCFStringTokenizerTokenNone !=<br>    (tokenType = CFStringTokenizerAdvanceToNextToken(tokenizer))) {<br>    CFRange tokenRange = CFStringTokenizerGetCurrentTokenRange(tokenizer);<br>    CFStringRef tokenValue =<br>    CFStringCreateWithSubstring(<br>                                kCFAllocatorDefault<br>                                , string1<br>                                , tokenRange);<br>    // Do something with the token<br>    NSLog(@”tokenValue:%@”,tokenValue);<br>    NSLog(@”tokenRange:%ld,%ld”,tokenRange.location,tokenRange.length);<br>    CFShow(tokenValue);<br>    CFRelease(tokenValue);<br>    ++tokensFound;<br>}<br>// Clean up<br>CFRelease(tokenizer);<br>CFRelease(locale);<br>打印如下：<br>2015-11-02 17:22:07.276 AFNetWorkingDemo[8620:300513] string:Lorem ipsum dolar sit amet.<br>2015-11-02 17:22:07.276 AFNetWorkingDemo[8620:300513] sss:Loremipsumdolarsitamet.<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenValue:Lorem<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenRange:0,5<br>Lorem<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenValue:ipsum<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenRange:9,5<br>ipsum<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenValue:dolar<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenRange:15,5<br>dolar<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenValue:sit<br>2015-11-02 17:22:07.277 AFNetWorkingDemo[8620:300513] tokenRange:23,3<br>sit<br>2015-11-02 17:22:07.278 AFNetWorkingDemo[8620:300513] tokenValue:amet<br>2015-11-02 17:22:07.278 AFNetWorkingDemo[8620:300513] tokenRange:28,4<br>amet</p><h4 id="function3："><a href="#function3：" class="headerlink" title="function3："></a>function3：</h4><p>NSString <em>string = @”Lorem    ipsum dolar   sit  amet.”;<br>string = [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];<br>NSArray </em>components = [string componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];<br>NSLog(@”%@”,components);<br>components = [components filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@”self &lt;&gt; ‘’”]];<br>NSLog(@”%@”,components);<br>string = [components componentsJoinedByString:@” “];<br>NSLog(@”string:%@”,string);<br>打印如下：<br>2015-11-02 17:22:07.275 AFNetWorkingDemo[8620:300513] (<br>    Lorem,<br>    “”,<br>    “”,<br>    “”,<br>    ipsum,<br>    dolar,<br>    “”,<br>    “”,<br>    sit,<br>    “”,<br>    “amet.”<br>)<br>2015-11-02 17:22:07.275 AFNetWorkingDemo[8620:300513] (<br>    Lorem,<br>    ipsum,<br>    dolar,<br>    sit,<br>    “amet.”<br>)<br>2015-11-02 17:22:07.276 AFNetWorkingDemo[8620:300513] string:Lorem ipsum dolar sit amet.   </p><hr><p>摘抄自大神可可的笔记<a href="https://zhuanlan.zhihu.com/p/20669823?refer=cocoanotes" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/20669823?refer=cocoanotes</a><br>想要把 UITableView 的 header 全都换成同一个效果，不用做任何 Subclassing，也不用做任何 Swizzling，直接 Appearance 搞定：<br><code>[[UILabel appearanceWhenContainedIn:[UITableViewHeaderFooterView class], nil] setTextColor:[UIColor redColor]];</code></p><hr><p>想要短信 app 里面那种元素之间相互挤压的物理效果，使用 UIDynamicAnimator 就可以了，这里有一个很不错的范例：<a href="https://github.com/AshFurrow/ASHSpringyCollectionView" target="_blank" rel="noopener">GitHub - ashfurrow/ASHSpringyCollectionView</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>记录一次Issues in NSObjCRuntime, NSZone, and NSObject</title>
      <link href="/2017/02/06/2017-2-6lesson/"/>
      <url>/2017/02/06/2017-2-6lesson/</url>
      
        <content type="html"><![CDATA[<p>iOS 我加了一个c的程序进到程序，然后程序始终编译不过。<br>这里有两个方案：</p><ol><li><a href="http://stackoverflow.com/questions/11857765/ios-parse-issues-in-nsobjcruntime-nszone-and-nsobject" target="_blank" rel="noopener">http://stackoverflow.com/questions/11857765/ios-parse-issues-in-nsobjcruntime-nszone-and-nsobject</a></li><li><a href="https://my.oschina.net/ioslighter/blog/416199" target="_blank" rel="noopener">https://my.oschina.net/ioslighter/blog/416199</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2017-2-5lesson</title>
      <link href="/2017/02/05/2017-2-5lesson/"/>
      <url>/2017/02/05/2017-2-5lesson/</url>
      
        <content type="html"><![CDATA[<p>这里记录一下给他人介绍一个想法</p><h3 id="闲鱼"><a href="#闲鱼" class="headerlink" title="闲鱼"></a>闲鱼</h3><p>闲鱼是淘宝的子APP，用来对付58等同城信息发布的应用<br>闲鱼有一个很了不起的功能：法院拍卖<code>法院拍卖这种交易不是谁想做就做的，马云能把这谈下来，简直了</code><br>闲鱼有个查询身份还有一些信用的手段，58或者赶集什么的，基本压力超大的了<br>闲鱼账号，你有淘宝账号，就有闲鱼账号</p><h3 id="如何操作"><a href="#如何操作" class="headerlink" title="如何操作"></a>如何操作</h3><p>首先在闲鱼网站，或者闲鱼APP，推荐app，搜索类似图例<img src="http://7xjcms.com1.z0.glb.clouddn.com/333.png" alt="搜索条件"></p><h2 id="因为转卖为必须要卖出去，留在手上没毛用的，又不需要用，所以优先考虑全新-奖品-未拆封之类的"><a href="#因为转卖为必须要卖出去，留在手上没毛用的，又不需要用，所以优先考虑全新-奖品-未拆封之类的" class="headerlink" title="因为转卖为必须要卖出去，留在手上没毛用的，又不需要用，所以优先考虑全新,奖品,未拆封之类的"></a>因为转卖为必须要卖出去，留在手上没毛用的，又不需要用，所以优先考虑<code>全新</code>,<code>奖品</code>,<code>未拆封</code>之类的</h2><p>我就先拿闲鱼截了一张某一商品图图<img src="http://7xjcms.com1.z0.glb.clouddn.com/111.png" alt="闲鱼上的商品，价格：2200"><br>在淘宝上可以搜索当今的价格<img src="http://7xjcms.com1.z0.glb.clouddn.com/222.png" alt="淘宝目前价格：2999"><br><img src="http://7xjcms.com1.z0.glb.clouddn.com/444.png" alt="例"><img src="http://7xjcms.com1.z0.glb.clouddn.com/555.png" alt="例"><br><img src="http://7xjcms.com1.z0.glb.clouddn.com/666.png" alt="例"><img src="http://7xjcms.com1.z0.glb.clouddn.com/777.png" alt="例"><br>这里说给定了价，其实你还可以还价。还价在闲鱼里面私聊，然后还价还到无耻为止，你就说“你不用了，你留着没用，浪费资源，尽早出了”之类的话。<br>最好自己亲自前往勘察物品真实性，这个环节做多了都会。</p><h2 id="亲自前往费用基本属于乘坐地铁、坐公交、自己骑车前往等。"><a href="#亲自前往费用基本属于乘坐地铁、坐公交、自己骑车前往等。" class="headerlink" title="亲自前往费用基本属于乘坐地铁、坐公交、自己骑车前往等。"></a>亲自前往费用基本属于乘坐地铁、坐公交、自己骑车前往等。</h2><p>所在城市，推荐中国直辖市，物品很多很多，每天都一堆的更新。</p><blockquote><p>拿一次我的经历：2015年时候我抽奖抽到一个蓝牙Beat音响。我自己根本不用，耳机的话还好说；寄回家里吧，没必要，家里还不如空放音响，那就只能卖了。淘宝我自己查了大概450多，我连外面的拆封都没有撕开。然后一个估计也是做这个的，跟我要价到320。好吧，留着也是留着。见面的时候他提了个黑色大挎包，鬼知道里面什么东西，矮胖矮胖的，他看到没拆封，300直接拿给我说“就300吧，我都亲自来取的”，然后直接往后走。他给的钱比较散，我还没说完，人就走远了。算了，亏20就20吧，我特么真的用不到，还不如买糖吃。</p></blockquote><p>呐，真的如此，这就是做生意了。里面还有很多门道，自己喜欢搞七搞八，都试试才知道世事不是那么简单。我也不喜欢整天憋家里，就靠赚那几毛生活。<br>打“蛇蛇争霸”这游戏，大家都会围着大蛇在旁边，就等着有肉吃自己上去抢一波，老妈还让我在小乡村卖菜？老妈老爸真的老了，所以才会有这思想，安稳才好。<br>安稳当然好，但是也只有灰色地带，才有油水了吧。不要太平凡，不要太激烈，循序渐进发展，能冲一波就冲，嘿嘿，，，<br>有空我多整整一些门道，，，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>device连接到本地电脑服务器</title>
      <link href="/2017/02/04/device%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%94%B5%E8%84%91%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2017/02/04/device%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%94%B5%E8%84%91%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>首先是根据这个答案<a href="http://stackoverflow.com/questions/12657651/connect-device-to-mac-localhost-server" target="_blank" rel="noopener">http://stackoverflow.com/questions/12657651/connect-device-to-mac-localhost-server</a><br>我搞了一会，parse服务器地址不变，将我的<br><code>configuration.server = @&quot;http://localhost:1337/parse&quot;</code>的地址改为<code>@&quot;http://&quot;MAC IP&quot;:1337/parse&quot;</code> MAC IP就是你电脑的地址，即可。很类似RN中将其指向本地构建的服务器中，脑袋没转过弯来，居然还要去查答案，万幸，没有花太多时间。<br>记录一下。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>大年初二研究成果</title>
      <link href="/2017/01/29/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%BA%8C%E7%A0%94%E7%A9%B6%E6%88%90%E6%9E%9C/"/>
      <url>/2017/01/29/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%BA%8C%E7%A0%94%E7%A9%B6%E6%88%90%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<p>今天大年初二，还是不能停歇，毕竟有兴趣，马达就一直在脑袋转着，哈哈。<br>先介绍我之前想用不敢用的一款文本创建第三方工具：<code>ZSSRichTextEditor</code></p><h3 id="ZSSRichTextEditor"><a href="#ZSSRichTextEditor" class="headerlink" title="ZSSRichTextEditor"></a>ZSSRichTextEditor</h3><p>这款作用是将你输入转化为html文本，你直接就可以将它当做链接用，如：<br>`NSString *htmlStr = @”<div class="\" test\""></div>\<br><!-- This is an HTML comment -->\</p><p></p><p>This is a test of the <strong>ZSSRichTextEditor</strong> by <a title="\" zed" said\" href="\" http: www.zedsaid.com\"">Zed Said Studio</a>\<br><img src="\" http: common.cnblogs.com images wechat.png\"" alt="\" weichat\"">\<br></p><font face="\" times" new roman, times, serif\">Dffhhhfff<sub>ffggg</sub><sup>ggggggggg<strike>gggggggggggg</strike><u>uuuuuuuuuuuuuuyy</u><i><u>tttttttt</u><b><u>gggggggggggggg</u>vvv</b></i></sup></font>\<p></p><p><div><a href="\" www.baidu.com\"">baidubaidu</a><font face="\" times" new roman, times, serif\"><sup><i><b><br></b></i></sup></font>\<br></div>“;<code>如果其中的</code>&lt;img src=\”data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBYR……alt=””&gt;<code>那么其为数据类型，data可能会很大，可能我会想办法将其作为图片传到服务器，然后再将其类型更改为地址，这样其中的数据就变小了。使用的话，很简单，如：</code>[self.webView loadHTMLString:self.htmlStr baseURL:nil];`<br>你可以自己加上头、背景啥的，一个文章便创建成功了，哈哈。<br>慢慢我也要学习前段知识啦，刚好之前学的React语法用得上，估计可以比较快用的顺手，嗷嗷，提供一个学习地址:<a href="http://www.cenizal.com/" target="_blank" rel="noopener">大牛博客</a></p><h3 id="快要睡觉了-直接贴FontAwesome学习使用代码"><a href="#快要睡觉了-直接贴FontAwesome学习使用代码" class="headerlink" title="快要睡觉了,直接贴FontAwesome学习使用代码"></a>快要睡觉了,直接贴FontAwesome学习使用代码</h3><p><code>FAKIonIcons *starIcon = [FAKIonIcons starIconWithSize:30];UIImage *starImage = [starIcon imageWithSize:CGSizeMake(30, 30)];FAKFontAwesome *settingIcon = [FAKFontAwesome cogIconWithSize:30];UIImage *settingImage = [settingIcon imageWithSize:CGSizeMake(30, 30)];NSArray *imageArr = @[starImage,settingImage];NSArray *selectedArr = @[starImage,settingImage];NSArray *nameArr = @[@&quot;&quot;,@&quot;&quot;];//    self.label.attributedText = [starIcon attributedString];//    starIcon.drawingBackgroundColor = [UIColor blackColor];//    starIcon.drawingPositionAdjustment = UIOffsetMake(2, 2);//    [starIcon removeAttribute:NSForegroundColorAttributeName];//    [starIcon setAttributes:attributes];//    [starIcon attributes];//    [starIcon addAttribute:NSForegroundColorAttributeName value:[UIColor whiteColor]];</code></p><ul><li>这里提一点，我将其Cocoapods导入的，然后捏，本身有.a文件，但是搜不到，于是我将其Resources文件复制到主工程的Resource下才OK，哈哈，记录一下吧</li></ul><h3 id="Array使用valueForKeyPath"><a href="#Array使用valueForKeyPath" class="headerlink" title="Array使用valueForKeyPath"></a>Array使用valueForKeyPath</h3><p>参考：<a href="http://blog.csdn.net/binyanye1/article/details/43413333" target="_blank" rel="noopener">http://blog.csdn.net/binyanye1/article/details/43413333</a><br><code>NSArray *testArray = [NSArray arrayWithObjects:@&quot;2.0&quot;, @&quot;2.3&quot;, @&quot;3.0&quot;, @&quot;4.0&quot;, nil];NSNumber *sum = [testArray valueForKeyPath:@&quot;@sum.floatValue&quot;];NSNumber *avg = [testArray valueForKeyPath:@&quot;@avg.floatValue&quot;];NSNumber *avg = [testArray valueForKeyPath:@&quot;@max.floatValue&quot;];NSNumber *avg = [testArray valueForKeyPath:@&quot;@min.floatValue&quot;];</code></p><p>如果类型如下：<br><code>(    {        city = “Beijing”;        country = “China”;    },    {        city = “Tokyo”;        country = “Japan”;    },    {        city = “New York”;        country = “U.S.”;    })</code></p><p>使用<code>[array valueForKeyPath:@&quot;city&quot;];</code><br>则会得到<br><code>(    “Beijing”,    “Tokyo”,    “New York”)</code><br>然后利用array的index:<code>[[array valueForKeyPath:@&quot;city&quot;] indexOfObject:@”Beijing”];</code><br>然后用得到的index获取对象：<code>[array objectAtIndex:[[array valueForKeyPath:@&quot;city&quot;] indexOfObject:@”Beijing]];</code></p><p>这是一个例子<br><code>NSMutableDictionary *dic=[NSMutableDictionary dictionary];[dic setObject:@&quot;v1&quot; forKey:@&quot;k1&quot;];[dic setObject:@&quot;v2&quot; forKey:@&quot;k2&quot;];[dic setObject:@&quot;v3&quot; forKey:@&quot;k3&quot;];NSArray *array=[NSArray arrayWithObjects:@&quot;2&quot;,@&quot;3&quot;,@&quot;4&quot;,@&quot;5&quot;,nil];[dic setObject:array forKey:@&quot;k4&quot;];id obj=[dic valueForKeyPath:@&quot;k4.@sum.floatValue&quot;];NSLog(@&quot;%@&quot;,[obj description]);//==14</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>记一次和后台讨论bug的过程吧</title>
      <link href="/2017/01/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%92%8C%E5%90%8E%E5%8F%B0%E8%AE%A8%E8%AE%BAbug%E7%9A%84%E8%BF%87%E7%A8%8B%E5%90%A7/"/>
      <url>/2017/01/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%92%8C%E5%90%8E%E5%8F%B0%E8%AE%A8%E8%AE%BAbug%E7%9A%84%E8%BF%87%E7%A8%8B%E5%90%A7/</url>
      
        <content type="html"><![CDATA[<p>和公司后台大哥打交道也有几次了，都不是很给力的解决bug过程。</p><h4 id="先说一下上一次的情形吧。"><a href="#先说一下上一次的情形吧。" class="headerlink" title="先说一下上一次的情形吧。"></a>先说一下上一次的情形吧。</h4><p>我们的后台是用php写的，我以前都是和java后台打交道，所以有些怪，而且后台用的他们以前公司的架构，我们之前的所有api，重要不重要都需要post请求，而且调试bug需要我们前段调节，我记得以前的java那边可以使用terminal调试。<br>这些都不是事，接下来的才是比较蛋疼的。<br>我们那次调试发布，类似发布帖子情形，怎么都发布不出去。我跟后台调了好久，最后我先下去吃饭了，一上来，说解决了。这件事离得比较久，有些忘记了，不过跟后台沟通真麻烦，真蛋疼的那种，我说说这次的吧，基本差不多，感受一下。</p><h4 id="“我这代码绝对没有问题，想想你们代码怎么写的吧；不是你们的错，也绝对不是我代码有问题，好吧，那就不用做了，不要做了”"><a href="#“我这代码绝对没有问题，想想你们代码怎么写的吧；不是你们的错，也绝对不是我代码有问题，好吧，那就不用做了，不要做了”" class="headerlink" title="“我这代码绝对没有问题，想想你们代码怎么写的吧；不是你们的错，也绝对不是我代码有问题，好吧，那就不用做了，不要做了”"></a>“我这代码绝对没有问题，想想你们代码怎么写的吧；不是你们的错，也绝对不是我代码有问题，好吧，那就不用做了，不要做了”</h4><p>是的，这个真是他这样说的。<br>这次是2017年1月23号，也就是鸡年快过年最后一天班。心比较急是真的。<br>后台把代码放到线上，我们都发现登陆、发布这两块不能用。<br>我们可以用排除法：</p><ul><li>登陆我使用测试登陆：手机号登陆、第三方登陆都没有问题；</li><li>我使用线上登陆：手机号登陆失败，第三方登陆没有问题；</li><li>我们前段iOS，线上线下唯一区别就是域名不一样，没有其他。</li><li>发布这个接口也有问题</li><li>我很久没有修改登陆位置的代码了<br>呐，上面可以看出，真的，要么线上线下都不能登录，要么所有接口全都不能用，那肯定是我们哪里错了，他就一句话一开始：肯定是你们前段的错，你们代码没有写好。<br>我当时一直的态度都是确定的知道是后台的错，我愿意陪你来改，帮后台查查那边的错误。<br>他一直说我们这都问题，好吧，毕竟是我当时写的，那我看看代码有没有变动吧：没有，只字未变，，，<br>我说，大哥，我们这里真的没有问题，要不你再查一查。<br>他就说，绝对不可能，怎么可能我这里有问题，你再查查再查查。说的很激动，，肯定是你们的错的。<br>我还是好言好语，毕竟做不好，大家年都不好过，心里想着。<br>接着他说，不然我们调bug。<br>好吧，于是调bug过程也很蛋疼，我用AFNetworking，简单使用网络连接的，他说88888，有没有，我说收到383838 38，中间有个空格。<br>他说我给你88888，你给我383838中间还有空格，肯定是你们那里错了，不然那里来的3，还出来空格，你赶紧改你们代码。<br>我说，大哥啊，我们收到什么就是什么，你给383838空格38，我当然收到相应的了，真不是我们这有错啊。<br>然后他就很凶的，我给你88888，你到时给出来38383838，你还说我这里有问题，那你说这3还有空格哪里来的。<br>我当时回说不知道啊，我们前段收到什么就是什么了。<br>他就一扭头，你先解决3和空格哪里来的在跟我说下一步，再说调试。<br>我无奈的说，你发过来什么我怎么可能找出来哪里来的3，真是服务器的情况啊，你看看测试可以用，线上第三方都能用<br>他插话，语气很凶的说，你不要跟我说什么测试能用，第三方能用，你先把383838那个3和空格找出来（这纯粹转移话题了，解决登陆、发布问题变成了解决3和空格问题）<br>我说，大哥，这没法测了，我们解决登陆问题，你让我查3和空格，我们这，你要什么参数我们提供给你们，你返回什么数据我们就收，我真查不出来啊。<br>然后他就更凶了，你说不是你们问题，那还不是我们问题类，那这样不要测了，不能做不要做了，<br>我蛋疼啊，我还是苦口婆心（毕竟这大过年的，登陆都没法，大家过年都不用过了，老板肯定会很气愤的啊，做了大半年），大哥，我们再查一查吧，毕竟不能登陆，老板肯定发飙啊。<br>他的凶依旧，查什么查，我这里根本不用查，你那边多出来3和空格还让我这边查，那要这样，我把代码还原，要是你还不能登陆，发布有问题，我跟你说好，接下来也不用找我，你自己解决，也不用找我帮忙。<br>（呐，听到这，真的很心寒，我确定是他那边有问题，我都是打着帮他调试bug的态度，心里也嘀咕，要真登陆不了，我没有后台帮忙调试，没法搞啊），我就说先下去吃饭了，登陆上来就换回之前代码试试，没办法了呀，只有这样才能确定是他那边还是我这边，要真我这边，那我也没话说啊<br>，，，我下去吃饭中，，，<br>心情也没被搞坏，毕竟出来给人工作，没必要受同事的气的，吃个饭，慢走慢走的上来了，大冬天，有点太阳，心情还是有点蛋疼。<br>上来看见我们iOS另一个同事和大哥调试着代码，慢慢调着，始终能把矛头指向他们那服务器有问题。<br>因为我一开始就能预见—&gt;才没几行代码啊，出去回来一个过程。<br>后来好吧，后台把代码退回去，（服务器还没运行）还是登不上，我做对面，觉得不对啊，然后他们退到首页看其他数据也没有，然后大哥说还没启动。（服务器运行着）：登陆、发布全部正常，这回后台没话说了，真的没话说了。<br>我也没说什么，搞我自己的东西，这明显的啊。<br>后来说是当时他们搞一些别的东西给代码加上别的东西。<br>可以这么说，这回我是真的蛋疼，特别蛋疼，我一直好声好气，给别人打工啊，没办法啊，后台那边就可以一句话：那就不用做了，不要做了，，，<br>我只是发泄一下，，，毕竟有苦闷着绝对不好，哈哈<br>如果界面有问题，那不用说了，前段的错。<br>逻辑有问题，可能双方哪里合作没有调试好。<br>如果比较矛盾问题，那估计是服务器有问题了。基本都是，前段的东西基本很少的，就这么几个代码啊！！！<br>我真是老好人，人家都凶成这样，我都还是笑脸相迎，我都恨不得给自己一巴掌得了：做你麻痹程序员，写你麻痹代码，，，<br>我其实也可以甩手，不用做就不用做呗，不做就不做呗，我本职做好，谁都没话说，你凶就你凶呗。<br>额弥陀福，，，也记住这一次，下一次还有类似蛋疼的，我就发这给大哥看看好了，我真的以大局为重，要都不解决，登陆不了，明年我们都散伙得了，我怎么对得起其他同事，，，真不想管那么多啊，真想随便拿个工资做做自己手上的事多好，，，，</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>微博API分析</title>
      <link href="/2017/01/23/%E5%BE%AE%E5%8D%9AAPI%E5%88%86%E6%9E%90/"/>
      <url>/2017/01/23/%E5%BE%AE%E5%8D%9AAPI%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>createdAt:<br>id:<br>pics:[“”,””,””]<br>text:”文字内容”<br>sourcetype:””—–&gt;不知道是什么鬼<br>geo:”地理位置”<br>source:”从哪里发过来的，什么设备”<br>video:”……..”    视频链接<br>user:{<br>id:<br>screen_name:”新浪财经”<br>province:”11”<br>city:”8”<br>description:”……” 简介<br>url:”……..” 其选填官网<br>“profile_image_url”:”……” 头像<br>“cover_image_phone”:”……” 其个人主页的背景图片<br>“gender”:m/f<br>followers_count:14020824<br>friends_count:1450<br>following:true/false 是否我关注了他<br>follow_me:false 是否关注了我<br>“level”:2   这里可以使用自己的积分<br>}<br>reposts_count:678 转发数<br>comments_count:262 评论数<br>attitudes_count:96 点赞数<br>page_info:{        这个是文章在外边时候展示的<br>page_id:<br>page_title:”…..”<br>page_url:”…….”<br>page_pic:”…….”<br>content1:”银行汇出100元就要进口100元”<br>content2:”。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。”<br>object_type:”webpage”<br>}<br>url_struct:[{      这个应该是文章的构造，跳转构造<br>page_id:””<br>ori_url:”……..”  文章跳转url<br>url_title:”银行汇出100元就要进口100原”<br>url_type_pic:””  图片<br>}]<br>topic_struct:[{    这个是#xxx#<br>“topic_title”:”一盒子的年味”<br>“topic_url”:”…………”<br>}]<br>retweeted_status:{<br>被转发的内容，同上内容<br>}</p><p>文章类型<br>图片类型<br>纯文字类型<br>视频类型</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>读文章微信导航栏实现写了demo</title>
      <link href="/2017/01/23/%E8%AF%BB%E6%96%87%E7%AB%A0%E5%BE%AE%E4%BF%A1%E5%AF%BC%E8%88%AA%E6%A0%8F%E5%AE%9E%E7%8E%B0%E5%86%99%E4%BA%86demo/"/>
      <url>/2017/01/23/%E8%AF%BB%E6%96%87%E7%AB%A0%E5%BE%AE%E4%BF%A1%E5%AF%BC%E8%88%AA%E6%A0%8F%E5%AE%9E%E7%8E%B0%E5%86%99%E4%BA%86demo/</url>
      
        <content type="html"><![CDATA[<p>看了这位大哥<a href="http://www.jobbole.com/members/3170539585/的文章，关于微信导航栏的实现。" target="_blank" rel="noopener">http://www.jobbole.com/members/3170539585/的文章，关于微信导航栏的实现。</a><br>由于他没有给出代码实现，当时我没有设置barstyle，导致不好看，哈哈。<br>这里给出完整代码<br>`#import “SHNavigationVC.h”</p><p>#import “UIColor+expanded.h”<br>@interface SHNavigationVC ()<br>@property (nonatomic, strong) UIView *blurBackView;<br>@end<br>@implementation SHNavigationVC</p><ul><li>(void)viewDidLoad {<br>[super viewDidLoad];<br>// Do any additional setup after loading the view.<br>UINavigationBar <em>navBar = self.navigationBar;<br>[navBar insertSubview:self.blurBackView atIndex:0];<br>}<br>-(UIView </em>)blurBackView{<br>if (!_blurBackView) {<br>_blurBackView = [UIView new];<br>_blurBackView.frame = CGRectMake(0, -20, KScreenSize.width, 64);<br>CAGradientLayer *gradientLayer = [[CAGradientLayer alloc]init];<br>gradientLayer.frame = CGRectMake(0, 0, KScreenSize.width, 64);<br>gradientLayer.colors = @[(<strong>bridge id)[UIColor colorWithHexString:@”0x040012” andAlpha:0.76].CGColor,(</strong>bridge id)[UIColor colorWithHexString:@”0x040012” andAlpha:0.28].CGColor];<br>gradientLayer.startPoint = CGPointMake(0, 0);<br>gradientLayer.endPoint = CGPointMake(0, 1.0);<br>[_blurBackView.layer addSublayer:gradientLayer];<br>_blurBackView.userInteractionEnabled = NO;<br>_blurBackView.alpha = 0.5;<br>}<br>return _blurBackView;<br>}`</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>动画显示和隐藏Tabbar和NaviBar</title>
      <link href="/2017/01/19/%E5%8A%A8%E7%94%BB%E6%98%BE%E7%A4%BA%E5%92%8C%E9%9A%90%E8%97%8FTabbar%E5%92%8CNaviBar/"/>
      <url>/2017/01/19/%E5%8A%A8%E7%94%BB%E6%98%BE%E7%A4%BA%E5%92%8C%E9%9A%90%E8%97%8FTabbar%E5%92%8CNaviBar/</url>
      
        <content type="html"><![CDATA[<p>‘//隐藏标签栏</p><ul><li>(void)hiddenTheTabBar<br>{<br>if (![[NSUserDefaults standardUserDefaults] boolForKey:@”isHiddenTabBar”]) {<br>for (UIView *v in [self.view subviews]) {<br>if ([v isKindOfClass:[UITabBar class]]) {<br>[UIView animateWithDuration:0.5f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(){<br>CGRect frame = v.frame;<br>frame.origin.y += 49.0f;<br>v.frame = frame;<br>} completion:nil];<br>} else {<br>[UIView animateWithDuration:0.5f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(){<br>CGRect frame = v.frame;<br>frame.size.height += 49.0f;<br>v.frame = frame;<br>} completion:nil];<br>}<br>}<br>[[NSUserDefaults standardUserDefaults] setBool:YES forKey:@”isHiddenTabBar”];<br>}<br>}<br>//显示标签栏</li><li>(void)showTheTabBar<br>{<br>if ([[NSUserDefaults standardUserDefaults] boolForKey:@”isHiddenTabBar”]) {<br>for (UIView *v in [self.view subviews]) {<br>if ([v isKindOfClass:[UITabBar class]]) {<br>[UIView animateWithDuration:0.3f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(){<br>CGRect frame = v.frame;<br>frame.origin.y -= 49.0f;<br>v.frame = frame;<br>} completion:nil];<br>} else {<br>[UIView animateWithDuration:0.3f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(){<br>CGRect frame = v.frame;<br>frame.size.height -= 49.0f;<br>v.frame = frame;<br>} completion:nil];<br>}<br>}<br>[[NSUserDefaults standardUserDefaults] setBool:NO forKey:@”isHiddenTabBar”];<br>}<br>}<br>‘<br>思路就是这样，别人那边看到的，就是找出来，然后拿着这玩意做动效，存着吧</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>最近做项目要用到的库</title>
      <link href="/2017/01/18/%E6%9C%80%E8%BF%91%E5%81%9A%E9%A1%B9%E7%9B%AE%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E5%BA%93/"/>
      <url>/2017/01/18/%E6%9C%80%E8%BF%91%E5%81%9A%E9%A1%B9%E7%9B%AE%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>由于2017年了，没有一个非常好的，拿得出手的项目，决定在闲暇时间花更多精力去写好一个产品。不能总是东拼西凑完成一些功能，代码自己也要完善好。这里先想好需要哪些东西，从哪里开始，做到哪里。</p><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p>由于想做的内容有多媒体，GPUImage必不可少，最近也研究了很久，公司项目又正好有用到，虽然还不太熟悉，不过，硬着头皮也要上。</p><ol><li>GPUImage</li><li>ReactiveCocoa</li><li>AsyncDisplayKit</li><li>Parse&amp;&amp;ParseServer</li><li>MBProgress</li><li>MMMarkdown</li><li>Shimmer</li><li>ChameleonFramework</li><li>MLeaksFinder</li><li>pop</li><li>Qiniu</li><li>MJRefresh/MJExtension</li><li>AVOS(这个怎么讲，免费额度还是不错的，一些快捷数据存放在那边，很好。)</li><li>CTMediator</li><li>ijk</li><li>Realm</li><li>320</li><li>AF</li><li>FLAnimatedImage</li><li>SD</li><li>GYBootingProtection</li><li>DZNEmptyDataSet</li><li>FontAwesome</li><li>LxDBAnything</li><li>Origami</li><li>FontAwesome</li><li>PermissionScope<br>大型库就差不多了。小的自己撸。<h3 id="做个啥"><a href="#做个啥" class="headerlink" title="做个啥"></a>做个啥</h3></li><li>能发布内容，包括<br>文本-&gt;markdown语法，解析棒啊<br>图片-&gt;拍摄加本地存取图片滤镜+gif<br>视频-&gt;拍摄加本地存取+视频+背景音乐+贴图+MV效果</li><li>展示页面<br>参考了微博、Facebook、twitter、内涵段子</li><li>总共界面<br>Feed界面、登陆界面、上传等界面、我的界面、查看用户界面</li><li>首先先这么多，哈哈<h3 id="什么方向"><a href="#什么方向" class="headerlink" title="什么方向"></a>什么方向</h3></li><li>我估计会做成跟内涵段子差不多方向</li><li>百思不得骑姐不行</li><li>那还是想内涵段子学习，多研究推送，参考大亨“Pinterest”、“Facebook”、“Weibo”、“即刻”、“微信”等推送能力</li><li>做东西不能想着赚钱，不过要想好赚钱渠道：</li></ol><ul><li>比如进入时的广告页</li><li>广场的广告页</li><li>观看时的广告页</li><li>推送<h3 id="做到哪里"><a href="#做到哪里" class="headerlink" title="做到哪里"></a>做到哪里</h3>做到哪里不如说，我想做什么。</li></ul><ul><li>之前大半年的业余时间，大半都浪费了。有想法了，就持续做出好的来，别东一个西一个。</li><li>由于最近搞的东西很多，没把React-native嵌进去已然减轻了很多了</li><li>边写边学。</li><li>比如视频部分，公司最近一直有往这一方向走。不过说实话，由于没资源、没人问导、老板又催促，着实很着急，这方面知识很难，毕竟这一块作品又不是烂大街。市场上有很多？更多的是新闻类好伐。</li><li>自己也有对视频有爱好，继续往里面学习。早先我就研究WebRTC，不过学的很粗浅，最后面用别人的（OpenTok+parse实现无后台操作）才实现了方案。GPUImage，很多坑，你没有做这些尝试，你都不知道做下去能不能出来。</li><li>这方面市场上还不是非常非常多人，尝试往里面挤挤，说不定有一些油水哟。</li></ul><hr><p>由于SVG对做地图比较好，我这里基本想用ttf搞定，就先忽略SVG</p><p>#最近要做的事情给他列一下好了</p><ul><li>CTMediator学习并直接使用到新项目   <strong>完成</strong></li><li>系统主题变色学习，将其swift改为OC版本，并且直接使用到新项目   <strong>使用微信导航栏方案代替</strong></li><li>GIF图搞进去,保存可以选择将GIF转成视频保存、或者GIF保存也行，便于复制转发。</li><li>编写APP啦</li><li>Origami继续搞</li><li>collection layout tutorial学习</li><li>学习一个非常酷的3D效果菜单，以前我写过一些类似的，但没有从大方向，不伦不类，好好看看他们怎么写的</li><li>OpenCV学习</li><li>阅读几个源码：FLAnimatedImage、RESidemenu、SDWebImage等文章</li><li>给我的博客优化优化，添加百度谷歌搜索</li><li>给我的博客加上广告，哈哈</li><li>评论区加上</li><li>统计</li></ul><p>这样梳理下来，有搞头了，知道方向就好多了，哈哈。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>使用charles下载appStore历史版本</title>
      <link href="/2017/01/17/%E4%BD%BF%E7%94%A8charles%E4%B8%8B%E8%BD%BDappStore%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC/"/>
      <url>/2017/01/17/%E4%BD%BF%E7%94%A8charles%E4%B8%8B%E8%BD%BDappStore%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>今早想看秒拍最早版本长啥样，于是就看看教程捣鼓捣鼓。说实话，网上的教程都是东一个西一个，缺少章节，重要位置往往遗漏。我这里自己写一个完整一些的，也算是记录，完全给菜鸟看，因为我也是菜鸟，连我特么都搞定了，你怕个鸟。</p><h3 id="申明几点"><a href="#申明几点" class="headerlink" title="申明几点"></a>申明几点</h3><p>charles可以使用手机代理来查看http或者https内容。但是到了App Store去下载时，点击下去，始终出现</p><blockquote><p><a href="https://p33-buy.itunes.apple.com" target="_blank" rel="noopener">https://p33-buy.itunes.apple.com</a> SSLHandshake: Remote host closed connection during handshake</p></blockquote><p>懒得整了，于是这里全部使用电脑端的使用，而且很快。</p><ol start="2"><li>记得要翻墙，对了，姿势要对，比如左手放在大腿附近，右手点击快进键。</li><li>我这里charles版本为3.11.2版本。正不正版无所谓，没付费不就是老是弹提示嘛，多弹几次能给我钱，那就更好了。</li><li>我这里使用的是MAC电脑<h3 id="进入正题"><a href="#进入正题" class="headerlink" title="进入正题"></a>进入正题</h3></li></ol><ul><li>下载https证书<a href="https://www.charlesproxy.com/assets/legacy-ssl/ssl.zip" target="_blank" rel="noopener">https://www.charlesproxy.com/assets/legacy-ssl/ssl.zip</a></li><li>解压之后,双击该证书。</li><li>前往钥匙串，搜索charles，然后就出现<img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_01.png" alt="该证书不被信任" title="不被信任不正常嘛"></li><li>双击该证书，同时点击第一项，使其<em>始终信任</em><img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_02.png" alt="该证书选为始终信任" title="始终信任"></li><li>左上角关闭，同时要求输入mac电脑密码。<h4 id="因为我们在电脑上搞，那么我们要将代理设到电脑上。"><a href="#因为我们在电脑上搞，那么我们要将代理设到电脑上。" class="headerlink" title="因为我们在电脑上搞，那么我们要将代理设到电脑上。"></a>因为我们在电脑上搞，那么我们要将代理设到电脑上。</h4></li><li>打开网络设置偏好-&gt;高级-&gt;代理-&gt;将http和https都设置为127.0.0.1 port:8888 <img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_03.png" alt="代理设置" title="按照步骤"></li><li>完了之后选择“应用”<h4 id="这里开始搞charles"><a href="#这里开始搞charles" class="headerlink" title="这里开始搞charles"></a>这里开始搞charles</h4></li><li>打开charles，我这个版本的ssl proxy设置在 proxy下边的#SSL Proxying settings#里边，点击他进入，同时按图中设置 <a href="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_04.png" title="按照步骤" target="_blank" rel="noopener">proxy设置</a><h4 id="这时打开iTunes和charles"><a href="#这时打开iTunes和charles" class="headerlink" title="这时打开iTunes和charles"></a>这时打开iTunes和charles</h4></li><li>在charles startRecording的时候，在iTunes-&gt;应用-&gt;App Store里面搜索“秒拍”<br>可以看到图中解释 <img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_05.png" alt="charles内容解释" title="按照步骤"><br>往下翻看到<br>key&gt;softwareVersionBundleId<br><string>com.yixia.iphone</string><br><key>softwareVersionExternalIdentifier</key><integer>820135955</integer><br><key>softwareVersionExternalIdentifiers</key><br><array><br><integer>4981074</integer><br><integer>5394180</integer><br><integer>6879271</integer><br><integer>7521689</integer><br><integer>7688644</integer><br><integer>7941305</integer><br><integer>8166440</integer><br><integer>9007047</integer><br><integer>9411091</integer><br><integer>9872854</integer><br><integer>10633066</integer><br><integer>15892678</integer><br><integer>15974682</integer><br><integer>16060211</integer><br><integer>16091930</integer><br><integer>16504676</integer><br><integer>17263812</integer><br><integer>59592659</integer><br><integer>81073287</integer><br><integer>139932634</integer><br><integer>192742647</integer><br><integer>220962670</integer><br><integer>294852730</integer><br><integer>305732696</integer><br><integer>329852736</integer><br><integer>398862656</integer><br><integer>468142680</integer><br><integer>513982646</integer><br><integer>572242779</integer><br><integer>589372761</integer><br><integer>641902654</integer><br><integer>652212932</integer><br><integer>655043181</integer><br><integer>662912853</integer><br><integer>701362692</integer><br><integer>709942656</integer><br><integer>770264233</integer><br><integer>811423848</integer><br><integer>811487803</integer><br><integer>811635729</integer><br><integer>811781222</integer><br><integer>812037027</integer><br><integer>812232597</integer><br><integer>812328295</integer><br><integer>812440942</integer><br><integer>812536145</integer><br><integer>812563006</integer><br><integer>812597840</integer><br><integer>812675604</integer><br><integer>812763862</integer><br><integer>812874619</integer><br><integer>812980000</integer><br><integer>813078957</integer><br><integer>813307221</integer><br><integer>813588175</integer><br><integer>813621742</integer><br><integer>813630679</integer><br><integer>814108034</integer><br><integer>814127199</integer><br><integer>814228608</integer><br><integer>814261627</integer><br><integer>814370408</integer><br><integer>814372706</integer><br><integer>814567037</integer><br><integer>814567882</integer><br><integer>814592662</integer><br><integer>814800494</integer><br><integer>814875099</integer><br><integer>815021644</integer><br><integer>815023592</integer><br><integer>815055555</integer><br><integer>815350442</integer><br><integer>815358012</integer><br><integer>815393500</integer><br><integer>815457608</integer><br><integer>815607029</integer><br><integer>815608372</integer><br><integer>815615057</integer><br><integer>815654426</integer><br><integer>816131497</integer><br><integer>816162845</integer><br><integer>816749956</integer><br><integer>816873466</integer><br><integer>816998702</integer><br><integer>817114988</integer><br><integer>817301959</integer><br><integer>818053825</integer><br><integer>818219564</integer><br><integer>818406305</integer><br><integer>818614237</integer><br><integer>818735711</integer><br><integer>818784109</integer><br><integer>818961748</integer><br><integer>819270136</integer><br><integer>819601281</integer><br><integer>820135955</integer><br></array><br><key>vendorId</key><br><integer>1754660</integer><br><key>drmVersionNumber</key><br><integer>0</integer></li></ul><p>这里820135955为目前最新的下载版本号，<br>这个4981074，则为其第一个版本</p><p><integer>820135955</integer> </p><p><key>softwareVersionExternalIdentifiers</key> </p><p><array> </array></p><p><integer>4981074</integer></p><h1 id="进入重点啦！！！"><a href="#进入重点啦！！！" class="headerlink" title="进入重点啦！！！"></a>进入重点啦！！！</h1><ul><li>删掉刚才的秒拍，给charles的那条链接点选这两个勾！！！breakpoint会让程序停在一开始的将要开始地方(这里就可以更改里面的参数，让其下载4981074历史版本)<br><img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_06.png" alt="charles勾选内容" title="两个都勾上"></li><li>关掉charles,iTunes不要关闭</li><li>打开charles,选上proxy-&gt;MAC OS X proxy</li><li>到将要下载秒拍的那个地方,点击获取，charles breakpoint到这张图<br><img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_07.png" alt="将要下载的内容换成“呱拍”,不要在意这个"></li><li>根据下图，修改里面的参数<br><img src="http://7xjcms.com1.z0.glb.clouddn.com/blog_installoldapps_08.png" alt="根据步骤操作"><br>当版本号修改过后，即可点击下面的按钮“excuse”，可能要点击2次，观察iTunes下载是否开始，当要结束时，似乎还要点击一次“excuse”，最后反正就是下载成功了。<br>我这里使用iTool安装，你也可以直接用iTunes安装，个人爱好。到这里，你就可以随意搞你要的各个app版本啦。</li></ul><p>附我参考的文章<br><a href="http://www.cocoachina.com/ios/20161214/18351.html" target="_blank" rel="noopener">http://www.cocoachina.com/ios/20161214/18351.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Charles https iTunes 下载历史版本 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20170112meetbug</title>
      <link href="/2017/01/12/20170112meetbug/"/>
      <url>/2017/01/12/20170112meetbug/</url>
      
        <content type="html"><![CDATA[<p>记一个比较逗比的bug。<br>由于使用ASDK，在里面使用<br>create a displayNode and return a block uiview:</p><p><code>self.progressView = [[SHRecordProgressView alloc]initWithFrame:CGRectMake(0, 0, KScreenWidth, 8)];self.progressView.backgroundColor = RGBA(245, 245, 245, 0.6);self.progressNode = [[ASDisplayNode alloc]initWithViewBlock:^UIView * _Nonnull{@strongify(self);return self.progressView;}];</code></p><p>progressView create views when user interactor with device,<br>I change the one of the “views”‘s width,<br>effect that come:progressView<br><code>-(void)layoutSubviews{[super layoutSubviews];NSLog(@&quot;%@&quot;,self);}</code></p><p>infinite  log :round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0; frame = (0 342; 320 8); layer = &lt;CALayer: 0x180f0080&gt;&gt;<br>:round_pushpin:-[SHRecordProgressView layoutSubviews] + 31:balloon:  self = &lt;SHRecordProgressView: 0x1807afd0<br>what does it mean??help:joy:</p><p>akerdi [3:48 PM]<br>I figure it out,I use FBShimmerView  add to the progressView, subViews not inside of  shimmerView will disappeare:joy:I am not use to ShimmerView</p><p>我使用ASDK，每当我改变progressView中某个subView的Width，程序便一直进入layoutSubViews，同时所有其他的progressView的subViews都不见了，关键是不见了。<br>我以为是ASDK哪里引发的。<br>最后注释掉了FBShimmerView，才发现问题跟他有关。<br>progressView addSubView:FBShimmerView<br>当ShimmerView的contentView大小被我改成和progressView中subViews的最后一个时，除了rect里面View，其他的都不见了。没搞懂FBShimmer的思想，确实不好找问题啊。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>根据一张gif图返回每张图片</title>
      <link href="/2017/01/10/%E6%A0%B9%E6%8D%AE%E4%B8%80%E5%BC%A0gif%E5%9B%BE%E8%BF%94%E5%9B%9E%E6%AF%8F%E5%BC%A0%E5%9B%BE%E7%89%87/"/>
      <url>/2017/01/10/%E6%A0%B9%E6%8D%AE%E4%B8%80%E5%BC%A0gif%E5%9B%BE%E8%BF%94%E5%9B%9E%E6%AF%8F%E5%BC%A0%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>由于GPUImage的UIElement在processFrame的block中回调需要用到过渡图片调用，这里处理是将gif图全部取出来，然后在里面进行更新<br>根据一篇博客<a href="http://blog.csdn.net/zafir_zzf/article/details/52993853" target="_blank" rel="noopener">http://blog.csdn.net/zafir_zzf/article/details/52993853</a><br>有以下操作：</p><ol><li>获取到GIF图的源数据 CGImageSourceRef<br><code>CGImageSourceRef gifSource = CGImageSourceCreateWithURL((CFURLRef)fileUrl, NULL);</code></li><li>由源数据 SourceRef生成一张CGImageRef类型图片<br><code>CGImageRef imageRef = CGImageSourceCreateImageAtIndex(gifSource, i, NULL);</code></li><li>拿到里面的图片数<br><code>size_t gifCount = CGImageSourceGetCount(gifSource);</code></li><li>有CGImageRef生成UIImage ,我们想要的.<br><code>UIImage *image = [UIImage imageWithCGImage:imageRef];</code></li><li>最后别忘了给他释放掉<br><code>CGImageRelease(imageRef);</code><br>他这里提供了一段代码,记得，需要添加Binary：ImageIO<br>`#import &lt;ImageIO/ImageIO.h&gt;<br>@implementation NSArray (CDIExtention)</li></ol><ul><li>(NSArray <em>)cdi_imagesWithGif:(NSString </em>)gifNameInBoundle {<br>NSURL <em>fileUrl = [[NSBundle mainBundle] URLForResource:gifNameInBoundle withExtension:@”gif”];<br>CGImageSourceRef gifSource = CGImageSourceCreateWithURL((CFURLRef)fileUrl, NULL);<br>size_t gifCount = CGImageSourceGetCount(gifSource);<br>NSMutableArray </em>frames = [[NSMutableArray alloc]init];<br>for (size_t i = 0; i&lt; gifCount; i++) {<br>CGImageRef imageRef = CGImageSourceCreateImageAtIndex(gifSource, i, NULL);<br>UIImage *image = [UIImage imageWithCGImage:imageRef];<br>[frames addObject:image];<br>CGImageRelease(imageRef);<br>}<br>return frames;<br>}<br>@end`</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>忙碌的2016</title>
      <link href="/2017/01/10/%E5%BF%99%E7%A2%8C%E7%9A%842016/"/>
      <url>/2017/01/10/%E5%BF%99%E7%A2%8C%E7%9A%842016/</url>
      
        <content type="html"><![CDATA[<p>刚过年回来不到一个月就被公司辞了，原因是这样的：第一我是去年进的公司，具体几月份进的记不清了，反正离6个月的试用期还有半个月而已。试用期间能做的基本也算是安分守己的做了，最后由于ios主管度蜜月去了，把工作丢给我了，从来没有自己扛过项目的我就这样被利用给踢了。哎，说实话，那主管真不是什么好鸟，明知道他的技术后续工作也是无法完成的，就找个理由把皮球踢我了（他知道我家里有个帮手，一直提防着我）。其实大可不必这样的，小心眼。后面我说我要结婚了，估计他们也猜到几分了，看我比较简单吧，辞了就辞了，忍了。</p><p>辞掉工作的我一直在房间里学习并养胎，但是那做饭太惨了，厨房在一楼，我们住在三楼，还是共用的厨房，每次煮个饭所有的的东西要搬下去，煮好了还得搬回来，作为一个孕妇的我确实也是不太方便的。四月份的时候决定还是回家养胎好了。</p><p>回到家的我（婆婆家），刚开始婆婆照顾的确实非常不错的，全心全意的照顾我，每天都给我煮好吃的。可是五一之后，我们是5.3号结的婚，5.4号二姐生小孩，之后全家人就天天围着二姐转了，哎，地位从此一落千丈啊。悲伤。。。说实话有点不大乐意住家里了的。但是又没有办法。忍了，毕竟产妇也是非常重要的，如果没有照顾我的话或许会留下bing</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2016年回顾</title>
      <link href="/2017/01/10/2016%E5%B9%B4%E5%9B%9E%E9%A1%BE/"/>
      <url>/2017/01/10/2016%E5%B9%B4%E5%9B%9E%E9%A1%BE/</url>
      
        <content type="html"><![CDATA[<p>说说我的2016年，回顾下我一共做了啥，学了啥，经历了啥。<br>    我从2015年年末任职目前的公司“鱼渊”，直到2016年4月左右停止更新“宝来屋”这一款上线的APP。这个APP跟我渊源之深，也只能说，里面主要的全部代码以及框架构建是我一次比较大的尝试，在里面学到了很多很多。由于在“宝来屋”大规模使用RAC，接下来的由于有新的要求，我们重做了一款“呱拍”这一款APP至今，思路都没太走偏。2016的春节把丫头带回去见爸妈，别说媳妇要娶进门了，爸妈还没见过，哈哈，然后我说，这丫头，怀孕了。春节回上海，丫头也还在上班，我继续加班搞“宝来屋”。由于住在类似酒店公寓，丫头怀孕不能吃到比较好的，确实比较麻烦，丫头在3、4月份的时候也由于经常呕吐、肚子越来越大，后来被辞职在家。一楼做个菜整到住的3楼来菜都凉了。于是我特么做了个大胆决定，让只在春节回到家的丫头，送她带火车站，一个人到我老家，大姐开车去接她。蛋疼蛋疼。。。<br>    5月份的时候，我放了10天得假期回去结婚了。那个时候丫头肚子大大的，简简单单举行完婚礼，下午的时候家族一个大叔在我们小房间帮忙举行完我们俩的夫妻酒。那个酒很劲大，我们俩都睡着了。现在回想起来，一切皆是那么顺其自然。虽然有点草草了事，不过没办法，先生存，这是我的座右铭。<br>    回来后，我的工作继续着。一个人待着实在无趣不行。期间暑假，大学班长和哥们转来上海工作，住我那。由于一个人住惯了，难免不太喜欢，毕竟大男人的我喜欢裸睡。最后的最后有点不欢，因为呆的时间过久（两个月），他在找到住所没那么快搬过去，我也是过于心急。不过希望对方不要想歪了，把大学难得的同学关系想复杂了。我没有别的不满和不快，毕竟一个结婚的人确实变化会很大，能让同学到主卧住俩月，我已经没谁了，他以后会明白的😁。<br>    七八月份我们开始了新的APP“呱拍”，里面有用到诸如拍摄、文字图片、图片滤镜。我在“宝来屋”全面使用的RAC和nimbus在前期帮下了忙，和新来的同事哥们“杰张”努力完成着。图片滤镜那边，始终不得要领，看不懂GPUImage的使用，没关系，最后用完全生成图片方法全部替换，于是有些时候会出现内存暴涨的情况。纯文字在之前为文字text，后来改成了文字图片，最开始的图始终无法生成高清图，后来也终于成功。图片滤镜后来加功能，要有贴图，贴图这时又不高清，后来搞清楚，把图片放到@3x情况下，终于解决。下半年的晚上都很堕落，老婆不在，刚结完婚就离开了，很失落，一直打游戏。白天都还好，得到的知识也是数之不尽，晚上就堕落了很多。这里排列一下学习到的相关知识能力：写了一个LOLdemo，地址：<a href="https://github.com/shaohung001/LOLDemo-SomeTransitionDemo" target="_blank" rel="noopener">https://github.com/shaohung001/LOLDemo-SomeTransitionDemo</a> ，使用了ASDK、GPUImage、转场、RAC、POP动画；研究了jsPatch的在线修改bug方案、Realm集成leancloudIM的聊天框架、qiniu的一些图片、视频在线适配方案、qiniu的域名更改方案、fontAwesome结合阿里的IconFont方案，需要注意的一点，其text需要使用Attribute富文本哟、IJK视频库的简单使用以及搞了个播放功能类；React-native的使用，这个比较牛逼，已经能开发一两个小程序，也只能小程序，止于学习Redux，认识了其局限性，不过帮我平缓的过度了没写过Css布局的ASDK的布局方式；前期硬着头皮写了swift，用RAC封装了一个简单聊天使用类，后来，你懂得，console基本打不出po代码，不能debug的代码多么不幸，留待以后继续，没学的很深，swift不会难。只要我们能写，不怕没资料，肯定能学会的；整了个越狱苹果，用破解Reveal分析各个APP内部构造，以下给出Apple APP的APPID：<br>App Store - com.apple.AppStore<br>Calculator - com.apple.calculator<br>Calendar - com.apple.mobilecal<br>Camera - com.apple.camera<br>Clock - com.apple.mobiletimer<br>Compass - com.apple.compass<br>Contacts - com.apple.MobileAddressBook<br>FaceTime - com.apple.facetime<br>Find Friends - com.apple.mobileme.fmf1<br>Find iPhone - com.apple.mobileme.fmip1<br>Game Center - com.apple.gamecenter<br>Health - com.apple.Health<br>iBooks - com.apple.iBooks<br>iTunes Store - com.apple.MobileStore<br>Mail - com.apple.mobilemail<br>Maps - com.apple.Maps<br>Messages - com.apple.MobileSMS<br>Music - com.apple.Music<br>News - com.apple.news<br>Notes - com.apple.mobilenotes<br>Phone - com.apple.mobilephone<br>Photos - com.apple.mobileslideshow<br>Podcasts - com.apple.podcasts<br>Reminders - com.apple.reminders<br>Safari - com.apple.mobilesafari<br>Settings - com.apple.Preferences<br>Stocks - com.apple.stocks<br>Tips - com.apple.tips<br>Videos - com.apple.videos<br>Voice Memos - com.apple.VoiceMemos<br>Wallet - com.apple.Passbook<br>Watch - com.apple.Bridge<br>Weather - com.apple.weather<br>    搞了图片贴图功能（一开始觉得很难，返回一看，瞬间明了）；用公司项目测试了节日换肤活动；丢弃了环信的聊天方案，改成轻量级的leanCloudIM，原因无他，leancloudIM你只需要能自己服务，即能使用仅仅通讯数据，我去掉所有database，自己整合了一个，虽然方案还不满意，不过，自己能控制，将能做更多的事情；同时使用了leancloud的在线crashReport功能；在制作视频这一块，目前的2.0“呱拍”上线全部使用SCPlayer的整套方案，原因是老板需要能有undo功能，我在没尝试GPUImage的相关movieWriter能力，不敢使用，毕竟使用下去，如果失败将失去很多时间。SCPlayer这里有个好处，就是其在滤镜更换页面，使用openGL能力，在我拍摄或者从手机取视频，到trim、crop、rotate、addMusic，addFilter，到最终发布，才export一个Movie，在某种程度来说，很轻便。不过目前我越来越觉得局限性，目前的功能需要有mv的更换场景能力，SCPlayer使用CIImage，里面很多滤镜要么不能用，要么用起来很别扭，尝试了几次后放弃了，咬着牙转换GPUImage。我在过渡过来的页面，先打包好，这一点参考了美拍。目前参考了别的前辈的知识，准备重写拍摄页面，这一块结合ASDK和GPUImage来做；trim视频、旋转视频、crop视频的页面使用AVFoundation的能力；<br>    基本我在研究新的技术，我负责的页面也很少，仅为发布、聊天、登陆页面维稳，其他的基本由另一个队友使命扛着。由于我的工作比较蛋疼，说难吧，真特么难，有多难，只有自己知道，老板肯定不知道，我早上一开始工作坐着就起不开身，但是将就着3、4个星期都没有进展，说什么自己都蛋疼。每次开会，蛋疼；心里老想着，这次开会我估计会被批评了吧，该滚蛋了吧。然后心里就那里嘀咕，不怕不怕，我这技术，出去很多公司多搂着要咧，蛋疼蛋疼。帮不了老板，确实蛋疼，老板要的功能还是特别前沿，特别难的，我一个研究framework都快hold不住了。也多亏老板现在还没给我T了，，，T.T;搞懂了CMTime到底是怎么回事、CGAffineTransform的真实能力，以及其一些基本用途；学习过“Origami”的使用，终于在后头搞懂其做法：switch、transition、和连线、start、end、更换其他属性，如color。“Origami”给我最大的印象就是，他最最直观；我的学习曲线是，不管啥，facebook最牛逼，facebook的开源技术能学的全学了，对了facebook的直播技术什么时候开源！！！哈哈😆；把facebook开源的parse Server在本地建立了起来，那个叫心动啊；曾经使用过郭宏宇的BeeFramework，也测试过他的另一款使用html开发的framework，后来放弃，不是好的解决方案。在看到React-native，湿了，眼眶湿了，使命的把玩，由于不精通前段，硬是搞到能开发几个小APP，不过缺陷也是明显的，想着全栈，绕过Apple审查，确实比较难，等着腾讯的OCS或者滴滴的DynamicCocoa出来吧，毕竟我觉得facebook会做正确的选择；使用MLeaksFinder找找内存泄漏；还有整了半个github.io的挂载网页；还有很多很多的framework被我用了又丢丢了又用的。<br>    这个2016学到的技术，要好好消化确实很多。<br>    以上有几个能力学起来之后便可以自己独立开发一款很好很好的APP，绝对不是外面那些个妖艳贱货APP能比的。<br>    8月20号我提前回家，计算了后面的节日，觉得差不多可以回去。没想到，丫头当天晚上就开始肚子痛。晚上12点把大姐喊过来，我和大姐、老妈、丫头就这么几个去市妇幼保健院了。隔天下午生下来现在的小宝。我干儿子名字我取的，叫承集，这个小屁孩就叫启程好啦。<br>    在医院那个叫累啊，睡都没地方，妈妈睡地板，好硬好硬的，我老是跑到外面睡，那些天真累，又担心小宝被偷了，又热、又累，，，一堆堆事情。后来终于回家了，不用担心小宝被偷了，就是蛋疼的睡地板，背好疼好疼，好硬的地板啊。半夜丫头起来好多次，都不敢喊我，硬是一个人扛着到现在，心疼，，，我只能尽力帮忙，小宝还特能叫，这猴🐒，尖叫猴🐒。陪产假回去公司继续搞我的工作，在快10月多的时候，把丫头和小宝整到上海来，由于小宝太能叫，然后他的黄疸还没有消下去，于是又把他送去他外公家（之前他们先到外公家住了好久，原因是家里丫头一个人带太累，老妈老爸在帮二姐带孩子）。。。当时是这样的，我把大宝小宝送到火车站后，心疼死了，他们两个坐到目的地，小宝外公接的他们。<br>    后来不久说小宝被细菌感染，肿了，我周五晚上坐火车去照顾，那个时候小宝黄的眼睛都绿了—-&gt;最喜欢取外号的我送给小宝最好听的名字“阿黄”。那几天也是累的呀，周日正好都出院，我就先回上海了，他们一行回家了。<br>    回来继续晚上打游戏，白天上班，周末就找“蓉儿”同桌玩，但系，他找女朋友后玩的机会就变少咯。。。<br>    11月份，我搬家了，搬得不远，我和我以前的同事“队长”和队长老婆，就是他老婆，没结婚也没差了，一直搬一直搬，东西也太多了，，我去。<br>    后来要办理暂住证，我的拖拉症还是硬着头皮，确实是硬着头皮啦，一直打电话给中介，帮我忙去办理暂住证，中介就打电话给房东，最后终于办成功了。签字需要丫头回来，刚好，我爸也被我说动，过来上海帮忙带孩子，丫头和小宝就先过来了，我去了趟小宝外公家，把母子俩接过来，因为丫头公积金一直没落下，所以要居住证去办理生育金。<br>    年前终于丫头把生育金也领了下来。过程让丫头写着了，后期会贴上。<br>    一年顺顺利利的过来了，过来那么久，老爸还没转过上海，趁着元旦放假三天，把老婆、老爸、儿子带去转了下。老爸第一次做地铁，进闸门的时候，没及时过来，被闸门卡在外面，后来钻进来，哈哈。过去我一路背着阿黄，他一直睡着，真能睡。逛了陆家嘴，一路给老爸和阿黄拍拍照，去坐渡轮，经过南京东路，下午过得真开心，好久没有把工作丢在后面了。后来回来，阿黄太久没换尿布，腿都快湿掉了。<br>    小时候我们的时间都是按5分钟算，小学按课间操算，初中按一节课算，高中按半天算，大学都是1天天打游戏过去算，出来工作，时间都是一星期一星期，于是1年回头一下就过去。但是还是希望未来更好，高歌猛进，不停歇就会前行。丫头回来，晚上都打不了游戏了，要不帮忙带孩子，要不写东西学东西，学的还不少啊，就是阿黄好吵，这尖叫猴 啊。。。蛋疼蛋疼，，，就蛋疼蛋疼吧，别人想尖叫猴都么得，哈哈哈</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Realm数据库的创建</title>
      <link href="/2017/01/10/Realm%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%88%9B%E5%BB%BA/"/>
      <url>/2017/01/10/Realm%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%88%9B%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>1：创建成一个库<br><img src="http://upload-images.jianshu.io/upload_images/3767775-6188a342798c67f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="50多兆"><br>重要的几点，一定要加到Embed framework里面，如图<br><img src="http://upload-images.jianshu.io/upload_images/3767775-4d0f08cf50c9c6ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="一定要加到Embed framework里面"><br><em>还有</em>！！！<br><img src="http://upload-images.jianshu.io/upload_images/3767775-c42e10c8b84e9d2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="*这个一定一定要写,不然发布到app Store会失败*"><br><code>bash&quot;${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH}/Realm.framework/strip-frameworks.sh&quot;</code><br>Run Script是让你在上传到苹果商店的时候打进去。<br>不然里面会有问题，最大的问题就是，通不过审核，哈哈。<br>使用的话，去看Realm的doc。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>xcode碰到-lcrt1.3.1.o</title>
      <link href="/2017/01/10/xcode%E7%A2%B0%E5%88%B0-lcrt1-3-1-o/"/>
      <url>/2017/01/10/xcode%E7%A2%B0%E5%88%B0-lcrt1-3-1-o/</url>
      
        <content type="html"><![CDATA[<p>xcode 碰到这种错误</p><p>选择target-》General-》Deployment Target 一项，将手机版本改为8.0以后即可</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>使用GPUImage一些坑</title>
      <link href="/2017/01/10/%E4%BD%BF%E7%94%A8GPUImage%E4%B8%80%E4%BA%9B%E5%9D%91/"/>
      <url>/2017/01/10/%E4%BD%BF%E7%94%A8GPUImage%E4%B8%80%E4%BA%9B%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<ol><li>首先理解了安装，作者推荐动态库安装，好处就是特么的，你看到的source都是输入源，filters都是滤镜过程，output就是出口啦</li><li>GPUImageMovie能接受<br>1）asset、2）AVPlayItem、3）URL路径，，，如果你有特殊要求，可以使用GPUImageMovieComposition这个类，允许你输入AVFoundation的多音频输入、画质动作、剪切之后的AVMutableComposition，我就用的这个</li><li>GPUImageMovie没有音频播放，美拍不知道怎么整的，估计我觉得就是使用另外一些人提供的思路，对源码侵入加入播放器<br>可以参考这个：1）：<a href="http://blog.csdn.net/personsky/article/details/52992919" target="_blank" rel="noopener">http://blog.csdn.net/personsky/article/details/52992919</a><br>2）：<a href="https://gist.github.com/anonymous/5112961" target="_blank" rel="noopener">https://gist.github.com/anonymous/5112961</a><br>毕竟音频播放就是个形式，，要不然你有没有美拍的源码，对了美拍还真就是用GPUImage，用的真是6啊，，偶像<br>3)：如果你没有用AVMutableComposition修改视频orientation，其滤镜里面也有能修改方向的方法setInputRotation<br>用法如：[sepiaFilter setInputRotation:kGPUImageRotateRight atIndex:0];</li><li>检查滤镜过程使用：filter setFrameProcessingCompletionBlock:^(GPUImageOutput *output,CMTime frameTime)<br>比如你可以在GPUImageElement里面修改这个</li><li>注意检查输入滤镜的pipeline过程有没有问题<br><a href="http://blog.csdn.net/u1031/article/details/48712163" target="_blank" rel="noopener">http://blog.csdn.net/u1031/article/details/48712163</a><br>这个大哥的几张图挺好的，看了之后对addTarget有更多的理解</li><li>多视频输入我这还好，没有什么问题，多语音的话，你就考虑使用GPUImageMovieComposition的audiomix，但是没法控制播放了似乎，</li><li>NSString*pathToMovie = [self movieSavedPath];<br>unlink([pathToMovieUTF8String]);// If a file already exists, AVAssetWriter won’t let you record new frames, so delete the old movie<br>可以使用快捷unlink视频，我特么不知道，仍然在使用filemanager，low逼格</li><li>附一个滤镜表在我国—&gt;China🇨🇳境内的名字翻译地址<br><a href="http://blog.csdn.net/qq_27074387/article/details/52221938" target="_blank" rel="noopener">http://blog.csdn.net/qq_27074387/article/details/52221938</a></li><li>在多视频输入里面，将self.movieFile.playAtActualSpeed=YES;<br>playAtActualSpeed都写上，如果视频不同步，有一个先完成了，则会有可能10s视频变成了4s，有时前一段视频播放正常，后一段就视频画面不动了。</li><li>forceProcessingAtSize：CGSize<br>给其定义大小</li><li>GPUImage  pipeline<br>1）、创建图片处理类GPUImagePicture把图片传进去stillImage<br>GPUImagePicture <em>staticPicture = [[GPUImagePicture alloc] initWithImage:stillImage smoothlyScaleOutput:YES];<br>2）、把多个滤镜对象放到数组中<br>NSMutableArray </em>arrayTemp=[NSMutableArray array];<br>[arrayTempaddObject:RGBFilter];<br>3）、创建GPUImageFilterPipeline对象 初始化使用<br>initWithOrderedFilters:(NSArray<em>) filters input:(GPUImageOutput</em>)input output:(id )output;<br>这个方法；这个方法需要三个参数：<br>filters：多个滤镜的数组<br>input：被渲染的图片（步骤1 的staticPicture 对象）<br>output：渲染后的图片的容器（类型是view）<br>GPUImageFilterPipeline <em> filterPipeline = [[GPUImageFilterPipeline alloc] initWithOrderedFilters:arrayTempinput:staticPictureoutput:output];<br>4）、渲染图片 使用processImage（此方法是GPUImagePicture类下的）和useNextFrameForImageCapture(此方法是GPUImageOutput下也就是单个滤镜)；<br>[staticPicture processImage];<br>[filteruseNextFrameForImageCapture];//这个filter 可以是RGBFiltertoonFilter等<br>5）、获取图片 使用currentFilteredFrame（此方法是GPUImageFilterPipeline类下的）；<br>UIImage </em>img = [pipeline currentFilteredFrame];<br>6）、对于使用GPUImageUIElement没有给contentView设置rect则会出现：<br>: CGContextTranslateCTM: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable.<br>*** Assertion failure in -[GPUImageFramebuffer generateFramebuffer], address/Submodules/framework/Source/GPUImageFramebuffer.m:156<br>同时breakpoint跳到<br><img src="http://upload-images.jianshu.io/upload_images/3767775-79332ec074f7938e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="breakpoint"></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>debug断点不进去且无效</title>
      <link href="/2017/01/10/debug%E6%96%AD%E7%82%B9%E4%B8%8D%E8%BF%9B%E5%8E%BB%E4%B8%94%E6%97%A0%E6%95%88/"/>
      <url>/2017/01/10/debug%E6%96%AD%E7%82%B9%E4%B8%8D%E8%BF%9B%E5%8E%BB%E4%B8%94%E6%97%A0%E6%95%88/</url>
      
        <content type="html"><![CDATA[<p>检查edit scheme 的Build Configuration 是否为debug模式</p><p>还有一点，在target里面的Build Setting 的 generate debug symbols 改为YES。</p><p>generate debug symbols在打包上传APP Store时能给项目压缩，平常给其打开可调试断点。</p><p>其原理？不懂，不过打开就能debug了，，，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mac升级到10.11cocoapods不能用</title>
      <link href="/2017/01/10/mac%E5%8D%87%E7%BA%A7%E5%88%B010-11cocoapods%E4%B8%8D%E8%83%BD%E7%94%A8/"/>
      <url>/2017/01/10/mac%E5%8D%87%E7%BA%A7%E5%88%B010-11cocoapods%E4%B8%8D%E8%83%BD%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>10.11 cocoapods安装：</p><p>sudo gem install -n /usr/local/bin cocoapods</p>]]></content>
      
      
      
        <tags>
            
            <tag> cocoapods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UIBazier学习和CAMediaTimingFunction</title>
      <link href="/2017/01/10/UIBazier%E5%AD%A6%E4%B9%A0%E5%92%8CCAMediaTimingFunction/"/>
      <url>/2017/01/10/UIBazier%E5%AD%A6%E4%B9%A0%E5%92%8CCAMediaTimingFunction/</url>
      
        <content type="html"><![CDATA[<p>UIBezier，这篇文章写得很好，简洁易懂。<br>我认为主要用到的有：<br>1：创建<br><code>UIBezierPath* aPath = [UIBezierPath bezierPath];</code><br>2：设置初始位置<br><code>[aPath moveToPoint:CGPointMake(100.0, 0.0)];</code><br>3：拐点<br><code>aPath.lineCapStyle = kCGLineCapRound;</code>//线条拐角<br><code>aPath.lineJoinStyle = kCGLineCapRound;</code>//终点处理<br>4：stroke和fill的区别<br>5：<code>- (void)addQuadCurveToPoint:(CGPoint)endPoint controlPoint:(CGPoint)controlPoint</code>方法<br>由于有setToPoint初始位置，有endPoint，然后controlPoint为改变曲面的<br>可以参考下图<br><img src="http://upload-images.jianshu.io/upload_images/3993684-22d35b19984fed4d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片1"><br>6：<code>- (void)addCurveToPoint:(CGPoint)endPoint controlPoint1:(CGPoint)controlPoint1 controlPoint2:(CGPoint)controlPoint2</code>//多参值<br>7：这句话很好：<br>使用UIBezierPath创建多边形—在path下面添加直线条形成多边形<br>多边形是一些简单的形状,这些形状是由一些直线线条组成，我们可以用moveToPoint: 和 addLineToPoint:方法去构建。<br>方法moveToPoint:设置我们想要创建形状的起点。从这点开始，我们可以用方法addLineToPoint:去创建一个形状的线段。<br>我们可以连续的创建line，每一个line的起点都是先前的终点，终点就是指定的点。<br><code>// Only override drawRect: if you perform custom drawing.</code><br><code>// An empty implementation adversely affects performance during animation.</code><br><code>- (void)drawRect:(CGRect)rect{    UIColor *color = [UIColor redColor];    [color set];//设置线条颜色    UIBezierPath* aPath = [UIBezierPath bezierPath];    aPath.lineWidth = 5.0;    aPath.lineCapStyle = kCGLineCapRound;//线条拐角    aPath.lineJoinStyle = kCGLineCapRound;//终点处理    // Set the starting point of the shape.    [aPath moveToPoint:CGPointMake(100.0, 0.0)];    // Draw the lines    [aPath addLineToPoint:CGPointMake(200.0, 40.0)];    [aPath addLineToPoint:CGPointMake(160, 140)];    [aPath addLineToPoint:CGPointMake(40.0, 140)];    [aPath addLineToPoint:CGPointMake(0.0, 40.0)];    [aPath closePath];//第五条线通过调用closePath方法得到的    [aPath stroke];//Draws line 根据坐标点连线}</code></p><p>CAMediaTimingFunction时间线可以通过<br><code>CAMediaTimingFunction *a = [CAMediaTimingFunction functionWithControlPoints:0.85 :0.01 :0.33 :1.14];</code>//创建</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>一些查询很久才得出的答案或者尝试很久得到的答案</title>
      <link href="/2017/01/10/%E4%B8%80%E4%BA%9B%E6%9F%A5%E8%AF%A2%E5%BE%88%E4%B9%85%E6%89%8D%E5%BE%97%E5%87%BA%E7%9A%84%E7%AD%94%E6%A1%88%E6%88%96%E8%80%85%E5%B0%9D%E8%AF%95%E5%BE%88%E4%B9%85%E5%BE%97%E5%88%B0%E7%9A%84%E7%AD%94%E6%A1%88/"/>
      <url>/2017/01/10/%E4%B8%80%E4%BA%9B%E6%9F%A5%E8%AF%A2%E5%BE%88%E4%B9%85%E6%89%8D%E5%BE%97%E5%87%BA%E7%9A%84%E7%AD%94%E6%A1%88%E6%88%96%E8%80%85%E5%B0%9D%E8%AF%95%E5%BE%88%E4%B9%85%E5%BE%97%E5%88%B0%E7%9A%84%E7%AD%94%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p>发表于(2 months ago)</p><p><a href="https://github.com/shaohung001/One-person-project" target="_blank" rel="noopener">地址</a></p><p>一些查询很久才得出的答案或者尝试很久得到的答案，类目主要用在chat、social、video、multi pic、watermark、filter、audio、Parse（FB）、个人无后台开发</p><p>1：由于用到贴图，网上寻觅不得，只说 UIGraphicsBeginImageContext(&lt;#CGSize size#&gt;)-&gt;换成UIGraphicsBeginImageContextWithOptions(&lt;#CGSize size#&gt;,&lt;#Bool opaque#&gt;,&lt;#CGFloat scale#&gt;) 上面这句话是重点 scale是缩放因子，使用[UIScreen mainScreen].scale即可； 中间的opaque是识别里面有没有alpha通道，如果有通道则填入NO，相反的哦； size则为你的图片的大小，比如上面一张大图，下面一张watermark，这size为大图的大小，毕竟大图在下面，第一个放入的； 这样子图片就会变为高清！！！没错，如果还没有变为高清，是有另一个原因的，那就是你的贴图不是@2x或者@3x的倍率，将其放入图片文件夹或者source，加入后缀，一定使用@3x，@2x也不怎么清晰！！！ 最后一步才是本文重点，网上没人说，自己尝试出来的</p><p>这一段是苹果私密api，用来找出Reveal的各个APP的bundleID，挺好用的</p><p><code>Class LSApplicationWorkspace_class = objc_getClass(&quot;LSApplicationWorkspace&quot;);    NSObject* workspace = [LSApplicationWorkspace_class performSelector:@selector(defaultWorkspace)];    NSArray *array = [workspace performSelector:@selector(allApplications)];    id a = array[0];    NSLog(@&quot;apps: %@&quot;, [workspace performSelector:@selector(allApplications)]);</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>iOS导航栏颜色和给的颜色不一样</title>
      <link href="/2017/01/09/iOS%E5%AF%BC%E8%88%AA%E6%A0%8F%E9%A2%9C%E8%89%B2%E5%92%8C%E7%BB%99%E7%9A%84%E9%A2%9C%E8%89%B2%E4%B8%8D%E4%B8%80%E6%A0%B7/"/>
      <url>/2017/01/09/iOS%E5%AF%BC%E8%88%AA%E6%A0%8F%E9%A2%9C%E8%89%B2%E5%92%8C%E7%BB%99%E7%9A%84%E9%A2%9C%E8%89%B2%E4%B8%8D%E4%B8%80%E6%A0%B7/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-12-14 19:43:11)</p><p>原因在于navigationBar的translucent，也就是是否带有透视选项的原因。<br>有时候APP上滑要看到美轮美奂的下边的图片如油画膜一般，慢慢掠过，默认该属性为true。<br>此时的设置颜色就会和给定的颜色不一般，会有一层白色膜一般。<br>但是将translucent设置为NO的话，加入的颜色，导航栏会看来有点厚重，看情况而定吧</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>UIBazier学习</title>
      <link href="/2017/01/09/UIBazier%E5%AD%A6%E4%B9%A0/"/>
      <url>/2017/01/09/UIBazier%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-12-14 19:41:34)</p><p>粗略的看了一遍这篇博客<br><a href="http://blog.csdn.net/crayondeng/article/details/11093689" target="_blank" rel="noopener">UIBezier</a><br>简介易懂，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>列举Apple的示例demo，同时提供了一个github下载地址</title>
      <link href="/2017/01/09/%E5%88%97%E4%B8%BEApple%E7%9A%84%E7%A4%BA%E4%BE%8Bdemo%EF%BC%8C%E5%90%8C%E6%97%B6%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AAgithub%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80/"/>
      <url>/2017/01/09/%E5%88%97%E4%B8%BEApple%E7%9A%84%E7%A4%BA%E4%BE%8Bdemo%EF%BC%8C%E5%90%8C%E6%97%B6%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AAgithub%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-12-06 18:24:22)</p><p><a href="http://www.jianshu.com/p/79a29a23d980" target="_blank" rel="noopener">http://www.jianshu.com/p/79a29a23d980</a><br>这个简书写了，感觉挺有用的，毕竟看其介绍能学到比较中肯的内容</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>使用JSPatch的一些经验总结</title>
      <link href="/2017/01/09/%E4%BD%BF%E7%94%A8JSPatch%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/"/>
      <url>/2017/01/09/%E4%BD%BF%E7%94%A8JSPatch%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-12-01 09:20:19)</p><p>在这之前你得</p><ol><li>尽量简化你的代码,尽量把你要实现的功能写成方法,这好替换,</li><li>在使用oc转换成js的时候,可以使用JSPatch convertor 这个软件来先转换一下,然后在具体修改,<br>转换以后修改你的代码的时候</li><li>一定要注意是否是js对象,还是oc对象,这个地方是我解析数据用的,传进来的是一个id类型的一个对象.这是oc的,所以我要在js里使用的话必须得用,.toJS()来转化成 (图一),如果你是在js里面初始化的对象,那就是js的obj,不用再转换,如(图二)<br><img src="http://s10.sinaimg.cn/mw690/003479W3zy76QdcKRND89&amp;690" alt="图一"><br><img src="http://s8.sinaimg.cn/mw690/003479W3zy76QdcQr9J47&amp;690" alt="图二"></li><li>你oc里面的下划线_,都要替换成双下划线__,是都要替换</li><li>NSArray/NSDictionary/NSString的处理:这个用JSPatch convertor 都可以转换出来要注意的就是你操做的是不是js对象,</li><li>只要是类带的属性,都要加()比如 model.ptitle(),因为默认帮你实现了setter 和getter的方法,你调用的是方法,方法就得加()</li><li>有一个大坑.是for in  在js里面的for in和oc里面的不一样<br><img src="http://s2.sinaimg.cn/mw690/003479W3zy76QdcpPEde1&amp;690" alt="图三"><br>【链接】JSPatch使用原理详解<br><a href="http://blog.csdn.net/iphonecat/article/details/50963317" target="_blank" rel="noopener">http://blog.csdn.net/iphonecat/article/details/50963317</a><br>这文章很详细,可以看一下</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>was mutated while being enumerate 这个错误</title>
      <link href="/2017/01/09/%E7%94%A8for%E5%BE%AA%E7%8E%AF%E7%9A%84%E5%87%BA%E6%93%8D%E4%BD%9C%E4%B8%AD%E6%93%8D%E4%BD%9C%E9%94%99%E8%AF%AF/"/>
      <url>/2017/01/09/%E7%94%A8for%E5%BE%AA%E7%8E%AF%E7%9A%84%E5%87%BA%E6%93%8D%E4%BD%9C%E4%B8%AD%E6%93%8D%E4%BD%9C%E9%94%99%E8%AF%AF/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-30 10:38:14)</p><p>用for循环的（id object in array）这种方法，如果内部有调整操作，则会跳出来was mutated while being enumerate 这个错误。<br>面对这个崩溃，不知道从哪里入手。<br>其实可以这样理解，我要操作object对象，挪动它，那么势必会影响后面哥们的战队。扩展一下，我object在最后，是不是就不会崩溃了？是的，因为操作了就不影响有站错队的哥们了，他们全都有队可站。<br>这里有几个做法：</p><ol><li><code>for （int i=0；i&lt;x;i++)</code></li><li><code>[array enumerateObjectsUsingBlock:^(id  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {do something...*stop = YES;}];</code></li><li>或者操作完你这一个之后，break整个循环<br>双击666</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AsyncDisplayKit的learning</title>
      <link href="/2017/01/09/AsyncDisplayKit%E7%9A%84learning/"/>
      <url>/2017/01/09/AsyncDisplayKit%E7%9A%84learning/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-29 17:35:30)</p><p><a href="http://www.open-open.com/lib/view/open1472701267252.html" target="_blank" rel="noopener">文章一</a><br>这篇文章讲了布局调用顺序measureWithSizeRange<br>当我们使用 ASDK 布局时，需要做下面四件事情中的一件：<br><em>提供 layoutSpecBlock</em>覆写 - layoutSpecThatFits: 方法<br><em>覆写 - calculateSizeThatFits: 方法</em>覆写 - calculateLayoutThatFits: 方法<br>*只有做上面四件事情中的其中一件才能对 ASDK 中的视图或者说结点进行布局。<br>同时给了一个网址<a href="http://nguyenhuy.github.io/froggy-asdk-layout/" target="_blank" rel="noopener">Foggy-ASDK-Layout</a>，我学了一下，对比React-native，一模一样。<br>然后找了下这篇文章<a href="http://www.qingpingshan.com/rjbc/ios/167576.html" target="_blank" rel="noopener">文章二</a><br>里面主要讲了有哪些基本属性enum可以使用</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CMTime中fps的scale理解和UIPanGestureRecorgnize的手势记录</title>
      <link href="/2017/01/09/CMTime%E4%B8%ADfps%E7%9A%84scale%E7%90%86%E8%A7%A3%E5%92%8CUIPanGestureRecorgnize%E7%9A%84%E6%89%8B%E5%8A%BF%E8%AE%B0%E5%BD%95/"/>
      <url>/2017/01/09/CMTime%E4%B8%ADfps%E7%9A%84scale%E7%90%86%E8%A7%A3%E5%92%8CUIPanGestureRecorgnize%E7%9A%84%E6%89%8B%E5%8A%BF%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-29 10:39:20)</p><p>视频帧处理有一点要明确，<br>CMTimeMakeWithSeconds(<br>Float64 seconds,<br>int32_t preferredTimescale)<br>这里seconds是第几次，preferredTimescale为片，<br>比如我要每秒一帧图片从视频取出来<br>`AVAssetImageGenerator <em>assetImageGenerator = [[AVAssetImageGenerator alloc]initWithAsset:self.viewModel.asset];<br>CGFloat scale = KScreenWidth</em>1.f/MAXImageShowInCollection/80;//collectionFlowSize width/height<br>assetImageGenerator.maximumSize = CGSizeMake(200<em>scale,200);<br>assetImageGenerator.appliesPreferredTrackTransform = TRUE;<br>Float64 duration = CMTimeGetSeconds(self.viewModel.asset.duration);<br>NSMutableArray </em>timeArr = [[NSMutableArray alloc]initWithCapacity:0];<br>if (self.segmentedControl.selectedSegmentIndex) {<br>for (int i=0; i&lt;8; i++) {//MIN(duration, 60)<br>[timeArr addObject:[NSValue valueWithCMTime:CMTimeMakeWithSeconds(i, duration/8)]];<br>}<br>}else{<br>for (int i=0; i&lt;floor(duration); i++) {<br>[timeArr addObject:[NSValue valueWithCMTime:CMTimeMakeWithSeconds(i, 1)]];<br>}<br>}<br>[assetImageGenerator generateCGImagesAsynchronouslyForTimes:timeArr completionHandler:<br>^(CMTime requestedTime, CGImageRef image, CMTime actualTime, AVAssetImageGeneratorResult result, NSError <em>error)<br>{<br>@strongify(self);<br>NSLog(@”actual got image at time:%f”, CMTimeGetSeconds(actualTime));<br>if (image)<br>{<br>UIImage </em>img = [UIImage imageWithCGImage:image];<br>[self.imageArray addObject:img];<br>if (self.imageArray.count==timeArr.count) {<br>dispatch_async(dispatch_get_main_queue(), ^{<br>@strongify(self);<br>[self.collection reloadData];<br>});<br>}<br>}</p><p>}];`</p><p>此处参考了美拍的如果取10s以内的视频，则都是以1s一片取图片CMTimeMakeWithSeconds(i, 1)，如果为1分钟或者美拍的那种5分钟，则就取8帧，总共就8帧CMTimeMakeWithSeconds(i, duration/8)。</p><p>UIPanGestureRecognize在手势滑动的判断<br>我犯得错误是使用坐标对坐标，两个会变动的参数判断，这里给自己提一个醒！！！<br>每次对其内部判断，都是在判断时，对[x locationInView:trimView]判断，对目前你的手在区域内位置判断，不然会狂闪。<br><code>[[leftPanGesture rac_gestureSignal] subscribeNext:^(UIPanGestureRecognizer * x) {@strongify(self);if (x.state == UIGestureRecognizerStateBegan) {}else if (x.state == UIGestureRecognizerStateChanged) {if ((rightPullView.centerX-[x locationInView:trimView].x)&gt;self.miniTwoLineLength) {}else{}}</code><br>道理都懂，有时就会犯迷糊，谨记</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>苹果加急审核</title>
      <link href="/2017/01/09/%E8%8B%B9%E6%9E%9C%E5%8A%A0%E6%80%A5%E5%AE%A1%E6%A0%B8/"/>
      <url>/2017/01/09/%E8%8B%B9%E6%9E%9C%E5%8A%A0%E6%80%A5%E5%AE%A1%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-29 10:34:01)</p><p>转载至<a href="http://blog.csdn.net/showhilllee/article/details/19541493" target="_blank" rel="noopener">http://blog.csdn.net/showhilllee/article/details/19541493</a><br>加急入口在Apple Connection 右下角</p><p>打电话的似乎寻求不到太大帮助，毕竟团队不一样。apple 审核团队向来神秘闻名，我们由于UGC的问题，被打了很多次了，其实对着他写的回复修改，也只能遮掩。我们遇到这次很逗，审核团队要求我们给“注册”时的账号，不是demo account，我们注册时有短信验证，给也没用啊，，，蛋疼，，，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>这里讲述一个7牛存放图片服务的更改为自定义融合CDN的经历</title>
      <link href="/2017/01/09/%E8%BF%99%E9%87%8C%E8%AE%B2%E8%BF%B0%E4%B8%80%E4%B8%AA7%E7%89%9B%E5%AD%98%E6%94%BE%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%9B%B4%E6%94%B9%E4%B8%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%9E%8D%E5%90%88CDN%E7%9A%84%E7%BB%8F%E5%8E%86/"/>
      <url>/2017/01/09/%E8%BF%99%E9%87%8C%E8%AE%B2%E8%BF%B0%E4%B8%80%E4%B8%AA7%E7%89%9B%E5%AD%98%E6%94%BE%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%9B%B4%E6%94%B9%E4%B8%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%9E%8D%E5%90%88CDN%E7%9A%84%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-24 15:25:55)</p><p>测试域名是有限制的,测试域名，其客户端配置：单 IP 每秒限制请求次数 10 次，大于 10 次 403 禁止 5 秒；限速：单 url 限速 8Mbps，下载到 10MB 之后，限速 1Mbps 带宽没有区别。<br>所以不建议将测试域名配置在生产环境上。<br>上面是需要更改为自定义融合CDN的原因。<br>接下来需要做的是，点开“融合CDN”-&gt;新增一个加速域名列表，其中一个填写你要做的二级域名，比如主域名为baidu.com，那么你可以写example.baidu.com,直接选确定。<br>审核12个小时以内（我的2个小时），出现在其“域名信息”一栏“填写CNAME”，此时复制“源站信息”的右边一串字符，将其复制到服务器(因为公司大陆备案过的域名在阿里云，那么就进入阿里云的服务器控制端)上的新增二级域名的地方。<br>按照<a href="https://support.qiniu.com/hc/kb/article/68977这个里面的这张图片" target="_blank" rel="noopener">https://support.qiniu.com/hc/kb/article/68977这个里面的这张图片</a><br><img src="http://s14.sinaimg.cn/mw690/003479W3zy76FqygSm1cd&amp;690" alt="图片1"><br>记录类型：就写CNAME<br>主机记录：比如我的example.baidu.com就写example即可<br>解析线路：为默认<br>记录值：填写七牛在“域名配置”-&gt;CNAME所属值：<br>别的其他都不用管，保存即可<br>接下来等待大概半小时，在“内容管理”随便一个您已经上传的文件，点击小眼睛，文件显示出来，那么就是正确的了，以后就可以使用这个链接了。<br>这里补充两点<br>1：你可以用站长工具测试某一个文件，看ping通花了多少毫秒，我对比了7牛的测试连接，44ms，而通过新的自定义的却很慢，达到280ms，提个工单，确实快了很多，88ms。<br>2：<a href="https://www.v2ex.com/t/292587这里有个文章讲了这么个事情，所以特么需要注意啦，我现在还在调整这个问题，看如何解决。" target="_blank" rel="noopener">https://www.v2ex.com/t/292587这里有个文章讲了这么个事情，所以特么需要注意啦，我现在还在调整这个问题，看如何解决。</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>16-11-18办理暂住证_过程_上海</title>
      <link href="/2017/01/09/16-11-18%E5%8A%9E%E7%90%86%E6%9A%82%E4%BD%8F%E8%AF%81-%E8%BF%87%E7%A8%8B-%E4%B8%8A%E6%B5%B7/"/>
      <url>/2017/01/09/16-11-18%E5%8A%9E%E7%90%86%E6%9A%82%E4%BD%8F%E8%AF%81-%E8%BF%87%E7%A8%8B-%E4%B8%8A%E6%B5%B7/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-18 15:11:27)</p><p>昨天去搞暂住证，我这里记录下过程，可以参考参考，毕竟这么累比的，当做吐槽加有意义的参考文案吧。<br>首先办理证件必须是周一至周五。当天还上班，中午特地骑到（闸北区工作的话，社保中心在沪太路延长中路附近）电动车去把超过6个月的社保单打印出来了。大概1点半，出发去问门卫处（小区在合阳小区），门卫告诉我去小区的居委会（合阳小区内的居委会，问一下就到了）；到了居委会，居委会说，我们这里办不了，这里一个工作人员也在附近的公安局（其实就在附近，很近，一定一定要保证电动车满电，说不定有其他用处）；好吧，我屁颠屁颠骑电动车到公安局（宜川路/白水路的公安局），取个号，到我了，该处为40多号，说往前走几步到51号左转，2点开始办公；我又屁颠屁颠去跑过去，似乎是户籍管理什么的办事处；好，进去，几个大叔在聊天，我点头弯腰说来办理暂住证，租赁客户，最里面的大叔说租赁的话，比较麻烦，这里办理不了，要前往这个地方（这里说几点，如果房子是你的，办就很快，还有就是前往你的亲戚的城市，办理亲属证明，也会非常快，我这属于最麻烦的，需要一堆的手续和文件，后面会一一道来）黄陵路/宜君路的街道事务中心；我赶紧出来，车子快没电了，赶紧去充电；这时，之前我打电话把房东喊过来（幸好遇到好房东的情况：我打电话让房东到公安局了，女房东到了公安局了，我又跑出来充电），说前往街道事务中心，于是她又开车前往街道事务中心；我先到地点，前台服务是一个胖大哥，问了是办暂住证，直接给我一个“综合服务”的号，我进去，问我需要的材料都对吗（我这里有我的身份证、工作合同、租赁合同原件、社保单（街道事务中心有机子可以取社保单）），然后等待房东来（记得，办这事，一定一定要房东来，房东那边需要准备的材料等会说明）；过没一会，房东来了，然后出示了有房产原件、身份证；然后说去12号台先填写申请，于是我们又跑过去12号，我这里需要准备的材料：有多少个人入住，我和我老婆的身份证+正反复印件、结婚证+复印件、工作合同的第二页和最后一页复印件、社保单、租赁合同+复印件、填写申请表如实填写，房东那边需要准备的材料：房东房产原件+房产原件复印件、房东身份证+复印件（如果房产有多人，必须有一个到场，没到场的需要填写委托书的文件，委托书文件格式，12号窗工作人员会给，你就到旁边写，内容有姓名、身份证，房产证有多少个人就写多少委托，签名写房东名字就可）。反正就是复印复印复印（期间我没带老婆的身份证、结婚证等，骑电动车回去，半路没电，用脚腾回去的，到家赶紧冲出来打车，到了目的地给钱，给他一张50块，司机说换一张，我说怎么了，他说这张是假的，我一看，我去，真是，我好久之前换的，之后一直手机支付没看那张50，后来用微信支付，接着去打印，特么零钱也用完了，那个大叔不肯给打印，真是没帮助的精神，不过是我，我可能也会有类似的作为就赶紧跑好远去取钱，还挺蛋疼的这次）。12号窗口办理，办理这个，如果多少个人写进去了，之后想更改就不能的了，所以确定好要写进去的人数和需要准备好的文件材料；12号窗口办理完会给你一张“信息填入”完的单子（这时房东的帮助已经完了，接下来就是自己的事情了），然后我们去“综合服务”窗口；我这里还需要提供租赁合同复印件、身份证复印件、社保单、“信息填入”文件的复印件，工作人员会给每一个敲一个章，我一一填入我的名字和时间（时间关系不大，如是说），老婆的部分由于本人未到场，必须她到场，不然办不了；这里说一下，这一办理过程是需要24小时生效时间，就是那张“信息填入”文件生效时间是在24小时之后，而且其左下角有个时间终止日期，超过也不能办，办理入住人必须都在场；诺，我又拿着我的文件屁颠屁颠回来了；<br>当时周四，我还是下周一带老婆一起过来好了。到时整好之后给大家一张截图，如若失败，没办法了，花钱办了，，文章里面需要的文件都写好了，也写好了过程步骤，幸好我的是有个好房东啊，，中间等了我接近50分钟，，我的天，，非常非常感谢房东，不管办不办的下来，好房东，，谢谢你，估计你看不见，不过我由衷感谢，，，<br>前两天11月22号，我拎着老婆孩子还去那个街道办事处。直接去“综合服务”办事点，把身份证+复印件、“信息填入”+复印件、社保单、合同原件+第二页和第四页的复印件准备好。他那边输入一些数据后知道我们第一次办，带我们到旁边拍了个照片，深色领子好。（中间原因一些原委，老婆合同原件没带，而且其复印件有文字涂改，需要在上面盖章，来来回回，而且那天下雨，车子堵得呀，花的钱又多-&gt;出租车，4点半街道办事处下班差点赶不及，直接下车跑了3个街道，气都快喘不过来了。）最后改签字的都签好，工作人员给了一张单子，说一个月后来这里领取办卡，也就是说，全部办好了，要办卡。出来办事，，真不是一般的累，来来回回整，而且需要的文件、流程都不熟悉，其中知道门道的，都是可以从中捞水了。一个月后去领卡了。另外，我问了，这不是暂住证，这是居住证，一年的居住证，嗷嗷嗷嗷。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>watermark贴图模糊</title>
      <link href="/2017/01/09/watermark%E8%B4%B4%E5%9B%BE%E6%A8%A1%E7%B3%8A/"/>
      <url>/2017/01/09/watermark%E8%B4%B4%E5%9B%BE%E6%A8%A1%E7%B3%8A/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-11-07 10:51:54)</p><p>博客内容转至github，妈蛋，打个字，复制也不行，打字也不行，经常写了老半天，点提交，特么什么东西没了，幸好保存了，，，心塞过，，，地址<a href="https://github.com/shaohung001/One-person-project/tree/master" target="_blank" rel="noopener">https://github.com/shaohung001/One-person-project/tree/master</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>制作滤镜的贴图，rotate、scale、pull，以及实现过程</title>
      <link href="/2017/01/09/%E5%88%B6%E4%BD%9C%E6%BB%A4%E9%95%9C%E7%9A%84%E8%B4%B4%E5%9B%BE%EF%BC%8Crotate%E3%80%81scale%E3%80%81pull%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/"/>
      <url>/2017/01/09/%E5%88%B6%E4%BD%9C%E6%BB%A4%E9%95%9C%E7%9A%84%E8%B4%B4%E5%9B%BE%EF%BC%8Crotate%E3%80%81scale%E3%80%81pull%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-10-17 16:43:22)</p><p><a href="https://github.com/shaohung001/Tie-tu-ScaleRotateView.git" target="_blank" rel="noopener">https://github.com/shaohung001/Tie-tu-ScaleRotateView.git</a><br>代码里面有相关注释</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>最近iOSAPP打包Success但是没有包，上传不了</title>
      <link href="/2017/01/09/%E6%9C%80%E8%BF%91iOSAPP%E6%89%93%E5%8C%85Success%E4%BD%86%E6%98%AF%E6%B2%A1%E6%9C%89%E5%8C%85%EF%BC%8C%E4%B8%8A%E4%BC%A0%E4%B8%8D%E4%BA%86/"/>
      <url>/2017/01/09/%E6%9C%80%E8%BF%91iOSAPP%E6%89%93%E5%8C%85Success%E4%BD%86%E6%98%AF%E6%B2%A1%E6%9C%89%E5%8C%85%EF%BC%8C%E4%B8%8A%E4%BC%A0%E4%B8%8D%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-10-17 15:59:47)</p><p>最近iOS APP打包Success 但是没有包 上传不了，如<br><a href="http://stackoverflow.com/questions/10715211/cannot-generate-ios-app-archive-in-xcode" target="_blank" rel="noopener">Cannot generate iOS App archive in xcode</a><br><a href="http://stackoverflow.com/questions/10715211/cannot-generate-ios-app-archive-in-xcode/31645306#31645306" target="_blank" rel="noopener">http://stackoverflow.com/questions/10715211/cannot-generate-ios-app-archive-in-xcode/31645306#31645306</a><br><img src="http://s7.sinaimg.cn/mw690/003479W3zy75GRaW8Wq76&amp;690" alt="图片1"></p><p>项目这里参考了这篇博文解决了打包success但是没有包的问题：<br>【链接】新版本Xcode无法打包生成ipa的问题解决Cannotg<br><a href="http://blog.csdn.net/iunion/article/details/49886973" target="_blank" rel="noopener">http://blog.csdn.net/iunion/article/details/49886973</a></p><p>希望能帮到大家。。。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>国庆放完假，重新找目标</title>
      <link href="/2017/01/09/%E5%9B%BD%E5%BA%86%E6%94%BE%E5%AE%8C%E5%81%87%EF%BC%8C%E9%87%8D%E6%96%B0%E6%89%BE%E7%9B%AE%E6%A0%87/"/>
      <url>/2017/01/09/%E5%9B%BD%E5%BA%86%E6%94%BE%E5%AE%8C%E5%81%87%EF%BC%8C%E9%87%8D%E6%96%B0%E6%89%BE%E7%9B%AE%E6%A0%87/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-10-10 13:30:14)<br>国庆，公司放了10天。把老婆孩子接过来住几天，孩子不好带，又送回去了，感觉还是挺累的，，，，<br>有时候总是会失去一会目标，就如目前，除了工作，回家之后就是打游戏，消遣，没有去年拼命的状态了。<br>原因是今年来来去去的，没有停歇，没有好好思考总结我要干什么，，，<br>每天晚上都在计划明天该干啥，然后当晚很晚睡，第二天要么很晚起，要么无精打采，，，这么累，于是又继续沉迷网络，，，<br>放下心来想了想为什么吃饭吃不香，睡觉睡不好，生活不自在，，，自己给自己了一个答案：<br>人不要太忙碌，要放慢脚步，稳步向前，，，脚踏实地，一步一脚印，，，<br>大都市的人会不由自主的失去目标，没有朋友在附近，没有好友搭起话，除了工作，老婆，孩子，，没别的了，，也就是这样，老婆孩子不在身边，，，前大半年我都过得浑浑噩噩，像极了猪，但人家猪还会早睡，我却总觉得，我不想睡，我还能消遣好一会，不能浪费啊，，，于是沉淀起来的疲惫，把我自己给迷糊了，，，<br>最近除了工作，要给自己下一些目标，让自己爱生活，，这样精神状态好起来，说不定对工作的热忱会更好，效率更高，发散思维能力越强，，，找找自己能持续作战的副业吧，，，找到一个自己也同样热衷的副业，其实是完美生活的一个调剂品，好好品尝，好好活着，，，，</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RAC循环引用</title>
      <link href="/2017/01/09/RAC%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8/"/>
      <url>/2017/01/09/RAC%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-27 16:35:49)</p><p>最近项目到某个节点，我在解决一些问题的时候，记录一下：</p><ol><li>RAC 在引用的时候会忽略一点，如<br><code>@weakify(self);@weakify(cell);[[[cell.clearButton rac_signalForControlEvents:UIControlEventTouchUpInside] takeUntil:cell.rac_prepareForReuseSignal] subscribeNext:^(UIButton *x) {if ([self_weak_.selectedNumArray containsObject:asset]) {[self_weak_.selectedNumArray removeObject:asset];cell_weak_.numButton.selected = NO;[self_weak_.collectionView reloadData];}else{if (self_weak_.addMorePicture) {if (self_weak_.selectedNumArray.count==self_weak_.maxPictureCanAdd) {LxDBAnyVar(self_weak_.selectedNumArray);LxDBAnyVar(self_weak_.maxPictureCanAdd);[SHUIHelper showAlertMessage:[NSString stringWithFormat:@&quot;您最多可添加%ld张哦&quot;,self_weak_.maxPictureCanAdd]];}else{[self_weak_.selectedNumArray addObject:asset];cell_weak_.numButton.selected = YES;[cell_weak_.numButton setTitle:[NSString stringWithFormat:@&quot;%ld&quot;,(unsigned long)self_weak_.selectedNumArray.count] forState:UIControlStateNormal];}}else{if (self_weak_.selectedNumArray.count==6) {[SHUIHelper showAlertMessage:@&quot;选取最多6张&quot;];}else{[self_weak_.selectedNumArray addObject:asset];cell_weak_.numButton.selected = YES;[cell_weak_.numButton setTitle:[NSString stringWithFormat:@&quot;%ld&quot;,(unsigned long)self_weak_.selectedNumArray.count] forState:UIControlStateNormal];}}}cell_weak_.grayLayerView.hidden = !cell_weak_.numButton.selected;}];</code><br>上面这里的cell，自己对自己进行了循环引用，原因就是：这一段如果写在该Cell class里面，那么block里面的cell，其实在自身类里面也叫self，于是也需要进行weak处理。<br>这里会出现这样的错误，就是因为写得太快了，然后有时候会想不出来，可以慢慢思考。</li><li>Realm 的RLMArray 如果添加某一个元素，但其已经存在数据库中，那么做法是先使用<code>[RLMObject objectForPrimaryKey：@“keyID”]</code>找出该元素添加进去，即可<blockquote><p>Just want to add a comment for future users of Realm. I think TiM means[ objectForPrimaryKey:…]. I literally typed [RLMObject objectForPrimaryKey:…] and got a crash about “RLMObject” is not persisted in Realm database</p></blockquote></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> reactivecocoa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MleaksFinder手动导入framework</title>
      <link href="/2017/01/09/MleaksFinder%E6%89%8B%E5%8A%A8%E5%AF%BC%E5%85%A5framework/"/>
      <url>/2017/01/09/MleaksFinder%E6%89%8B%E5%8A%A8%E5%AF%BC%E5%85%A5framework/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-19 18:24:20)<br>由于前段时间cocoapods有个issue，导致我的第三方工程都得手动导入，今天抽出时间把MleaksFinder这款很好的监测内存泄漏的工具用手动导入方式写出来。</p><ul><li><p>先去下两个zip：</p><ul><li><a href="https://github.com/Zepo/MLeaksFinder" target="_blank" rel="noopener">https://github.com/Zepo/MLeaksFinder</a></li><li><a href="https://github.com/facebook/FBRetainCycleDetector" target="_blank" rel="noopener">https://github.com/facebook/FBRetainCycleDetector</a></li></ul></li><li><p>直接将</p><ul><li><img src="http://s9.sinaimg.cn/mw690/003479W3zy74Yms7wiQd8&amp;690" alt="导入工程，记得点选1、2、4选项" title="导入工程，记得点选1、2、4选项"></li><li><img src="http://s9.sinaimg.cn/mw690/003479W3zy74YmyHZy038&amp;690" alt="导入工程，记得点选1、2、4选项" title="导入工程，记得点选1、2、4选项"></li></ul></li><li>将下载下来的FBRetainCycleDetector-master直接复制到根目录文件<ul><li><img src="http://s3.sinaimg.cn/mw690/003479W3zy74YmO5Xpg42&amp;690" alt="将下载下来的FBRetainCycleDetector-master直接复制到根目录文件" title="将下载下来的FBRetainCycleDetector-master直接复制到根目录文件"></li></ul></li><li>如图操作：<ul><li><img src="http://s9.sinaimg.cn/mw690/003479W3zy74YoNFBAk28&amp;690" alt="第四步如图操作"></li><li>同时将FBRetainCycleDetector.xcodeproj-》Targets-》Deployment Info的Deployment Target 改为手机适用的，不然会运行起来说target版本不对</li></ul></li><li>加入framework<ul><li><img src="http://s1.sinaimg.cn/mw690/003479W3zy74YnTj7gI20&amp;690" alt="加入framework"></li></ul></li><li><em>至此，不需要添加代码，你就可以使用啦。我先记录，慢慢来开发他的使用啦</em></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RN了SecRandomCopyBytes_ignoring_return_value</title>
      <link href="/2017/01/09/RN%E4%BA%86SecRandomCopyBytes-ignoring-return-value/"/>
      <url>/2017/01/09/RN%E4%BA%86SecRandomCopyBytes-ignoring-return-value/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-19 10:16:43)</p><p>大早上的起来，在XCode8，iOS10环境中，就看见RN编译不起来，报SecRandomCopyBytes ignoring return value这样的错。在RCTWebSocket 的SecRandomCopyBytes函数编译不过去，有3种方法，自行实测一种，很方便的一种（1）<br>1：<a href="https://github.com/facebook/react-native/issues/8584中" target="_blank" rel="noopener">https://github.com/facebook/react-native/issues/8584中</a><br><img src="http://s3.sinaimg.cn/mw690/003479W3zy74Zv5sPiG22&amp;690" alt="图片1"><br>双击Library里面的RCTWebSocket进入上图界面，将“3”中的两个删除即可<br>2、3：<a href="https://github.com/facebook/react-native/issues/8108中" target="_blank" rel="noopener">https://github.com/facebook/react-native/issues/8108中</a><br>mskalra所述和antoor所述，针对不同问题的解决方案</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>展示大图出现卡顿</title>
      <link href="/2017/01/08/%E5%B1%95%E7%A4%BA%E5%A4%A7%E5%9B%BE%E5%87%BA%E7%8E%B0%E5%8D%A1%E9%A1%BF/"/>
      <url>/2017/01/08/%E5%B1%95%E7%A4%BA%E5%A4%A7%E5%9B%BE%E5%87%BA%E7%8E%B0%E5%8D%A1%E9%A1%BF/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-18 12:06:12)</p><p>这里拿iOS里边代码做考究：<br>图片页面，我之前不是说会很卡吗？？如果用户拿去很大的图片的话，我这里之前的处理是压缩<br><img src="http://s10.sinaimg.cn/mw690/003479W3zy74WlkrbAZ69&amp;690" alt="图片1"><br>这里压缩是把相同临近像素融合，减小像素密度，，但是卡顿原因不是这个，，其实是—》<br>这样理解，就是我有一张比如一个墙壁大的图片，相框只有200*200，于是照片要放进去就比较麻烦，但是我减小照片大小，<br><img src="http://s6.sinaimg.cn/mw690/003479W3zy74WlmwDU975&amp;690" alt="图片2"><br>这样图片不大，放进相框就好放啦，，，1000是系数，可以自行比例系数哦</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>这里记录一个获取图片时，图片旋转问题</title>
      <link href="/2017/01/08/%E8%BF%99%E9%87%8C%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E6%97%B6%EF%BC%8C%E5%9B%BE%E7%89%87%E6%97%8B%E8%BD%AC%E9%97%AE%E9%A2%98/"/>
      <url>/2017/01/08/%E8%BF%99%E9%87%8C%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E6%97%B6%EF%BC%8C%E5%9B%BE%E7%89%87%E6%97%8B%E8%BD%AC%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-05 11:09:26)<br>这里记录一个获取图片时，图片旋转问题：<br>ALAssetRepresentation<em> rep = self.asset.defaultRepresentation;<br>if (rep) {<br>UIImage</em> image = [UIImage imageWithCGImage:rep.fullResolutionImage<br>scale:rep.scale<br>orientation:0];<br>return image;</p><p>如上写法，orientation：0的时候会发生图片旋转，即使本应该的说要拿取肖像orientation，<br>改成如下：<br>ALAssetRepresentation<em> rep = self.asset.defaultRepresentation;<br>if (rep) {<br>UIImage</em> image = [UIImage imageWithCGImage:rep.fullResolutionImage<br>scale:rep.scale<br>orientation:(UIImageOrientation)rep.orientation];//0];</p><p>return image;</p><p>此时拿到的图片不再旋转。。。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>很长时间没有更新记录了</title>
      <link href="/2017/01/08/%E5%BE%88%E9%95%BF%E6%97%B6%E9%97%B4%E6%B2%A1%E6%9C%89%E6%9B%B4%E6%96%B0%E8%AE%B0%E5%BD%95%E4%BA%86/"/>
      <url>/2017/01/08/%E5%BE%88%E9%95%BF%E6%97%B6%E9%97%B4%E6%B2%A1%E6%9C%89%E6%9B%B4%E6%96%B0%E8%AE%B0%E5%BD%95%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-09-01 00:05:08)</p><p>之前老婆要生产进入尾声了，工作也进入紧张阶段，一直忙忙忙，接下来会陆续写上：<br>1：GPUImage在生产中可能会用到的单滤镜、多滤镜处理<br>2：贴图<br>3：对接LeanIM的聊天，使用Realm接本地数据库的心得<br>4：还有一些其他的<br>尽量快些写出来哦，么么哒</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>计算机算三角函数和圆心角</title>
      <link href="/2017/01/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%AE%97%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E5%92%8C%E5%9C%86%E5%BF%83%E8%A7%92/"/>
      <url>/2017/01/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%AE%97%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E5%92%8C%E5%9C%86%E5%BF%83%E8%A7%92/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-07-01 10:09:21)</p><p><a href="http://c.biancheng.net/cpp/html/2526.html" target="_blank" rel="noopener">http://c.biancheng.net/cpp/html/2526.html</a><br>c语言的一个圆心角计算</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>appstore链接的mt=x意义</title>
      <link href="/2017/01/08/appstore%E9%93%BE%E6%8E%A5%E7%9A%84mt-x%E6%84%8F%E4%B9%89/"/>
      <url>/2017/01/08/appstore%E9%93%BE%E6%8E%A5%E7%9A%84mt-x%E6%84%8F%E4%B9%89/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-30 11:48:22)</p><p>我自己试了下，这个问题，mt的作用，也就是你加跟不加都可以。<br>mt 代表 meta-type，有效值如下：<br>1   Music<br>2   Podcasts<br>3   Audiobooks<br>4   TV Shows<br>5   Music Videos<br>6   Movies<br>7   iPod Games<br>8   Mobile Software Applications<br>9   Ringtones<br>10  iTunes U<br>11  E-Books<br>12  Desktop Apps<br>当链接进行查询时，如果没有定义id，就有可能出现不同类别的内容，但是名字相同，例如某专辑的名字和某个app的名字重合。这时mt就起作用了。<br>ls代表link special，当查询的类型为某首歌曲时，不定义ls，默认指向歌曲的专辑，定义后直接进入该歌曲并试播。（貌似是这样，apple的论坛里看到的，跟app的关系不大）<br>这是上面的解释，我觉得行得通。<br>我一开始觉得是1是美国mt的简称，我们APP有两个版本，美国版本和中国版本，不过追根始源，找到了他的真正意义，，哈哈</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GPUImage如何创建，图文介绍</title>
      <link href="/2017/01/08/GPUImage%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%9B%BE%E6%96%87%E4%BB%8B%E7%BB%8D/"/>
      <url>/2017/01/08/GPUImage%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%9B%BE%E6%96%87%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-20 00:29:06)</p><p>GPUImage的网上教程，在建立方面，“头文件搜索路径: project’s build settings, 把GPUImage的source和source下的iOS目录加到搜索路径里, 使用相对路径和递归.“总有这样的词汇，根本不知道怎么创建，这里使用图文并茂，一步步跟着来做<br><img src="http://s6.sinaimg.cn/mw690/003479W3gy72CBDIA7j45&amp;690" alt="图片1"><br>首先<br>1：在你的工程文件建立一个Submodules文件夹，再在下一级创建GPUImage文件夹<br>2：将在<a href="https://github.com/BradLarson/GPUImage下的framework放到上图位置，，" target="_blank" rel="noopener">https://github.com/BradLarson/GPUImage下的framework放到上图位置，，</a><br>3：在工程里面引用，记得1，2，4的勾选上，如图，<br><img src="http://s14.sinaimg.cn/mw690/003479W3gy72Et1lS8tad&amp;690" alt="图片2"><br>4：接着在下图中加入箭头所标记的<br><img src="http://s11.sinaimg.cn/mw690/003479W3gy72EsTrXPY9a&amp;690" alt="图片3"><br>5：这是最重要的一步，很多人不理解“头文件搜索路径: project’s build settings, 把GPUImage的source和source下的iOS目录加到搜索路径里, 使用相对路径和递归.”里面的相对路径、递归什么的，那就按照上面一步一步，就可以了。<br><img src="http://s16.sinaimg.cn/mw690/003479W3gy72EsTvPfF8f&amp;690" alt="图片4"><br>６：target-build setting里面，other linker flags 里面添加 -fobjc-arc -ObjC 这两项<br>OK,这一步之后就可以，第五步的作用就是让工程找到头文件。这时#import “GPUImage.h”就能找到你的滤镜效果啦。</p>]]></content>
      
      
      
        <tags>
            
            <tag> GPUimage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>昨天尝试了rsa加密的问题</title>
      <link href="/2017/01/08/%E6%98%A8%E5%A4%A9%E5%B0%9D%E8%AF%95%E4%BA%86rsa%E5%8A%A0%E5%AF%86%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2017/01/08/%E6%98%A8%E5%A4%A9%E5%B0%9D%E8%AF%95%E4%BA%86rsa%E5%8A%A0%E5%AF%86%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-16 11:59:05)</p><p>这几天的问题出现在，当时后台的底层构架他们没法改，在请求头将sign给服务器的同时，在parameter传送过程也需要将sign（数据库钥匙）以及用户账号密码等也在此中。这时出现的一个问题，在charles截取数据，sign、密码等都是明文，这是很恐怖的：服务器钥匙串、密码等都是暴露在人前。你说你去银行，这时你的账号、密码以及银行最重要的钥匙只要有点经验的人都能获取得到，谁还敢将钱放在银行。<br>这时前段将密码过滤多少次都没用，唯一的就是服务器和前段进行密码加密才可解决（服务器那边说没办法，只能这么处理，目前没去更改https，也没法将密码、sign值等放入header中），ok，下面是我们的处理。<br>可以参考这篇文章：<a href="http://www.tuicool.com/articles/bAN7BrR" target="_blank" rel="noopener">http://www.tuicool.com/articles/bAN7BrR</a></p><p>#!/usr/bin/env bash echo “Generating RSA key pair …” echo “1024 RSA key: private_key.pem” openssl genrsa -out private_key.pem 1024 echo “create certification require file: rsaCertReq.csr” openssl req -new -key private_key.pem -out rsaCertReq.csr echo “create certification using x509: rsaCert.crt” openssl x509 -req -days 3650 -in rsaCertReq.csr -signkey private_key.pem -out rsaCert.crt echo “create public_key.der For IOS” openssl x509 -outform der -in rsaCert.crt -out public_key.der echo “create private_key.p12 For IOS. Please remember your password. The password will be used in iOS.” openssl pkcs12 -export -out private_key.p12 -inkey private_key.pem -in rsaCert.crt echo “create rsa_public_key.pem For Java” openssl rsa -in private_key.pem -out rsa_public_key.pem -pubout echo “create pkcs8_private_key.pem For Java” openssl pkcs8 -topk8 -in private_key.pem -out pkcs8_private_key.pem -nocrypt echo “finished.”</p><p>上面的为分开处理，一条一条的哟，有需要填入比如密码、公司信息、province一堆信息，记得信息记录下来哦。</p><p>Tips:</p><ul><li>在创建证书的时候, terminal会提示输入证书信息. 根据wizard输入对应信息就OK. </li><li>在创建p12密匙时, 会提示输入密码, 此时的密码必须记住, 之后会用到.</li><li>如果上面指令有问题,请参考最新的openssl官方文档, 以官方的为准. 之前在网上搜索指令, 被坑了一圈之后, 还是会到啃官方文档上. 每条指令文档在最后都会有几个sample,参考sample即可.</li></ul><p>里面有个RSAEncryptor,自己去github上下载。base64在NSData里边，从iOS 7.0开始自动支持</p><p>加密</p><p><code>RSAEncryptor *rsa = [[RSAEncryptor alloc] init]; NSLog(@&quot;encryptor using rsa&quot;); NSString *publicKeyPath = [[NSBundle mainBundle] pathForResource:@&quot;public_key&quot; ofType:@&quot;der&quot;]; NSLog(@&quot;public key: %@&quot;, publicKeyPath); [rsa loadPublicKeyFromFile:publicKeyPath]; NSString *securityText = @&quot;hello ~&quot;; NSString *encryptedString = [rsa rsaEncryptString:securityText]; NSLog(@&quot;encrypted data: %@&quot;, encryptedString);</code></p><p><strong>[rsa rsaEncryptString:securityText]</strong>会返回decrypted base64编码的字符串:</p><p>console out 写道<br>encrypted data: I1Mnu33cU7QcgaC9uo2bxV0vyfJSqAwyC3DZ+p8jm0G2EmcClarrR5R2xLDdXqvtKj+UJbES7TT+AgkK1NDoQvOJBY+jkmrpAchmRbV2jvi3cEZYQG955jrdSAu21NzQe8xWtEc3YzP+TACPdP4B3Cyy0u8N2RcSFWyxu0YKPXE=</p><p>解密:<br><code>NSLog(@&quot;decryptor using rsa&quot;); [rsa loadPrivateKeyFromFile:[[NSBundle mainBundle] pathForResource:@&quot;private_key&quot; ofType:@&quot;p12&quot;] password:@&quot;123456&quot;]; NSString *decryptedString = [rsa rsaDecryptString:encryptedString]; NSLog(@&quot;decrypted data: %@&quot;, decryptedString);</code></p><p>服务器那边就让他们服务器去弄，这就是我们前段需要处理的地方</p><p>上边整理下来的文件有7个   .gem .der p12等等</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>swift的xib在模拟器显示正常，真机不显示</title>
      <link href="/2017/01/08/swift%E7%9A%84xib%E5%9C%A8%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%98%BE%E7%A4%BA%E6%AD%A3%E5%B8%B8%EF%BC%8C%E7%9C%9F%E6%9C%BA%E4%B8%8D%E6%98%BE%E7%A4%BA/"/>
      <url>/2017/01/08/swift%E7%9A%84xib%E5%9C%A8%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%98%BE%E7%A4%BA%E6%AD%A3%E5%B8%B8%EF%BC%8C%E7%9C%9F%E6%9C%BA%E4%B8%8D%E6%98%BE%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-13 11:34:52)</p><p>这个完美解决了swift会不加载xib的问题~~xib都OK，模拟器可以显示，但是真机却没有显示的解决方案，原因就是swift不默认加载xib，强制让他加上就好了<br><a href="http://my.oschina.net/227/blog/470553" target="_blank" rel="noopener">http://my.oschina.net/227/blog/470553</a><br>这个是转帖嘿嘿，谢谢大哥啦</p><p>import UIKit<br>class FormController: UIViewController {</p><p>override init(nibName nibNameOrNil: String?, bundle nibBundleOrNil: NSBundle?) {<br>super.init(nibName: nibNameOrNil, bundle: nibBundleOrNil)<br>//println(nibName);    }<br>convenience init() {<br>var nibNameOrNil = String?(“FormController”)</p><p>//        //考虑到xib文件可能不存在或被删，故加入判断//        if NSBundle.mainBundle().pathForResource(nibNameOrNil, ofType: “xib”) == nil{   nibNameOrNil = nil}<br>self.init(nibName: nibNameOrNil, bundle: nil)<br>}<br>required init(coder aDecoder: NSCoder) {<br>fatalError(“init(coder:) has not been implemented”)<br>}</p><p>override func viewDidLoad() {</p><p>}<br>override func didReceiveMemoryWarning() {<br>super.didReceiveMemoryWarning()<br>// Dispose of any resources that can be recreated.    }</p><p>}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>collectionView的minimumLineSpacing内部空隙默认不为空</title>
      <link href="/2017/01/08/collectionView%E7%9A%84minimumLineSpacing%E5%86%85%E9%83%A8%E7%A9%BA%E9%9A%99%E9%BB%98%E8%AE%A4%E4%B8%8D%E4%B8%BA%E7%A9%BA/"/>
      <url>/2017/01/08/collectionView%E7%9A%84minimumLineSpacing%E5%86%85%E9%83%A8%E7%A9%BA%E9%9A%99%E9%BB%98%E8%AE%A4%E4%B8%8D%E4%B8%BA%E7%A9%BA/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-06 17:29:45)</p><p>我这里有个需求，用了collectionView做，中间是没有空隙的，但是实际上，没有设置minimumLineSpacing的时候，老是有空隙，后台我直接设置collectionView.minimumLineSpacing = 0的时候才完成。把坑位留下，下次不犯了，哈哈</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>xcode一直不会更新的新下载的证书</title>
      <link href="/2017/01/08/xcode%E4%B8%80%E7%9B%B4%E4%B8%8D%E4%BC%9A%E6%9B%B4%E6%96%B0%E7%9A%84%E6%96%B0%E4%B8%8B%E8%BD%BD%E7%9A%84%E8%AF%81%E4%B9%A6/"/>
      <url>/2017/01/08/xcode%E4%B8%80%E7%9B%B4%E4%B8%8D%E4%BC%9A%E6%9B%B4%E6%96%B0%E7%9A%84%E6%96%B0%E4%B8%8B%E8%BD%BD%E7%9A%84%E8%AF%81%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-06-02 10:12:04)</p><p>个人觉得这个是帮了个大忙，xcode一直不会更新的新下载的证书，好烦，很久以前就一直有的问题。明明我刚下好的certificate，就是不出现，说没有这个。我说下我的步骤：1，在project，是的，如果你用workspace，还是要右键project“显示包文件”；2，找到图中所说的project.pbxproj文件，编辑器打开；3：将所有“PROVISIONING_PROFILE”的一整行删除，不放心的话，你可以提前先拷贝一份你的绿色的project文件，安全是吧。然后重开xcode，这简直帮了我大忙。<br><img src="http://s10.sinaimg.cn/mw690/003479W3gy729X8HJfX99&amp;690" alt="图片1"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>谈谈对swift的看法</title>
      <link href="/2017/01/08/%E8%B0%88%E8%B0%88%E5%AF%B9swift%E7%9A%84%E7%9C%8B%E6%B3%95/"/>
      <url>/2017/01/08/%E8%B0%88%E8%B0%88%E5%AF%B9swift%E7%9A%84%E7%9C%8B%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-05-29 22:24:22)</p><p>swift出来挺久的了，我一直在升级OC的技能，基本基础都OK。<br>最近要开始一个新的项目，我就在思考，如果不写swift会带来的后果，这是考量我该不该使用新的语言，毕竟我之前从来没看。</p><ol><li>我感觉，预计今年十月份开始，swift将会大行其道。你不会可能都说不过去了，毕竟就如一些技能“ASI”的过气、“MRC”也过气等等；这都是知名的，都是我之前的时代，我也在改变，那就毋庸置疑了，应该改变。</li><li>我个人觉得，目前程序员不就是一直在学新的东西么，不就是一个语言么，没啥难度，用法不会，查不查就可以，毕竟和OC很相近的。</li><li>之前我用的库也都能用，而且swift语言其实是基于OC的库，OC多稳定，swift只是一个编译程序的过程用的工具</li><li>我当时花了两天，边打游戏边看github一个“30天30 swift demo”，基本也能掌握。</li><li>怕个鸟，就是从ReactiveCocoa转到RxSwift比较麻烦<br>这里贴一个大哥的“简书”地址—-&gt;<a href="http://www.jianshu.com/p/7e286fbbc3d7，我当时学ReactiveCocoa的时候，其实也是比较值的变化，慢慢学，看了一会其实跟OC的响应式编程相近。项目中用到，多用几次就会了。" target="_blank" rel="noopener">http://www.jianshu.com/p/7e286fbbc3d7，我当时学ReactiveCocoa的时候，其实也是比较值的变化，慢慢学，看了一会其实跟OC的响应式编程相近。项目中用到，多用几次就会了。</a><br>其实后期我越来越感觉到，其实语言这东西，就是一个工具，就是一个工具，你写的东西，在相应的编译器才识别，也就是一个描述性文档，想要学的深，只能慢慢来，现在的范围广这一步我走的还行，多用多接触一些东西，慢慢的也要试试走更底层一些东西啦，，人生不停下就好，，，我还想当管理，我还想多学点，我还想户外运动，我还想业余活动，，，你慢慢想吧，，，，，，，，，</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>IOS图片加水印或文字</title>
      <link href="/2017/01/08/IOS%E5%9B%BE%E7%89%87%E5%8A%A0%E6%B0%B4%E5%8D%B0%E6%88%96%E6%96%87%E5%AD%97/"/>
      <url>/2017/01/08/IOS%E5%9B%BE%E7%89%87%E5%8A%A0%E6%B0%B4%E5%8D%B0%E6%88%96%E6%96%87%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-04-30 23:40:20)</p><p><a href="http://blog.sina.com.cn/s/blog_70854cfb0101d2dr.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_70854cfb0101d2dr.html</a><br>转载自这里，最近有做类似图片、视频的进阶，所以查阅了下博客，谢谢博主的分享啦</p><p>1.加文字</p><p>-(UIImage <em>)addText:(UIImage </em>)img text:(NSString <em>)text1<br>{<br>//get image width and height<br>int w = img.size.width;<br>int h = img.size.height;<br>CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();<br>//create a graphic context with CGBitmapContextCreate<br>CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 </em> w, colorSpace, kCGImageAlphaPremultipliedFirst);<br>CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);<br>CGContextSetRGBFillColor(context, 0.0, 1.0, 1.0, 1);<br>char<em> text = (char </em>)[text1 cStringUsingEncoding:NSASCIIStringEncoding];<br>CGContextSelectFont(context, “Georgia”, 30, kCGEncodingMacRoman);<br>CGContextSetTextDrawingMode(context, kCGTextFill);<br>CGContextSetRGBFillColor(context, 255, 0, 0, 1);<br>CGContextShowTextAtPoint(context, w/2-strlen(text)*5, h/2, text, strlen(text));<br>//Create image ref from the context<br>CGImageRef imageMasked = CGBitmapContextCreateImage(context);<br>CGContextRelease(context);<br>CGColorSpaceRelease(colorSpace);<br>return [UIImage imageWithCGImage:imageMasked];<br>}</p><p>2.加图片<br>-(UIImage <em>)addImageLogo:(UIImage </em>)img text:(UIImage <em>)logo<br>{<br>//get image width and height<br>int w = img.size.width;<br>int h = img.size.height;<br>int logoWidth = logo.size.width;<br>int logoHeight = logo.size.height;<br>CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();<br>//create a graphic context with CGBitmapContextCreate<br>CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 </em> w, colorSpace, kCGImageAlphaPremultipliedFirst);<br>CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);<br>CGContextDrawImage(context, CGRectMake(w-logoWidth, 0, logoWidth, logoHeight), [logo CGImage]);<br>CGImageRef imageMasked = CGBitmapContextCreateImage(context);<br>CGContextRelease(context);<br>CGColorSpaceRelease(colorSpace);<br>return [UIImage imageWithCGImage:imageMasked];<br>//  CGContextDrawImage(contextRef, CGRectMake(100, 50, 200, 80), [smallImg CGImage]);<br>}</p><p>3.加半透明的水印</p><ul><li>(UIImage <em>)addImage:(UIImage </em>)useImage addImage1:(UIImage <em>)addImage1<br>{<br>UIGraphicsBeginImageContext(useImage.size);<br>[useImage drawInRect:CGRectMake(0, 0, useImage.size.width, useImage.size.height)];<br>[addImage1 drawInRect:CGRectMake(0, useImage.size.height-addImage1.size.height, addImage1.size.width, addImage1.size.height)];<br>UIImage </em>resultingImage = UIGraphicsGetImageFromCurrentImageContext();<br>UIGraphicsEndImageContext();<br>return resultingImage;<br>}</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>iOS单元格分割线</title>
      <link href="/2017/01/08/iOS%E5%8D%95%E5%85%83%E6%A0%BC%E5%88%86%E5%89%B2%E7%BA%BF/"/>
      <url>/2017/01/08/iOS%E5%8D%95%E5%85%83%E6%A0%BC%E5%88%86%E5%89%B2%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-04-28 15:41:01)</p><p>网上找的一个改表格的分割线方法，测试有用，记录一下了</p><p>void)viewDidLayoutSubviews<br>{<br>if ([self.tableView respondsToSelector:@selector(setSeparatorInset:)]) {<br>[self.tableView setSeparatorInset:UIEdgeInsetsMake(0,0,0,0)];<br>}  </p><p>if ([self.tableView respondsToSelector:@selector(setLayoutMargins:)]) {<br>[self.tableView setLayoutMargins:UIEdgeInsetsMake(0,0,0,0)];<br>}<br>}  </p><p>-(void)tableView:(UITableView <em>)tableView willDisplayCell:(UITableViewCell </em>)cell forRowAtIndexPath:(NSIndexPath *)indexPath<br>{<br>if ([cell respondsToSelector:@selector(setSeparatorInset:)]) {<br>[cell setSeparatorInset:UIEdgeInsetsZero];<br>}  </p><p>if ([cell respondsToSelector:@selector(setLayoutMargins:)]) {<br>[cell setLayoutMargins:UIEdgeInsetsZero];<br>}<br>}  </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>近期生活回顾</title>
      <link href="/2017/01/08/%E8%BF%91%E6%9C%9F%E7%94%9F%E6%B4%BB%E5%9B%9E%E9%A1%BE/"/>
      <url>/2017/01/08/%E8%BF%91%E6%9C%9F%E7%94%9F%E6%B4%BB%E5%9B%9E%E9%A1%BE/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-04-08 09:31:51)<br>近期，，也就是清明，刚过去。和同伴们闹腾的比较嗨的一次玩乐，主要是老板人年轻，活力。嘎嘎，，，<br>清明前一天，一大堆人坐车前往老板定好的大轰趴现场，我拎着丫头去，一个pregnant4/5Month的，让她不要乱动。过去之后，老板陪我们玩乐会，就喊上了几个姑娘做饭菜去了。我从一楼玩到地下，有唱K的，有桌球比拼的，有台球，有x-box，有游戏厅玩的那种游戏机，有麻将机。反正，这是我第一次看过，简直不要太好的、太豪华的（没见过世面，莫怪）住所。我玩得几件衣服都脱掉了。晚上，吃个饭当然是打牌啦，赌钱，现在我觉得，确实是很有魔力。不赌钱，没动力，赌大钱，玩不起。慢慢来，玩“干瞪眼”、“21点”（老板自创，，）、“德州”。傍晚，老板来了两个朋友，超会赌。安妮玩“干瞪眼”还是一样，能打的很好，我本来不咋地，座位往她们那片移，风气来的挡都挡不住。后来姑凉们去睡了，11点左右。丫头时不时担心我，跑来给我热水，又跑回去躺一躺，睡不着，她。我们后来玩了“21点”，不好玩，玩了一圈，这简直就是赌博，换一个–“德州”。这个我比较喜欢，一开始的筹码，我慢慢的全输光了，她们说我是赌徒，很快ALL IN,老板看不下去，给了我不知道几次的资助，MONA也是，给了，不用还了。要知道，我的牌肯定是很大我才会压，没想到，永远差最后一张牌，她们都能成立，那我也就没办法了。每个人赢钱，又输掉，大哥很谨慎，最后都输了一些。MONA，她的心态比较简单，不想赢你们太多钱，我会赢，你们小心一点。老板，从玩“干瞪眼”起就一直输，“德州”的时候一开始赢了好多好多，同时资助了我好多好多。一段时间会输好多，然后猛吸一口气，,啧啧，还别说，立马来好牌，这是我发现的规律，，，老板，人，，，，运气真的很好，，，，，业华，女同事刚开始玩，也挺开心的，但是玩到“21点”觉得无趣，确实，我也是这么认为的。那晚我都是当做游戏的，玩的开心就好，“21点”没有玩劲，不给力不给力。老板的朋友，经常玩打牌赌博把，，发了一晚上牌，是我肯定早崩溃，他越发越带劲。好吧，那晚我们除了女孩子们，硬是撑到了过夜5点。我是捂着眼睛（尽量减少力气）撑过去；老板太困，跑去洗了个澡，回来—牌突然又好了，神奇吧；大哥舍命陪君子，不过第二天他居然还有精力跑去外滩，我也是醉了；MONA，嗯哼，她表示没问题；老板朋友们，你懂得，越玩越带劲；<br>第二天我带着丫头回家，他们早走回去了，我和丫头实在是太累，她昨晚没睡好，我和她在徐汇站凳子做了好久好久，回去的时候，我一点都不敢睡，特么一个孕妇在旁边，得用命保护啊—我看着对面窗户反射看到的自己，简直是大熊猫，超级黑眼圈。下午睡了一觉，醒了无聊打游戏，打到11点，，就感觉不自在——于是写代码写到2点，心里才舒坦啊。。。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>多图上传，一个接着一个上传Reactivecocoa方法</title>
      <link href="/2017/01/08/%E5%A4%9A%E5%9B%BE%E4%B8%8A%E4%BC%A0%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%8E%A5%E7%9D%80%E4%B8%80%E4%B8%AA%E4%B8%8A%E4%BC%A0Reactivecocoa%E6%96%B9%E6%B3%95/"/>
      <url>/2017/01/08/%E5%A4%9A%E5%9B%BE%E4%B8%8A%E4%BC%A0%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%8E%A5%E7%9D%80%E4%B8%80%E4%B8%AA%E4%B8%8A%E4%BC%A0Reactivecocoa%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-03-17 16:49:49)<br><img src="http://s4.sinaimg.cn/mw690/003479W3gy70bAat4vpa3&amp;690" alt="图片1"><br><img src="http://s14.sinaimg.cn/mw690/003479W3gy70bzRX6572d&amp;690" alt="图片1"><br>这里使用RAC方法，发送多图上传的方法，目标是七牛，可以作为队列使用。图片会一个一个的有序上传。<br>username拼接上idx是为了防止图片上传速度过快，名字重名，导致失败，于是拼上idx的话，可以有唯一性。<br>链式需求可以很好解决。<br>在图片超过9张那里，没有设置timeout：30，记得加入哟，，还有可以优化的地方。<br>希望能帮到你。<br>final code:<br><img src="http://s2.sinaimg.cn/mw690/003479W3gy70bAp6g5X51&amp;690" alt="图片1"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>修改底部TabBar样式</title>
      <link href="/2017/01/08/%E4%BF%AE%E6%94%B9%E5%BA%95%E9%83%A8TabBar%E6%A0%B7%E5%BC%8F/"/>
      <url>/2017/01/08/%E4%BF%AE%E6%94%B9%E5%BA%95%E9%83%A8TabBar%E6%A0%B7%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-03-16 10:21:44)</p><p><a href="http://blog.csdn.net/l863784757/article/details/45167389" target="_blank" rel="noopener">http://blog.csdn.net/l863784757/article/details/45167389</a><br>这是一个博主修改底部TabBar的UI，感觉很好，谢谢资源</p><p>这需要讲一点imageWithRenderingMode可以避免主题色被tabbarItem转换；<br>如果UIEdgeInsetsMake(6, 0, -6, 0)这里的6和-6要对其，不然会出现其中的图片拉伸情况，<br>我这里把title=“”之后，摆放imageInset，一定要对齐</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>利用Reveal看任何APP，亲测有用</title>
      <link href="/2017/01/08/%E5%88%A9%E7%94%A8Reveal%E7%9C%8B%E4%BB%BB%E4%BD%95APP%EF%BC%8C%E4%BA%B2%E6%B5%8B%E6%9C%89%E7%94%A8/"/>
      <url>/2017/01/08/%E5%88%A9%E7%94%A8Reveal%E7%9C%8B%E4%BB%BB%E4%BD%95APP%EF%BC%8C%E4%BA%B2%E6%B5%8B%E6%9C%89%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-03-08 11:48:18)</p><p><a href="http://www.ianisme.com/ios/1887.html我是按着这个网址的教程，" target="_blank" rel="noopener">http://www.ianisme.com/ios/1887.html我是按着这个网址的教程，</a><br>有几个麻烦的，</p><ol><li>Reavel包括内破解方法，链接地址<a href="http://7xjcms.com1.z0.glb.clouddn.com/Reveal.zip" target="_blank" rel="noopener">Reveal</a></li><li>破解可以用pp越狱助手，下一堆鬼东西，至少你也得懂越狱吧，哈哈。</li><li>在Cydia下iFile，这个好东西我就不说了，越狱了第一个就想用的东西。按照上面教程走。<br>我这里遇到的问题是，那个什么iFunBox或者iTools都没法打开Mobile的目录，但是他们能打开Media的文件夹，直接把libReveal.dylib放到那边,目录为：上面文章提供的地址</li><li>将文件存放的地址为/Library/MobileSubstrate/DynamicLibraries目录下</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>解决Xcode断点调试值都为nil的问题</title>
      <link href="/2017/01/08/%E8%A7%A3%E5%86%B3Xcode%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E5%80%BC%E9%83%BD%E4%B8%BAnil%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2017/01/08/%E8%A7%A3%E5%86%B3Xcode%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E5%80%BC%E9%83%BD%E4%B8%BAnil%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-02-25 14:04:24)</p><p>解决Xcode断点调试值都为nil的问题   </p><p>在Build Settings中 Optimization Level 设置成 None</p><p><a href="http://www.cocoachina.com/bbs/read.php?tid=229014" target="_blank" rel="noopener">http://www.cocoachina.com/bbs/read.php?tid=229014</a></p><p>我从这里抄来的，没有debug功能，叫什么开发，开你妹的开。。。。。。</p><p>最近学习react-native，没有买书籍，没办法，只能一点点学，写一点，在google断点调试一点，就只有这样。用debug方式一点点走程序，这是最好的方法，知道了程序的走向，就知道怎么回事了。</p><p>debug是学习之路，望多打断点哟。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>github里demoMChat使用的EaseMob的版本，这里发上来</title>
      <link href="/2017/01/08/github%E9%87%8CdemoMChat%E4%BD%BF%E7%94%A8%E7%9A%84EaseMob%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E8%BF%99%E9%87%8C%E5%8F%91%E4%B8%8A%E6%9D%A5/"/>
      <url>/2017/01/08/github%E9%87%8CdemoMChat%E4%BD%BF%E7%94%A8%E7%9A%84EaseMob%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E8%BF%99%E9%87%8C%E5%8F%91%E4%B8%8A%E6%9D%A5/</url>
      
        <content type="html"><![CDATA[<p>发表于2016-02-17 09:32<br><a href="https://github.com/shaohung001/MChat-reactivecocoa-easeMob" target="_blank" rel="noopener">项目地址</a><br>remove easeMob folder and some big frame, you should add some framework in the Build Phases with ‘Foundation’/‘UIKit’/‘CFNetwork’/‘MobileCoreServices’ before start.And fold fold ./MChat/Thirdpart/EaseMobSDK is empty, you need to go to the address of EaseMob ,download which’s SDK and move it to the fold . The SDK cost 130M, and the one’s download resource is here<br><a href="http://7xjcms.com1.z0.glb.clouddn.com/EaseMobSDK.zip" target="_blank" rel="noopener">SDK下载地址</a><br>版本记得是这两个中的一个，记得去掉UI库<br>版本：V2.2.1r2 2015-12-26</p><p>bug fix:</p><p>SDK bug: 内部优化。<br>版本：V2.2.1 2015-10-28</p><p>新功能:</p><p>新增一个UI库EaseUI，方便开发者更加快速的集成环信sdk，新的demo也基于此库开发，旧demo将不再维护。<br>bug fix:</p><p>SDK bug: 修复离线收不到被踢出群及群解散的通知的bug。<br>SDK细节调整:</p><p>视频通话优化了优化了码率控制，降低码率视频质量不下降。</p><p>还有文件目录 ThirdPart/Nimbus/的压缩地址：<br><a href="http://7xjcms.com1.z0.glb.clouddn.com/Nimbus.zip" target="_blank" rel="noopener">SDK下载地址</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>React-native经历</title>
      <link href="/2017/01/08/React-native%E7%BB%8F%E5%8E%86/"/>
      <url>/2017/01/08/React-native%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-02-01 13:25:13)<br><img src="http://s14.sinaimg.cn/mw690/003479W3gy6Z1zJ4Tspcd&amp;690" alt="图一"><br>有个哥们在React-native遇到如 at process._tickCallback问题，一哥们在如下设置即可以解决。留着吧。<br><img src="http://s1.sinaimg.cn/mw690/003479W3gy6Z1zJ0cNy60&amp;690" alt="图二"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>React-native自学之路</title>
      <link href="/2017/01/08/React-native%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/"/>
      <url>/2017/01/08/React-native%E8%87%AA%E5%AD%A6%E4%B9%8B%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<p>发表于(2016-01-26 12:12:40)<br>首先先去React-native官网看看。网上一堆的文章；这里推荐两篇文章1：<a href="https://github.com/ele828/react-native-guide；https://github.com/vczero/react-native-lesson大爱第二个，宇宙无敌超级详细；谢谢作者。" target="_blank" rel="noopener">https://github.com/ele828/react-native-guide；https://github.com/vczero/react-native-lesson大爱第二个，宇宙无敌超级详细；谢谢作者。</a><br>接下来说几点我觉得我踩得坑：<br>1、react-native的Exmaple里面的运行不了，他的URL错了，用下面的注释掉的那个，多试几次就可以了。<br>2：忍住性子把第二个大神给的demo全部写几遍，，当然，我现在才写到第二个，共勉励之啦。<br>3、不要用atom，特别不要用atom的那个FaceBook的那个插件，卡成娘了。我现在用sublime，老是弹出来让我去purchase，特么没钱。他喵的。<br>4、sublime没有提示，去这个网址<a href="https://packagecontrol.io/installation#st2，官网里下package" target="_blank" rel="noopener">https://packagecontrol.io/installation#st2，官网里下package</a> control</p><p>安装插件：<br>使用Package Control组件安装,先安装此组件<br>按Ctrl+`调出console，粘贴以下代码到底部命令行并回车：<br>import urllib.request,os,hashlib; h = ‘eb2297e1a458f27d836c04bb0cbaf282’ +<br>‘d0e7a3098092775ccb37ca9d6b2e4b7d’; pf = ‘Package Control.sublime-package’; ipp = sublime.installed_packages_path();<br>urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( ‘<a href="http://packagecontrol.io/&#39;" target="_blank" rel="noopener">http://packagecontrol.io/&#39;</a> + pf.replace(‘ ‘, ‘ ‘)).read(); dh =<br>hashlib.sha256(by).hexdigest(); print(‘Error validating download (got %s instead of %s), please try manual install’ % (dh, h)) if dh != h else open(os.path.join( ipp, pf), ‘wb’ ).write(by)<br>重启Sublime Text 3，如果在Perferences-&gt;package settings中看到package control这一项，则安装成功。<br>用Package Control安装插件的方法<br>按下Ctrl+Shift+P调出命令面板，输入install 调出 Install Package 选项并回车，然后在列表中选中要安装的插件。</p><p>5、重点说下，snippet是代码片段，就是提示你用的，一步一步试试。不要放弃，走多了的，我相信花时间投资React-native肯定会有回报的。未来肯定很明亮。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>iOSpop返回手势向右滑动</title>
      <link href="/2017/01/08/iOSpop%E8%BF%94%E5%9B%9E%E6%89%8B%E5%8A%BF%E5%90%91%E5%8F%B3%E6%BB%91%E5%8A%A8/"/>
      <url>/2017/01/08/iOSpop%E8%BF%94%E5%9B%9E%E6%89%8B%E5%8A%BF%E5%90%91%E5%8F%B3%E6%BB%91%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<p>根据这篇文章<a href="http://www.jianshu.com/p/349636eb3fca" target="_blank" rel="noopener">http://www.jianshu.com/p/349636eb3fca</a> 这是一篇简书的技术文章和一篇优化的文章：<a href="http://blog.csdn.net/chenyong05314/article/details/40344763。" target="_blank" rel="noopener">http://blog.csdn.net/chenyong05314/article/details/40344763。</a><br>读懂几个信息：</p><ol><li>如果你重新定义返回按钮，这个按钮变为自定义的leftBarButtonItem的时候，iOS7之后的pop手势交互就失效。</li><li>如果需要重新启用，你可以用自定义的导航栏，更改两个东西或者新添几个地方：<br>1）：<code>@interface CBNavigationController : UINavigationController &lt;UINavigationControllerDelegate,UIGestureRecognizerDelegate&gt;</code><br>在类别中声明需要接收两个协议<br>2）：<br>`-(void)viewDidLoad<br>{<br> __weak CBNavigationController *weakSelf = self;<br> if ([self respondsToSelector:@selector(interactivePopGestureRecognizer)])<br> {<pre><code>self.interactivePopGestureRecognizer.delegate = weakSelf;self.delegate = weakSelf;</code></pre> }<br>}<code>然后还有两个协议：3）：</code>-(void)pushViewController:(UIViewController <em>)viewController animated:(BOOL)animated{<br> if ([self respondsToSelector:@selector(interactivePopGestureRecognizer)]) {<br> self.interactivePopGestureRecognizer.enabled = NO;<br> }<br> [super pushViewController:viewController animated:animated];<br>}<code></code>-(void)navigationController:(UINavigationController </em>)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated{<br> if ([navigationController respondsToSelector:@selector(interactivePopGestureRecognizer)]) {<pre><code>if ([navigationController.viewControllers count]==1) {    navigationController.interactivePopGestureRecognizer.enabled = NO;}else{    navigationController.interactivePopGestureRecognizer.enabled = YES;}</code></pre> }<br>}`<br>这样你就可以愉快的使用返回手势啦</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>说说iOS7布局的俩坑</title>
      <link href="/2017/01/08/%E8%AF%B4%E8%AF%B4iOS7%E5%B8%83%E5%B1%80%E7%9A%84%E4%BF%A9%E5%9D%91/"/>
      <url>/2017/01/08/%E8%AF%B4%E8%AF%B4iOS7%E5%B8%83%E5%B1%80%E7%9A%84%E4%BF%A9%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-12-23 09:01:55)</p><p>首先，贴两段代码：</p><ol><li><code>if ([self respondsToSelector:@selector(edgesForExtendedLayout)]) {self.edgesForExtendedLayout = UIRectEdgeNone;}</code></li><li><code>if ([self respondsToSelector:@selector(setAutomaticallyAdjustsScrollViewInsets:)]) {self.automaticallyAdjustsScrollViewInsets = NO;}</code></li></ol><p>视图透明的时候，下面的view会往上顶就是第一个控制的（如果导航栏为透明的话，不透明则默认不顶上去）<br>第二个是更坑爹的，你在滑动tableView的时候，会发现uitableviewwrapperview（你用三维视图，可以看到贴在tableview上得一层膜，就是uitableviewwrapperview）在刚开始的时候正常，越滑，这玩意越短，到最后视图不如我们所想，就是第二个控制的，，反正我发现的时候烦死。<br>比较需要注意的是第二个，不管我用UITableViewController或者VC贴上TableView后，wrapperView都会有变动。</p>]]></content>
      
      
      
        <tags>
            
            <tag> ios7 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RACCommand的使用</title>
      <link href="/2017/01/08/RACCommand%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2017/01/08/RACCommand%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>发表于2015-12-20 22:17<br>具体直接给图，这样写比较正规，具体组织代码，看自己咯<br><img src="http://s9.sinaimg.cn/mw690/003479W3gy6XVzZF3Ica8&amp;690" alt="RACCommand使用逻辑"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>应用瘦身</title>
      <link href="/2017/01/08/%E5%BA%94%E7%94%A8%E7%98%A6%E8%BA%AB/"/>
      <url>/2017/01/08/%E5%BA%94%E7%94%A8%E7%98%A6%E8%BA%AB/</url>
      
        <content type="html"><![CDATA[<p>发表于2015-12-20 22:14<br><a href="https://github.com/rtyley/bfg-repo-cleaner" target="_blank" rel="noopener">rtyley/bfg-repo-cleaner</a><br>源码管理系统不是永远不出问题的黑盒子。如果你没有合理地维护好你的仓库，对于要使用它们的开发人员来说，这些仓库会变成一个重大的负担。有些工具能帮你维护它们，Roberto Tyley的<a href="https://rtyley.github.io/bfg-repo-cleaner/" target="_blank" rel="noopener">BFG Repo-Cleaner for Git</a>就是这样一个工具。这个工具可以用来删除那些你不小心提交到git分支上的二进制大文件。<br>如果是给api瘦身，可以从资源文件入手、没有使用的类、将一些图片打进iconfont、使用bitcode，参考下面文章<br><a href="http://www.tuicool.com/articles/2UjumaM" target="_blank" rel="noopener">我是一片文章blablabla</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>这一段时间的工作安排</title>
      <link href="/2017/01/08/%E8%BF%99%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%AE%89%E6%8E%92/"/>
      <url>/2017/01/08/%E8%BF%99%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%AE%89%E6%8E%92/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-12-10 10:09:49)<br>由于工作没有排期，很没有效率。到目前为止，公司开过一个会说了上下班时间安排，之后没有提及工作事由，进程难以把控。<br>写在这里，是想说，管理层很重要，为每人安排充足时间干要紧事，充实。<br>工作闲，我却不能，毕竟时间不多，我的学习期也就这一两年了，过了我要么转型做管理层，要么去做股东或者自己创业。<br>花个1星期写个coretext库，接下来研究研究雷神的demo，接下来开始css的开发了，一个个来。<br>人生没有停下这一说，毕竟我是男人。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>对于从xcode6的代码搬迁至xcode7.1.1beta版出：dylib文件找不到</title>
      <link href="/2017/01/08/%E5%AF%B9%E4%BA%8E%E4%BB%8Excode6%E7%9A%84%E4%BB%A3%E7%A0%81%E6%90%AC%E8%BF%81%E8%87%B3xcode7-1-1beta%E7%89%88%E5%87%BA%EF%BC%9Adylib%E6%96%87%E4%BB%B6%E6%89%BE%E4%B8%8D%E5%88%B0/"/>
      <url>/2017/01/08/%E5%AF%B9%E4%BA%8E%E4%BB%8Excode6%E7%9A%84%E4%BB%A3%E7%A0%81%E6%90%AC%E8%BF%81%E8%87%B3xcode7-1-1beta%E7%89%88%E5%87%BA%EF%BC%9Adylib%E6%96%87%E4%BB%B6%E6%89%BE%E4%B8%8D%E5%88%B0/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-12-07 10:44:04)<br>这个问题是xcode7.1.1beta版本的版本，我从网上阅历几篇文章，得出两种解决方法；<br><img src="http://s11.sinaimg.cn/mw690/003479W3gy6XA5QBko21a&amp;690" alt="Build出错图"></p><p>首先这个问题，是因为xcode6有dylib的苹果的库文件，但是xcode7之后全部换成了.tbd的库文件，也就是说，在/Applications/Xcode7.1.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/目录下去找xcode 库文件储存地址没有找到要用到的.dylib    xcode 6的后缀名file，所以就报错。<br>我根据stack flow的解释（<a href="http://stackoverflow.com/questions/32734097/xcode7-ios9-about-libz-tbd-is-not-an-object-file-not-allowed-in-a-library、https://forums.developer.apple.com/thread/4572），得出两种，一种就如他们说的那般，很麻烦，，到settings/Other" target="_blank" rel="noopener">http://stackoverflow.com/questions/32734097/xcode7-ios9-about-libz-tbd-is-not-an-object-file-not-allowed-in-a-library、https://forums.developer.apple.com/thread/4572），得出两种，一种就如他们说的那般，很麻烦，，到settings/Other</a> link flag 更改相应的取名（听不懂）<br>第二种方法：<br>第一种方法给人直接想到的是，我这工程到哪里都是可以被别人用的，这也是为外国人推崇，不用说我把工程递交给其他人之后还需要处理什么。于是第二种方法较为简单！！<br>你只需要将dylib文件置放于/Applications/Xcode7.1.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/目录下，xcode说找不到，，那我就去xcode6去移植dylib文件过来即可（目录相同），这个问题同样可以解决。<br>下面为压缩包6.4xcode<br><a href="https://github.com/shaohung001/xcode6-xcode7-" target="_blank" rel="noopener">dylib压缩包xcode6.4下载地址</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ios it dylib(nosuchfileordirectory) </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BitBucket和MAC版的sourcetree初次使用</title>
      <link href="/2017/01/08/BitBucket%E5%92%8CMAC%E7%89%88%E7%9A%84sourcetree%E5%88%9D%E6%AC%A1%E4%BD%BF%E7%94%A8/"/>
      <url>/2017/01/08/BitBucket%E5%92%8CMAC%E7%89%88%E7%9A%84sourcetree%E5%88%9D%E6%AC%A1%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-11-28 23:48:42)</p><p>先来说说近况，由于工作需要协同开发，考虑要么svn，要么git。<br>git管理我知道的有两大热门：github和bitbucket<br>github公开源码是免费的，但是要私有的就必须教每个月5（RMB还是dollar忘了）块钱费用，于是就只有bitbucket了。<br>bitbucket5人以下完全免费，无限量。<br>首先参考这篇文章：<a href="http://www.open-open.com/lib/view/open1420034265890.html学到如何将其由英文改为中文就好啦。接着米西米西到了创建团队、创建仓库。" target="_blank" rel="noopener">http://www.open-open.com/lib/view/open1420034265890.html学到如何将其由英文改为中文就好啦。接着米西米西到了创建团队、创建仓库。</a><br>右边有个按钮invite人，点击之后输入队友邮箱，队友收到邮件，点击进入：如果有bitbucket账号则直接登录，否则进入注册界面。<br>bitbucket配备sourcetree：<br><img src="http://s1.sinaimg.cn/mw690/003479W3gy6XmBmzJ6ge0&amp;690" alt="图1"><br>最左边那个点击进入：<br><img src="http://s10.sinaimg.cn/mw690/003479W3gy6XmBrZAmJ39&amp;690" alt="图2"><br>上面那个写上你的：<br><img src="http://s15.sinaimg.cn/mw690/003479W3gy6XmBHFMYu2e&amp;690" alt="图3"><br>https的那个链接，下面则是你到时要储存的地址，点击OK就到了这个页面：<br><img src="http://s2.sinaimg.cn/mw690/003479W3gy6XmBSB3gZc1&amp;690" alt="图4"><br>这时右下角有两个按钮，鼠标放上去才会有的，点左边那个按钮，跳转到类似svn的sourcetree文件操作页面。<br>主要说几点我懂得的，我用没多久，要是有懂得的大哥不妨赐教。</p><ol><li>第一次把代码放到bitbucket，你需要把文件（不是大文件夹，而是里面的全部文件）全部拷到你本地路径，同时在sourcetree点击commit，这时，仅仅是把更改内容同步在本地，（svn点击commit按钮就相当于更新服务器数据），这时你还需要点击push。</li><li>fetch的作用，我是将其作为第一次从网上拉取数据的操作，pull是同步。其他按钮我没去搞明白。</li><li>删除的话，在sourcetree一级页面的设置按钮（如图3的右下角那个按钮）,点击删除；同时在bitbucket那边也点击删除</li></ol><p>基本操作就这么多，大概也够用了，毕竟免费这东西，我习惯自己开发，现在公司连服务器都没有，，蛋疼。<br>网上这类例子都是东一个西一个，我在此将bitbucket和sourcetree的一些基本操作和作用一起写下来，希望对大家有用。最后还是希望多动手把，知道什么功能，试试成功了那就OK了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> bitbucket  ios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GET请求InvalidParameternotsatisfying</title>
      <link href="/2017/01/08/GET%E8%AF%B7%E6%B1%82InvalidParameternotsatisfying/"/>
      <url>/2017/01/08/GET%E8%AF%B7%E6%B1%82InvalidParameternotsatisfying/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-11-26 11:54:45)<br>GET请求是最常见的请求，对于链接可以不需要parameter，但是有时链接古怪，在请求过程中，请求方法对<br>NSParameterAssert(URLString);的URLString 进行判别，于是乎，控制台崩溃打印为“Invalid parameter not satisfying: URLString”。<br>(<a href="http://www.bubuko.com/infodetail-398645.html" target="_blank" rel="noopener">http://www.bubuko.com/infodetail-398645.html</a>)<br>这个地址可以解释，做法很简单，不要把你的paramater拼进URLString，单独写出来，如：<br><code>[[AFHTTPRequestOperationManager manager] GET:urlString parameters:paraDic success:^(AFHTTPRequestOperation *operation, id responseObject) {    successBlock(operation,responseObject);    NSLog(@&quot;-----responseObject:%@&quot;,responseObject);} failure:^(AFHTTPRequestOperation *operation, NSError *error) {    NSLog(@&quot;-----error:%@&quot;,error);    failBlock(operation,error);}];</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>定时器</title>
      <link href="/2017/01/08/%E5%AE%9A%E6%97%B6%E5%99%A8/"/>
      <url>/2017/01/08/%E5%AE%9A%E6%97%B6%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-11-25 10:26:26)<br>今天在群里讨论一个问题<br><img src="http://s6.sinaimg.cn/mw690/003479W3gy6XgUW8NcVc5&amp;690" alt="实战图片1" title="60秒定时器"><br>这里程序已进入即开始走，而且，当第一次点击时，时间跳转60s走了30s，，减少一半。我判断为：在判断enable的时候，定时器就认为走了，把判断语句换了就可以了</p><h2 id="于是程序如下："><a href="#于是程序如下：" class="headerlink" title="于是程序如下："></a>于是程序如下：</h2><p><code>@weakify(self);</code><br><code>RACSignal *timeSignal = [[[[[RACSignal interval:1.0f onScheduler:[RACScheduler mainThreadScheduler]] take:60]startWith:@1] map:^id(NSDate *date) {    @strongify(self);    NSLog(@&quot;我被执行第%d次___%@&quot;,_number,date);    if (_number == 0) {        [self.button setTitle:@&quot;重新发送&quot; forState:UIControlStateNormal];        return @YES;    }    else{        [self.button setTitle:[NSString stringWithFormat:@&quot;%d&quot;, _number--] forState:UIControlStateDisabled];        return @NO;    }}] takeUntil:self.rac_willDeallocSignal];</code></p><p><code>self.button.rac_command = [[RACCommand alloc]initWithEnabled:[self  enableSignal]signalBlock:^RACSignal *(id input) {    _number = 60;    return timeSignal;}];}</code></p><p><code>-(RACSignal *)enableSignal{    return [[RACSignal createSignal:^RACDisposable *(id subscriber) {        return nil;    }] map:^id(id value) {        return @(self.number&gt;0);    }];}</code></p><p>把enable换成固定signal，这样就不会失误了。<br>记，成功只给勤奋的人，我认为一个demo写的好，我对着写了一遍，不理解，没关系；第二遍重写，理解了里面思路；第三遍，学会了怎么用；第四遍，我思考着他的功能，稍微看了下，自己写。<br>我认为只有这样才会记进心里去。</p>]]></content>
      
      
      
        <tags>
            
            <tag> RAC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ReactiveCocoa常用语法</title>
      <link href="/2017/01/08/ReactiveCocoa%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/"/>
      <url>/2017/01/08/ReactiveCocoa%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-11-20 11:13:34)<br>此为青玉伏案 发表，我觉得挺有概括的，基础学不错，RACSubject我在别的一些文章看到说，不要太范用，不过却又是原生和RAC世界的桥梁，大家看着办吧。<br>`-(void)uppercaseString{<br>RACSequence <em>sequence = @[@”you”,@”are”,@”beautiful”].rac_sequence;<br>RACSignal </em>signal = sequence.signal;</p><p>RACSignal *capitalizedSignal = [signal map:^id(id value) {<br>return [value capitalizedString];<br>}];</p><p>[signal subscribeNext:^(id x) {<br>NSLog(@”%@”,x);<br>}];`</p><p>`//    [capitalizedSignal subscribeNext:^(id x) {<br>//        NSLog(@”capitalizedSignal —— %@”,x);<br>//    }];<br>//<br>//<br>//<br>//    [[[@[@”you”,@”are”,@”beautiful”].rac_sequence signal]<br>//     map:^id(id value) {<br>//        return [value capitalizedString];<br>//    }] subscribeNext:^(id x) {<br>//        NSLog(@”%@”,x);<br>//    }];</p><p>}`</p><p>`-(void)signalSwitch{<br>RACSubject <em>google = [RACSubject subject];<br>RACSubject </em>baidu = [RACSubject subject];<br>RACSubject *signalOfSignal = [RACSubject subject];</p><p>RACSignal *switchSignal = [signalOfSignal switchToLatest];</p><p>[switchSignal subscribeNext:^(id x) {<br>NSLog(@”%@”,x);<br>}];</p><p>[signalOfSignal sendNext:baidu];<br>[baidu sendNext:@”baidu”];<br>[google sendNext:@”google”];</p><p>[signalOfSignal sendNext:google];<br>[baidu sendNext:@”baidu”];<br>[google sendNext:@”google”];</p><p>}`</p><p>`-(void)combinaLatest{<br>RACSubject <em>signalA = [RACSubject subject];<br>RACSubject </em>signalB = [RACSubject subject];</p><p>[[RACSignal combineLatest:@[signalA,signalB]<br>reduce:^id(NSString <em>a,NSString </em>b){<br>return [a stringByAppendingString:b];<br>}] subscribeNext:^(id x) {<br>NSLog(@”x:%@”,x);<br>}];</p><p>[signalA sendNext:@”a”];<br>[signalA sendNext:@”b”];<br>[signalB sendNext:@”1”];<br>[signalB sendNext:@”2”];</p><p>}`</p><p>`-(void)mergeSignal{<br>RACSubject <em>letters = [RACSubject subject];<br>RACSubject </em>numbers = [RACSubject subject];</p><p>RACSubject *chinese = [RACSubject subject];</p><p>[[RACSignal merge:@[letters,numbers,chinese]] subscribeNext:^(id x) {<br>NSLog(@”merge : %@”,x);<br>}];</p><p>[letters sendNext:@”aaa”];<br>[numbers sendNext:@”666”];<br>[chinese sendNext:@”好好好”];</p><p>}`</p>]]></content>
      
      
      
        <tags>
            
            <tag> IT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2015年11月23日</title>
      <link href="/2015/11/23/2015%E5%B9%B411%E6%9C%8823%E6%97%A5/"/>
      <url>/2015/11/23/2015%E5%B9%B411%E6%9C%8823%E6%97%A5/</url>
      
        <content type="html"><![CDATA[<p>发表于(2015-11-23 10:00:27)<br>记一次写朋友圈，当全屏展示照片，然后退下出现原来正常的tableView，向下走了44px。视图进入时，一开始有些坐标，变现正常，后来不正常了。这里我做了两件事来避免，原因没有找对吧</p><ol><li><a href="http://www.tuicool.com/articles/FFJv2eF" title="写的还不错哦" target="_blank" rel="noopener">IOS7 导航栏适配 - 王小飞</a></li><li>更改习惯，viewDidLoad只进行控件、信息、内容加载；viewWillAppear进行坐标定位。</li></ol><p>昨天给别人改一个问题，LongGesture的方法老是走两次，一直没认真想，为什么。其实很久以前知道，但是不以为然，总的来说，工作的时候，一定以工作为主，活动就以活动为主，不然，活动的时候想工作的事情，毕竟静不下心，想不进去问题的本身。</p>]]></content>
      
      
      
        <tags>
            
            <tag> IT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>学习进步,记录点滴</title>
      <link href="/2015/10/23/hello-world/"/>
      <url>/2015/10/23/hello-world/</url>
      
        <content type="html"><![CDATA[<h1 id="学习永不止步，前进永不止步，记录永不止步"><a href="#学习永不止步，前进永不止步，记录永不止步" class="headerlink" title="学习永不止步，前进永不止步，记录永不止步"></a>学习永不止步，前进永不止步，记录永不止步</h1><h2 id="我是一名Object-C开发者，爱记录，爱钻研，还有什么爱好呢，还没好好开发副业，想好就出发"><a href="#我是一名Object-C开发者，爱记录，爱钻研，还有什么爱好呢，还没好好开发副业，想好就出发" class="headerlink" title="我是一名Object-C开发者，爱记录，爱钻研，还有什么爱好呢，还没好好开发副业，想好就出发"></a>我是一名Object-C开发者，爱记录，爱钻研，还有什么爱好呢，还没好好开发副业，想好就出发</h2><ol><li>整理知识，学习笔记</li><li>发布日记，杂文，所见所想</li><li>生活记录，点滴不怠</li><li>点子记录</li><li>勇于尝试</li></ol>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
